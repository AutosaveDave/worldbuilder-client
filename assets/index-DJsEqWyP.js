import{a as eM,b as sP,c as rP,d as cn,u as aP,e as oP,r as Ve,j as W,B as yn,A as IR,T as Nt,D as R0,L as lP,f as lA,g as cA,H as cP,h as uA,P as fb,i as hA,k as uP,l as hP,I as k_,M as fP,m as dP,n as fA,o as ey,C as DR,p as pP,R as mP,G as xr,q as kp,s as Hp,t as Gp,v as Un,S as gs,w as vc,x as NR,y as tM,z as gP,E as yP,F as vP,J as _P,K as xP,N as bP,O as SP,Q as EP,U as MP,V as TP,W as AP,X as wP,Y as CP,Z as RP,_ as IP,$ as DP,a0 as NP,a1 as PR,a2 as PP,a3 as LR,a4 as $_,a5 as J_,a6 as ex,a7 as _l,a8 as OR,a9 as UR,aa as sE,ab as LP,ac as dA,ad as OP,ae as UP,af as zP}from"./mui-DUnp5vII.js";import{u as fd,a as zR,L as pA,O as FP,b as vm,H as BP,R as VP,c as au}from"./react-8jfLZ-x7.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var FS={exports:{}},Wg={},BS={exports:{}},VS={};var mA;function kP(){return mA||(mA=1,(function(i){function e(ee,ie){var ye=ee.length;ee.push(ie);e:for(;0<ye;){var be=ye-1>>>1,Be=ee[be];if(0<s(Be,ie))ee[be]=ie,ee[ye]=Be,ye=be;else break e}}function t(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var ie=ee[0],ye=ee.pop();if(ye!==ie){ee[0]=ye;e:for(var be=0,Be=ee.length,Oe=Be>>>1;be<Oe;){var Pe=2*(be+1)-1,$e=ee[Pe],Mt=Pe+1,Yt=ee[Mt];if(0>s($e,ye))Mt<Be&&0>s(Yt,$e)?(ee[be]=Yt,ee[Mt]=ye,be=Mt):(ee[be]=$e,ee[Pe]=ye,be=Pe);else if(Mt<Be&&0>s(Yt,ye))ee[be]=Yt,ee[Mt]=ye,be=Mt;else break e}}return ie}function s(ee,ie){var ye=ee.sortIndex-ie.sortIndex;return ye!==0?ye:ee.id-ie.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var c=Date,f=c.now();i.unstable_now=function(){return c.now()-f}}var d=[],m=[],y=1,v=null,x=3,E=!1,T=!1,I=!1,w=!1,A=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function U(ee){for(var ie=t(m);ie!==null;){if(ie.callback===null)n(m);else if(ie.startTime<=ee)n(m),ie.sortIndex=ie.expirationTime,e(d,ie);else break;ie=t(m)}}function q(ee){if(I=!1,U(ee),!T)if(t(d)!==null)T=!0,j||(j=!0,X());else{var ie=t(m);ie!==null&&he(q,ie.startTime-ee)}}var j=!1,F=-1,R=5,P=-1;function H(){return w?!0:!(i.unstable_now()-P<R)}function B(){if(w=!1,j){var ee=i.unstable_now();P=ee;var ie=!0;try{e:{T=!1,I&&(I=!1,N(F),F=-1),E=!0;var ye=x;try{t:{for(U(ee),v=t(d);v!==null&&!(v.expirationTime>ee&&H());){var be=v.callback;if(typeof be=="function"){v.callback=null,x=v.priorityLevel;var Be=be(v.expirationTime<=ee);if(ee=i.unstable_now(),typeof Be=="function"){v.callback=Be,U(ee),ie=!0;break t}v===t(d)&&n(d),U(ee)}else n(d);v=t(d)}if(v!==null)ie=!0;else{var Oe=t(m);Oe!==null&&he(q,Oe.startTime-ee),ie=!1}}break e}finally{v=null,x=ye,E=!1}ie=void 0}}finally{ie?X():j=!1}}}var X;if(typeof O=="function")X=function(){O(B)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,ue=k.port2;k.port1.onmessage=B,X=function(){ue.postMessage(null)}}else X=function(){A(B,0)};function he(ee,ie){F=A(function(){ee(i.unstable_now())},ie)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(ee){ee.callback=null},i.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ee?Math.floor(1e3/ee):5},i.unstable_getCurrentPriorityLevel=function(){return x},i.unstable_next=function(ee){switch(x){case 1:case 2:case 3:var ie=3;break;default:ie=x}var ye=x;x=ie;try{return ee()}finally{x=ye}},i.unstable_requestPaint=function(){w=!0},i.unstable_runWithPriority=function(ee,ie){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ye=x;x=ee;try{return ie()}finally{x=ye}},i.unstable_scheduleCallback=function(ee,ie,ye){var be=i.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?be+ye:be):ye=be,ee){case 1:var Be=-1;break;case 2:Be=250;break;case 5:Be=1073741823;break;case 4:Be=1e4;break;default:Be=5e3}return Be=ye+Be,ee={id:y++,callback:ie,priorityLevel:ee,startTime:ye,expirationTime:Be,sortIndex:-1},ye>be?(ee.sortIndex=ye,e(m,ee),t(d)===null&&ee===t(m)&&(I?(N(F),F=-1):I=!0,he(q,ye-be))):(ee.sortIndex=Be,e(d,ee),T||E||(T=!0,j||(j=!0,X()))),ee},i.unstable_shouldYield=H,i.unstable_wrapCallback=function(ee){var ie=x;return function(){var ye=x;x=ie;try{return ee.apply(this,arguments)}finally{x=ye}}}})(VS)),VS}var gA;function FR(){return gA||(gA=1,BS.exports=kP()),BS.exports}var yA;function HP(){if(yA)return Wg;yA=1;var i=FR(),e=eM(),t=sP();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,h=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(h=o.return),r=o.return;while(r)}return o.tag===3?h:null}function c(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function f(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function d(r){if(a(r)!==r)throw Error(n(188))}function m(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(n(188));return o!==r?null:r}for(var h=r,p=o;;){var S=h.return;if(S===null)break;var M=S.alternate;if(M===null){if(p=S.return,p!==null){h=p;continue}break}if(S.child===M.child){for(M=S.child;M;){if(M===h)return d(S),r;if(M===p)return d(S),o;M=M.sibling}throw Error(n(188))}if(h.return!==p.return)h=S,p=M;else{for(var z=!1,K=S.child;K;){if(K===h){z=!0,h=S,p=M;break}if(K===p){z=!0,p=S,h=M;break}K=K.sibling}if(!z){for(K=M.child;K;){if(K===h){z=!0,h=M,p=S;break}if(K===p){z=!0,p=M,h=S;break}K=K.sibling}if(!z)throw Error(n(189))}}if(h.alternate!==p)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?r:o}function y(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=y(r),o!==null)return o;r=r.sibling}return null}var v=Object.assign,x=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),O=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function X(r){return r===null||typeof r!="object"?null:(r=B&&r[B]||r["@@iterator"],typeof r=="function"?r:null)}var k=Symbol.for("react.client.reference");function ue(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===k?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case A:return"Profiler";case w:return"StrictMode";case q:return"Suspense";case j:return"SuspenseList";case P:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case T:return"Portal";case O:return r.displayName||"Context";case N:return(r._context.displayName||"Context")+".Consumer";case U:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case F:return o=r.displayName||null,o!==null?o:ue(r.type)||"Memo";case R:o=r._payload,r=r._init;try{return ue(r(o))}catch{}}return null}var he=Array.isArray,ee=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye={pending:!1,data:null,method:null,action:null},be=[],Be=-1;function Oe(r){return{current:r}}function Pe(r){0>Be||(r.current=be[Be],be[Be]=null,Be--)}function $e(r,o){Be++,be[Be]=r.current,r.current=o}var Mt=Oe(null),Yt=Oe(null),Ie=Oe(null),tt=Oe(null);function nt(r,o){switch($e(Ie,o),$e(Yt,r),$e(Mt,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?DT(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=DT(o),r=NT(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}Pe(Mt),$e(Mt,r)}function Tt(){Pe(Mt),Pe(Yt),Pe(Ie)}function Lt(r){r.memoizedState!==null&&$e(tt,r);var o=Mt.current,h=NT(o,r.type);o!==h&&($e(Yt,r),$e(Mt,h))}function Ht(r){Yt.current===r&&(Pe(Mt),Pe(Yt)),tt.current===r&&(Pe(tt),kg._currentValue=ye)}var un,zt;function Ue(r){if(un===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);un=o&&o[1]||"",zt=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+un+r+zt}var Ye=!1;function ze(r,o){if(!r||Ye)return"";Ye=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var Ge=function(){throw Error()};if(Object.defineProperty(Ge.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ge,[])}catch(Ne){var Me=Ne}Reflect.construct(r,[],Ge)}else{try{Ge.call()}catch(Ne){Me=Ne}r.call(Ge.prototype)}}else{try{throw Error()}catch(Ne){Me=Ne}(Ge=r())&&typeof Ge.catch=="function"&&Ge.catch(function(){})}}catch(Ne){if(Ne&&Me&&typeof Ne.stack=="string")return[Ne.stack,Me.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var M=p.DetermineComponentFrameRoot(),z=M[0],K=M[1];if(z&&K){var re=z.split(`
`),_e=K.split(`
`);for(S=p=0;p<re.length&&!re[p].includes("DetermineComponentFrameRoot");)p++;for(;S<_e.length&&!_e[S].includes("DetermineComponentFrameRoot");)S++;if(p===re.length||S===_e.length)for(p=re.length-1,S=_e.length-1;1<=p&&0<=S&&re[p]!==_e[S];)S--;for(;1<=p&&0<=S;p--,S--)if(re[p]!==_e[S]){if(p!==1||S!==1)do if(p--,S--,0>S||re[p]!==_e[S]){var Le=`
`+re[p].replace(" at new "," at ");return r.displayName&&Le.includes("<anonymous>")&&(Le=Le.replace("<anonymous>",r.displayName)),Le}while(1<=p&&0<=S);break}}}finally{Ye=!1,Error.prepareStackTrace=h}return(h=r?r.displayName||r.name:"")?Ue(h):""}function ot(r,o){switch(r.tag){case 26:case 27:case 5:return Ue(r.type);case 16:return Ue("Lazy");case 13:return r.child!==o&&o!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return ze(r.type,!1);case 11:return ze(r.type.render,!1);case 1:return ze(r.type,!0);case 31:return Ue("Activity");default:return""}}function te(r){try{var o="",h=null;do o+=ot(r,h),h=r,r=r.return;while(r);return o}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}var yt=Object.prototype.hasOwnProperty,it=i.unstable_scheduleCallback,Rt=i.unstable_cancelCallback,st=i.unstable_shouldYield,Q=i.unstable_requestPaint,G=i.unstable_now,oe=i.unstable_getCurrentPriorityLevel,Ae=i.unstable_ImmediatePriority,Fe=i.unstable_UserBlockingPriority,we=i.unstable_NormalPriority,vt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,It=i.log,Ft=i.unstable_setDisableYieldValue,We=null,Xe=null;function _t(r){if(typeof It=="function"&&Ft(r),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(We,r)}catch{}}var ne=Math.clz32?Math.clz32:se,xe=Math.log,at=Math.LN2;function se(r){return r>>>=0,r===0?32:31-(xe(r)/at|0)|0}var je=256,Ze=262144,Je=4194304;function Qe(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Ce(r,o,h){var p=r.pendingLanes;if(p===0)return 0;var S=0,M=r.suspendedLanes,z=r.pingedLanes;r=r.warmLanes;var K=p&134217727;return K!==0?(p=K&~M,p!==0?S=Qe(p):(z&=K,z!==0?S=Qe(z):h||(h=K&~r,h!==0&&(S=Qe(h))))):(K=p&~M,K!==0?S=Qe(K):z!==0?S=Qe(z):h||(h=p&~r,h!==0&&(S=Qe(h)))),S===0?0:o!==0&&o!==S&&(o&M)===0&&(M=S&-S,h=o&-o,M>=h||M===32&&(h&4194048)!==0)?o:S}function dt(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function Bt(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hn(){var r=Je;return Je<<=1,(Je&62914560)===0&&(Je=4194304),r}function nn(r){for(var o=[],h=0;31>h;h++)o.push(r);return o}function Si(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Gi(r,o,h,p,S,M){var z=r.pendingLanes;r.pendingLanes=h,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=h,r.entangledLanes&=h,r.errorRecoveryDisabledLanes&=h,r.shellSuspendCounter=0;var K=r.entanglements,re=r.expirationTimes,_e=r.hiddenUpdates;for(h=z&~h;0<h;){var Le=31-ne(h),Ge=1<<Le;K[Le]=0,re[Le]=-1;var Me=_e[Le];if(Me!==null)for(_e[Le]=null,Le=0;Le<Me.length;Le++){var Ne=Me[Le];Ne!==null&&(Ne.lane&=-536870913)}h&=~Ge}p!==0&&Er(r,p,0),M!==0&&S===0&&r.tag!==0&&(r.suspendedLanes|=M&~(z&~o))}function Er(r,o,h){r.pendingLanes|=o,r.suspendedLanes&=~o;var p=31-ne(o);r.entangledLanes|=o,r.entanglements[p]=r.entanglements[p]|1073741824|h&261930}function pa(r,o){var h=r.entangledLanes|=o;for(r=r.entanglements;h;){var p=31-ne(h),S=1<<p;S&o|r[p]&o&&(r[p]|=o),h&=~S}}function Tl(r,o){var h=o&-o;return h=(h&42)!==0?1:qr(h),(h&(r.suspendedLanes|o))!==0?0:h}function qr(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function er(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Mr(){var r=ie.p;return r!==0?r:(r=window.event,r===void 0?32:tA(r.type))}function ji(r,o){var h=ie.p;try{return ie.p=r,o()}finally{ie.p=h}}var tr=Math.random().toString(36).slice(2),fi="__reactFiber$"+tr,_i="__reactProps$"+tr,nr="__reactContainer$"+tr,bs="__reactEvents$"+tr,Xr="__reactListeners$"+tr,Wa="__reactHandles$"+tr,Al="__reactResources$"+tr,Ws="__reactMarker$"+tr;function ma(r){delete r[fi],delete r[_i],delete r[bs],delete r[Xr],delete r[Wa]}function Yr(r){var o=r[fi];if(o)return o;for(var h=r.parentNode;h;){if(o=h[nr]||h[fi]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(r=BT(r);r!==null;){if(h=r[fi])return h;r=BT(r)}return o}r=h,h=r.parentNode}return null}function ir(r){if(r=r[fi]||r[nr]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function qs(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function Z(r){var o=r[Al];return o||(o=r[Al]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function le(r){r[Ws]=!0}var Se=new Set,ge={};function me(r,o){lt(r,o),lt(r+"Capture",o)}function lt(r,o){for(ge[r]=o,r=0;r<o.length;r++)Se.add(o[r])}var pt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gt={},ht={};function Pt(r){return yt.call(ht,r)?!0:yt.call(gt,r)?!1:pt.test(r)?ht[r]=!0:(gt[r]=!0,!1)}function Kt(r,o,h){if(Pt(o))if(h===null)r.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+h)}}function jt(r,o,h){if(h===null)r.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+h)}}function bt(r,o,h,p){if(p===null)r.removeAttribute(h);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(h);return}r.setAttributeNS(o,h,""+p)}}function sn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function qn(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ti(r,o,h){var p=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var S=p.get,M=p.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return S.call(this)},set:function(z){h=""+z,M.call(this,z)}}),Object.defineProperty(r,o,{enumerable:p.enumerable}),{getValue:function(){return h},setValue:function(z){h=""+z},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Ut(r){if(!r._valueTracker){var o=qn(r)?"checked":"value";r._valueTracker=ti(r,o,""+r[o])}}function Cn(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var h=o.getValue(),p="";return r&&(p=qn(r)?r.checked?"true":"false":r.value),r=p,r!==h?(o.setValue(r),!0):!1}function ct(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ei=/[\n"\\]/g;function Qt(r){return r.replace(Ei,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Wi(r,o,h,p,S,M,z,K){r.name="",z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?r.type=z:r.removeAttribute("type"),o!=null?z==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+sn(o)):r.value!==""+sn(o)&&(r.value=""+sn(o)):z!=="submit"&&z!=="reset"||r.removeAttribute("value"),o!=null?qi(r,z,sn(o)):h!=null?qi(r,z,sn(h)):p!=null&&r.removeAttribute("value"),S==null&&M!=null&&(r.defaultChecked=!!M),S!=null&&(r.checked=S&&typeof S!="function"&&typeof S!="symbol"),K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?r.name=""+sn(K):r.removeAttribute("name")}function Ls(r,o,h,p,S,M,z,K){if(M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(r.type=M),o!=null||h!=null){if(!(M!=="submit"&&M!=="reset"||o!=null)){Ut(r);return}h=h!=null?""+sn(h):"",o=o!=null?""+sn(o):h,K||o===r.value||(r.value=o),r.defaultValue=o}p=p??S,p=typeof p!="function"&&typeof p!="symbol"&&!!p,r.checked=K?r.checked:!!p,r.defaultChecked=!!p,z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"&&(r.name=z),Ut(r)}function qi(r,o,h){o==="number"&&ct(r.ownerDocument)===r||r.defaultValue===""+h||(r.defaultValue=""+h)}function Ss(r,o,h,p){if(r=r.options,o){o={};for(var S=0;S<h.length;S++)o["$"+h[S]]=!0;for(h=0;h<r.length;h++)S=o.hasOwnProperty("$"+r[h].value),r[h].selected!==S&&(r[h].selected=S),S&&p&&(r[h].defaultSelected=!0)}else{for(h=""+sn(h),o=null,S=0;S<r.length;S++){if(r[S].value===h){r[S].selected=!0,p&&(r[S].defaultSelected=!0);return}o!==null||r[S].disabled||(o=r[S])}o!==null&&(o.selected=!0)}}function Vn(r,o,h){if(o!=null&&(o=""+sn(o),o!==r.value&&(r.value=o),h==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=h!=null?""+sn(h):""}function li(r,o,h,p){if(o==null){if(p!=null){if(h!=null)throw Error(n(92));if(he(p)){if(1<p.length)throw Error(n(93));p=p[0]}h=p}h==null&&(h=""),o=h}h=sn(o),r.defaultValue=h,p=r.textContent,p===h&&p!==""&&p!==null&&(r.value=p),Ut(r)}function Mi(r,o){if(o){var h=r.firstChild;if(h&&h===r.lastChild&&h.nodeType===3){h.nodeValue=o;return}}r.textContent=o}var Ti=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sr(r,o,h){var p=o.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?p?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":p?r.setProperty(o,h):typeof h!="number"||h===0||Ti.has(o)?o==="float"?r.cssFloat=h:r[o]=(""+h).trim():r[o]=h+"px"}function Zr(r,o,h){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,h!=null){for(var p in h)!h.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?r.setProperty(p,""):p==="float"?r.cssFloat="":r[p]="");for(var S in o)p=o[S],o.hasOwnProperty(S)&&h[S]!==p&&sr(r,S,p)}else for(var M in o)o.hasOwnProperty(M)&&sr(r,M,o[M])}function ho(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),fo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cc(r){return fo.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function qa(){}var Su=null;function Kr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Xo=null,ga=null;function wl(r){var o=ir(r);if(o&&(r=o.stateNode)){var h=r[_i]||null;e:switch(r=o.stateNode,o.type){case"input":if(Wi(r,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),o=h.name,h.type==="radio"&&o!=null){for(h=r;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+Qt(""+o)+'"][type="radio"]'),o=0;o<h.length;o++){var p=h[o];if(p!==r&&p.form===r.form){var S=p[_i]||null;if(!S)throw Error(n(90));Wi(p,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(o=0;o<h.length;o++)p=h[o],p.form===r.form&&Cn(p)}break e;case"textarea":Vn(r,h.value,h.defaultValue);break e;case"select":o=h.value,o!=null&&Ss(r,!!h.multiple,o,!1)}}}var Rc=!1;function Yo(r,o,h){if(Rc)return r(o,h);Rc=!0;try{var p=r(o);return p}finally{if(Rc=!1,(Xo!==null||ga!==null)&&(io(),Xo&&(o=Xo,r=ga,ga=Xo=null,wl(o),r)))for(o=0;o<r.length;o++)wl(r[o])}}function ya(r,o){var h=r.stateNode;if(h===null)return null;var p=h[_i]||null;if(p===null)return null;h=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(r=r.type,p=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!p;break e;default:r=!1}if(r)return null;if(h&&typeof h!="function")throw Error(n(231,o,typeof h));return h}var Qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ic=!1;if(Qr)try{var si={};Object.defineProperty(si,"passive",{get:function(){Ic=!0}}),window.addEventListener("test",si,si),window.removeEventListener("test",si,si)}catch{Ic=!1}var rr=null,Eu=null,po=null;function Cl(){if(po)return po;var r,o=Eu,h=o.length,p,S="value"in rr?rr.value:rr.textContent,M=S.length;for(r=0;r<h&&o[r]===S[r];r++);var z=h-r;for(p=1;p<=z&&o[h-p]===S[M-p];p++);return po=S.slice(r,1<p?1-p:void 0)}function Rl(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Xa(){return!0}function Ya(){return!1}function Es(r){function o(h,p,S,M,z){this._reactName=h,this._targetInst=S,this.type=p,this.nativeEvent=M,this.target=z,this.currentTarget=null;for(var K in r)r.hasOwnProperty(K)&&(h=r[K],this[K]=h?h(M):M[K]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?Xa:Ya,this.isPropagationStopped=Ya,this}return v(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Xa)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Xa)},persist:function(){},isPersistent:Xa}),o}var mo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Za=Es(mo),Zo=v({},mo,{view:0,detail:0}),Mu=Es(Zo),go,Dc,Ka,Il=v({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ko,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ka&&(Ka&&r.type==="mousemove"?(go=r.screenX-Ka.screenX,Dc=r.screenY-Ka.screenY):Dc=go=0,Ka=r),go)},movementY:function(r){return"movementY"in r?r.movementY:Dc}}),Tu=Es(Il),Dl=v({},Il,{dataTransfer:0}),qh=Es(Dl),Au=v({},Zo,{relatedTarget:0}),Nl=Es(Au),wu=v({},mo,{animationName:0,elapsedTime:0,pseudoElement:0}),vd=Es(wu),Cu=v({},mo,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Xh=Es(Cu),Pl=v({},mo,{data:0}),va=Es(Pl),Nc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ru(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Zh[r])?!!o[r]:!1}function Ko(){return Ru}var Xs=v({},Zo,{key:function(r){if(r.key){var o=Nc[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Rl(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Yh[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ko,charCode:function(r){return r.type==="keypress"?Rl(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Rl(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),yo=Es(Xs),Pc=v({},Il,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vo=Es(Pc),_=v({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ko}),L=Es(_),V=v({},mo,{propertyName:0,elapsedTime:0,pseudoElement:0}),$=Es(V),fe=v({},Il,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Te=Es(fe),mt=v({},mo,{newState:0,oldState:0}),fn=Es(mt),Fi=[9,13,27,32],zn=Qr&&"CompositionEvent"in window,xi=null;Qr&&"documentMode"in document&&(xi=document.documentMode);var ar=Qr&&"TextEvent"in window&&!xi,Qa=Qr&&(!zn||xi&&8<xi&&11>=xi),$a=" ",Tr=!1;function Qo(r,o){switch(r){case"keyup":return Fi.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lc(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Oc=!1;function yy(r,o){switch(r){case"compositionend":return Lc(o);case"keypress":return o.which!==32?null:(Tr=!0,$a);case"textInput":return r=o.data,r===$a&&Tr?null:r;default:return null}}function Nm(r,o){if(Oc)return r==="compositionend"||!zn&&Qo(r,o)?(r=Cl(),po=Eu=rr=null,Oc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Qa&&o.locale!=="ko"?null:o.data;default:return null}}var Pm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lm(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!Pm[r.type]:o==="textarea"}function _d(r,o,h,p){Xo?ga?ga.push(p):ga=[p]:Xo=p,o=Sv(o,"onChange"),0<o.length&&(h=new Za("onChange","change",null,h,p),r.push({event:h,listeners:o}))}var Ll=null,Uc=null;function vy(r){TT(r,0)}function Iu(r){var o=qs(r);if(Cn(o))return r}function Om(r,o){if(r==="change")return o}var _o=!1;if(Qr){var Kh;if(Qr){var Um="oninput"in document;if(!Um){var zm=document.createElement("div");zm.setAttribute("oninput","return;"),Um=typeof zm.oninput=="function"}Kh=Um}else Kh=!1;_o=Kh&&(!document.documentMode||9<document.documentMode)}function _a(){Ll&&(Ll.detachEvent("onpropertychange",Qh),Uc=Ll=null)}function Qh(r){if(r.propertyName==="value"&&Iu(Uc)){var o=[];_d(o,Uc,r,Kr(r)),Yo(vy,o)}}function _y(r,o,h){r==="focusin"?(_a(),Ll=o,Uc=h,Ll.attachEvent("onpropertychange",Qh)):r==="focusout"&&_a()}function Fm(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Iu(Uc)}function xy(r,o){if(r==="click")return Iu(o)}function by(r,o){if(r==="input"||r==="change")return Iu(o)}function Bm(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var or=typeof Object.is=="function"?Object.is:Bm;function Du(r,o){if(or(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var h=Object.keys(r),p=Object.keys(o);if(h.length!==p.length)return!1;for(p=0;p<h.length;p++){var S=h[p];if(!yt.call(o,S)||!or(r[S],o[S]))return!1}return!0}function $h(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Nu(r,o){var h=$h(r);r=0;for(var p;h;){if(h.nodeType===3){if(p=r+h.textContent.length,r<=o&&p>=o)return{node:h,offset:o-r};r=p}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=$h(h)}}function di(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?di(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Sy(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=ct(r.document);o instanceof r.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)r=o.contentWindow;else break;o=ct(r.document)}return o}function Vm(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var Ey=Qr&&"documentMode"in document&&11>=document.documentMode,xo=null,bo=null,Pu=null,xd=!1;function Lu(r,o,h){var p=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;xd||xo==null||xo!==ct(p)||(p=xo,"selectionStart"in p&&Vm(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Pu&&Du(Pu,p)||(Pu=p,p=Sv(bo,"onSelect"),0<p.length&&(o=new Za("onSelect","select",null,o,h),r.push({event:o,listeners:p}),o.target=xo)))}function Ys(r,o){var h={};return h[r.toLowerCase()]=o.toLowerCase(),h["Webkit"+r]="webkit"+o,h["Moz"+r]="moz"+o,h}var zc={animationend:Ys("Animation","AnimationEnd"),animationiteration:Ys("Animation","AnimationIteration"),animationstart:Ys("Animation","AnimationStart"),transitionrun:Ys("Transition","TransitionRun"),transitionstart:Ys("Transition","TransitionStart"),transitioncancel:Ys("Transition","TransitionCancel"),transitionend:Ys("Transition","TransitionEnd")},Jh={},km={};Qr&&(km=document.createElement("div").style,"AnimationEvent"in window||(delete zc.animationend.animation,delete zc.animationiteration.animation,delete zc.animationstart.animation),"TransitionEvent"in window||delete zc.transitionend.transition);function $o(r){if(Jh[r])return Jh[r];if(!zc[r])return r;var o=zc[r],h;for(h in o)if(o.hasOwnProperty(h)&&h in km)return Jh[r]=o[h];return r}var bd=$o("animationend"),ef=$o("animationiteration"),Hm=$o("animationstart"),My=$o("transitionrun"),oS=$o("transitionstart"),Ty=$o("transitioncancel"),Gm=$o("transitionend"),xa=new Map,tf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");tf.push("scrollEnd");function ba(r,o){xa.set(r,o),me(o,[r])}var nf=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Sa=[],Jo=0,Ms=0;function sf(){for(var r=Jo,o=Ms=Jo=0;o<r;){var h=Sa[o];Sa[o++]=null;var p=Sa[o];Sa[o++]=null;var S=Sa[o];Sa[o++]=null;var M=Sa[o];if(Sa[o++]=null,p!==null&&S!==null){var z=p.pending;z===null?S.next=S:(S.next=z.next,z.next=S),p.pending=S}M!==0&&Ol(h,S,M)}}function Ts(r,o,h,p){Sa[Jo++]=r,Sa[Jo++]=o,Sa[Jo++]=h,Sa[Jo++]=p,Ms|=p,r.lanes|=p,r=r.alternate,r!==null&&(r.lanes|=p)}function Sd(r,o,h,p){return Ts(r,o,h,p),Ea(r)}function lr(r,o){return Ts(r,null,null,o),Ea(r)}function Ol(r,o,h){r.lanes|=h;var p=r.alternate;p!==null&&(p.lanes|=h);for(var S=!1,M=r.return;M!==null;)M.childLanes|=h,p=M.alternate,p!==null&&(p.childLanes|=h),M.tag===22&&(r=M.stateNode,r===null||r._visibility&1||(S=!0)),r=M,M=M.return;return r.tag===3?(M=r.stateNode,S&&o!==null&&(S=31-ne(h),r=M.hiddenUpdates,p=r[S],p===null?r[S]=[o]:p.push(o),o.lane=h|536870912),M):null}function Ea(r){if(50<ec)throw ec=0,nu=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Ul={};function jm(r,o,h,p){this.tag=r,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ii(r,o,h,p){return new jm(r,o,h,p)}function Ed(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ar(r,o){var h=r.alternate;return h===null?(h=Ii(r.tag,o,r.key,r.mode),h.elementType=r.elementType,h.type=r.type,h.stateNode=r.stateNode,h.alternate=r,r.alternate=h):(h.pendingProps=o,h.type=r.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=r.flags&65011712,h.childLanes=r.childLanes,h.lanes=r.lanes,h.child=r.child,h.memoizedProps=r.memoizedProps,h.memoizedState=r.memoizedState,h.updateQueue=r.updateQueue,o=r.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=r.sibling,h.index=r.index,h.ref=r.ref,h.refCleanup=r.refCleanup,h}function Ou(r,o){r.flags&=65011714;var h=r.alternate;return h===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=h.childLanes,r.lanes=h.lanes,r.child=h.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=h.memoizedProps,r.memoizedState=h.memoizedState,r.updateQueue=h.updateQueue,r.type=h.type,o=h.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function So(r,o,h,p,S,M){var z=0;if(p=r,typeof r=="function")Ed(r)&&(z=1);else if(typeof r=="string")z=qN(r,h,Mt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case P:return r=Ii(31,h,o,S),r.elementType=P,r.lanes=M,r;case I:return zl(h.children,S,M,o);case w:z=8,S|=24;break;case A:return r=Ii(12,h,o,S|2),r.elementType=A,r.lanes=M,r;case q:return r=Ii(13,h,o,S),r.elementType=q,r.lanes=M,r;case j:return r=Ii(19,h,o,S),r.elementType=j,r.lanes=M,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case O:z=10;break e;case N:z=9;break e;case U:z=11;break e;case F:z=14;break e;case R:z=16,p=null;break e}z=29,h=Error(n(130,r===null?"null":typeof r,"")),p=null}return o=Ii(z,h,o,S),o.elementType=r,o.type=p,o.lanes=M,o}function zl(r,o,h,p){return r=Ii(7,r,p,o),r.lanes=h,r}function Md(r,o,h){return r=Ii(6,r,null,o),r.lanes=h,r}function Uu(r){var o=Ii(18,null,null,0);return o.stateNode=r,o}function Td(r,o,h){return o=Ii(4,r.children!==null?r.children:[],r.key,o),o.lanes=h,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var rf=new WeakMap;function $r(r,o){if(typeof r=="object"&&r!==null){var h=rf.get(r);return h!==void 0?h:(o={value:r,source:o,stack:te(o)},rf.set(r,o),o)}return{value:r,source:o,stack:te(o)}}var Fl=[],Bl=0,zu=null,Fu=0,wr=[],Ai=0,el=null,Di=1,Ja="";function Eo(r,o){Fl[Bl++]=Fu,Fl[Bl++]=zu,zu=r,Fu=o}function Ay(r,o,h){wr[Ai++]=Di,wr[Ai++]=Ja,wr[Ai++]=el,el=r;var p=Di;r=Ja;var S=32-ne(p)-1;p&=~(1<<S),h+=1;var M=32-ne(o)+S;if(30<M){var z=S-S%5;M=(p&(1<<z)-1).toString(32),p>>=z,S-=z,Di=1<<32-ne(o)+S|h<<S|p,Ja=M+r}else Di=1<<M|h<<S|p,Ja=r}function Mo(r){r.return!==null&&(Eo(r,1),Ay(r,1,0))}function Ad(r){for(;r===zu;)zu=Fl[--Bl],Fl[Bl]=null,Fu=Fl[--Bl],Fl[Bl]=null;for(;r===el;)el=wr[--Ai],wr[Ai]=null,Ja=wr[--Ai],wr[Ai]=null,Di=wr[--Ai],wr[Ai]=null}function wd(r,o){wr[Ai++]=Di,wr[Ai++]=Ja,wr[Ai++]=el,Di=o.id,Ja=o.overflow,el=r}var Bi=null,pi=null,Ln=!1,tl=null,Jr=!1,Bu=Error(n(519));function To(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ao($r(o,r)),Bu}function wy(r){var o=r.stateNode,h=r.type,p=r.memoizedProps;switch(o[fi]=r,o[_i]=p,h){case"dialog":Bn("cancel",o),Bn("close",o);break;case"iframe":case"object":case"embed":Bn("load",o);break;case"video":case"audio":for(h=0;h<Ua.length;h++)Bn(Ua[h],o);break;case"source":Bn("error",o);break;case"img":case"image":case"link":Bn("error",o),Bn("load",o);break;case"details":Bn("toggle",o);break;case"input":Bn("invalid",o),Ls(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0);break;case"select":Bn("invalid",o);break;case"textarea":Bn("invalid",o),li(o,p.value,p.defaultValue,p.children)}h=p.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||o.textContent===""+h||p.suppressHydrationWarning===!0||RT(o.textContent,h)?(p.popover!=null&&(Bn("beforetoggle",o),Bn("toggle",o)),p.onScroll!=null&&Bn("scroll",o),p.onScrollEnd!=null&&Bn("scrollend",o),p.onClick!=null&&(o.onclick=qa),o=!0):o=!1,o||To(r,!0)}function Cy(r){for(Bi=r.return;Bi;)switch(Bi.tag){case 5:case 31:case 13:Jr=!1;return;case 27:case 3:Jr=!0;return;default:Bi=Bi.return}}function Vu(r){if(r!==Bi)return!1;if(!Ln)return Cy(r),Ln=!0,!1;var o=r.tag,h;if((h=o!==3&&o!==27)&&((h=o===5)&&(h=r.type,h=!(h!=="form"&&h!=="button")||ES(r.type,r.memoizedProps)),h=!h),h&&pi&&To(r),Cy(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));pi=FT(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));pi=FT(r)}else o===27?(o=pi,ah(r.type)?(r=CS,CS=null,pi=r):pi=o):pi=Bi?Vo(r.stateNode.nextSibling):null;return!0}function Vl(){pi=Bi=null,Ln=!1}function Cd(){var r=tl;return r!==null&&(ki===null?ki=r:ki.push.apply(ki,r),tl=null),r}function Ao(r){tl===null?tl=[r]:tl.push(r)}var ku=Oe(null),kl=null,wo=null;function nl(r,o,h){$e(ku,o._currentValue),o._currentValue=h}function Co(r){r._currentValue=ku.current,Pe(ku)}function Rd(r,o,h){for(;r!==null;){var p=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),r===h)break;r=r.return}}function Id(r,o,h,p){var S=r.child;for(S!==null&&(S.return=r);S!==null;){var M=S.dependencies;if(M!==null){var z=S.child;M=M.firstContext;e:for(;M!==null;){var K=M;M=S;for(var re=0;re<o.length;re++)if(K.context===o[re]){M.lanes|=h,K=M.alternate,K!==null&&(K.lanes|=h),Rd(M.return,h,r),p||(z=null);break e}M=K.next}}else if(S.tag===18){if(z=S.return,z===null)throw Error(n(341));z.lanes|=h,M=z.alternate,M!==null&&(M.lanes|=h),Rd(z,h,r),z=null}else z=S.child;if(z!==null)z.return=S;else for(z=S;z!==null;){if(z===r){z=null;break}if(S=z.sibling,S!==null){S.return=z.return,z=S;break}z=z.return}S=z}}function Ro(r,o,h,p){r=null;for(var S=o,M=!1;S!==null;){if(!M){if((S.flags&524288)!==0)M=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var z=S.alternate;if(z===null)throw Error(n(387));if(z=z.memoizedProps,z!==null){var K=S.type;or(S.pendingProps.value,z.value)||(r!==null?r.push(K):r=[K])}}else if(S===tt.current){if(z=S.alternate,z===null)throw Error(n(387));z.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(r!==null?r.push(kg):r=[kg])}S=S.return}r!==null&&Id(o,r,h,p),o.flags|=262144}function af(r){for(r=r.firstContext;r!==null;){if(!or(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Hl(r){kl=r,wo=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function tn(r){return Ry(kl,r)}function Hu(r,o){return kl===null&&Hl(r),Ry(r,o)}function Ry(r,o){var h=o._currentValue;if(o={context:o,memoizedValue:h,next:null},wo===null){if(r===null)throw Error(n(308));wo=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else wo=wo.next=o;return h}var Iy=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(h,p){r.push(p)}};this.abort=function(){o.aborted=!0,r.forEach(function(h){return h()})}},lS=i.unstable_scheduleCallback,cS=i.unstable_NormalPriority,is={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Wm(){return{controller:new Iy,data:new Map,refCount:0}}function Fc(r){r.refCount--,r.refCount===0&&lS(cS,function(){r.controller.abort()})}var ea=null,Dd=0,il=0,Ma=null;function qm(r,o){if(ea===null){var h=ea=[];Dd=0,il=Re(),Ma={status:"pending",value:void 0,then:function(p){h.push(p)}}}return Dd++,o.then(Xm,Xm),o}function Xm(){if(--Dd===0&&ea!==null){Ma!==null&&(Ma.status="fulfilled");var r=ea;ea=null,il=0,Ma=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function Ym(r,o){var h=[],p={status:"pending",value:null,reason:null,then:function(S){h.push(S)}};return r.then(function(){p.status="fulfilled",p.value=o;for(var S=0;S<h.length;S++)(0,h[S])(o)},function(S){for(p.status="rejected",p.reason=S,S=0;S<h.length;S++)(0,h[S])(void 0)}),p}var Dy=ee.S;ee.S=function(r,o){Og=G(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&qm(r,o),Dy!==null&&Dy(r,o)};var Gl=Oe(null);function Nd(){var r=Gl.current;return r!==null?r:ln.pooledCache}function of(r,o){o===null?$e(Gl,Gl.current):$e(Gl,o.pool)}function Zm(){var r=Nd();return r===null?null:{parent:is._currentValue,pool:r}}var Bc=Error(n(460)),lf=Error(n(474)),Sn=Error(n(542)),Pd={then:function(){}};function Cr(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Ld(r,o,h){switch(h=r[h],h===void 0?r.push(o):h!==o&&(o.then(qa,qa),o=h),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Hc(r),r;default:if(typeof o.status=="string")o.then(qa,qa);else{if(r=ln,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(p){if(o.status==="pending"){var S=o;S.status="fulfilled",S.value=p}},function(p){if(o.status==="pending"){var S=o;S.status="rejected",S.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Hc(r),r}throw Io=o,Bc}}function Vc(r){try{var o=r._init;return o(r._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Io=h,Bc):h}}var Io=null;function kc(){if(Io===null)throw Error(n(459));var r=Io;return Io=null,r}function Hc(r){if(r===Bc||r===Sn)throw Error(n(483))}var Gc=null,jc=0;function cf(r){var o=jc;return jc+=1,Gc===null&&(Gc=[]),Ld(Gc,r,o)}function Ta(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Gu(r,o){throw o.$$typeof===x?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function Od(r){function o(de,ce){if(r){var ve=de.deletions;ve===null?(de.deletions=[ce],de.flags|=16):ve.push(ce)}}function h(de,ce){if(!r)return null;for(;ce!==null;)o(de,ce),ce=ce.sibling;return null}function p(de){for(var ce=new Map;de!==null;)de.key!==null?ce.set(de.key,de):ce.set(de.index,de),de=de.sibling;return ce}function S(de,ce){return de=Ar(de,ce),de.index=0,de.sibling=null,de}function M(de,ce,ve){return de.index=ve,r?(ve=de.alternate,ve!==null?(ve=ve.index,ve<ce?(de.flags|=67108866,ce):ve):(de.flags|=67108866,ce)):(de.flags|=1048576,ce)}function z(de){return r&&de.alternate===null&&(de.flags|=67108866),de}function K(de,ce,ve,He){return ce===null||ce.tag!==6?(ce=Md(ve,de.mode,He),ce.return=de,ce):(ce=S(ce,ve),ce.return=de,ce)}function re(de,ce,ve,He){var qt=ve.type;return qt===I?Le(de,ce,ve.props.children,He,ve.key):ce!==null&&(ce.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===R&&Vc(qt)===ce.type)?(ce=S(ce,ve.props),Ta(ce,ve),ce.return=de,ce):(ce=So(ve.type,ve.key,ve.props,null,de.mode,He),Ta(ce,ve),ce.return=de,ce)}function _e(de,ce,ve,He){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ve.containerInfo||ce.stateNode.implementation!==ve.implementation?(ce=Td(ve,de.mode,He),ce.return=de,ce):(ce=S(ce,ve.children||[]),ce.return=de,ce)}function Le(de,ce,ve,He,qt){return ce===null||ce.tag!==7?(ce=zl(ve,de.mode,He,qt),ce.return=de,ce):(ce=S(ce,ve),ce.return=de,ce)}function Ge(de,ce,ve){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=Md(""+ce,de.mode,ve),ce.return=de,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case E:return ve=So(ce.type,ce.key,ce.props,null,de.mode,ve),Ta(ve,ce),ve.return=de,ve;case T:return ce=Td(ce,de.mode,ve),ce.return=de,ce;case R:return ce=Vc(ce),Ge(de,ce,ve)}if(he(ce)||X(ce))return ce=zl(ce,de.mode,ve,null),ce.return=de,ce;if(typeof ce.then=="function")return Ge(de,cf(ce),ve);if(ce.$$typeof===O)return Ge(de,Hu(de,ce),ve);Gu(de,ce)}return null}function Me(de,ce,ve,He){var qt=ce!==null?ce.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return qt!==null?null:K(de,ce,""+ve,He);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case E:return ve.key===qt?re(de,ce,ve,He):null;case T:return ve.key===qt?_e(de,ce,ve,He):null;case R:return ve=Vc(ve),Me(de,ce,ve,He)}if(he(ve)||X(ve))return qt!==null?null:Le(de,ce,ve,He,null);if(typeof ve.then=="function")return Me(de,ce,cf(ve),He);if(ve.$$typeof===O)return Me(de,ce,Hu(de,ve),He);Gu(de,ve)}return null}function Ne(de,ce,ve,He,qt){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return de=de.get(ve)||null,K(ce,de,""+He,qt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case E:return de=de.get(He.key===null?ve:He.key)||null,re(ce,de,He,qt);case T:return de=de.get(He.key===null?ve:He.key)||null,_e(ce,de,He,qt);case R:return He=Vc(He),Ne(de,ce,ve,He,qt)}if(he(He)||X(He))return de=de.get(ve)||null,Le(ce,de,He,qt,null);if(typeof He.then=="function")return Ne(de,ce,ve,cf(He),qt);if(He.$$typeof===O)return Ne(de,ce,ve,Hu(ce,He),qt);Gu(ce,He)}return null}function Ot(de,ce,ve,He){for(var qt=null,ni=null,Vt=ce,An=ce=0,Hn=null;Vt!==null&&An<ve.length;An++){Vt.index>An?(Hn=Vt,Vt=null):Hn=Vt.sibling;var ii=Me(de,Vt,ve[An],He);if(ii===null){Vt===null&&(Vt=Hn);break}r&&Vt&&ii.alternate===null&&o(de,Vt),ce=M(ii,ce,An),ni===null?qt=ii:ni.sibling=ii,ni=ii,Vt=Hn}if(An===ve.length)return h(de,Vt),Ln&&Eo(de,An),qt;if(Vt===null){for(;An<ve.length;An++)Vt=Ge(de,ve[An],He),Vt!==null&&(ce=M(Vt,ce,An),ni===null?qt=Vt:ni.sibling=Vt,ni=Vt);return Ln&&Eo(de,An),qt}for(Vt=p(Vt);An<ve.length;An++)Hn=Ne(Vt,de,An,ve[An],He),Hn!==null&&(r&&Hn.alternate!==null&&Vt.delete(Hn.key===null?An:Hn.key),ce=M(Hn,ce,An),ni===null?qt=Hn:ni.sibling=Hn,ni=Hn);return r&&Vt.forEach(function(hh){return o(de,hh)}),Ln&&Eo(de,An),qt}function en(de,ce,ve,He){if(ve==null)throw Error(n(151));for(var qt=null,ni=null,Vt=ce,An=ce=0,Hn=null,ii=ve.next();Vt!==null&&!ii.done;An++,ii=ve.next()){Vt.index>An?(Hn=Vt,Vt=null):Hn=Vt.sibling;var hh=Me(de,Vt,ii.value,He);if(hh===null){Vt===null&&(Vt=Hn);break}r&&Vt&&hh.alternate===null&&o(de,Vt),ce=M(hh,ce,An),ni===null?qt=hh:ni.sibling=hh,ni=hh,Vt=Hn}if(ii.done)return h(de,Vt),Ln&&Eo(de,An),qt;if(Vt===null){for(;!ii.done;An++,ii=ve.next())ii=Ge(de,ii.value,He),ii!==null&&(ce=M(ii,ce,An),ni===null?qt=ii:ni.sibling=ii,ni=ii);return Ln&&Eo(de,An),qt}for(Vt=p(Vt);!ii.done;An++,ii=ve.next())ii=Ne(Vt,de,An,ii.value,He),ii!==null&&(r&&ii.alternate!==null&&Vt.delete(ii.key===null?An:ii.key),ce=M(ii,ce,An),ni===null?qt=ii:ni.sibling=ii,ni=ii);return r&&Vt.forEach(function(iP){return o(de,iP)}),Ln&&Eo(de,An),qt}function yi(de,ce,ve,He){if(typeof ve=="object"&&ve!==null&&ve.type===I&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case E:e:{for(var qt=ve.key;ce!==null;){if(ce.key===qt){if(qt=ve.type,qt===I){if(ce.tag===7){h(de,ce.sibling),He=S(ce,ve.props.children),He.return=de,de=He;break e}}else if(ce.elementType===qt||typeof qt=="object"&&qt!==null&&qt.$$typeof===R&&Vc(qt)===ce.type){h(de,ce.sibling),He=S(ce,ve.props),Ta(He,ve),He.return=de,de=He;break e}h(de,ce);break}else o(de,ce);ce=ce.sibling}ve.type===I?(He=zl(ve.props.children,de.mode,He,ve.key),He.return=de,de=He):(He=So(ve.type,ve.key,ve.props,null,de.mode,He),Ta(He,ve),He.return=de,de=He)}return z(de);case T:e:{for(qt=ve.key;ce!==null;){if(ce.key===qt)if(ce.tag===4&&ce.stateNode.containerInfo===ve.containerInfo&&ce.stateNode.implementation===ve.implementation){h(de,ce.sibling),He=S(ce,ve.children||[]),He.return=de,de=He;break e}else{h(de,ce);break}else o(de,ce);ce=ce.sibling}He=Td(ve,de.mode,He),He.return=de,de=He}return z(de);case R:return ve=Vc(ve),yi(de,ce,ve,He)}if(he(ve))return Ot(de,ce,ve,He);if(X(ve)){if(qt=X(ve),typeof qt!="function")throw Error(n(150));return ve=qt.call(ve),en(de,ce,ve,He)}if(typeof ve.then=="function")return yi(de,ce,cf(ve),He);if(ve.$$typeof===O)return yi(de,ce,Hu(de,ve),He);Gu(de,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,ce!==null&&ce.tag===6?(h(de,ce.sibling),He=S(ce,ve),He.return=de,de=He):(h(de,ce),He=Md(ve,de.mode,He),He.return=de,de=He),z(de)):h(de,ce)}return function(de,ce,ve,He){try{jc=0;var qt=yi(de,ce,ve,He);return Gc=null,qt}catch(Vt){if(Vt===Bc||Vt===Sn)throw Vt;var ni=Ii(29,Vt,null,de.mode);return ni.lanes=He,ni.return=de,ni}}}var sl=Od(!0),Ud=Od(!1),cr=!1;function uf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Km(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function rl(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function jl(r,o,h){var p=r.updateQueue;if(p===null)return null;if(p=p.shared,(kt&2)!==0){var S=p.pending;return S===null?o.next=o:(o.next=S.next,S.next=o),p.pending=o,o=Ea(r),Ol(r,null,h),o}return Ts(r,p,o,h),Ea(r)}function Wl(r,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194048)!==0)){var p=o.lanes;p&=r.pendingLanes,h|=p,o.lanes=h,pa(r,h)}}function Wt(r,o){var h=r.updateQueue,p=r.alternate;if(p!==null&&(p=p.updateQueue,h===p)){var S=null,M=null;if(h=h.firstBaseUpdate,h!==null){do{var z={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};M===null?S=M=z:M=M.next=z,h=h.next}while(h!==null);M===null?S=M=o:M=M.next=o}else S=M=o;h={baseState:p.baseState,firstBaseUpdate:S,lastBaseUpdate:M,shared:p.shared,callbacks:p.callbacks},r.updateQueue=h;return}r=h.lastBaseUpdate,r===null?h.firstBaseUpdate=o:r.next=o,h.lastBaseUpdate=o}var Qm=!1;function hf(){if(Qm){var r=Ma;if(r!==null)throw r}}function ju(r,o,h,p){Qm=!1;var S=r.updateQueue;cr=!1;var M=S.firstBaseUpdate,z=S.lastBaseUpdate,K=S.shared.pending;if(K!==null){S.shared.pending=null;var re=K,_e=re.next;re.next=null,z===null?M=_e:z.next=_e,z=re;var Le=r.alternate;Le!==null&&(Le=Le.updateQueue,K=Le.lastBaseUpdate,K!==z&&(K===null?Le.firstBaseUpdate=_e:K.next=_e,Le.lastBaseUpdate=re))}if(M!==null){var Ge=S.baseState;z=0,Le=_e=re=null,K=M;do{var Me=K.lane&-536870913,Ne=Me!==K.lane;if(Ne?(_n&Me)===Me:(p&Me)===Me){Me!==0&&Me===il&&(Qm=!0),Le!==null&&(Le=Le.next={lane:0,tag:K.tag,payload:K.payload,callback:null,next:null});e:{var Ot=r,en=K;Me=o;var yi=h;switch(en.tag){case 1:if(Ot=en.payload,typeof Ot=="function"){Ge=Ot.call(yi,Ge,Me);break e}Ge=Ot;break e;case 3:Ot.flags=Ot.flags&-65537|128;case 0:if(Ot=en.payload,Me=typeof Ot=="function"?Ot.call(yi,Ge,Me):Ot,Me==null)break e;Ge=v({},Ge,Me);break e;case 2:cr=!0}}Me=K.callback,Me!==null&&(r.flags|=64,Ne&&(r.flags|=8192),Ne=S.callbacks,Ne===null?S.callbacks=[Me]:Ne.push(Me))}else Ne={lane:Me,tag:K.tag,payload:K.payload,callback:K.callback,next:null},Le===null?(_e=Le=Ne,re=Ge):Le=Le.next=Ne,z|=Me;if(K=K.next,K===null){if(K=S.shared.pending,K===null)break;Ne=K,K=Ne.next,Ne.next=null,S.lastBaseUpdate=Ne,S.shared.pending=null}}while(!0);Le===null&&(re=Ge),S.baseState=re,S.firstBaseUpdate=_e,S.lastBaseUpdate=Le,M===null&&(S.shared.lanes=0),zo|=z,r.lanes=z,r.memoizedState=Ge}}function Wu(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function Ny(r,o){var h=r.callbacks;if(h!==null)for(r.callbacks=null,r=0;r<h.length;r++)Wu(h[r],o)}var qu=Oe(null),zd=Oe(0);function Py(r,o){r=sa,$e(zd,r),$e(qu,o),sa=r|o.baseLanes}function $m(){$e(zd,sa),$e(qu,qu.current)}function ff(){sa=zd.current,Pe(qu),Pe(zd)}var Rr=Oe(null),ur=null;function al(r){var o=r.alternate;$e(On,On.current&1),$e(Rr,r),ur===null&&(o===null||qu.current!==null||o.memoizedState!==null)&&(ur=r)}function Jm(r){$e(On,On.current),$e(Rr,r),ur===null&&(ur=r)}function Ly(r){r.tag===22?($e(On,On.current),$e(Rr,r),ur===null&&(ur=r)):Ir()}function Ir(){$e(On,On.current),$e(Rr,Rr.current)}function Xi(r){Pe(Rr),ur===r&&(ur=null),Pe(On)}var On=Oe(0);function ta(r){for(var o=r;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||AS(h)||wS(h)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var wi=0,pn=null,ci=null,Dn=null,Aa=!1,Xu=!1,Wc=!1,Fd=0,df=0,Yu=null,eg=0;function Ni(){throw Error(n(321))}function tg(r,o){if(o===null)return!1;for(var h=0;h<o.length&&h<r.length;h++)if(!or(r[h],o[h]))return!1;return!0}function Bd(r,o,h,p,S,M){return wi=M,pn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ee.H=r===null||r.memoizedState===null?fv:bg,Wc=!1,M=h(p,S),Wc=!1,Xu&&(M=qc(o,h,p,S)),Oy(r),M}function Oy(r){ee.H=Zu;var o=ci!==null&&ci.next!==null;if(wi=0,Dn=ci=pn=null,Aa=!1,df=0,Yu=null,o)throw Error(n(300));r===null||ss||(r=r.dependencies,r!==null&&af(r)&&(ss=!0))}function qc(r,o,h,p){pn=r;var S=0;do{if(Xu&&(Yu=null),df=0,Xu=!1,25<=S)throw Error(n(301));if(S+=1,Dn=ci=null,r.updateQueue!=null){var M=r.updateQueue;M.lastEffect=null,M.events=null,M.stores=null,M.memoCache!=null&&(M.memoCache.index=0)}ee.H=wa,M=o(h,p)}while(Xu);return M}function Xc(){var r=ee.H,o=r.useState()[0];return o=typeof o.then=="function"?pf(o):o,r=r.useState()[0],(ci!==null?ci.memoizedState:null)!==r&&(pn.flags|=1024),o}function ng(){var r=Fd!==0;return Fd=0,r}function ig(r,o,h){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~h}function sg(r){if(Aa){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Aa=!1}wi=0,Dn=ci=pn=null,Xu=!1,df=Fd=0,Yu=null}function cs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?pn.memoizedState=Dn=r:Dn=Dn.next=r,Dn}function Yi(){if(ci===null){var r=pn.alternate;r=r!==null?r.memoizedState:null}else r=ci.next;var o=Dn===null?pn.memoizedState:Dn.next;if(o!==null)Dn=o,ci=r;else{if(r===null)throw pn.alternate===null?Error(n(467)):Error(n(310));ci=r,r={memoizedState:ci.memoizedState,baseState:ci.baseState,baseQueue:ci.baseQueue,queue:ci.queue,next:null},Dn===null?pn.memoizedState=Dn=r:Dn=Dn.next=r}return Dn}function Vd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function pf(r){var o=df;return df+=1,Yu===null&&(Yu=[]),r=Ld(Yu,r,o),o=pn,(Dn===null?o.memoizedState:Dn.next)===null&&(o=o.alternate,ee.H=o===null||o.memoizedState===null?fv:bg),r}function ql(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return pf(r);if(r.$$typeof===O)return tn(r)}throw Error(n(438,String(r)))}function rg(r){var o=null,h=pn.updateQueue;if(h!==null&&(o=h.memoCache),o==null){var p=pn.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(S){return S.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),h===null&&(h=Vd(),pn.updateQueue=h),h.memoCache=o,h=o.data[o.index],h===void 0)for(h=o.data[o.index]=Array(r),p=0;p<r;p++)h[p]=H;return o.index++,h}function ol(r,o){return typeof o=="function"?o(r):o}function kd(r){var o=Yi();return ag(o,ci,r)}function ag(r,o,h){var p=r.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=h;var S=r.baseQueue,M=p.pending;if(M!==null){if(S!==null){var z=S.next;S.next=M.next,M.next=z}o.baseQueue=S=M,p.pending=null}if(M=r.baseState,S===null)r.memoizedState=M;else{o=S.next;var K=z=null,re=null,_e=o,Le=!1;do{var Ge=_e.lane&-536870913;if(Ge!==_e.lane?(_n&Ge)===Ge:(wi&Ge)===Ge){var Me=_e.revertLane;if(Me===0)re!==null&&(re=re.next={lane:0,revertLane:0,gesture:null,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),Ge===il&&(Le=!0);else if((wi&Me)===Me){_e=_e.next,Me===il&&(Le=!0);continue}else Ge={lane:0,revertLane:_e.revertLane,gesture:null,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},re===null?(K=re=Ge,z=M):re=re.next=Ge,pn.lanes|=Me,zo|=Me;Ge=_e.action,Wc&&h(M,Ge),M=_e.hasEagerState?_e.eagerState:h(M,Ge)}else Me={lane:Ge,revertLane:_e.revertLane,gesture:_e.gesture,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},re===null?(K=re=Me,z=M):re=re.next=Me,pn.lanes|=Ge,zo|=Ge;_e=_e.next}while(_e!==null&&_e!==o);if(re===null?z=M:re.next=K,!or(M,r.memoizedState)&&(ss=!0,Le&&(h=Ma,h!==null)))throw h;r.memoizedState=M,r.baseState=z,r.baseQueue=re,p.lastRenderedState=M}return S===null&&(p.lanes=0),[r.memoizedState,p.dispatch]}function og(r){var o=Yi(),h=o.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=r;var p=h.dispatch,S=h.pending,M=o.memoizedState;if(S!==null){h.pending=null;var z=S=S.next;do M=r(M,z.action),z=z.next;while(z!==S);or(M,o.memoizedState)||(ss=!0),o.memoizedState=M,o.baseQueue===null&&(o.baseState=M),h.lastRenderedState=M}return[M,p]}function Uy(r,o,h){var p=pn,S=Yi(),M=Ln;if(M){if(h===void 0)throw Error(n(407));h=h()}else h=o();var z=!or((ci||S).memoizedState,h);if(z&&(S.memoizedState=h,ss=!0),S=S.queue,mg(By.bind(null,p,S,r),[r]),S.getSnapshot!==o||z||Dn!==null&&Dn.memoizedState.tag&1){if(p.flags|=2048,Xl(9,{destroy:void 0},Fy.bind(null,p,S,h,o),null),ln===null)throw Error(n(349));M||(wi&127)!==0||zy(p,o,h)}return h}function zy(r,o,h){r.flags|=16384,r={getSnapshot:o,value:h},o=pn.updateQueue,o===null?(o=Vd(),pn.updateQueue=o,o.stores=[r]):(h=o.stores,h===null?o.stores=[r]:h.push(r))}function Fy(r,o,h,p){o.value=h,o.getSnapshot=p,Vy(o)&&ky(r)}function By(r,o,h){return h(function(){Vy(o)&&ky(r)})}function Vy(r){var o=r.getSnapshot;r=r.value;try{var h=o();return!or(r,h)}catch{return!0}}function ky(r){var o=lr(r,2);o!==null&&Mn(o,r,2)}function lg(r){var o=cs();if(typeof r=="function"){var h=r;if(r=h(),Wc){_t(!0);try{h()}finally{_t(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ol,lastRenderedState:r},o}function cg(r,o,h,p){return r.baseState=h,ag(r,ci,typeof p=="function"?p:ol)}function uS(r,o,h,p,S){if(Wd(r))throw Error(n(485));if(r=o.action,r!==null){var M={payload:S,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(z){M.listeners.push(z)}};ee.T!==null?h(!0):M.isTransition=!1,p(M),h=o.pending,h===null?(M.next=o.pending=M,Hy(o,M)):(M.next=h.next,o.pending=h.next=M)}}function Hy(r,o){var h=o.action,p=o.payload,S=r.state;if(o.isTransition){var M=ee.T,z={};ee.T=z;try{var K=h(S,p),re=ee.S;re!==null&&re(z,K),Gy(r,o,K)}catch(_e){ug(r,o,_e)}finally{M!==null&&z.types!==null&&(M.types=z.types),ee.T=M}}else try{M=h(S,p),Gy(r,o,M)}catch(_e){ug(r,o,_e)}}function Gy(r,o,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(p){jy(r,o,p)},function(p){return ug(r,o,p)}):jy(r,o,h)}function jy(r,o,h){o.status="fulfilled",o.value=h,Wy(o),r.state=h,o=r.pending,o!==null&&(h=o.next,h===o?r.pending=null:(h=h.next,o.next=h,Hy(r,h)))}function ug(r,o,h){var p=r.pending;if(r.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=h,Wy(o),o=o.next;while(o!==p)}r.action=null}function Wy(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function hg(r,o){return o}function fg(r,o){if(Ln){var h=ln.formState;if(h!==null){e:{var p=pn;if(Ln){if(pi){t:{for(var S=pi,M=Jr;S.nodeType!==8;){if(!M){S=null;break t}if(S=Vo(S.nextSibling),S===null){S=null;break t}}M=S.data,S=M==="F!"||M==="F"?S:null}if(S){pi=Vo(S.nextSibling),p=S.data==="F!";break e}}To(p)}p=!1}p&&(o=h[0])}}return h=cs(),h.memoizedState=h.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hg,lastRenderedState:o},h.queue=p,h=cv.bind(null,pn,p),p.dispatch=h,p=lg(!1),M=xg.bind(null,pn,!1,p.queue),p=cs(),S={state:o,dispatch:null,action:r,pending:null},p.queue=S,h=uS.bind(null,pn,S,M,h),S.dispatch=h,p.memoizedState=r,[o,h,!1]}function qy(r){var o=Yi();return dg(o,ci,r)}function dg(r,o,h){if(o=ag(r,o,hg)[0],r=kd(ol)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=pf(o)}catch(z){throw z===Bc?Sn:z}else p=o;o=Yi();var S=o.queue,M=S.dispatch;return h!==o.memoizedState&&(pn.flags|=2048,Xl(9,{destroy:void 0},Xy.bind(null,S,h),null)),[p,M,r]}function Xy(r,o){r.action=o}function pg(r){var o=Yi(),h=ci;if(h!==null)return dg(o,h,r);Yi(),o=o.memoizedState,h=Yi();var p=h.queue.dispatch;return h.memoizedState=r,[o,p,!1]}function Xl(r,o,h,p){return r={tag:r,create:h,deps:p,inst:o,next:null},o=pn.updateQueue,o===null&&(o=Vd(),pn.updateQueue=o),h=o.lastEffect,h===null?o.lastEffect=r.next=r:(p=h.next,h.next=r,r.next=p,o.lastEffect=r),r}function Hd(){return Yi().memoizedState}function Gd(r,o,h,p){var S=cs();pn.flags|=r,S.memoizedState=Xl(1|o,{destroy:void 0},h,p===void 0?null:p)}function jd(r,o,h,p){var S=Yi();p=p===void 0?null:p;var M=S.memoizedState.inst;ci!==null&&p!==null&&tg(p,ci.memoizedState.deps)?S.memoizedState=Xl(o,M,h,p):(pn.flags|=r,S.memoizedState=Xl(1|o,M,h,p))}function Yy(r,o){Gd(8390656,8,r,o)}function mg(r,o){jd(2048,8,r,o)}function Zy(r){pn.flags|=4;var o=pn.updateQueue;if(o===null)o=Vd(),pn.updateQueue=o,o.events=[r];else{var h=o.events;h===null?o.events=[r]:h.push(r)}}function Ky(r){var o=Yi().memoizedState;return Zy({ref:o,nextImpl:r}),function(){if((kt&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function Qy(r,o){return jd(4,2,r,o)}function $y(r,o){return jd(4,4,r,o)}function Jy(r,o){if(typeof o=="function"){r=r();var h=o(r);return function(){typeof h=="function"?h():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function ev(r,o,h){h=h!=null?h.concat([r]):null,jd(4,4,Jy.bind(null,o,r),h)}function gg(){}function tv(r,o){var h=Yi();o=o===void 0?null:o;var p=h.memoizedState;return o!==null&&tg(o,p[1])?p[0]:(h.memoizedState=[r,o],r)}function nv(r,o){var h=Yi();o=o===void 0?null:o;var p=h.memoizedState;if(o!==null&&tg(o,p[1]))return p[0];if(p=r(),Wc){_t(!0);try{r()}finally{_t(!1)}}return h.memoizedState=[p,o],p}function yg(r,o,h){return h===void 0||(wi&1073741824)!==0&&(_n&261930)===0?r.memoizedState=o:(r.memoizedState=h,r=Rn(),pn.lanes|=r,zo|=r,h)}function iv(r,o,h,p){return or(h,o)?h:qu.current!==null?(r=yg(r,h,p),or(r,o)||(ss=!0),r):(wi&42)===0||(wi&1073741824)!==0&&(_n&261930)===0?(ss=!0,r.memoizedState=h):(r=Rn(),pn.lanes|=r,zo|=r,o)}function sv(r,o,h,p,S){var M=ie.p;ie.p=M!==0&&8>M?M:8;var z=ee.T,K={};ee.T=K,xg(r,!1,o,h);try{var re=S(),_e=ee.S;if(_e!==null&&_e(K,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Le=Ym(re,p);mf(r,o,Le,aa(r))}else mf(r,o,p,aa(r))}catch(Ge){mf(r,o,{then:function(){},status:"rejected",reason:Ge},aa())}finally{ie.p=M,z!==null&&K.types!==null&&(z.types=K.types),ee.T=z}}function hS(){}function vg(r,o,h,p){if(r.tag!==5)throw Error(n(476));var S=rv(r).queue;sv(r,S,o,ye,h===null?hS:function(){return av(r),h(p)})}function rv(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:ye,baseState:ye,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ol,lastRenderedState:ye},next:null};var h={};return o.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ol,lastRenderedState:h},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function av(r){var o=rv(r);o.next===null&&(o=r.alternate.memoizedState),mf(r,o.next.queue,{},aa())}function _g(){return tn(kg)}function ov(){return Yi().memoizedState}function lv(){return Yi().memoizedState}function fS(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var h=aa();r=rl(h);var p=jl(o,r,h);p!==null&&(Mn(p,o,h),Wl(p,o,h)),o={cache:Wm()},r.payload=o;return}o=o.return}}function dS(r,o,h){var p=aa();h={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Wd(r)?uv(o,h):(h=Sd(r,o,h,p),h!==null&&(Mn(h,r,p),hv(h,o,p)))}function cv(r,o,h){var p=aa();mf(r,o,h,p)}function mf(r,o,h,p){var S={lane:p,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Wd(r))uv(o,S);else{var M=r.alternate;if(r.lanes===0&&(M===null||M.lanes===0)&&(M=o.lastRenderedReducer,M!==null))try{var z=o.lastRenderedState,K=M(z,h);if(S.hasEagerState=!0,S.eagerState=K,or(K,z))return Ts(r,o,S,0),ln===null&&sf(),!1}catch{}if(h=Sd(r,o,S,p),h!==null)return Mn(h,r,p),hv(h,o,p),!0}return!1}function xg(r,o,h,p){if(p={lane:2,revertLane:Re(),gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Wd(r)){if(o)throw Error(n(479))}else o=Sd(r,h,p,2),o!==null&&Mn(o,r,2)}function Wd(r){var o=r.alternate;return r===pn||o!==null&&o===pn}function uv(r,o){Xu=Aa=!0;var h=r.pending;h===null?o.next=o:(o.next=h.next,h.next=o),r.pending=o}function hv(r,o,h){if((h&4194048)!==0){var p=o.lanes;p&=r.pendingLanes,h|=p,o.lanes=h,pa(r,h)}}var Zu={readContext:tn,use:ql,useCallback:Ni,useContext:Ni,useEffect:Ni,useImperativeHandle:Ni,useLayoutEffect:Ni,useInsertionEffect:Ni,useMemo:Ni,useReducer:Ni,useRef:Ni,useState:Ni,useDebugValue:Ni,useDeferredValue:Ni,useTransition:Ni,useSyncExternalStore:Ni,useId:Ni,useHostTransitionStatus:Ni,useFormState:Ni,useActionState:Ni,useOptimistic:Ni,useMemoCache:Ni,useCacheRefresh:Ni};Zu.useEffectEvent=Ni;var fv={readContext:tn,use:ql,useCallback:function(r,o){return cs().memoizedState=[r,o===void 0?null:o],r},useContext:tn,useEffect:Yy,useImperativeHandle:function(r,o,h){h=h!=null?h.concat([r]):null,Gd(4194308,4,Jy.bind(null,o,r),h)},useLayoutEffect:function(r,o){return Gd(4194308,4,r,o)},useInsertionEffect:function(r,o){Gd(4,2,r,o)},useMemo:function(r,o){var h=cs();o=o===void 0?null:o;var p=r();if(Wc){_t(!0);try{r()}finally{_t(!1)}}return h.memoizedState=[p,o],p},useReducer:function(r,o,h){var p=cs();if(h!==void 0){var S=h(o);if(Wc){_t(!0);try{h(o)}finally{_t(!1)}}}else S=o;return p.memoizedState=p.baseState=S,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:S},p.queue=r,r=r.dispatch=dS.bind(null,pn,r),[p.memoizedState,r]},useRef:function(r){var o=cs();return r={current:r},o.memoizedState=r},useState:function(r){r=lg(r);var o=r.queue,h=cv.bind(null,pn,o);return o.dispatch=h,[r.memoizedState,h]},useDebugValue:gg,useDeferredValue:function(r,o){var h=cs();return yg(h,r,o)},useTransition:function(){var r=lg(!1);return r=sv.bind(null,pn,r.queue,!0,!1),cs().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,h){var p=pn,S=cs();if(Ln){if(h===void 0)throw Error(n(407));h=h()}else{if(h=o(),ln===null)throw Error(n(349));(_n&127)!==0||zy(p,o,h)}S.memoizedState=h;var M={value:h,getSnapshot:o};return S.queue=M,Yy(By.bind(null,p,M,r),[r]),p.flags|=2048,Xl(9,{destroy:void 0},Fy.bind(null,p,M,h,o),null),h},useId:function(){var r=cs(),o=ln.identifierPrefix;if(Ln){var h=Ja,p=Di;h=(p&~(1<<32-ne(p)-1)).toString(32)+h,o="_"+o+"R_"+h,h=Fd++,0<h&&(o+="H"+h.toString(32)),o+="_"}else h=eg++,o="_"+o+"r_"+h.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:_g,useFormState:fg,useActionState:fg,useOptimistic:function(r){var o=cs();o.memoizedState=o.baseState=r;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=h,o=xg.bind(null,pn,!0,h),h.dispatch=o,[r,o]},useMemoCache:rg,useCacheRefresh:function(){return cs().memoizedState=fS.bind(null,pn)},useEffectEvent:function(r){var o=cs(),h={impl:r};return o.memoizedState=h,function(){if((kt&2)!==0)throw Error(n(440));return h.impl.apply(void 0,arguments)}}},bg={readContext:tn,use:ql,useCallback:tv,useContext:tn,useEffect:mg,useImperativeHandle:ev,useInsertionEffect:Qy,useLayoutEffect:$y,useMemo:nv,useReducer:kd,useRef:Hd,useState:function(){return kd(ol)},useDebugValue:gg,useDeferredValue:function(r,o){var h=Yi();return iv(h,ci.memoizedState,r,o)},useTransition:function(){var r=kd(ol)[0],o=Yi().memoizedState;return[typeof r=="boolean"?r:pf(r),o]},useSyncExternalStore:Uy,useId:ov,useHostTransitionStatus:_g,useFormState:qy,useActionState:qy,useOptimistic:function(r,o){var h=Yi();return cg(h,ci,r,o)},useMemoCache:rg,useCacheRefresh:lv};bg.useEffectEvent=Ky;var wa={readContext:tn,use:ql,useCallback:tv,useContext:tn,useEffect:mg,useImperativeHandle:ev,useInsertionEffect:Qy,useLayoutEffect:$y,useMemo:nv,useReducer:og,useRef:Hd,useState:function(){return og(ol)},useDebugValue:gg,useDeferredValue:function(r,o){var h=Yi();return ci===null?yg(h,r,o):iv(h,ci.memoizedState,r,o)},useTransition:function(){var r=og(ol)[0],o=Yi().memoizedState;return[typeof r=="boolean"?r:pf(r),o]},useSyncExternalStore:Uy,useId:ov,useHostTransitionStatus:_g,useFormState:pg,useActionState:pg,useOptimistic:function(r,o){var h=Yi();return ci!==null?cg(h,ci,r,o):(h.baseState=r,[r,h.queue.dispatch])},useMemoCache:rg,useCacheRefresh:lv};wa.useEffectEvent=Ky;function qd(r,o,h,p){o=r.memoizedState,h=h(p,o),h=h==null?o:v({},o,h),r.memoizedState=h,r.lanes===0&&(r.updateQueue.baseState=h)}var gf={enqueueSetState:function(r,o,h){r=r._reactInternals;var p=aa(),S=rl(p);S.payload=o,h!=null&&(S.callback=h),o=jl(r,S,p),o!==null&&(Mn(o,r,p),Wl(o,r,p))},enqueueReplaceState:function(r,o,h){r=r._reactInternals;var p=aa(),S=rl(p);S.tag=1,S.payload=o,h!=null&&(S.callback=h),o=jl(r,S,p),o!==null&&(Mn(o,r,p),Wl(o,r,p))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var h=aa(),p=rl(h);p.tag=2,o!=null&&(p.callback=o),o=jl(r,p,h),o!==null&&(Mn(o,r,h),Wl(o,r,h))}};function Sg(r,o,h,p,S,M,z){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(p,M,z):o.prototype&&o.prototype.isPureReactComponent?!Du(h,p)||!Du(S,M):!0}function Eg(r,o,h,p){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,p),o.state!==r&&gf.enqueueReplaceState(o,o.state,null)}function Yl(r,o){var h=o;if("ref"in o){h={};for(var p in o)p!=="ref"&&(h[p]=o[p])}if(r=r.defaultProps){h===o&&(h=v({},h));for(var S in r)h[S]===void 0&&(h[S]=r[S])}return h}function dv(r){nf(r)}function Mg(r){console.error(r)}function Tg(r){nf(r)}function Xd(r,o){try{var h=r.onUncaughtError;h(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function pv(r,o,h){try{var p=r.onCaughtError;p(h.value,{componentStack:h.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function Ag(r,o,h){return h=rl(h),h.tag=3,h.payload={element:null},h.callback=function(){Xd(r,o)},h}function wg(r){return r=rl(r),r.tag=3,r}function mv(r,o,h,p){var S=h.type.getDerivedStateFromError;if(typeof S=="function"){var M=p.value;r.payload=function(){return S(M)},r.callback=function(){pv(o,h,p)}}var z=h.stateNode;z!==null&&typeof z.componentDidCatch=="function"&&(r.callback=function(){pv(o,h,p),typeof S!="function"&&(Qi===null?Qi=new Set([this]):Qi.add(this));var K=p.stack;this.componentDidCatch(p.value,{componentStack:K!==null?K:""})})}function us(r,o,h,p,S){if(h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=h.alternate,o!==null&&Ro(o,h,S,!0),h=Rr.current,h!==null){switch(h.tag){case 31:case 13:return ur===null?nh():h.alternate===null&&Pi===0&&(Pi=3),h.flags&=-257,h.flags|=65536,h.lanes=S,p===Pd?h.flags|=16384:(o=h.updateQueue,o===null?h.updateQueue=new Set([p]):o.add(p),Cf(r,p,S)),!1;case 22:return h.flags|=65536,p===Pd?h.flags|=16384:(o=h.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},h.updateQueue=o):(h=o.retryQueue,h===null?o.retryQueue=new Set([p]):h.add(p)),Cf(r,p,S)),!1}throw Error(n(435,h.tag))}return Cf(r,p,S),nh(),!1}if(Ln)return o=Rr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=S,p!==Bu&&(r=Error(n(422),{cause:p}),Ao($r(r,h)))):(p!==Bu&&(o=Error(n(423),{cause:p}),Ao($r(o,h))),r=r.current.alternate,r.flags|=65536,S&=-S,r.lanes|=S,p=$r(p,h),S=Ag(r.stateNode,p,S),Wt(r,S),Pi!==4&&(Pi=2)),!1;var M=Error(n(520),{cause:p});if(M=$r(M,h),tu===null?tu=[M]:tu.push(M),Pi!==4&&(Pi=2),o===null)return!0;p=$r(p,h),h=o;do{switch(h.tag){case 3:return h.flags|=65536,r=S&-S,h.lanes|=r,r=Ag(h.stateNode,p,r),Wt(h,r),!1;case 1:if(o=h.type,M=h.stateNode,(h.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(Qi===null||!Qi.has(M))))return h.flags|=65536,S&=-S,h.lanes|=S,S=wg(S),mv(S,r,h,p),Wt(h,S),!1}h=h.return}while(h!==null);return!1}var Yd=Error(n(461)),ss=!1;function As(r,o,h,p){o.child=r===null?Ud(o,null,h,p):sl(o,r.child,h,p)}function Cg(r,o,h,p,S){h=h.render;var M=o.ref;if("ref"in p){var z={};for(var K in p)K!=="ref"&&(z[K]=p[K])}else z=p;return Hl(o),p=Bd(r,o,h,z,M,S),K=ng(),r!==null&&!ss?(ig(r,o,S),Zi(r,o,S)):(Ln&&K&&Mo(o),o.flags|=1,As(r,o,p,S),o.child)}function Yc(r,o,h,p,S){if(r===null){var M=h.type;return typeof M=="function"&&!Ed(M)&&M.defaultProps===void 0&&h.compare===null?(o.tag=15,o.type=M,Zd(r,o,M,p,S)):(r=So(h.type,null,p,o,o.mode,S),r.ref=o.ref,r.return=o,o.child=r)}if(M=r.child,!tp(r,S)){var z=M.memoizedProps;if(h=h.compare,h=h!==null?h:Du,h(z,p)&&r.ref===o.ref)return Zi(r,o,S)}return o.flags|=1,r=Ar(M,p),r.ref=o.ref,r.return=o,o.child=r}function Zd(r,o,h,p,S){if(r!==null){var M=r.memoizedProps;if(Du(M,p)&&r.ref===o.ref)if(ss=!1,o.pendingProps=p=M,tp(r,S))(r.flags&131072)!==0&&(ss=!0);else return o.lanes=r.lanes,Zi(r,o,S)}return Ku(r,o,h,p,S)}function Zc(r,o,h,p){var S=p.children,M=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),p.mode==="hidden"){if((o.flags&128)!==0){if(M=M!==null?M.baseLanes|h:h,r!==null){for(p=o.child=r.child,S=0;p!==null;)S=S|p.lanes|p.childLanes,p=p.sibling;p=S&~M}else p=0,o.child=null;return Dr(r,o,M,h,p)}if((h&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&of(o,M!==null?M.cachePool:null),M!==null?Py(o,M):$m(),Ly(o);else return p=o.lanes=536870912,Dr(r,o,M!==null?M.baseLanes|h:h,h,p)}else M!==null?(of(o,M.cachePool),Py(o,M),Ir(),o.memoizedState=null):(r!==null&&of(o,null),$m(),Ir());return As(r,o,S,h),o.child}function Do(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function Dr(r,o,h,p,S){var M=Nd();return M=M===null?null:{parent:is._currentValue,pool:M},o.memoizedState={baseLanes:h,cachePool:M},r!==null&&of(o,null),$m(),Ly(o),r!==null&&Ro(r,o,p,!0),o.childLanes=S,null}function Kd(r,o){return o=ep({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function gv(r,o,h){return sl(o,r.child,null,h),r=Kd(o,o.pendingProps),r.flags|=2,Xi(o),o.memoizedState=null,r}function Qd(r,o,h){var p=o.pendingProps,S=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Ln){if(p.mode==="hidden")return r=Kd(o,p),o.lanes=536870912,Do(null,r);if(Jm(o),(r=pi)?(r=zT(r,Jr),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:el!==null?{id:Di,overflow:Ja}:null,retryLane:536870912,hydrationErrors:null},h=Uu(r),h.return=o,o.child=h,Bi=o,pi=null)):r=null,r===null)throw To(o);return o.lanes=536870912,null}return Kd(o,p)}var M=r.memoizedState;if(M!==null){var z=M.dehydrated;if(Jm(o),S)if(o.flags&256)o.flags&=-257,o=gv(r,o,h);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(ss||Ro(r,o,h,!1),S=(h&r.childLanes)!==0,ss||S){if(p=ln,p!==null&&(z=Tl(p,h),z!==0&&z!==M.retryLane))throw M.retryLane=z,lr(r,z),Mn(p,r,z),Yd;nh(),o=gv(r,o,h)}else r=M.treeContext,pi=Vo(z.nextSibling),Bi=o,Ln=!0,tl=null,Jr=!1,r!==null&&wd(o,r),o=Kd(o,p),o.flags|=4096;return o}return r=Ar(r.child,{mode:p.mode,children:p.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Kc(r,o){var h=o.ref;if(h===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(r===null||r.ref!==h)&&(o.flags|=4194816)}}function Ku(r,o,h,p,S){return Hl(o),h=Bd(r,o,h,p,void 0,S),p=ng(),r!==null&&!ss?(ig(r,o,S),Zi(r,o,S)):(Ln&&p&&Mo(o),o.flags|=1,As(r,o,h,S),o.child)}function yf(r,o,h,p,S,M){return Hl(o),o.updateQueue=null,h=qc(o,p,h,S),Oy(r),p=ng(),r!==null&&!ss?(ig(r,o,M),Zi(r,o,M)):(Ln&&p&&Mo(o),o.flags|=1,As(r,o,h,M),o.child)}function $d(r,o,h,p,S){if(Hl(o),o.stateNode===null){var M=Ul,z=h.contextType;typeof z=="object"&&z!==null&&(M=tn(z)),M=new h(p,M),o.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=gf,o.stateNode=M,M._reactInternals=o,M=o.stateNode,M.props=p,M.state=o.memoizedState,M.refs={},uf(o),z=h.contextType,M.context=typeof z=="object"&&z!==null?tn(z):Ul,M.state=o.memoizedState,z=h.getDerivedStateFromProps,typeof z=="function"&&(qd(o,h,z,p),M.state=o.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(z=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),z!==M.state&&gf.enqueueReplaceState(M,M.state,null),ju(o,p,M,S),hf(),M.state=o.memoizedState),typeof M.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(r===null){M=o.stateNode;var K=o.memoizedProps,re=Yl(h,K);M.props=re;var _e=M.context,Le=h.contextType;z=Ul,typeof Le=="object"&&Le!==null&&(z=tn(Le));var Ge=h.getDerivedStateFromProps;Le=typeof Ge=="function"||typeof M.getSnapshotBeforeUpdate=="function",K=o.pendingProps!==K,Le||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(K||_e!==z)&&Eg(o,M,p,z),cr=!1;var Me=o.memoizedState;M.state=Me,ju(o,p,M,S),hf(),_e=o.memoizedState,K||Me!==_e||cr?(typeof Ge=="function"&&(qd(o,h,Ge,p),_e=o.memoizedState),(re=cr||Sg(o,h,re,p,Me,_e,z))?(Le||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount()),typeof M.componentDidMount=="function"&&(o.flags|=4194308)):(typeof M.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=_e),M.props=p,M.state=_e,M.context=z,p=re):(typeof M.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{M=o.stateNode,Km(r,o),z=o.memoizedProps,Le=Yl(h,z),M.props=Le,Ge=o.pendingProps,Me=M.context,_e=h.contextType,re=Ul,typeof _e=="object"&&_e!==null&&(re=tn(_e)),K=h.getDerivedStateFromProps,(_e=typeof K=="function"||typeof M.getSnapshotBeforeUpdate=="function")||typeof M.UNSAFE_componentWillReceiveProps!="function"&&typeof M.componentWillReceiveProps!="function"||(z!==Ge||Me!==re)&&Eg(o,M,p,re),cr=!1,Me=o.memoizedState,M.state=Me,ju(o,p,M,S),hf();var Ne=o.memoizedState;z!==Ge||Me!==Ne||cr||r!==null&&r.dependencies!==null&&af(r.dependencies)?(typeof K=="function"&&(qd(o,h,K,p),Ne=o.memoizedState),(Le=cr||Sg(o,h,Le,p,Me,Ne,re)||r!==null&&r.dependencies!==null&&af(r.dependencies))?(_e||typeof M.UNSAFE_componentWillUpdate!="function"&&typeof M.componentWillUpdate!="function"||(typeof M.componentWillUpdate=="function"&&M.componentWillUpdate(p,Ne,re),typeof M.UNSAFE_componentWillUpdate=="function"&&M.UNSAFE_componentWillUpdate(p,Ne,re)),typeof M.componentDidUpdate=="function"&&(o.flags|=4),typeof M.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof M.componentDidUpdate!="function"||z===r.memoizedProps&&Me===r.memoizedState||(o.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||z===r.memoizedProps&&Me===r.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=Ne),M.props=p,M.state=Ne,M.context=re,p=Le):(typeof M.componentDidUpdate!="function"||z===r.memoizedProps&&Me===r.memoizedState||(o.flags|=4),typeof M.getSnapshotBeforeUpdate!="function"||z===r.memoizedProps&&Me===r.memoizedState||(o.flags|=1024),p=!1)}return M=p,Kc(r,o),p=(o.flags&128)!==0,M||p?(M=o.stateNode,h=p&&typeof h.getDerivedStateFromError!="function"?null:M.render(),o.flags|=1,r!==null&&p?(o.child=sl(o,r.child,null,S),o.child=sl(o,null,h,S)):As(r,o,h,S),o.memoizedState=M.state,r=o.child):r=Zi(r,o,S),r}function yv(r,o,h,p){return Vl(),o.flags|=256,As(r,o,h,p),o.child}var Rg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zs(r){return{baseLanes:r,cachePool:Zm()}}function Jd(r,o,h){return r=r!==null?r.childLanes&~h:0,o&&(r|=dr),r}function vv(r,o,h){var p=o.pendingProps,S=!1,M=(o.flags&128)!==0,z;if((z=M)||(z=r!==null&&r.memoizedState===null?!1:(On.current&2)!==0),z&&(S=!0,o.flags&=-129),z=(o.flags&32)!==0,o.flags&=-33,r===null){if(Ln){if(S?al(o):Ir(),(r=pi)?(r=zT(r,Jr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:el!==null?{id:Di,overflow:Ja}:null,retryLane:536870912,hydrationErrors:null},h=Uu(r),h.return=o,o.child=h,Bi=o,pi=null)):r=null,r===null)throw To(o);return wS(r)?o.lanes=32:o.lanes=536870912,null}var K=p.children;return p=p.fallback,S?(Ir(),S=o.mode,K=ep({mode:"hidden",children:K},S),p=zl(p,S,h,null),K.return=o,p.return=o,K.sibling=p,o.child=K,p=o.child,p.memoizedState=Zs(h),p.childLanes=Jd(r,z,h),o.memoizedState=Rg,Do(null,p)):(al(o),vf(o,K))}var re=r.memoizedState;if(re!==null&&(K=re.dehydrated,K!==null)){if(M)o.flags&256?(al(o),o.flags&=-257,o=Ig(r,o,h)):o.memoizedState!==null?(Ir(),o.child=r.child,o.flags|=128,o=null):(Ir(),K=p.fallback,S=o.mode,p=ep({mode:"visible",children:p.children},S),K=zl(K,S,h,null),K.flags|=2,p.return=o,K.return=o,p.sibling=K,o.child=p,sl(o,r.child,null,h),p=o.child,p.memoizedState=Zs(h),p.childLanes=Jd(r,z,h),o.memoizedState=Rg,o=Do(null,p));else if(al(o),wS(K)){if(z=K.nextSibling&&K.nextSibling.dataset,z)var _e=z.dgst;z=_e,p=Error(n(419)),p.stack="",p.digest=z,Ao({value:p,source:null,stack:null}),o=Ig(r,o,h)}else if(ss||Ro(r,o,h,!1),z=(h&r.childLanes)!==0,ss||z){if(z=ln,z!==null&&(p=Tl(z,h),p!==0&&p!==re.retryLane))throw re.retryLane=p,lr(r,p),Mn(z,r,p),Yd;AS(K)||nh(),o=Ig(r,o,h)}else AS(K)?(o.flags|=192,o.child=r.child,o=null):(r=re.treeContext,pi=Vo(K.nextSibling),Bi=o,Ln=!0,tl=null,Jr=!1,r!==null&&wd(o,r),o=vf(o,p.children),o.flags|=4096);return o}return S?(Ir(),K=p.fallback,S=o.mode,re=r.child,_e=re.sibling,p=Ar(re,{mode:"hidden",children:p.children}),p.subtreeFlags=re.subtreeFlags&65011712,_e!==null?K=Ar(_e,K):(K=zl(K,S,h,null),K.flags|=2),K.return=o,p.return=o,p.sibling=K,o.child=p,Do(null,p),p=o.child,K=r.child.memoizedState,K===null?K=Zs(h):(S=K.cachePool,S!==null?(re=is._currentValue,S=S.parent!==re?{parent:re,pool:re}:S):S=Zm(),K={baseLanes:K.baseLanes|h,cachePool:S}),p.memoizedState=K,p.childLanes=Jd(r,z,h),o.memoizedState=Rg,Do(r.child,p)):(al(o),h=r.child,r=h.sibling,h=Ar(h,{mode:"visible",children:p.children}),h.return=o,h.sibling=null,r!==null&&(z=o.deletions,z===null?(o.deletions=[r],o.flags|=16):z.push(r)),o.child=h,o.memoizedState=null,h)}function vf(r,o){return o=ep({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function ep(r,o){return r=Ii(22,r,null,o),r.lanes=0,r}function Ig(r,o,h){return sl(o,r.child,null,h),r=vf(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function _v(r,o,h){r.lanes|=o;var p=r.alternate;p!==null&&(p.lanes|=o),Rd(r.return,o,h)}function Qc(r,o,h,p,S,M){var z=r.memoizedState;z===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:h,tailMode:S,treeForkCount:M}:(z.isBackwards=o,z.rendering=null,z.renderingStartTime=0,z.last=p,z.tail=h,z.tailMode=S,z.treeForkCount=M)}function Nr(r,o,h){var p=o.pendingProps,S=p.revealOrder,M=p.tail;p=p.children;var z=On.current,K=(z&2)!==0;if(K?(z=z&1|2,o.flags|=128):z&=1,$e(On,z),As(r,o,p,h),p=Ln?Fu:0,!K&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&_v(r,h,o);else if(r.tag===19)_v(r,h,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(S){case"forwards":for(h=o.child,S=null;h!==null;)r=h.alternate,r!==null&&ta(r)===null&&(S=h),h=h.sibling;h=S,h===null?(S=o.child,o.child=null):(S=h.sibling,h.sibling=null),Qc(o,!1,S,h,M,p);break;case"backwards":case"unstable_legacy-backwards":for(h=null,S=o.child,o.child=null;S!==null;){if(r=S.alternate,r!==null&&ta(r)===null){o.child=S;break}r=S.sibling,S.sibling=h,h=S,S=r}Qc(o,!0,h,null,M,p);break;case"together":Qc(o,!1,null,null,void 0,p);break;default:o.memoizedState=null}return o.child}function Zi(r,o,h){if(r!==null&&(o.dependencies=r.dependencies),zo|=o.lanes,(h&o.childLanes)===0)if(r!==null){if(Ro(r,o,h,!1),(h&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,h=Ar(r,r.pendingProps),o.child=h,h.return=o;r.sibling!==null;)r=r.sibling,h=h.sibling=Ar(r,r.pendingProps),h.return=o;h.sibling=null}return o.child}function tp(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&af(r)))}function pS(r,o,h){switch(o.tag){case 3:nt(o,o.stateNode.containerInfo),nl(o,is,r.memoizedState.cache),Vl();break;case 27:case 5:Lt(o);break;case 4:nt(o,o.stateNode.containerInfo);break;case 10:nl(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Jm(o),null;break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(al(o),o.flags|=128,null):(h&o.child.childLanes)!==0?vv(r,o,h):(al(o),r=Zi(r,o,h),r!==null?r.sibling:null);al(o);break;case 19:var S=(r.flags&128)!==0;if(p=(h&o.childLanes)!==0,p||(Ro(r,o,h,!1),p=(h&o.childLanes)!==0),S){if(p)return Nr(r,o,h);o.flags|=128}if(S=o.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),$e(On,On.current),p)break;return null;case 22:return o.lanes=0,Zc(r,o,h,o.pendingProps);case 24:nl(o,is,r.memoizedState.cache)}return Zi(r,o,h)}function np(r,o,h){if(r!==null)if(r.memoizedProps!==o.pendingProps)ss=!0;else{if(!tp(r,h)&&(o.flags&128)===0)return ss=!1,pS(r,o,h);ss=(r.flags&131072)!==0}else ss=!1,Ln&&(o.flags&1048576)!==0&&Ay(o,Fu,o.index);switch(o.lanes=0,o.tag){case 16:e:{var p=o.pendingProps;if(r=Vc(o.elementType),o.type=r,typeof r=="function")Ed(r)?(p=Yl(r,p),o.tag=1,o=$d(null,o,r,p,h)):(o.tag=0,o=Ku(null,o,r,p,h));else{if(r!=null){var S=r.$$typeof;if(S===U){o.tag=11,o=Cg(null,o,r,p,h);break e}else if(S===F){o.tag=14,o=Yc(null,o,r,p,h);break e}}throw o=ue(r)||r,Error(n(306,o,""))}}return o;case 0:return Ku(r,o,o.type,o.pendingProps,h);case 1:return p=o.type,S=Yl(p,o.pendingProps),$d(r,o,p,S,h);case 3:e:{if(nt(o,o.stateNode.containerInfo),r===null)throw Error(n(387));p=o.pendingProps;var M=o.memoizedState;S=M.element,Km(r,o),ju(o,p,null,h);var z=o.memoizedState;if(p=z.cache,nl(o,is,p),p!==M.cache&&Id(o,[is],h,!0),hf(),p=z.element,M.isDehydrated)if(M={element:p,isDehydrated:!1,cache:z.cache},o.updateQueue.baseState=M,o.memoizedState=M,o.flags&256){o=yv(r,o,p,h);break e}else if(p!==S){S=$r(Error(n(424)),o),Ao(S),o=yv(r,o,p,h);break e}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,pi=Vo(r.firstChild),Bi=o,Ln=!0,tl=null,Jr=!0,h=Ud(o,null,p,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Vl(),p===S){o=Zi(r,o,h);break e}As(r,o,p,h)}o=o.child}return o;case 26:return Kc(r,o),r===null?(h=GT(o.type,null,o.pendingProps,null))?o.memoizedState=h:Ln||(h=o.type,r=o.pendingProps,p=Ev(Ie.current).createElement(h),p[fi]=o,p[_i]=r,mr(p,h,r),le(p),o.stateNode=p):o.memoizedState=GT(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Lt(o),r===null&&Ln&&(p=o.stateNode=VT(o.type,o.pendingProps,Ie.current),Bi=o,Jr=!0,S=pi,ah(o.type)?(CS=S,pi=Vo(p.firstChild)):pi=S),As(r,o,o.pendingProps.children,h),Kc(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Ln&&((S=p=pi)&&(p=PN(p,o.type,o.pendingProps,Jr),p!==null?(o.stateNode=p,Bi=o,pi=Vo(p.firstChild),Jr=!1,S=!0):S=!1),S||To(o)),Lt(o),S=o.type,M=o.pendingProps,z=r!==null?r.memoizedProps:null,p=M.children,ES(S,M)?p=null:z!==null&&ES(S,z)&&(o.flags|=32),o.memoizedState!==null&&(S=Bd(r,o,Xc,null,null,h),kg._currentValue=S),Kc(r,o),As(r,o,p,h),o.child;case 6:return r===null&&Ln&&((r=h=pi)&&(h=LN(h,o.pendingProps,Jr),h!==null?(o.stateNode=h,Bi=o,pi=null,r=!0):r=!1),r||To(o)),null;case 13:return vv(r,o,h);case 4:return nt(o,o.stateNode.containerInfo),p=o.pendingProps,r===null?o.child=sl(o,null,p,h):As(r,o,p,h),o.child;case 11:return Cg(r,o,o.type,o.pendingProps,h);case 7:return As(r,o,o.pendingProps,h),o.child;case 8:return As(r,o,o.pendingProps.children,h),o.child;case 12:return As(r,o,o.pendingProps.children,h),o.child;case 10:return p=o.pendingProps,nl(o,o.type,p.value),As(r,o,p.children,h),o.child;case 9:return S=o.type._context,p=o.pendingProps.children,Hl(o),S=tn(S),p=p(S),o.flags|=1,As(r,o,p,h),o.child;case 14:return Yc(r,o,o.type,o.pendingProps,h);case 15:return Zd(r,o,o.type,o.pendingProps,h);case 19:return Nr(r,o,h);case 31:return Qd(r,o,h);case 22:return Zc(r,o,h,o.pendingProps);case 24:return Hl(o),p=tn(is),r===null?(S=Nd(),S===null&&(S=ln,M=Wm(),S.pooledCache=M,M.refCount++,M!==null&&(S.pooledCacheLanes|=h),S=M),o.memoizedState={parent:p,cache:S},uf(o),nl(o,is,S)):((r.lanes&h)!==0&&(Km(r,o),ju(o,null,null,h),hf()),S=r.memoizedState,M=o.memoizedState,S.parent!==p?(S={parent:p,cache:p},o.memoizedState=S,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=S),nl(o,is,p)):(p=M.cache,nl(o,is,p),p!==S.cache&&Id(o,[is],h,!0))),As(r,o,o.pendingProps.children,h),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function No(r){r.flags|=4}function _f(r,o,h,p,S){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(S&335544128)===S)if(r.stateNode.complete)r.flags|=8192;else if(Oi())r.flags|=8192;else throw Io=Pd,lf}else r.flags&=-16777217}function Dg(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!YT(o))if(Oi())r.flags|=8192;else throw Io=Pd,lf}function ll(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?hn():536870912,r.lanes|=o,bi|=o)}function Po(r,o){if(!Ln)switch(r.tailMode){case"hidden":o=r.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?r.tail=null:h.sibling=null;break;case"collapsed":h=r.tail;for(var p=null;h!==null;)h.alternate!==null&&(p=h),h=h.sibling;p===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:p.sibling=null}}function ui(r){var o=r.alternate!==null&&r.alternate.child===r.child,h=0,p=0;if(o)for(var S=r.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags&65011712,p|=S.flags&65011712,S.return=r,S=S.sibling;else for(S=r.child;S!==null;)h|=S.lanes|S.childLanes,p|=S.subtreeFlags,p|=S.flags,S.return=r,S=S.sibling;return r.subtreeFlags|=p,r.childLanes=h,o}function xf(r,o,h){var p=o.pendingProps;switch(Ad(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ui(o),null;case 1:return ui(o),null;case 3:return h=o.stateNode,p=null,r!==null&&(p=r.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),Co(is),Tt(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Vu(o)?No(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Cd())),ui(o),null;case 26:var S=o.type,M=o.memoizedState;return r===null?(No(o),M!==null?(ui(o),Dg(o,M)):(ui(o),_f(o,S,null,p,h))):M?M!==r.memoizedState?(No(o),ui(o),Dg(o,M)):(ui(o),o.flags&=-16777217):(r=r.memoizedProps,r!==p&&No(o),ui(o),_f(o,S,r,p,h)),null;case 27:if(Ht(o),h=Ie.current,S=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==p&&No(o);else{if(!p){if(o.stateNode===null)throw Error(n(166));return ui(o),null}r=Mt.current,Vu(o)?wy(o):(r=VT(S,p,h),o.stateNode=r,No(o))}return ui(o),null;case 5:if(Ht(o),S=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==p&&No(o);else{if(!p){if(o.stateNode===null)throw Error(n(166));return ui(o),null}if(M=Mt.current,Vu(o))wy(o);else{var z=Ev(Ie.current);switch(M){case 1:M=z.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:M=z.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":M=z.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":M=z.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":M=z.createElement("div"),M.innerHTML="<script><\/script>",M=M.removeChild(M.firstChild);break;case"select":M=typeof p.is=="string"?z.createElement("select",{is:p.is}):z.createElement("select"),p.multiple?M.multiple=!0:p.size&&(M.size=p.size);break;default:M=typeof p.is=="string"?z.createElement(S,{is:p.is}):z.createElement(S)}}M[fi]=o,M[_i]=p;e:for(z=o.child;z!==null;){if(z.tag===5||z.tag===6)M.appendChild(z.stateNode);else if(z.tag!==4&&z.tag!==27&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===o)break e;for(;z.sibling===null;){if(z.return===null||z.return===o)break e;z=z.return}z.sibling.return=z.return,z=z.sibling}o.stateNode=M;e:switch(mr(M,S,p),S){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&No(o)}}return ui(o),_f(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,h),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==p&&No(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(n(166));if(r=Ie.current,Vu(o)){if(r=o.stateNode,h=o.memoizedProps,p=null,S=Bi,S!==null)switch(S.tag){case 27:case 5:p=S.memoizedProps}r[fi]=o,r=!!(r.nodeValue===h||p!==null&&p.suppressHydrationWarning===!0||RT(r.nodeValue,h)),r||To(o,!0)}else r=Ev(r).createTextNode(p),r[fi]=o,o.stateNode=r}return ui(o),null;case 31:if(h=o.memoizedState,r===null||r.memoizedState!==null){if(p=Vu(o),h!==null){if(r===null){if(!p)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[fi]=o}else Vl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ui(o),r=!1}else h=Cd(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=h),r=!0;if(!r)return o.flags&256?(Xi(o),o):(Xi(o),null);if((o.flags&128)!==0)throw Error(n(558))}return ui(o),null;case 13:if(p=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(S=Vu(o),p!==null&&p.dehydrated!==null){if(r===null){if(!S)throw Error(n(318));if(S=o.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[fi]=o}else Vl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ui(o),S=!1}else S=Cd(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=S),S=!0;if(!S)return o.flags&256?(Xi(o),o):(Xi(o),null)}return Xi(o),(o.flags&128)!==0?(o.lanes=h,o):(h=p!==null,r=r!==null&&r.memoizedState!==null,h&&(p=o.child,S=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(S=p.alternate.memoizedState.cachePool.pool),M=null,p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(M=p.memoizedState.cachePool.pool),M!==S&&(p.flags|=2048)),h!==r&&h&&(o.child.flags|=8192),ll(o,o.updateQueue),ui(o),null);case 4:return Tt(),r===null&&vS(o.stateNode.containerInfo),ui(o),null;case 10:return Co(o.type),ui(o),null;case 19:if(Pe(On),p=o.memoizedState,p===null)return ui(o),null;if(S=(o.flags&128)!==0,M=p.rendering,M===null)if(S)Po(p,!1);else{if(Pi!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(M=ta(r),M!==null){for(o.flags|=128,Po(p,!1),r=M.updateQueue,o.updateQueue=r,ll(o,r),o.subtreeFlags=0,r=h,h=o.child;h!==null;)Ou(h,r),h=h.sibling;return $e(On,On.current&1|2),Ln&&Eo(o,p.treeForkCount),o.child}r=r.sibling}p.tail!==null&&G()>Ki&&(o.flags|=128,S=!0,Po(p,!1),o.lanes=4194304)}else{if(!S)if(r=ta(M),r!==null){if(o.flags|=128,S=!0,r=r.updateQueue,o.updateQueue=r,ll(o,r),Po(p,!0),p.tail===null&&p.tailMode==="hidden"&&!M.alternate&&!Ln)return ui(o),null}else 2*G()-p.renderingStartTime>Ki&&h!==536870912&&(o.flags|=128,S=!0,Po(p,!1),o.lanes=4194304);p.isBackwards?(M.sibling=o.child,o.child=M):(r=p.last,r!==null?r.sibling=M:o.child=M,p.last=M)}return p.tail!==null?(r=p.tail,p.rendering=r,p.tail=r.sibling,p.renderingStartTime=G(),r.sibling=null,h=On.current,$e(On,S?h&1|2:h&1),Ln&&Eo(o,p.treeForkCount),r):(ui(o),null);case 22:case 23:return Xi(o),ff(),p=o.memoizedState!==null,r!==null?r.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(h&536870912)!==0&&(o.flags&128)===0&&(ui(o),o.subtreeFlags&6&&(o.flags|=8192)):ui(o),h=o.updateQueue,h!==null&&ll(o,h.retryQueue),h=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==h&&(o.flags|=2048),r!==null&&Pe(Gl),null;case 24:return h=null,r!==null&&(h=r.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),Co(is),ui(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function Ca(r,o){switch(Ad(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Co(is),Tt(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Ht(o),null;case 31:if(o.memoizedState!==null){if(Xi(o),o.alternate===null)throw Error(n(340));Vl()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(Xi(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Vl()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Pe(On),null;case 4:return Tt(),null;case 10:return Co(o.type),null;case 22:case 23:return Xi(o),ff(),r!==null&&Pe(Gl),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Co(is),null;case 25:return null;default:return null}}function na(r,o){switch(Ad(o),o.tag){case 3:Co(is),Tt();break;case 26:case 27:case 5:Ht(o);break;case 4:Tt();break;case 31:o.memoizedState!==null&&Xi(o);break;case 13:Xi(o);break;case 19:Pe(On);break;case 10:Co(o.type);break;case 22:case 23:Xi(o),ff(),r!==null&&Pe(Gl);break;case 24:Co(is)}}function Ra(r,o){try{var h=o.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var S=p.next;h=S;do{if((h.tag&r)===r){p=void 0;var M=h.create,z=h.inst;p=M(),z.destroy=p}h=h.next}while(h!==S)}}catch(K){jn(o,o.return,K)}}function Os(r,o,h){try{var p=o.updateQueue,S=p!==null?p.lastEffect:null;if(S!==null){var M=S.next;p=M;do{if((p.tag&r)===r){var z=p.inst,K=z.destroy;if(K!==void 0){z.destroy=void 0,S=o;var re=h,_e=K;try{_e()}catch(Le){jn(S,re,Le)}}}p=p.next}while(p!==M)}}catch(Le){jn(o,o.return,Le)}}function eo(r){var o=r.updateQueue;if(o!==null){var h=r.stateNode;try{Ny(o,h)}catch(p){jn(r,r.return,p)}}}function ws(r,o,h){h.props=Yl(r.type,r.memoizedProps),h.state=r.memoizedState;try{h.componentWillUnmount()}catch(p){jn(r,o,p)}}function cl(r,o){try{var h=r.ref;if(h!==null){switch(r.tag){case 26:case 27:case 5:var p=r.stateNode;break;case 30:p=r.stateNode;break;default:p=r.stateNode}typeof h=="function"?r.refCleanup=h(p):h.current=p}}catch(S){jn(r,o,S)}}function Us(r,o){var h=r.ref,p=r.refCleanup;if(h!==null)if(typeof p=="function")try{p()}catch(S){jn(r,o,S)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(S){jn(r,o,S)}else h.current=null}function bf(r){var o=r.type,h=r.memoizedProps,p=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":h.autoFocus&&p.focus();break e;case"img":h.src?p.src=h.src:h.srcSet&&(p.srcset=h.srcSet)}}catch(S){jn(r,r.return,S)}}function hs(r,o,h){try{var p=r.stateNode;wN(p,r.type,h,o),p[_i]=o}catch(S){jn(r,r.return,S)}}function Ci(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ah(r.type)||r.tag===4}function Nn(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Ci(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ah(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Lo(r,o,h){var p=r.tag;if(p===5||p===6)r=r.stateNode,o?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(r,o):(o=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,o.appendChild(r),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=qa));else if(p!==4&&(p===27&&ah(r.type)&&(h=r.stateNode,o=null),r=r.child,r!==null))for(Lo(r,o,h),r=r.sibling;r!==null;)Lo(r,o,h),r=r.sibling}function hr(r,o,h){var p=r.tag;if(p===5||p===6)r=r.stateNode,o?h.insertBefore(r,o):h.appendChild(r);else if(p!==4&&(p===27&&ah(r.type)&&(h=r.stateNode),r=r.child,r!==null))for(hr(r,o,h),r=r.sibling;r!==null;)hr(r,o,h),r=r.sibling}function ip(r){var o=r.stateNode,h=r.memoizedProps;try{for(var p=r.type,S=o.attributes;S.length;)o.removeAttributeNode(S[0]);mr(o,p,h),o[fi]=r,o[_i]=h}catch(M){jn(r,r.return,M)}}var Ia=!1,mi=!1,to=!1,xv=typeof WeakSet=="function"?WeakSet:Set,Cs=null;function mS(r,o){if(r=r.containerInfo,bS=Iv,r=Sy(r),Vm(r)){if("selectionStart"in r)var h={start:r.selectionStart,end:r.selectionEnd};else e:{h=(h=r.ownerDocument)&&h.defaultView||window;var p=h.getSelection&&h.getSelection();if(p&&p.rangeCount!==0){h=p.anchorNode;var S=p.anchorOffset,M=p.focusNode;p=p.focusOffset;try{h.nodeType,M.nodeType}catch{h=null;break e}var z=0,K=-1,re=-1,_e=0,Le=0,Ge=r,Me=null;t:for(;;){for(var Ne;Ge!==h||S!==0&&Ge.nodeType!==3||(K=z+S),Ge!==M||p!==0&&Ge.nodeType!==3||(re=z+p),Ge.nodeType===3&&(z+=Ge.nodeValue.length),(Ne=Ge.firstChild)!==null;)Me=Ge,Ge=Ne;for(;;){if(Ge===r)break t;if(Me===h&&++_e===S&&(K=z),Me===M&&++Le===p&&(re=z),(Ne=Ge.nextSibling)!==null)break;Ge=Me,Me=Ge.parentNode}Ge=Ne}h=K===-1||re===-1?null:{start:K,end:re}}else h=null}h=h||{start:0,end:0}}else h=null;for(SS={focusedElem:r,selectionRange:h},Iv=!1,Cs=o;Cs!==null;)if(o=Cs,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Cs=r;else for(;Cs!==null;){switch(o=Cs,M=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(h=0;h<r.length;h++)S=r[h],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&M!==null){r=void 0,h=o,S=M.memoizedProps,M=M.memoizedState,p=h.stateNode;try{var Ot=Yl(h.type,S);r=p.getSnapshotBeforeUpdate(Ot,M),p.__reactInternalSnapshotBeforeUpdate=r}catch(en){jn(h,h.return,en)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,h=r.nodeType,h===9)TS(r);else if(h===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":TS(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,Cs=r;break}Cs=o.return}}function Ri(r,o,h){var p=h.flags;switch(h.tag){case 0:case 11:case 15:Pa(r,h),p&4&&Ra(5,h);break;case 1:if(Pa(r,h),p&4)if(r=h.stateNode,o===null)try{r.componentDidMount()}catch(z){jn(h,h.return,z)}else{var S=Yl(h.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(S,o,r.__reactInternalSnapshotBeforeUpdate)}catch(z){jn(h,h.return,z)}}p&64&&eo(h),p&512&&cl(h,h.return);break;case 3:if(Pa(r,h),p&64&&(r=h.updateQueue,r!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{Ny(r,o)}catch(z){jn(h,h.return,z)}}break;case 27:o===null&&p&4&&ip(h);case 26:case 5:Pa(r,h),o===null&&p&4&&bf(h),p&512&&cl(h,h.return);break;case 12:Pa(r,h);break;case 31:Pa(r,h),p&4&&Zl(r,h);break;case 13:Pa(r,h),p&4&&Qu(r,h),p&64&&(r=h.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(h=g.bind(null,h),ON(r,h))));break;case 22:if(p=h.memoizedState!==null||Ia,!p){o=o!==null&&o.memoizedState!==null||mi,S=Ia;var M=mi;Ia=p,(mi=o)&&!M?fr(r,h,(h.subtreeFlags&8772)!==0):Pa(r,h),Ia=S,mi=M}break;case 30:break;default:Pa(r,h)}}function Sf(r){var o=r.alternate;o!==null&&(r.alternate=null,Sf(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&ma(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var ri=null,Ks=!1;function Da(r,o,h){for(h=h.child;h!==null;)sp(r,o,h),h=h.sibling}function sp(r,o,h){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(We,h)}catch{}switch(h.tag){case 26:mi||Us(h,o),Da(r,o,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:mi||Us(h,o);var p=ri,S=Ks;ah(h.type)&&(ri=h.stateNode,Ks=!1),Da(r,o,h),Fg(h.stateNode),ri=p,Ks=S;break;case 5:mi||Us(h,o);case 6:if(p=ri,S=Ks,ri=null,Da(r,o,h),ri=p,Ks=S,ri!==null)if(Ks)try{(ri.nodeType===9?ri.body:ri.nodeName==="HTML"?ri.ownerDocument.body:ri).removeChild(h.stateNode)}catch(M){jn(h,o,M)}else try{ri.removeChild(h.stateNode)}catch(M){jn(h,o,M)}break;case 18:ri!==null&&(Ks?(r=ri,OT(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,h.stateNode),fp(r)):OT(ri,h.stateNode));break;case 4:p=ri,S=Ks,ri=h.stateNode.containerInfo,Ks=!0,Da(r,o,h),ri=p,Ks=S;break;case 0:case 11:case 14:case 15:Os(2,h,o),mi||Os(4,h,o),Da(r,o,h);break;case 1:mi||(Us(h,o),p=h.stateNode,typeof p.componentWillUnmount=="function"&&ws(h,o,p)),Da(r,o,h);break;case 21:Da(r,o,h);break;case 22:mi=(p=mi)||h.memoizedState!==null,Da(r,o,h),mi=p;break;default:Da(r,o,h)}}function Zl(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{fp(r)}catch(h){jn(o,o.return,h)}}}function Qu(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{fp(r)}catch(h){jn(o,o.return,h)}}function Ng(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new xv),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new xv),o;default:throw Error(n(435,r.tag))}}function ul(r,o){var h=Ng(r);o.forEach(function(p){if(!h.has(p)){h.add(p);var S=b.bind(null,r,p);p.then(S,S)}})}function fs(r,o){var h=o.deletions;if(h!==null)for(var p=0;p<h.length;p++){var S=h[p],M=r,z=o,K=z;e:for(;K!==null;){switch(K.tag){case 27:if(ah(K.type)){ri=K.stateNode,Ks=!1;break e}break;case 5:ri=K.stateNode,Ks=!1;break e;case 3:case 4:ri=K.stateNode.containerInfo,Ks=!0;break e}K=K.return}if(ri===null)throw Error(n(160));sp(M,z,S),ri=null,Ks=!1,M=S.alternate,M!==null&&(M.return=null),S.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Kl(o,r),o=o.sibling}var Na=null;function Kl(r,o){var h=r.alternate,p=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:fs(o,r),ds(r),p&4&&(Os(3,r,r.return),Ra(3,r),Os(5,r,r.return));break;case 1:fs(o,r),ds(r),p&512&&(mi||h===null||Us(h,h.return)),p&64&&Ia&&(r=r.updateQueue,r!==null&&(p=r.callbacks,p!==null&&(h=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=h===null?p:h.concat(p))));break;case 26:var S=Na;if(fs(o,r),ds(r),p&512&&(mi||h===null||Us(h,h.return)),p&4){var M=h!==null?h.memoizedState:null;if(p=r.memoizedState,h===null)if(p===null)if(r.stateNode===null){e:{p=r.type,h=r.memoizedProps,S=S.ownerDocument||S;t:switch(p){case"title":M=S.getElementsByTagName("title")[0],(!M||M[Ws]||M[fi]||M.namespaceURI==="http://www.w3.org/2000/svg"||M.hasAttribute("itemprop"))&&(M=S.createElement(p),S.head.insertBefore(M,S.querySelector("head > title"))),mr(M,p,h),M[fi]=r,le(M),p=M;break e;case"link":var z=qT("link","href",S).get(p+(h.href||""));if(z){for(var K=0;K<z.length;K++)if(M=z[K],M.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&M.getAttribute("rel")===(h.rel==null?null:h.rel)&&M.getAttribute("title")===(h.title==null?null:h.title)&&M.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){z.splice(K,1);break t}}M=S.createElement(p),mr(M,p,h),S.head.appendChild(M);break;case"meta":if(z=qT("meta","content",S).get(p+(h.content||""))){for(K=0;K<z.length;K++)if(M=z[K],M.getAttribute("content")===(h.content==null?null:""+h.content)&&M.getAttribute("name")===(h.name==null?null:h.name)&&M.getAttribute("property")===(h.property==null?null:h.property)&&M.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&M.getAttribute("charset")===(h.charSet==null?null:h.charSet)){z.splice(K,1);break t}}M=S.createElement(p),mr(M,p,h),S.head.appendChild(M);break;default:throw Error(n(468,p))}M[fi]=r,le(M),p=M}r.stateNode=p}else XT(S,r.type,r.stateNode);else r.stateNode=WT(S,p,r.memoizedProps);else M!==p?(M===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):M.count--,p===null?XT(S,r.type,r.stateNode):WT(S,p,r.memoizedProps)):p===null&&r.stateNode!==null&&hs(r,r.memoizedProps,h.memoizedProps)}break;case 27:fs(o,r),ds(r),p&512&&(mi||h===null||Us(h,h.return)),h!==null&&p&4&&hs(r,r.memoizedProps,h.memoizedProps);break;case 5:if(fs(o,r),ds(r),p&512&&(mi||h===null||Us(h,h.return)),r.flags&32){S=r.stateNode;try{Mi(S,"")}catch(Ot){jn(r,r.return,Ot)}}p&4&&r.stateNode!=null&&(S=r.memoizedProps,hs(r,S,h!==null?h.memoizedProps:S)),p&1024&&(to=!0);break;case 6:if(fs(o,r),ds(r),p&4){if(r.stateNode===null)throw Error(n(162));p=r.memoizedProps,h=r.stateNode;try{h.nodeValue=p}catch(Ot){jn(r,r.return,Ot)}}break;case 3:if(Av=null,S=Na,Na=Mv(o.containerInfo),fs(o,r),Na=S,ds(r),p&4&&h!==null&&h.memoizedState.isDehydrated)try{fp(o.containerInfo)}catch(Ot){jn(r,r.return,Ot)}to&&(to=!1,rp(r));break;case 4:p=Na,Na=Mv(r.stateNode.containerInfo),fs(o,r),ds(r),Na=p;break;case 12:fs(o,r),ds(r);break;case 31:fs(o,r),ds(r),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,ul(r,p)));break;case 13:fs(o,r),ds(r),r.child.flags&8192&&r.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&($u=G()),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,ul(r,p)));break;case 22:S=r.memoizedState!==null;var re=h!==null&&h.memoizedState!==null,_e=Ia,Le=mi;if(Ia=_e||S,mi=Le||re,fs(o,r),mi=Le,Ia=_e,ds(r),p&8192)e:for(o=r.stateNode,o._visibility=S?o._visibility&-2:o._visibility|1,S&&(h===null||re||Ia||mi||Oo(r)),h=null,o=r;;){if(o.tag===5||o.tag===26){if(h===null){re=h=o;try{if(M=re.stateNode,S)z=M.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none";else{K=re.stateNode;var Ge=re.memoizedProps.style,Me=Ge!=null&&Ge.hasOwnProperty("display")?Ge.display:null;K.style.display=Me==null||typeof Me=="boolean"?"":(""+Me).trim()}}catch(Ot){jn(re,re.return,Ot)}}}else if(o.tag===6){if(h===null){re=o;try{re.stateNode.nodeValue=S?"":re.memoizedProps}catch(Ot){jn(re,re.return,Ot)}}}else if(o.tag===18){if(h===null){re=o;try{var Ne=re.stateNode;S?UT(Ne,!0):UT(re.stateNode,!1)}catch(Ot){jn(re,re.return,Ot)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;h===o&&(h=null),o=o.return}h===o&&(h=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=r.updateQueue,p!==null&&(h=p.retryQueue,h!==null&&(p.retryQueue=null,ul(r,h))));break;case 19:fs(o,r),ds(r),p&4&&(p=r.updateQueue,p!==null&&(r.updateQueue=null,ul(r,p)));break;case 30:break;case 21:break;default:fs(o,r),ds(r)}}function ds(r){var o=r.flags;if(o&2){try{for(var h,p=r.return;p!==null;){if(Ci(p)){h=p;break}p=p.return}if(h==null)throw Error(n(160));switch(h.tag){case 27:var S=h.stateNode,M=Nn(r);hr(r,M,S);break;case 5:var z=h.stateNode;h.flags&32&&(Mi(z,""),h.flags&=-33);var K=Nn(r);hr(r,K,z);break;case 3:case 4:var re=h.stateNode.containerInfo,_e=Nn(r);Lo(r,_e,re);break;default:throw Error(n(161))}}catch(Le){jn(r,r.return,Le)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function rp(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;rp(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Pa(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Ri(r,o.alternate,o),o=o.sibling}function Oo(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:Os(4,o,o.return),Oo(o);break;case 1:Us(o,o.return);var h=o.stateNode;typeof h.componentWillUnmount=="function"&&ws(o,o.return,h),Oo(o);break;case 27:Fg(o.stateNode);case 26:case 5:Us(o,o.return),Oo(o);break;case 22:o.memoizedState===null&&Oo(o);break;case 30:Oo(o);break;default:Oo(o)}r=r.sibling}}function fr(r,o,h){for(h=h&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,S=r,M=o,z=M.flags;switch(M.tag){case 0:case 11:case 15:fr(S,M,h),Ra(4,M);break;case 1:if(fr(S,M,h),p=M,S=p.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(_e){jn(p,p.return,_e)}if(p=M,S=p.updateQueue,S!==null){var K=p.stateNode;try{var re=S.shared.hiddenCallbacks;if(re!==null)for(S.shared.hiddenCallbacks=null,S=0;S<re.length;S++)Wu(re[S],K)}catch(_e){jn(p,p.return,_e)}}h&&z&64&&eo(M),cl(M,M.return);break;case 27:ip(M);case 26:case 5:fr(S,M,h),h&&p===null&&z&4&&bf(M),cl(M,M.return);break;case 12:fr(S,M,h);break;case 31:fr(S,M,h),h&&z&4&&Zl(S,M);break;case 13:fr(S,M,h),h&&z&4&&Qu(S,M);break;case 22:M.memoizedState===null&&fr(S,M,h),cl(M,M.return);break;case 30:break;default:fr(S,M,h)}o=o.sibling}}function Ql(r,o){var h=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(h=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==h&&(r!=null&&r.refCount++,h!=null&&Fc(h))}function $c(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Fc(r))}function zs(r,o,h,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Pg(r,o,h,p),o=o.sibling}function Pg(r,o,h,p){var S=o.flags;switch(o.tag){case 0:case 11:case 15:zs(r,o,h,p),S&2048&&Ra(9,o);break;case 1:zs(r,o,h,p);break;case 3:zs(r,o,h,p),S&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Fc(r)));break;case 12:if(S&2048){zs(r,o,h,p),r=o.stateNode;try{var M=o.memoizedProps,z=M.id,K=M.onPostCommit;typeof K=="function"&&K(z,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(re){jn(o,o.return,re)}}else zs(r,o,h,p);break;case 31:zs(r,o,h,p);break;case 13:zs(r,o,h,p);break;case 23:break;case 22:M=o.stateNode,z=o.alternate,o.memoizedState!==null?M._visibility&2?zs(r,o,h,p):Uo(r,o):M._visibility&2?zs(r,o,h,p):(M._visibility|=2,Fs(r,o,h,p,(o.subtreeFlags&10256)!==0||!1)),S&2048&&Ql(z,o);break;case 24:zs(r,o,h,p),S&2048&&$c(o.alternate,o);break;default:zs(r,o,h,p)}}function Fs(r,o,h,p,S){for(S=S&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var M=r,z=o,K=h,re=p,_e=z.flags;switch(z.tag){case 0:case 11:case 15:Fs(M,z,K,re,S),Ra(8,z);break;case 23:break;case 22:var Le=z.stateNode;z.memoizedState!==null?Le._visibility&2?Fs(M,z,K,re,S):Uo(M,z):(Le._visibility|=2,Fs(M,z,K,re,S)),S&&_e&2048&&Ql(z.alternate,z);break;case 24:Fs(M,z,K,re,S),S&&_e&2048&&$c(z.alternate,z);break;default:Fs(M,z,K,re,S)}o=o.sibling}}function Uo(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var h=r,p=o,S=p.flags;switch(p.tag){case 22:Uo(h,p),S&2048&&Ql(p.alternate,p);break;case 24:Uo(h,p),S&2048&&$c(p.alternate,p);break;default:Uo(h,p)}o=o.sibling}}var Jc=8192;function ia(r,o,h){if(r.subtreeFlags&Jc)for(r=r.child;r!==null;)ap(r,o,h),r=r.sibling}function ap(r,o,h){switch(r.tag){case 26:ia(r,o,h),r.flags&Jc&&r.memoizedState!==null&&XN(h,Na,r.memoizedState,r.memoizedProps);break;case 5:ia(r,o,h);break;case 3:case 4:var p=Na;Na=Mv(r.stateNode.containerInfo),ia(r,o,h),Na=p;break;case 22:r.memoizedState===null&&(p=r.alternate,p!==null&&p.memoizedState!==null?(p=Jc,Jc=16777216,ia(r,o,h),Jc=p):ia(r,o,h));break;default:ia(r,o,h)}}function eu(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function $l(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];Cs=p,Vi(p,r)}eu(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Pr(r),r=r.sibling}function Pr(r){switch(r.tag){case 0:case 11:case 15:$l(r),r.flags&2048&&Os(9,r,r.return);break;case 3:$l(r);break;case 12:$l(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Lr(r)):$l(r);break;default:$l(r)}}function Lr(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];Cs=p,Vi(p,r)}eu(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:Os(8,o,o.return),Lr(o);break;case 22:h=o.stateNode,h._visibility&2&&(h._visibility&=-3,Lr(o));break;default:Lr(o)}r=r.sibling}}function Vi(r,o){for(;Cs!==null;){var h=Cs;switch(h.tag){case 0:case 11:case 15:Os(8,h,o);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var p=h.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Fc(h.memoizedState.cache)}if(p=h.child,p!==null)p.return=h,Cs=p;else e:for(h=r;Cs!==null;){p=Cs;var S=p.sibling,M=p.return;if(Sf(p),p===h){Cs=null;break e}if(S!==null){S.return=M,Cs=S;break e}Cs=M}}}var hl={getCacheForType:function(r){var o=tn(is),h=o.data.get(r);return h===void 0&&(h=r(),o.data.set(r,h)),h},cacheSignal:function(){return tn(is).controller.signal}},mn=typeof WeakMap=="function"?WeakMap:Map,kt=0,ln=null,En=null,_n=0,Fn=0,Qs=null,La=!1,no=!1,Lg=!1,sa=0,Pi=0,zo=0,Jl=0,Ef=0,dr=0,bi=0,tu=null,ki=null,Hi=!1,$u=0,Og=0,Ki=1/0,Li=null,Qi=null,ai=0,ra=null,Ju=null,Oa=0,eh=0,th=null,Mf=null,ec=0,nu=null;function aa(){return(kt&2)!==0&&_n!==0?_n&-_n:ee.T!==null?Re():Mr()}function Rn(){if(dr===0)if((_n&536870912)===0||Ln){var r=Ze;Ze<<=1,(Ze&3932160)===0&&(Ze=262144),dr=r}else dr=536870912;return r=Rr.current,r!==null&&(r.flags|=32),dr}function Mn(r,o,h){(r===ln&&(Fn===2||Fn===9)||r.cancelPendingCommit!==null)&&(nc(r,0),rs(r,_n,dr,!1)),Si(r,h),((kt&2)===0||r!==ln)&&(r===ln&&((kt&2)===0&&(Jl|=h),Pi===4&&rs(r,_n,dr,!1)),et(r))}function In(r,o,h){if((kt&6)!==0)throw Error(n(327));var p=!h&&(o&127)===0&&(o&r.expiredLanes)===0||dt(r,o),S=p?Tf(r,o):pr(r,o,!0),M=p;do{if(S===0){no&&!p&&rs(r,o,0,!1);break}else{if(h=r.current.alternate,M&&!oi(h)){S=pr(r,o,!1),M=!1;continue}if(S===2){if(M=o,r.errorRecoveryDisabledLanes&M)var z=0;else z=r.pendingLanes&-536870913,z=z!==0?z:z&536870912?536870912:0;if(z!==0){o=z;e:{var K=r;S=tu;var re=K.current.memoizedState.isDehydrated;if(re&&(nc(K,z).flags|=256),z=pr(K,z,!1),z!==2){if(Lg&&!re){K.errorRecoveryDisabledLanes|=M,Jl|=M,S=4;break e}M=ki,ki=S,M!==null&&(ki===null?ki=M:ki.push.apply(ki,M))}S=z}if(M=!1,S!==2)continue}}if(S===1){nc(r,0),rs(r,o,0,!0);break}e:{switch(p=r,M=S,M){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:rs(p,o,dr,!La);break e;case 2:ki=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(S=$u+300-G(),10<S)){if(rs(p,o,dr,!La),Ce(p,0,!0)!==0)break e;Oa=o,p.timeoutHandle=PT(Pn.bind(null,p,h,ki,Li,Hi,o,dr,Jl,bi,La,M,"Throttled",-0,0),S);break e}Pn(p,h,ki,Li,Hi,o,dr,Jl,bi,La,M,null,-0,0)}}break}while(!0);et(r)}function Pn(r,o,h,p,S,M,z,K,re,_e,Le,Ge,Me,Ne){if(r.timeoutHandle=-1,Ge=o.subtreeFlags,Ge&8192||(Ge&16785408)===16785408){Ge={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:qa},ap(o,M,Ge);var Ot=(M&62914560)===M?$u-G():(M&4194048)===M?Og-G():0;if(Ot=YN(Ge,Ot),Ot!==null){Oa=M,r.cancelPendingCommit=Ot(dl.bind(null,r,o,M,h,p,S,z,K,re,Le,Ge,null,Me,Ne)),rs(r,M,z,!_e);return}}dl(r,o,M,h,p,S,z,K,re)}function oi(r){for(var o=r;;){var h=o.tag;if((h===0||h===11||h===15)&&o.flags&16384&&(h=o.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var p=0;p<h.length;p++){var S=h[p],M=S.getSnapshot;S=S.value;try{if(!or(M(),S))return!1}catch{return!1}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function rs(r,o,h,p){o&=~Ef,o&=~Jl,r.suspendedLanes|=o,r.pingedLanes&=~o,p&&(r.warmLanes|=o),p=r.expirationTimes;for(var S=o;0<S;){var M=31-ne(S),z=1<<M;p[M]=-1,S&=~z}h!==0&&Er(r,h,o)}function io(){return(kt&6)===0?(At(0),!1):!0}function tc(){if(En!==null){if(Fn===0)var r=En.return;else r=En,wo=kl=null,sg(r),Gc=null,jc=0,r=En;for(;r!==null;)na(r.alternate,r),r=r.return;En=null}}function nc(r,o){var h=r.timeoutHandle;h!==-1&&(r.timeoutHandle=-1,IN(h)),h=r.cancelPendingCommit,h!==null&&(r.cancelPendingCommit=null,h()),Oa=0,tc(),ln=r,En=h=Ar(r.current,null),_n=o,Fn=0,Qs=null,La=!1,no=dt(r,o),Lg=!1,bi=dr=Ef=Jl=zo=Pi=0,ki=tu=null,Hi=!1,(o&8)!==0&&(o|=o&32);var p=r.entangledLanes;if(p!==0)for(r=r.entanglements,p&=o;0<p;){var S=31-ne(p),M=1<<S;o|=r[S],p&=~M}return sa=o,sf(),h}function Fo(r,o){pn=null,ee.H=Zu,o===Bc||o===Sn?(o=kc(),Fn=3):o===lf?(o=kc(),Fn=4):Fn=o===Yd?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Qs=o,En===null&&(Pi=1,Xd(r,$r(o,r.current)))}function Oi(){var r=Rr.current;return r===null?!0:(_n&4194048)===_n?ur===null:(_n&62914560)===_n||(_n&536870912)!==0?r===ur:!1}function fl(){var r=ee.H;return ee.H=Zu,r===null?Zu:r}function ic(){var r=ee.A;return ee.A=hl,r}function nh(){Pi=4,La||(_n&4194048)!==_n&&Rr.current!==null||(no=!0),(zo&134217727)===0&&(Jl&134217727)===0||ln===null||rs(ln,_n,dr,!1)}function pr(r,o,h){var p=kt;kt|=2;var S=fl(),M=ic();(ln!==r||_n!==o)&&(Li=null,nc(r,o)),o=!1;var z=Pi;e:do try{if(Fn!==0&&En!==null){var K=En,re=Qs;switch(Fn){case 8:tc(),z=6;break e;case 3:case 2:case 9:case 6:Rr.current===null&&(o=!0);var _e=Fn;if(Fn=0,Qs=null,iu(r,K,re,_e),h&&no){z=0;break e}break;default:_e=Fn,Fn=0,Qs=null,iu(r,K,re,_e)}}ih(),z=Pi;break}catch(Le){Fo(r,Le)}while(!0);return o&&r.shellSuspendCounter++,wo=kl=null,kt=p,ee.H=S,ee.A=M,En===null&&(ln=null,_n=0,sf()),z}function ih(){for(;En!==null;)op(En)}function Tf(r,o){var h=kt;kt|=2;var p=fl(),S=ic();ln!==r||_n!==o?(Li=null,Ki=G()+500,nc(r,o)):no=dt(r,o);e:do try{if(Fn!==0&&En!==null){o=En;var M=Qs;t:switch(Fn){case 1:Fn=0,Qs=null,iu(r,o,M,1);break;case 2:case 9:if(Cr(M)){Fn=0,Qs=null,Af(o);break}o=function(){Fn!==2&&Fn!==9||ln!==r||(Fn=7),et(r)},M.then(o,o);break e;case 3:Fn=7;break e;case 4:Fn=5;break e;case 7:Cr(M)?(Fn=0,Qs=null,Af(o)):(Fn=0,Qs=null,iu(r,o,M,7));break;case 5:var z=null;switch(En.tag){case 26:z=En.memoizedState;case 5:case 27:var K=En;if(z?YT(z):K.stateNode.complete){Fn=0,Qs=null;var re=K.sibling;if(re!==null)En=re;else{var _e=K.return;_e!==null?(En=_e,sc(_e)):En=null}break t}}Fn=0,Qs=null,iu(r,o,M,5);break;case 6:Fn=0,Qs=null,iu(r,o,M,6);break;case 8:tc(),Pi=6;break e;default:throw Error(n(462))}}Or();break}catch(Le){Fo(r,Le)}while(!0);return wo=kl=null,ee.H=p,ee.A=S,kt=h,En!==null?0:(ln=null,_n=0,sf(),Pi)}function Or(){for(;En!==null&&!st();)op(En)}function op(r){var o=np(r.alternate,r,sa);r.memoizedProps=r.pendingProps,o===null?sc(r):En=o}function Af(r){var o=r,h=o.alternate;switch(o.tag){case 15:case 0:o=yf(h,o,o.pendingProps,o.type,void 0,_n);break;case 11:o=yf(h,o,o.pendingProps,o.type.render,o.ref,_n);break;case 5:sg(o);default:na(h,o),o=En=Ou(o,sa),o=np(h,o,sa)}r.memoizedProps=r.pendingProps,o===null?sc(r):En=o}function iu(r,o,h,p){wo=kl=null,sg(o),Gc=null,jc=0;var S=o.return;try{if(us(r,S,o,h,_n)){Pi=1,Xd(r,$r(h,r.current)),En=null;return}}catch(M){if(S!==null)throw En=S,M;Pi=1,Xd(r,$r(h,r.current)),En=null;return}o.flags&32768?(Ln||p===1?r=!0:no||(_n&536870912)!==0?r=!1:(La=r=!0,(p===2||p===9||p===3||p===6)&&(p=Rr.current,p!==null&&p.tag===13&&(p.flags|=16384))),wf(o,r)):sc(o)}function sc(r){var o=r;do{if((o.flags&32768)!==0){wf(o,La);return}r=o.return;var h=xf(o.alternate,o,sa);if(h!==null){En=h;return}if(o=o.sibling,o!==null){En=o;return}En=o=r}while(o!==null);Pi===0&&(Pi=5)}function wf(r,o){do{var h=Ca(r.alternate,r);if(h!==null){h.flags&=32767,En=h;return}if(h=r.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!o&&(r=r.sibling,r!==null)){En=r;return}En=r=h}while(r!==null);Pi=6,En=null}function dl(r,o,h,p,S,M,z,K,re){r.cancelPendingCommit=null;do sh();while(ai!==0);if((kt&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(M=o.lanes|o.childLanes,M|=Ms,Gi(r,h,M,z,K,re),r===ln&&(En=ln=null,_n=0),Ju=o,ra=r,Oa=h,eh=M,th=S,Mf=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,C(we,function(){return lp(),null})):(r.callbackNode=null,r.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=ee.T,ee.T=null,S=ie.p,ie.p=2,z=kt,kt|=4;try{mS(r,o,h)}finally{kt=z,ie.p=S,ee.T=p}}ai=1,as(),pl(),su()}}function as(){if(ai===1){ai=0;var r=ra,o=Ju,h=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||h){h=ee.T,ee.T=null;var p=ie.p;ie.p=2;var S=kt;kt|=4;try{Kl(o,r);var M=SS,z=Sy(r.containerInfo),K=M.focusedElem,re=M.selectionRange;if(z!==K&&K&&K.ownerDocument&&di(K.ownerDocument.documentElement,K)){if(re!==null&&Vm(K)){var _e=re.start,Le=re.end;if(Le===void 0&&(Le=_e),"selectionStart"in K)K.selectionStart=_e,K.selectionEnd=Math.min(Le,K.value.length);else{var Ge=K.ownerDocument||document,Me=Ge&&Ge.defaultView||window;if(Me.getSelection){var Ne=Me.getSelection(),Ot=K.textContent.length,en=Math.min(re.start,Ot),yi=re.end===void 0?en:Math.min(re.end,Ot);!Ne.extend&&en>yi&&(z=yi,yi=en,en=z);var de=Nu(K,en),ce=Nu(K,yi);if(de&&ce&&(Ne.rangeCount!==1||Ne.anchorNode!==de.node||Ne.anchorOffset!==de.offset||Ne.focusNode!==ce.node||Ne.focusOffset!==ce.offset)){var ve=Ge.createRange();ve.setStart(de.node,de.offset),Ne.removeAllRanges(),en>yi?(Ne.addRange(ve),Ne.extend(ce.node,ce.offset)):(ve.setEnd(ce.node,ce.offset),Ne.addRange(ve))}}}}for(Ge=[],Ne=K;Ne=Ne.parentNode;)Ne.nodeType===1&&Ge.push({element:Ne,left:Ne.scrollLeft,top:Ne.scrollTop});for(typeof K.focus=="function"&&K.focus(),K=0;K<Ge.length;K++){var He=Ge[K];He.element.scrollLeft=He.left,He.element.scrollTop=He.top}}Iv=!!bS,SS=bS=null}finally{kt=S,ie.p=p,ee.T=h}}r.current=o,ai=2}}function pl(){if(ai===2){ai=0;var r=ra,o=Ju,h=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||h){h=ee.T,ee.T=null;var p=ie.p;ie.p=2;var S=kt;kt|=4;try{Ri(r,o.alternate,o)}finally{kt=S,ie.p=p,ee.T=h}}ai=3}}function su(){if(ai===4||ai===3){ai=0,Q();var r=ra,o=Ju,h=Oa,p=Mf;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?ai=5:(ai=0,Ju=ra=null,Bo(r,r.pendingLanes));var S=r.pendingLanes;if(S===0&&(Qi=null),er(h),o=o.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(We,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=ee.T,S=ie.p,ie.p=2,ee.T=null;try{for(var M=r.onRecoverableError,z=0;z<p.length;z++){var K=p[z];M(K.value,{componentStack:K.stack})}}finally{ee.T=o,ie.p=S}}(Oa&3)!==0&&sh(),et(r),S=r.pendingLanes,(h&261930)!==0&&(S&42)!==0?r===nu?ec++:(ec=0,nu=r):ec=0,At(0)}}function Bo(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Fc(o)))}function sh(){return as(),pl(),su(),lp()}function lp(){if(ai!==5)return!1;var r=ra,o=eh;eh=0;var h=er(Oa),p=ee.T,S=ie.p;try{ie.p=32>h?32:h,ee.T=null,h=th,th=null;var M=ra,z=Oa;if(ai=0,Ju=ra=null,Oa=0,(kt&6)!==0)throw Error(n(331));var K=kt;if(kt|=4,Pr(M.current),Pg(M,M.current,z,h),kt=K,At(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(We,M)}catch{}return!0}finally{ie.p=S,ee.T=p,Bo(r,o)}}function Ug(r,o,h){o=$r(h,o),o=Ag(r.stateNode,o,2),r=jl(r,o,2),r!==null&&(Si(r,2),et(r))}function jn(r,o,h){if(r.tag===3)Ug(r,r,h);else for(;o!==null;){if(o.tag===3){Ug(o,r,h);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Qi===null||!Qi.has(p))){r=$r(h,r),h=wg(2),p=jl(o,h,2),p!==null&&(mv(h,p,o,r),Si(p,2),et(p));break}}o=o.return}}function Cf(r,o,h){var p=r.pingCache;if(p===null){p=r.pingCache=new mn;var S=new Set;p.set(o,S)}else S=p.get(o),S===void 0&&(S=new Set,p.set(o,S));S.has(h)||(Lg=!0,S.add(h),r=l.bind(null,r,o,h),o.then(r,r))}function l(r,o,h){var p=r.pingCache;p!==null&&p.delete(o),r.pingedLanes|=r.suspendedLanes&h,r.warmLanes&=~h,ln===r&&(_n&h)===h&&(Pi===4||Pi===3&&(_n&62914560)===_n&&300>G()-$u?(kt&2)===0&&nc(r,0):Ef|=h,bi===_n&&(bi=0)),et(r)}function u(r,o){o===0&&(o=hn()),r=lr(r,o),r!==null&&(Si(r,o),et(r))}function g(r){var o=r.memoizedState,h=0;o!==null&&(h=o.retryLane),u(r,h)}function b(r,o){var h=0;switch(r.tag){case 31:case 13:var p=r.stateNode,S=r.memoizedState;S!==null&&(h=S.retryLane);break;case 19:p=r.stateNode;break;case 22:p=r.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(o),u(r,h)}function C(r,o){return it(r,o)}var D=null,Y=null,ae=!1,De=!1,Ke=!1,ft=0;function et(r){r!==Y&&r.next===null&&(Y===null?D=Y=r:Y=Y.next=r),De=!0,ae||(ae=!0,pe())}function At(r,o){if(!Ke&&De){Ke=!0;do for(var h=!1,p=D;p!==null;){if(r!==0){var S=p.pendingLanes;if(S===0)var M=0;else{var z=p.suspendedLanes,K=p.pingedLanes;M=(1<<31-ne(42|r)+1)-1,M&=S&~(z&~K),M=M&201326741?M&201326741|1:M?M|2:0}M!==0&&(h=!0,Ee(p,M))}else M=_n,M=Ce(p,p===ln?M:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(M&3)===0||dt(p,M)||(h=!0,Ee(p,M));p=p.next}while(h);Ke=!1}}function dn(){$i()}function $i(){De=ae=!1;var r=0;ft!==0&&RN()&&(r=ft);for(var o=G(),h=null,p=D;p!==null;){var S=p.next,M=rh(p,o);M===0?(p.next=null,h===null?D=S:h.next=S,S===null&&(Y=h)):(h=p,(r!==0||(M&3)!==0)&&(De=!0)),p=S}ai!==0&&ai!==5||At(r),ft!==0&&(ft=0)}function rh(r,o){for(var h=r.suspendedLanes,p=r.pingedLanes,S=r.expirationTimes,M=r.pendingLanes&-62914561;0<M;){var z=31-ne(M),K=1<<z,re=S[z];re===-1?((K&h)===0||(K&p)!==0)&&(S[z]=Bt(K,o)):re<=o&&(r.expiredLanes|=K),M&=~K}if(o=ln,h=_n,h=Ce(r,r===o?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),p=r.callbackNode,h===0||r===o&&(Fn===2||Fn===9)||r.cancelPendingCommit!==null)return p!==null&&p!==null&&Rt(p),r.callbackNode=null,r.callbackPriority=0;if((h&3)===0||dt(r,h)){if(o=h&-h,o===r.callbackPriority)return o;switch(p!==null&&Rt(p),er(h)){case 2:case 8:h=Fe;break;case 32:h=we;break;case 268435456:h=rt;break;default:h=we}return p=rc.bind(null,r),h=it(h,p),r.callbackPriority=o,r.callbackNode=h,o}return p!==null&&p!==null&&Rt(p),r.callbackPriority=2,r.callbackNode=null,2}function rc(r,o){if(ai!==0&&ai!==5)return r.callbackNode=null,r.callbackPriority=0,null;var h=r.callbackNode;if(sh()&&r.callbackNode!==h)return null;var p=_n;return p=Ce(r,r===ln?p:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),p===0?null:(In(r,p,o),rh(r,G()),r.callbackNode!=null&&r.callbackNode===h?rc.bind(null,r):null)}function Ee(r,o){if(sh())return null;In(r,o,!0)}function pe(){DN(function(){(kt&6)!==0?it(Ae,dn):$i()})}function Re(){if(ft===0){var r=il;r===0&&(r=je,je<<=1,(je&261888)===0&&(je=256)),ft=r}return ft}function ut(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Cc(""+r)}function Zt(r,o){var h=o.ownerDocument.createElement("input");return h.name=o.name,h.value=o.value,r.id&&h.setAttribute("form",r.id),o.parentNode.insertBefore(h,o),r=new FormData(r),h.parentNode.removeChild(h),r}function Ui(r,o,h,p,S){if(o==="submit"&&h&&h.stateNode===S){var M=ut((S[_i]||null).action),z=p.submitter;z&&(o=(o=z[_i]||null)?ut(o.formAction):z.getAttribute("formAction"),o!==null&&(M=o,z=null));var K=new Za("action","action",null,p,S);r.push({event:K,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(ft!==0){var re=z?Zt(S,z):new FormData(S);vg(h,{pending:!0,data:re,method:S.method,action:M},null,re)}}else typeof M=="function"&&(K.preventDefault(),re=z?Zt(S,z):new FormData(S),vg(h,{pending:!0,data:re,method:S.method,action:M},M,re))},currentTarget:S}]})}}for(var $t=0;$t<tf.length;$t++){var kn=tf[$t],Rs=kn.toLowerCase(),Xn=kn[0].toUpperCase()+kn.slice(1);ba(Rs,"on"+Xn)}ba(bd,"onAnimationEnd"),ba(ef,"onAnimationIteration"),ba(Hm,"onAnimationStart"),ba("dblclick","onDoubleClick"),ba("focusin","onFocus"),ba("focusout","onBlur"),ba(My,"onTransitionRun"),ba(oS,"onTransitionStart"),ba(Ty,"onTransitionCancel"),ba(Gm,"onTransitionEnd"),lt("onMouseEnter",["mouseout","mouseover"]),lt("onMouseLeave",["mouseout","mouseover"]),lt("onPointerEnter",["pointerout","pointerover"]),lt("onPointerLeave",["pointerout","pointerover"]),me("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),me("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),me("onBeforeInput",["compositionend","keypress","textInput","paste"]),me("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),me("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),me("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ua));function TT(r,o){o=(o&4)!==0;for(var h=0;h<r.length;h++){var p=r[h],S=p.event;p=p.listeners;e:{var M=void 0;if(o)for(var z=p.length-1;0<=z;z--){var K=p[z],re=K.instance,_e=K.currentTarget;if(K=K.listener,re!==M&&S.isPropagationStopped())break e;M=K,S.currentTarget=_e;try{M(S)}catch(Le){nf(Le)}S.currentTarget=null,M=re}else for(z=0;z<p.length;z++){if(K=p[z],re=K.instance,_e=K.currentTarget,K=K.listener,re!==M&&S.isPropagationStopped())break e;M=K,S.currentTarget=_e;try{M(S)}catch(Le){nf(Le)}S.currentTarget=null,M=re}}}}function Bn(r,o){var h=o[bs];h===void 0&&(h=o[bs]=new Set);var p=r+"__bubble";h.has(p)||(AT(o,r,2,!1),h.add(p))}function yS(r,o,h){var p=0;o&&(p|=4),AT(h,r,p,o)}var bv="_reactListening"+Math.random().toString(36).slice(2);function vS(r){if(!r[bv]){r[bv]=!0,Se.forEach(function(h){h!=="selectionchange"&&(gS.has(h)||yS(h,!1,r),yS(h,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[bv]||(o[bv]=!0,yS("selectionchange",!1,o))}}function AT(r,o,h,p){switch(tA(o)){case 2:var S=QN;break;case 8:S=$N;break;default:S=PS}h=S.bind(null,o,h,r),S=void 0,!Ic||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(S=!0),p?S!==void 0?r.addEventListener(o,h,{capture:!0,passive:S}):r.addEventListener(o,h,!0):S!==void 0?r.addEventListener(o,h,{passive:S}):r.addEventListener(o,h,!1)}function _S(r,o,h,p,S){var M=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var z=p.tag;if(z===3||z===4){var K=p.stateNode.containerInfo;if(K===S)break;if(z===4)for(z=p.return;z!==null;){var re=z.tag;if((re===3||re===4)&&z.stateNode.containerInfo===S)return;z=z.return}for(;K!==null;){if(z=Yr(K),z===null)return;if(re=z.tag,re===5||re===6||re===26||re===27){p=M=z;continue e}K=K.parentNode}}p=p.return}Yo(function(){var _e=M,Le=Kr(h),Ge=[];e:{var Me=xa.get(r);if(Me!==void 0){var Ne=Za,Ot=r;switch(r){case"keypress":if(Rl(h)===0)break e;case"keydown":case"keyup":Ne=yo;break;case"focusin":Ot="focus",Ne=Nl;break;case"focusout":Ot="blur",Ne=Nl;break;case"beforeblur":case"afterblur":Ne=Nl;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ne=Tu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ne=qh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ne=L;break;case bd:case ef:case Hm:Ne=vd;break;case Gm:Ne=$;break;case"scroll":case"scrollend":Ne=Mu;break;case"wheel":Ne=Te;break;case"copy":case"cut":case"paste":Ne=Xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ne=vo;break;case"toggle":case"beforetoggle":Ne=fn}var en=(o&4)!==0,yi=!en&&(r==="scroll"||r==="scrollend"),de=en?Me!==null?Me+"Capture":null:Me;en=[];for(var ce=_e,ve;ce!==null;){var He=ce;if(ve=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||ve===null||de===null||(He=ya(ce,de),He!=null&&en.push(zg(ce,He,ve))),yi)break;ce=ce.return}0<en.length&&(Me=new Ne(Me,Ot,null,h,Le),Ge.push({event:Me,listeners:en}))}}if((o&7)===0){e:{if(Me=r==="mouseover"||r==="pointerover",Ne=r==="mouseout"||r==="pointerout",Me&&h!==Su&&(Ot=h.relatedTarget||h.fromElement)&&(Yr(Ot)||Ot[nr]))break e;if((Ne||Me)&&(Me=Le.window===Le?Le:(Me=Le.ownerDocument)?Me.defaultView||Me.parentWindow:window,Ne?(Ot=h.relatedTarget||h.toElement,Ne=_e,Ot=Ot?Yr(Ot):null,Ot!==null&&(yi=a(Ot),en=Ot.tag,Ot!==yi||en!==5&&en!==27&&en!==6)&&(Ot=null)):(Ne=null,Ot=_e),Ne!==Ot)){if(en=Tu,He="onMouseLeave",de="onMouseEnter",ce="mouse",(r==="pointerout"||r==="pointerover")&&(en=vo,He="onPointerLeave",de="onPointerEnter",ce="pointer"),yi=Ne==null?Me:qs(Ne),ve=Ot==null?Me:qs(Ot),Me=new en(He,ce+"leave",Ne,h,Le),Me.target=yi,Me.relatedTarget=ve,He=null,Yr(Le)===_e&&(en=new en(de,ce+"enter",Ot,h,Le),en.target=ve,en.relatedTarget=yi,He=en),yi=He,Ne&&Ot)t:{for(en=MN,de=Ne,ce=Ot,ve=0,He=de;He;He=en(He))ve++;He=0;for(var qt=ce;qt;qt=en(qt))He++;for(;0<ve-He;)de=en(de),ve--;for(;0<He-ve;)ce=en(ce),He--;for(;ve--;){if(de===ce||ce!==null&&de===ce.alternate){en=de;break t}de=en(de),ce=en(ce)}en=null}else en=null;Ne!==null&&wT(Ge,Me,Ne,en,!1),Ot!==null&&yi!==null&&wT(Ge,yi,Ot,en,!0)}}e:{if(Me=_e?qs(_e):window,Ne=Me.nodeName&&Me.nodeName.toLowerCase(),Ne==="select"||Ne==="input"&&Me.type==="file")var ni=Om;else if(Lm(Me))if(_o)ni=by;else{ni=Fm;var Vt=_y}else Ne=Me.nodeName,!Ne||Ne.toLowerCase()!=="input"||Me.type!=="checkbox"&&Me.type!=="radio"?_e&&ho(_e.elementType)&&(ni=Om):ni=xy;if(ni&&(ni=ni(r,_e))){_d(Ge,ni,h,Le);break e}Vt&&Vt(r,Me,_e),r==="focusout"&&_e&&Me.type==="number"&&_e.memoizedProps.value!=null&&qi(Me,"number",Me.value)}switch(Vt=_e?qs(_e):window,r){case"focusin":(Lm(Vt)||Vt.contentEditable==="true")&&(xo=Vt,bo=_e,Pu=null);break;case"focusout":Pu=bo=xo=null;break;case"mousedown":xd=!0;break;case"contextmenu":case"mouseup":case"dragend":xd=!1,Lu(Ge,h,Le);break;case"selectionchange":if(Ey)break;case"keydown":case"keyup":Lu(Ge,h,Le)}var An;if(zn)e:{switch(r){case"compositionstart":var Hn="onCompositionStart";break e;case"compositionend":Hn="onCompositionEnd";break e;case"compositionupdate":Hn="onCompositionUpdate";break e}Hn=void 0}else Oc?Qo(r,h)&&(Hn="onCompositionEnd"):r==="keydown"&&h.keyCode===229&&(Hn="onCompositionStart");Hn&&(Qa&&h.locale!=="ko"&&(Oc||Hn!=="onCompositionStart"?Hn==="onCompositionEnd"&&Oc&&(An=Cl()):(rr=Le,Eu="value"in rr?rr.value:rr.textContent,Oc=!0)),Vt=Sv(_e,Hn),0<Vt.length&&(Hn=new va(Hn,r,null,h,Le),Ge.push({event:Hn,listeners:Vt}),An?Hn.data=An:(An=Lc(h),An!==null&&(Hn.data=An)))),(An=ar?yy(r,h):Nm(r,h))&&(Hn=Sv(_e,"onBeforeInput"),0<Hn.length&&(Vt=new va("onBeforeInput","beforeinput",null,h,Le),Ge.push({event:Vt,listeners:Hn}),Vt.data=An)),Ui(Ge,r,_e,h,Le)}TT(Ge,o)})}function zg(r,o,h){return{instance:r,listener:o,currentTarget:h}}function Sv(r,o){for(var h=o+"Capture",p=[];r!==null;){var S=r,M=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||M===null||(S=ya(r,h),S!=null&&p.unshift(zg(r,S,M)),S=ya(r,o),S!=null&&p.push(zg(r,S,M))),r.tag===3)return p;r=r.return}return[]}function MN(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function wT(r,o,h,p,S){for(var M=o._reactName,z=[];h!==null&&h!==p;){var K=h,re=K.alternate,_e=K.stateNode;if(K=K.tag,re!==null&&re===p)break;K!==5&&K!==26&&K!==27||_e===null||(re=_e,S?(_e=ya(h,M),_e!=null&&z.unshift(zg(h,_e,re))):S||(_e=ya(h,M),_e!=null&&z.push(zg(h,_e,re)))),h=h.return}z.length!==0&&r.push({event:o,listeners:z})}var TN=/\r\n?/g,AN=/\u0000|\uFFFD/g;function CT(r){return(typeof r=="string"?r:""+r).replace(TN,`
`).replace(AN,"")}function RT(r,o){return o=CT(o),CT(r)===o}function gi(r,o,h,p,S,M){switch(h){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||Mi(r,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&Mi(r,""+p);break;case"className":jt(r,"class",p);break;case"tabIndex":jt(r,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":jt(r,h,p);break;case"style":Zr(r,p,M);break;case"data":if(o!=="object"){jt(r,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||h!=="href")){r.removeAttribute(h);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){r.removeAttribute(h);break}p=Cc(""+p),r.setAttribute(h,p);break;case"action":case"formAction":if(typeof p=="function"){r.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof M=="function"&&(h==="formAction"?(o!=="input"&&gi(r,o,"name",S.name,S,null),gi(r,o,"formEncType",S.formEncType,S,null),gi(r,o,"formMethod",S.formMethod,S,null),gi(r,o,"formTarget",S.formTarget,S,null)):(gi(r,o,"encType",S.encType,S,null),gi(r,o,"method",S.method,S,null),gi(r,o,"target",S.target,S,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){r.removeAttribute(h);break}p=Cc(""+p),r.setAttribute(h,p);break;case"onClick":p!=null&&(r.onclick=qa);break;case"onScroll":p!=null&&Bn("scroll",r);break;case"onScrollEnd":p!=null&&Bn("scrollend",r);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(h=p.__html,h!=null){if(S.children!=null)throw Error(n(60));r.innerHTML=h}}break;case"multiple":r.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":r.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){r.removeAttribute("xlink:href");break}h=Cc(""+p),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(h,""+p):r.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(h,""):r.removeAttribute(h);break;case"capture":case"download":p===!0?r.setAttribute(h,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?r.setAttribute(h,p):r.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?r.setAttribute(h,p):r.removeAttribute(h);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?r.removeAttribute(h):r.setAttribute(h,p);break;case"popover":Bn("beforetoggle",r),Bn("toggle",r),Kt(r,"popover",p);break;case"xlinkActuate":bt(r,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":bt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":bt(r,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":bt(r,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":bt(r,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":bt(r,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":bt(r,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":bt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":bt(r,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Kt(r,"is",p);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=Wh.get(h)||h,Kt(r,h,p))}}function xS(r,o,h,p,S,M){switch(h){case"style":Zr(r,p,M);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(h=p.__html,h!=null){if(S.children!=null)throw Error(n(60));r.innerHTML=h}}break;case"children":typeof p=="string"?Mi(r,p):(typeof p=="number"||typeof p=="bigint")&&Mi(r,""+p);break;case"onScroll":p!=null&&Bn("scroll",r);break;case"onScrollEnd":p!=null&&Bn("scrollend",r);break;case"onClick":p!=null&&(r.onclick=qa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ge.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(S=h.endsWith("Capture"),o=h.slice(2,S?h.length-7:void 0),M=r[_i]||null,M=M!=null?M[h]:null,typeof M=="function"&&r.removeEventListener(o,M,S),typeof p=="function")){typeof M!="function"&&M!==null&&(h in r?r[h]=null:r.hasAttribute(h)&&r.removeAttribute(h)),r.addEventListener(o,p,S);break e}h in r?r[h]=p:p===!0?r.setAttribute(h,""):Kt(r,h,p)}}}function mr(r,o,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bn("error",r),Bn("load",r);var p=!1,S=!1,M;for(M in h)if(h.hasOwnProperty(M)){var z=h[M];if(z!=null)switch(M){case"src":p=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:gi(r,o,M,z,h,null)}}S&&gi(r,o,"srcSet",h.srcSet,h,null),p&&gi(r,o,"src",h.src,h,null);return;case"input":Bn("invalid",r);var K=M=z=S=null,re=null,_e=null;for(p in h)if(h.hasOwnProperty(p)){var Le=h[p];if(Le!=null)switch(p){case"name":S=Le;break;case"type":z=Le;break;case"checked":re=Le;break;case"defaultChecked":_e=Le;break;case"value":M=Le;break;case"defaultValue":K=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(n(137,o));break;default:gi(r,o,p,Le,h,null)}}Ls(r,M,K,re,_e,z,S,!1);return;case"select":Bn("invalid",r),p=z=M=null;for(S in h)if(h.hasOwnProperty(S)&&(K=h[S],K!=null))switch(S){case"value":M=K;break;case"defaultValue":z=K;break;case"multiple":p=K;default:gi(r,o,S,K,h,null)}o=M,h=z,r.multiple=!!p,o!=null?Ss(r,!!p,o,!1):h!=null&&Ss(r,!!p,h,!0);return;case"textarea":Bn("invalid",r),M=S=p=null;for(z in h)if(h.hasOwnProperty(z)&&(K=h[z],K!=null))switch(z){case"value":p=K;break;case"defaultValue":S=K;break;case"children":M=K;break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(n(91));break;default:gi(r,o,z,K,h,null)}li(r,p,S,M);return;case"option":for(re in h)h.hasOwnProperty(re)&&(p=h[re],p!=null)&&(re==="selected"?r.selected=p&&typeof p!="function"&&typeof p!="symbol":gi(r,o,re,p,h,null));return;case"dialog":Bn("beforetoggle",r),Bn("toggle",r),Bn("cancel",r),Bn("close",r);break;case"iframe":case"object":Bn("load",r);break;case"video":case"audio":for(p=0;p<Ua.length;p++)Bn(Ua[p],r);break;case"image":Bn("error",r),Bn("load",r);break;case"details":Bn("toggle",r);break;case"embed":case"source":case"link":Bn("error",r),Bn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_e in h)if(h.hasOwnProperty(_e)&&(p=h[_e],p!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:gi(r,o,_e,p,h,null)}return;default:if(ho(o)){for(Le in h)h.hasOwnProperty(Le)&&(p=h[Le],p!==void 0&&xS(r,o,Le,p,h,void 0));return}}for(K in h)h.hasOwnProperty(K)&&(p=h[K],p!=null&&gi(r,o,K,p,h,null))}function wN(r,o,h,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,M=null,z=null,K=null,re=null,_e=null,Le=null;for(Ne in h){var Ge=h[Ne];if(h.hasOwnProperty(Ne)&&Ge!=null)switch(Ne){case"checked":break;case"value":break;case"defaultValue":re=Ge;default:p.hasOwnProperty(Ne)||gi(r,o,Ne,null,p,Ge)}}for(var Me in p){var Ne=p[Me];if(Ge=h[Me],p.hasOwnProperty(Me)&&(Ne!=null||Ge!=null))switch(Me){case"type":M=Ne;break;case"name":S=Ne;break;case"checked":_e=Ne;break;case"defaultChecked":Le=Ne;break;case"value":z=Ne;break;case"defaultValue":K=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(n(137,o));break;default:Ne!==Ge&&gi(r,o,Me,Ne,p,Ge)}}Wi(r,z,K,re,_e,Le,M,S);return;case"select":Ne=z=K=Me=null;for(M in h)if(re=h[M],h.hasOwnProperty(M)&&re!=null)switch(M){case"value":break;case"multiple":Ne=re;default:p.hasOwnProperty(M)||gi(r,o,M,null,p,re)}for(S in p)if(M=p[S],re=h[S],p.hasOwnProperty(S)&&(M!=null||re!=null))switch(S){case"value":Me=M;break;case"defaultValue":K=M;break;case"multiple":z=M;default:M!==re&&gi(r,o,S,M,p,re)}o=K,h=z,p=Ne,Me!=null?Ss(r,!!h,Me,!1):!!p!=!!h&&(o!=null?Ss(r,!!h,o,!0):Ss(r,!!h,h?[]:"",!1));return;case"textarea":Ne=Me=null;for(K in h)if(S=h[K],h.hasOwnProperty(K)&&S!=null&&!p.hasOwnProperty(K))switch(K){case"value":break;case"children":break;default:gi(r,o,K,null,p,S)}for(z in p)if(S=p[z],M=h[z],p.hasOwnProperty(z)&&(S!=null||M!=null))switch(z){case"value":Me=S;break;case"defaultValue":Ne=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==M&&gi(r,o,z,S,p,M)}Vn(r,Me,Ne);return;case"option":for(var Ot in h)Me=h[Ot],h.hasOwnProperty(Ot)&&Me!=null&&!p.hasOwnProperty(Ot)&&(Ot==="selected"?r.selected=!1:gi(r,o,Ot,null,p,Me));for(re in p)Me=p[re],Ne=h[re],p.hasOwnProperty(re)&&Me!==Ne&&(Me!=null||Ne!=null)&&(re==="selected"?r.selected=Me&&typeof Me!="function"&&typeof Me!="symbol":gi(r,o,re,Me,p,Ne));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var en in h)Me=h[en],h.hasOwnProperty(en)&&Me!=null&&!p.hasOwnProperty(en)&&gi(r,o,en,null,p,Me);for(_e in p)if(Me=p[_e],Ne=h[_e],p.hasOwnProperty(_e)&&Me!==Ne&&(Me!=null||Ne!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":if(Me!=null)throw Error(n(137,o));break;default:gi(r,o,_e,Me,p,Ne)}return;default:if(ho(o)){for(var yi in h)Me=h[yi],h.hasOwnProperty(yi)&&Me!==void 0&&!p.hasOwnProperty(yi)&&xS(r,o,yi,void 0,p,Me);for(Le in p)Me=p[Le],Ne=h[Le],!p.hasOwnProperty(Le)||Me===Ne||Me===void 0&&Ne===void 0||xS(r,o,Le,Me,p,Ne);return}}for(var de in h)Me=h[de],h.hasOwnProperty(de)&&Me!=null&&!p.hasOwnProperty(de)&&gi(r,o,de,null,p,Me);for(Ge in p)Me=p[Ge],Ne=h[Ge],!p.hasOwnProperty(Ge)||Me===Ne||Me==null&&Ne==null||gi(r,o,Ge,Me,p,Ne)}function IT(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function CN(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,h=performance.getEntriesByType("resource"),p=0;p<h.length;p++){var S=h[p],M=S.transferSize,z=S.initiatorType,K=S.duration;if(M&&K&&IT(z)){for(z=0,K=S.responseEnd,p+=1;p<h.length;p++){var re=h[p],_e=re.startTime;if(_e>K)break;var Le=re.transferSize,Ge=re.initiatorType;Le&&IT(Ge)&&(re=re.responseEnd,z+=Le*(re<K?1:(K-_e)/(re-_e)))}if(--p,o+=8*(M+z)/(S.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var bS=null,SS=null;function Ev(r){return r.nodeType===9?r:r.ownerDocument}function DT(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function NT(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function ES(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var MS=null;function RN(){var r=window.event;return r&&r.type==="popstate"?r===MS?!1:(MS=r,!0):(MS=null,!1)}var PT=typeof setTimeout=="function"?setTimeout:void 0,IN=typeof clearTimeout=="function"?clearTimeout:void 0,LT=typeof Promise=="function"?Promise:void 0,DN=typeof queueMicrotask=="function"?queueMicrotask:typeof LT<"u"?function(r){return LT.resolve(null).then(r).catch(NN)}:PT;function NN(r){setTimeout(function(){throw r})}function ah(r){return r==="head"}function OT(r,o){var h=o,p=0;do{var S=h.nextSibling;if(r.removeChild(h),S&&S.nodeType===8)if(h=S.data,h==="/$"||h==="/&"){if(p===0){r.removeChild(S),fp(o);return}p--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")p++;else if(h==="html")Fg(r.ownerDocument.documentElement);else if(h==="head"){h=r.ownerDocument.head,Fg(h);for(var M=h.firstChild;M;){var z=M.nextSibling,K=M.nodeName;M[Ws]||K==="SCRIPT"||K==="STYLE"||K==="LINK"&&M.rel.toLowerCase()==="stylesheet"||h.removeChild(M),M=z}}else h==="body"&&Fg(r.ownerDocument.body);h=S}while(h);fp(o)}function UT(r,o){var h=r;r=0;do{var p=h.nextSibling;if(h.nodeType===1?o?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(o?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),p&&p.nodeType===8)if(h=p.data,h==="/$"){if(r===0)break;r--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||r++;h=p}while(h)}function TS(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var h=o;switch(o=o.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":TS(h),ma(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}r.removeChild(h)}}function PN(r,o,h,p){for(;r.nodeType===1;){var S=h;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(p){if(!r[Ws])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(M=r.getAttribute("rel"),M==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(M!==S.rel||r.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||r.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||r.getAttribute("title")!==(S.title==null?null:S.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(M=r.getAttribute("src"),(M!==(S.src==null?null:S.src)||r.getAttribute("type")!==(S.type==null?null:S.type)||r.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&M&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var M=S.name==null?null:""+S.name;if(S.type==="hidden"&&r.getAttribute("name")===M)return r}else return r;if(r=Vo(r.nextSibling),r===null)break}return null}function LN(r,o,h){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!h||(r=Vo(r.nextSibling),r===null))return null;return r}function zT(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Vo(r.nextSibling),r===null))return null;return r}function AS(r){return r.data==="$?"||r.data==="$~"}function wS(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function ON(r,o){var h=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||h.readyState!=="loading")o();else{var p=function(){o(),h.removeEventListener("DOMContentLoaded",p)};h.addEventListener("DOMContentLoaded",p),r._reactRetry=p}}function Vo(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var CS=null;function FT(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var h=r.data;if(h==="/$"||h==="/&"){if(o===0)return Vo(r.nextSibling);o--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||o++}r=r.nextSibling}return null}function BT(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var h=r.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(o===0)return r;o--}else h!=="/$"&&h!=="/&"||o++}r=r.previousSibling}return null}function VT(r,o,h){switch(o=Ev(h),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function Fg(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);ma(r)}var ko=new Map,kT=new Set;function Mv(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var ru=ie.d;ie.d={f:UN,r:zN,D:FN,C:BN,L:VN,m:kN,X:GN,S:HN,M:jN};function UN(){var r=ru.f(),o=io();return r||o}function zN(r){var o=ir(r);o!==null&&o.tag===5&&o.type==="form"?av(o):ru.r(r)}var cp=typeof document>"u"?null:document;function HT(r,o,h){var p=cp;if(p&&typeof o=="string"&&o){var S=Qt(o);S='link[rel="'+r+'"][href="'+S+'"]',typeof h=="string"&&(S+='[crossorigin="'+h+'"]'),kT.has(S)||(kT.add(S),r={rel:r,crossOrigin:h,href:o},p.querySelector(S)===null&&(o=p.createElement("link"),mr(o,"link",r),le(o),p.head.appendChild(o)))}}function FN(r){ru.D(r),HT("dns-prefetch",r,null)}function BN(r,o){ru.C(r,o),HT("preconnect",r,o)}function VN(r,o,h){ru.L(r,o,h);var p=cp;if(p&&r&&o){var S='link[rel="preload"][as="'+Qt(o)+'"]';o==="image"&&h&&h.imageSrcSet?(S+='[imagesrcset="'+Qt(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(S+='[imagesizes="'+Qt(h.imageSizes)+'"]')):S+='[href="'+Qt(r)+'"]';var M=S;switch(o){case"style":M=up(r);break;case"script":M=hp(r)}ko.has(M)||(r=v({rel:"preload",href:o==="image"&&h&&h.imageSrcSet?void 0:r,as:o},h),ko.set(M,r),p.querySelector(S)!==null||o==="style"&&p.querySelector(Bg(M))||o==="script"&&p.querySelector(Vg(M))||(o=p.createElement("link"),mr(o,"link",r),le(o),p.head.appendChild(o)))}}function kN(r,o){ru.m(r,o);var h=cp;if(h&&r){var p=o&&typeof o.as=="string"?o.as:"script",S='link[rel="modulepreload"][as="'+Qt(p)+'"][href="'+Qt(r)+'"]',M=S;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":M=hp(r)}if(!ko.has(M)&&(r=v({rel:"modulepreload",href:r},o),ko.set(M,r),h.querySelector(S)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Vg(M)))return}p=h.createElement("link"),mr(p,"link",r),le(p),h.head.appendChild(p)}}}function HN(r,o,h){ru.S(r,o,h);var p=cp;if(p&&r){var S=Z(p).hoistableStyles,M=up(r);o=o||"default";var z=S.get(M);if(!z){var K={loading:0,preload:null};if(z=p.querySelector(Bg(M)))K.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":o},h),(h=ko.get(M))&&RS(r,h);var re=z=p.createElement("link");le(re),mr(re,"link",r),re._p=new Promise(function(_e,Le){re.onload=_e,re.onerror=Le}),re.addEventListener("load",function(){K.loading|=1}),re.addEventListener("error",function(){K.loading|=2}),K.loading|=4,Tv(z,o,p)}z={type:"stylesheet",instance:z,count:1,state:K},S.set(M,z)}}}function GN(r,o){ru.X(r,o);var h=cp;if(h&&r){var p=Z(h).hoistableScripts,S=hp(r),M=p.get(S);M||(M=h.querySelector(Vg(S)),M||(r=v({src:r,async:!0},o),(o=ko.get(S))&&IS(r,o),M=h.createElement("script"),le(M),mr(M,"link",r),h.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},p.set(S,M))}}function jN(r,o){ru.M(r,o);var h=cp;if(h&&r){var p=Z(h).hoistableScripts,S=hp(r),M=p.get(S);M||(M=h.querySelector(Vg(S)),M||(r=v({src:r,async:!0,type:"module"},o),(o=ko.get(S))&&IS(r,o),M=h.createElement("script"),le(M),mr(M,"link",r),h.head.appendChild(M)),M={type:"script",instance:M,count:1,state:null},p.set(S,M))}}function GT(r,o,h,p){var S=(S=Ie.current)?Mv(S):null;if(!S)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(o=up(h.href),h=Z(S).hoistableStyles,p=h.get(o),p||(p={type:"style",instance:null,count:0,state:null},h.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){r=up(h.href);var M=Z(S).hoistableStyles,z=M.get(r);if(z||(S=S.ownerDocument||S,z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},M.set(r,z),(M=S.querySelector(Bg(r)))&&!M._p&&(z.instance=M,z.state.loading=5),ko.has(r)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},ko.set(r,h),M||WN(S,r,h,z.state))),o&&p===null)throw Error(n(528,""));return z}if(o&&p!==null)throw Error(n(529,""));return null;case"script":return o=h.async,h=h.src,typeof h=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=hp(h),h=Z(S).hoistableScripts,p=h.get(o),p||(p={type:"script",instance:null,count:0,state:null},h.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function up(r){return'href="'+Qt(r)+'"'}function Bg(r){return'link[rel="stylesheet"]['+r+"]"}function jT(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function WN(r,o,h,p){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=r.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),mr(o,"link",h),le(o),r.head.appendChild(o))}function hp(r){return'[src="'+Qt(r)+'"]'}function Vg(r){return"script[async]"+r}function WT(r,o,h){if(o.count++,o.instance===null)switch(o.type){case"style":var p=r.querySelector('style[data-href~="'+Qt(h.href)+'"]');if(p)return o.instance=p,le(p),p;var S=v({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return p=(r.ownerDocument||r).createElement("style"),le(p),mr(p,"style",S),Tv(p,h.precedence,r),o.instance=p;case"stylesheet":S=up(h.href);var M=r.querySelector(Bg(S));if(M)return o.state.loading|=4,o.instance=M,le(M),M;p=jT(h),(S=ko.get(S))&&RS(p,S),M=(r.ownerDocument||r).createElement("link"),le(M);var z=M;return z._p=new Promise(function(K,re){z.onload=K,z.onerror=re}),mr(M,"link",p),o.state.loading|=4,Tv(M,h.precedence,r),o.instance=M;case"script":return M=hp(h.src),(S=r.querySelector(Vg(M)))?(o.instance=S,le(S),S):(p=h,(S=ko.get(M))&&(p=v({},h),IS(p,S)),r=r.ownerDocument||r,S=r.createElement("script"),le(S),mr(S,"link",p),r.head.appendChild(S),o.instance=S);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,Tv(p,h.precedence,r));return o.instance}function Tv(r,o,h){for(var p=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=p.length?p[p.length-1]:null,M=S,z=0;z<p.length;z++){var K=p[z];if(K.dataset.precedence===o)M=K;else if(M!==S)break}M?M.parentNode.insertBefore(r,M.nextSibling):(o=h.nodeType===9?h.head:h,o.insertBefore(r,o.firstChild))}function RS(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function IS(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var Av=null;function qT(r,o,h){if(Av===null){var p=new Map,S=Av=new Map;S.set(h,p)}else S=Av,p=S.get(h),p||(p=new Map,S.set(h,p));if(p.has(r))return p;for(p.set(r,null),h=h.getElementsByTagName(r),S=0;S<h.length;S++){var M=h[S];if(!(M[Ws]||M[fi]||r==="link"&&M.getAttribute("rel")==="stylesheet")&&M.namespaceURI!=="http://www.w3.org/2000/svg"){var z=M.getAttribute(o)||"";z=r+z;var K=p.get(z);K?K.push(M):p.set(z,[M])}}return p}function XT(r,o,h){r=r.ownerDocument||r,r.head.insertBefore(h,o==="title"?r.querySelector("head > title"):null)}function qN(r,o,h){if(h===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function YT(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function XN(r,o,h,p){if(h.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var S=up(p.href),M=o.querySelector(Bg(S));if(M){o=M._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=wv.bind(r),o.then(r,r)),h.state.loading|=4,h.instance=M,le(M);return}M=o.ownerDocument||o,p=jT(p),(S=ko.get(S))&&RS(p,S),M=M.createElement("link"),le(M);var z=M;z._p=new Promise(function(K,re){z.onload=K,z.onerror=re}),mr(M,"link",p),h.instance=M}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(h,o),(o=h.state.preload)&&(h.state.loading&3)===0&&(r.count++,h=wv.bind(r),o.addEventListener("load",h),o.addEventListener("error",h))}}var DS=0;function YN(r,o){return r.stylesheets&&r.count===0&&Rv(r,r.stylesheets),0<r.count||0<r.imgCount?function(h){var p=setTimeout(function(){if(r.stylesheets&&Rv(r,r.stylesheets),r.unsuspend){var M=r.unsuspend;r.unsuspend=null,M()}},6e4+o);0<r.imgBytes&&DS===0&&(DS=62500*CN());var S=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Rv(r,r.stylesheets),r.unsuspend)){var M=r.unsuspend;r.unsuspend=null,M()}},(r.imgBytes>DS?50:800)+o);return r.unsuspend=h,function(){r.unsuspend=null,clearTimeout(p),clearTimeout(S)}}:null}function wv(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Rv(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Cv=null;function Rv(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Cv=new Map,o.forEach(ZN,r),Cv=null,wv.call(r))}function ZN(r,o){if(!(o.state.loading&4)){var h=Cv.get(r);if(h)var p=h.get(null);else{h=new Map,Cv.set(r,h);for(var S=r.querySelectorAll("link[data-precedence],style[data-precedence]"),M=0;M<S.length;M++){var z=S[M];(z.nodeName==="LINK"||z.getAttribute("media")!=="not all")&&(h.set(z.dataset.precedence,z),p=z)}p&&h.set(null,p)}S=o.instance,z=S.getAttribute("data-precedence"),M=h.get(z)||p,M===p&&h.set(null,S),h.set(z,S),this.count++,p=wv.bind(this),S.addEventListener("load",p),S.addEventListener("error",p),M?M.parentNode.insertBefore(S,M.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(S,r.firstChild)),o.state.loading|=4}}var kg={$$typeof:O,Provider:null,Consumer:null,_currentValue:ye,_currentValue2:ye,_threadCount:0};function KN(r,o,h,p,S,M,z,K,re){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=nn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nn(0),this.hiddenUpdates=nn(null),this.identifierPrefix=p,this.onUncaughtError=S,this.onCaughtError=M,this.onRecoverableError=z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function ZT(r,o,h,p,S,M,z,K,re,_e,Le,Ge){return r=new KN(r,o,h,z,re,_e,Le,Ge,K),o=1,M===!0&&(o|=24),M=Ii(3,null,null,o),r.current=M,M.stateNode=r,o=Wm(),o.refCount++,r.pooledCache=o,o.refCount++,M.memoizedState={element:p,isDehydrated:h,cache:o},uf(M),r}function KT(r){return r?(r=Ul,r):Ul}function QT(r,o,h,p,S,M){S=KT(S),p.context===null?p.context=S:p.pendingContext=S,p=rl(o),p.payload={element:h},M=M===void 0?null:M,M!==null&&(p.callback=M),h=jl(r,p,o),h!==null&&(Mn(h,r,o),Wl(h,r,o))}function $T(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var h=r.retryLane;r.retryLane=h!==0&&h<o?h:o}}function NS(r,o){$T(r,o),(r=r.alternate)&&$T(r,o)}function JT(r){if(r.tag===13||r.tag===31){var o=lr(r,67108864);o!==null&&Mn(o,r,67108864),NS(r,67108864)}}function eA(r){if(r.tag===13||r.tag===31){var o=aa();o=qr(o);var h=lr(r,o);h!==null&&Mn(h,r,o),NS(r,o)}}var Iv=!0;function QN(r,o,h,p){var S=ee.T;ee.T=null;var M=ie.p;try{ie.p=2,PS(r,o,h,p)}finally{ie.p=M,ee.T=S}}function $N(r,o,h,p){var S=ee.T;ee.T=null;var M=ie.p;try{ie.p=8,PS(r,o,h,p)}finally{ie.p=M,ee.T=S}}function PS(r,o,h,p){if(Iv){var S=LS(p);if(S===null)_S(r,o,p,Dv,h),nA(r,p);else if(eP(S,r,o,h,p))p.stopPropagation();else if(nA(r,p),o&4&&-1<JN.indexOf(r)){for(;S!==null;){var M=ir(S);if(M!==null)switch(M.tag){case 3:if(M=M.stateNode,M.current.memoizedState.isDehydrated){var z=Qe(M.pendingLanes);if(z!==0){var K=M;for(K.pendingLanes|=2,K.entangledLanes|=2;z;){var re=1<<31-ne(z);K.entanglements[1]|=re,z&=~re}et(M),(kt&6)===0&&(Ki=G()+500,At(0))}}break;case 31:case 13:K=lr(M,2),K!==null&&Mn(K,M,2),io(),NS(M,2)}if(M=LS(p),M===null&&_S(r,o,p,Dv,h),M===S)break;S=M}S!==null&&p.stopPropagation()}else _S(r,o,p,null,h)}}function LS(r){return r=Kr(r),OS(r)}var Dv=null;function OS(r){if(Dv=null,r=Yr(r),r!==null){var o=a(r);if(o===null)r=null;else{var h=o.tag;if(h===13){if(r=c(o),r!==null)return r;r=null}else if(h===31){if(r=f(o),r!==null)return r;r=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Dv=r,null}function tA(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case Ae:return 2;case Fe:return 8;case we:case vt:return 32;case rt:return 268435456;default:return 32}default:return 32}}var US=!1,oh=null,lh=null,ch=null,Hg=new Map,Gg=new Map,uh=[],JN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function nA(r,o){switch(r){case"focusin":case"focusout":oh=null;break;case"dragenter":case"dragleave":lh=null;break;case"mouseover":case"mouseout":ch=null;break;case"pointerover":case"pointerout":Hg.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gg.delete(o.pointerId)}}function jg(r,o,h,p,S,M){return r===null||r.nativeEvent!==M?(r={blockedOn:o,domEventName:h,eventSystemFlags:p,nativeEvent:M,targetContainers:[S]},o!==null&&(o=ir(o),o!==null&&JT(o)),r):(r.eventSystemFlags|=p,o=r.targetContainers,S!==null&&o.indexOf(S)===-1&&o.push(S),r)}function eP(r,o,h,p,S){switch(o){case"focusin":return oh=jg(oh,r,o,h,p,S),!0;case"dragenter":return lh=jg(lh,r,o,h,p,S),!0;case"mouseover":return ch=jg(ch,r,o,h,p,S),!0;case"pointerover":var M=S.pointerId;return Hg.set(M,jg(Hg.get(M)||null,r,o,h,p,S)),!0;case"gotpointercapture":return M=S.pointerId,Gg.set(M,jg(Gg.get(M)||null,r,o,h,p,S)),!0}return!1}function iA(r){var o=Yr(r.target);if(o!==null){var h=a(o);if(h!==null){if(o=h.tag,o===13){if(o=c(h),o!==null){r.blockedOn=o,ji(r.priority,function(){eA(h)});return}}else if(o===31){if(o=f(h),o!==null){r.blockedOn=o,ji(r.priority,function(){eA(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){r.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Nv(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var h=LS(r.nativeEvent);if(h===null){h=r.nativeEvent;var p=new h.constructor(h.type,h);Su=p,h.target.dispatchEvent(p),Su=null}else return o=ir(h),o!==null&&JT(o),r.blockedOn=h,!1;o.shift()}return!0}function sA(r,o,h){Nv(r)&&h.delete(o)}function tP(){US=!1,oh!==null&&Nv(oh)&&(oh=null),lh!==null&&Nv(lh)&&(lh=null),ch!==null&&Nv(ch)&&(ch=null),Hg.forEach(sA),Gg.forEach(sA)}function Pv(r,o){r.blockedOn===o&&(r.blockedOn=null,US||(US=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,tP)))}var Lv=null;function rA(r){Lv!==r&&(Lv=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Lv===r&&(Lv=null);for(var o=0;o<r.length;o+=3){var h=r[o],p=r[o+1],S=r[o+2];if(typeof p!="function"){if(OS(p||h)===null)continue;break}var M=ir(h);M!==null&&(r.splice(o,3),o-=3,vg(M,{pending:!0,data:S,method:h.method,action:p},p,S))}}))}function fp(r){function o(re){return Pv(re,r)}oh!==null&&Pv(oh,r),lh!==null&&Pv(lh,r),ch!==null&&Pv(ch,r),Hg.forEach(o),Gg.forEach(o);for(var h=0;h<uh.length;h++){var p=uh[h];p.blockedOn===r&&(p.blockedOn=null)}for(;0<uh.length&&(h=uh[0],h.blockedOn===null);)iA(h),h.blockedOn===null&&uh.shift();if(h=(r.ownerDocument||r).$$reactFormReplay,h!=null)for(p=0;p<h.length;p+=3){var S=h[p],M=h[p+1],z=S[_i]||null;if(typeof M=="function")z||rA(h);else if(z){var K=null;if(M&&M.hasAttribute("formAction")){if(S=M,z=M[_i]||null)K=z.formAction;else if(OS(S)!==null)continue}else K=z.action;typeof K=="function"?h[p+1]=K:(h.splice(p,3),p-=3),rA(h)}}}function aA(){function r(M){M.canIntercept&&M.info==="react-transition"&&M.intercept({handler:function(){return new Promise(function(z){return S=z})},focusReset:"manual",scroll:"manual"})}function o(){S!==null&&(S(),S=null),p||setTimeout(h,20)}function h(){if(!p&&!navigation.transition){var M=navigation.currentEntry;M&&M.url!=null&&navigation.navigate(M.url,{state:M.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var p=!1,S=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(h,100),function(){p=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),S!==null&&(S(),S=null)}}}function zS(r){this._internalRoot=r}Ov.prototype.render=zS.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var h=o.current,p=aa();QT(h,p,r,o,null,null)},Ov.prototype.unmount=zS.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;QT(r.current,2,null,r,null,null),io(),o[nr]=null}};function Ov(r){this._internalRoot=r}Ov.prototype.unstable_scheduleHydration=function(r){if(r){var o=Mr();r={blockedOn:null,target:r,priority:o};for(var h=0;h<uh.length&&o!==0&&o<uh[h].priority;h++);uh.splice(h,0,r),h===0&&iA(r)}};var oA=e.version;if(oA!=="19.2.4")throw Error(n(527,oA,"19.2.4"));ie.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=m(o),r=r!==null?y(r):null,r=r===null?null:r.stateNode,r};var nP={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Uv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Uv.isDisabled&&Uv.supportsFiber)try{We=Uv.inject(nP),Xe=Uv}catch{}}return Wg.createRoot=function(r,o){if(!s(r))throw Error(n(299));var h=!1,p="",S=dv,M=Mg,z=Tg;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(S=o.onUncaughtError),o.onCaughtError!==void 0&&(M=o.onCaughtError),o.onRecoverableError!==void 0&&(z=o.onRecoverableError)),o=ZT(r,1,!1,null,null,h,p,null,S,M,z,aA),r[nr]=o.current,vS(r),new zS(o)},Wg.hydrateRoot=function(r,o,h){if(!s(r))throw Error(n(299));var p=!1,S="",M=dv,z=Mg,K=Tg,re=null;return h!=null&&(h.unstable_strictMode===!0&&(p=!0),h.identifierPrefix!==void 0&&(S=h.identifierPrefix),h.onUncaughtError!==void 0&&(M=h.onUncaughtError),h.onCaughtError!==void 0&&(z=h.onCaughtError),h.onRecoverableError!==void 0&&(K=h.onRecoverableError),h.formState!==void 0&&(re=h.formState)),o=ZT(r,1,!0,o,h??null,p,S,re,M,z,K,aA),o.context=KT(null),h=o.current,p=aa(),p=qr(p),S=rl(p),S.callback=null,jl(h,S,p),h=p,o.current.lanes=h,Si(o,h),et(o),r[nr]=o.current,vS(r),new Ov(o)},Wg.version="19.2.4",Wg}var vA;function GP(){if(vA)return FS.exports;vA=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),FS.exports=HP(),FS.exports}var jP=GP();const kS="#7c4dff",HS="#121829",WP=rP({palette:{mode:"dark",primary:{main:kS},secondary:{main:"#00e5ff"},background:{default:"#0a0f1e",paper:HS},divider:cn("#ffffff",.08)},shape:{borderRadius:12},typography:{fontFamily:'"Inter", "Roboto", "Helvetica Neue", Arial, sans-serif',h4:{fontWeight:700},h5:{fontWeight:700},h6:{fontWeight:600}},components:{MuiCssBaseline:{styleOverrides:{body:{scrollbarColor:`${cn("#ffffff",.2)} transparent`,"&::-webkit-scrollbar, & *::-webkit-scrollbar":{width:8},"&::-webkit-scrollbar-thumb, & *::-webkit-scrollbar-thumb":{borderRadius:8,backgroundColor:cn("#ffffff",.2)}}}},MuiCard:{defaultProps:{elevation:0},styleOverrides:{root:{border:`1px solid ${cn("#ffffff",.08)}`,backdropFilter:"blur(12px)",transition:"border-color 0.2s, box-shadow 0.2s","&:hover":{borderColor:cn(kS,.4),boxShadow:`0 0 20px ${cn(kS,.15)}`}}}},MuiChip:{styleOverrides:{root:{fontWeight:500}}},MuiDrawer:{styleOverrides:{paper:{backgroundColor:HS,borderRight:`1px solid ${cn("#ffffff",.06)}`}}},MuiAppBar:{defaultProps:{elevation:0},styleOverrides:{root:{backgroundColor:cn(HS,.8),backdropFilter:"blur(12px)",borderBottom:`1px solid ${cn("#ffffff",.06)}`}}}}}),GS=260;function qP(){const i=aP(),e=oP(i.breakpoints.down("md")),[t,n]=Ve.useState(!1),s=fd(),a=zR(),c=Ve.useMemo(()=>{const d=a.pathname.split("/").filter(Boolean),m=[];let y="";for(const v of d)y+=`/${v}`,m.push({label:decodeURIComponent(v),path:y});return m},[a.pathname]),f=W.jsxs(yn,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[W.jsxs(yn,{sx:{p:2,display:"flex",alignItems:"center",gap:1.5},children:[W.jsx(IR,{color:"primary"}),W.jsx(Nt,{variant:"h6",color:"primary",fontWeight:700,noWrap:!0,children:"Worldbuilder"})]}),W.jsx(R0,{}),W.jsxs(lP,{sx:{flex:1},children:[W.jsxs(lA,{selected:a.pathname==="/",onClick:()=>{s("/"),n(!1)},children:[W.jsx(cA,{children:W.jsx(cP,{})}),W.jsx(uA,{primary:"Home"})]}),W.jsxs(lA,{selected:a.pathname.startsWith("/worlds"),onClick:()=>{s("/worlds"),n(!1)},children:[W.jsx(cA,{children:W.jsx(fb,{})}),W.jsx(uA,{primary:"Worlds"})]})]})]});return W.jsxs(yn,{sx:{display:"flex",minHeight:"100vh"},children:[W.jsx(yn,{component:"nav",sx:{width:{md:GS},flexShrink:{md:0}},children:e?W.jsx(hA,{variant:"temporary",open:t,onClose:()=>n(!1),ModalProps:{keepMounted:!0},sx:{"& .MuiDrawer-paper":{width:GS}},children:f}):W.jsx(hA,{variant:"permanent",sx:{"& .MuiDrawer-paper":{width:GS,boxSizing:"border-box"}},open:!0,children:f})}),W.jsxs(yn,{sx:{flex:1,display:"flex",flexDirection:"column",minWidth:0},children:[W.jsx(uP,{position:"sticky",sx:{zIndex:d=>d.zIndex.drawer-1},children:W.jsxs(hP,{children:[e&&W.jsx(k_,{color:"inherit",edge:"start",onClick:()=>n(!0),sx:{mr:2},children:W.jsx(fP,{})}),W.jsxs(dP,{sx:{color:"text.secondary",fontSize:"0.85rem","& .MuiBreadcrumbs-separator":{mx:.5}},children:[W.jsx(fA,{component:pA,to:"/",color:"inherit",underline:"hover",children:"Home"}),c.map((d,m)=>W.jsx(fA,{component:pA,to:d.path,color:m===c.length-1?"text.primary":"inherit",underline:"hover",sx:{textTransform:"capitalize"},children:d.label},d.path))]})]})}),W.jsx(yn,{component:"main",sx:{flex:1,p:{xs:2,sm:3},maxWidth:1400,width:"100%",mx:"auto"},children:W.jsx(FP,{})})]})]})}function XP(){const i=fd();return W.jsxs(yn,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"70vh",textAlign:"center",gap:4,children:[W.jsx(IR,{sx:{fontSize:80,color:"primary.main"}}),W.jsx(Nt,{variant:"h4",fontWeight:700,children:"Worldbuilder Explorer"}),W.jsx(Nt,{variant:"body1",color:"text.secondary",maxWidth:500,children:"Browse and explore your game worlds  characters, factions, planets, quests, timelines, and more."}),W.jsx(ey,{variant:"contained",size:"large",startIcon:W.jsx(fb,{}),onClick:()=>i("/worlds"),sx:{px:4,py:1.5},children:"Browse Worlds"})]})}const YP="https://us-central1-YOUR_PROJECT_ID.cloudfunctions.net/mcp/mcp",ZP="your-api-key";let KP=0;async function QP(i,e={}){const t=++KP,n=await fetch(YP,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream","x-api-key":ZP},body:JSON.stringify({jsonrpc:"2.0",id:t,method:"tools/call",params:{name:i,arguments:e}})});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const a=(await n.text()).split(`
`);for(const c of a)if(c.startsWith("data: ")){const f=JSON.parse(c.slice(6));if(f.error)throw new Error(f.error.message||"RPC error");const d=f.result.content[0].text;return JSON.parse(d)}throw new Error("No data line found in SSE response")}function _m(i,e,t=[]){const[n,s]=Ve.useState(null),[a,c]=Ve.useState(!0),[f,d]=Ve.useState(null),[m,y]=Ve.useState(),[v,x]=Ve.useState(),E=Ve.useRef(e);E.current=e;const T=Ve.useCallback(async()=>{c(!0),d(null);try{const I=await QP(i,E.current);I.success?(s(I.data??null),y(I.totalCount),x(I.nextPageToken)):d(I.error??"Unknown error")}catch(I){d(I instanceof Error?I.message:String(I))}finally{c(!1)}},[i,...t]);return Ve.useEffect(()=>{T()},[T]),{data:n,loading:a,error:f,refetch:T,totalCount:m,nextPageToken:v}}function xm({loading:i,error:e,onRetry:t,children:n}){return i?W.jsx(yn,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:300,children:W.jsx(DR,{})}):e?W.jsx(pP,{severity:"error",sx:{my:2},action:t?W.jsx(ey,{color:"inherit",size:"small",startIcon:W.jsx(mP,{}),onClick:t,children:"Retry"}):void 0,children:W.jsx(Nt,{variant:"body2",children:e})}):W.jsx(W.Fragment,{children:n})}function $P(){const{data:i,loading:e,error:t,refetch:n}=_m("list_worlds",{limit:100}),s=fd();return W.jsxs(yn,{children:[W.jsx(Nt,{variant:"h4",mb:3,children:"Worlds"}),W.jsx(xm,{loading:e,error:t,onRetry:n,children:W.jsxs(xr,{container:!0,spacing:2,children:[i?.map(a=>W.jsx(xr,{size:{xs:12,sm:6,md:4},children:W.jsx(kp,{sx:{height:"100%"},children:W.jsx(Hp,{onClick:()=>s(`/worlds/${a.id}`),sx:{height:"100%"},children:W.jsxs(Gp,{children:[W.jsx(Nt,{variant:"h6",gutterBottom:!0,noWrap:!0,children:a.name}),a.genre&&W.jsx(Un,{label:a.genre,size:"small",sx:c=>({bgcolor:cn(c.palette.secondary.main,.15),color:c.palette.secondary.light,mb:1,textTransform:"capitalize"})}),a.description&&W.jsx(Nt,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:a.description}),a.tags&&a.tags.length>0&&W.jsx(gs,{direction:"row",spacing:.5,mt:1.5,flexWrap:"wrap",useFlexGap:!0,children:a.tags.slice(0,4).map(c=>W.jsx(Un,{label:c,size:"small",variant:"outlined",sx:{fontSize:"0.65rem"}},c))}),a.entityCounts&&W.jsxs(Nt,{variant:"caption",color:"text.secondary",sx:{mt:1.5,display:"block"},children:[Object.values(a.entityCounts).reduce((c,f)=>c+f,0)," entities"]})]})})})},a.id)),i&&i.length===0&&W.jsx(xr,{size:12,children:W.jsx(Nt,{color:"text.secondary",textAlign:"center",py:6,children:"No worlds found. Create one on your server to get started."})})]})})]})}const BR=["characters","factions","species","planets","star-systems","galactic-regions","locations","technologies","vehicles","items","abilities","quests","events","conflicts","lore","religions","economies","relationships"],VR={characters:"character",factions:"faction",planets:"planet",locations:"location",technologies:"technology",vehicles:"vehicle",species:"species",items:"item",quests:"quest",events:"event",lore:"lore",economies:"economy",relationships:"relationship",abilities:"ability",conflicts:"conflict","galactic-regions":"galactic_region",religions:"religion","star-systems":"star_system"},nM={characters:"Characters",factions:"Factions",planets:"Planets",locations:"Locations",technologies:"Technologies",vehicles:"Vehicles",species:"Species",items:"Items",quests:"Quests",events:"Events",lore:"Lore",economies:"Economies",relationships:"Relationships",abilities:"Abilities",conflicts:"Conflicts","galactic-regions":"Galactic Regions",religions:"Religions","star-systems":"Star Systems"},JP={characters:W.jsx(NP,{}),factions:W.jsx(DP,{}),planets:W.jsx(fb,{}),locations:W.jsx(IP,{}),technologies:W.jsx(RP,{}),vehicles:W.jsx(CP,{}),species:W.jsx(wP,{}),items:W.jsx(AP,{}),quests:W.jsx(TP,{}),events:W.jsx(MP,{}),lore:W.jsx(EP,{}),economies:W.jsx(SP,{}),relationships:W.jsx(tM,{}),abilities:W.jsx(bP,{}),conflicts:W.jsx(xP,{}),"galactic-regions":W.jsx(_P,{}),religions:W.jsx(vP,{}),"star-systems":W.jsx(yP,{})};function eL(){const{worldId:i}=vm(),e=fd(),{data:t,loading:n,error:s,refetch:a}=_m("get_world_summary",{worldId:i},[i]),c=t?.world,f=t?.entityCounts??c?.entityCounts??{};return W.jsx(yn,{children:W.jsx(xm,{loading:n,error:s,onRetry:a,children:c&&W.jsxs(W.Fragment,{children:[W.jsxs(yn,{mb:4,children:[W.jsx(Nt,{variant:"h4",gutterBottom:!0,children:c.name}),W.jsxs(gs,{direction:"row",spacing:1,mb:1,flexWrap:"wrap",useFlexGap:!0,children:[c.genre&&W.jsx(Un,{label:c.genre,size:"small",sx:d=>({bgcolor:cn(d.palette.secondary.main,.15),color:d.palette.secondary.light,textTransform:"capitalize"})}),c.status&&W.jsx(Un,{label:c.status,size:"small",color:c.status==="active"?"success":"default",sx:{textTransform:"capitalize"}}),c.tags?.map(d=>W.jsx(Un,{label:d,size:"small",variant:"outlined"},d))]}),c.description&&W.jsx(Nt,{variant:"body1",color:"text.secondary",mt:1,children:c.description})]}),c.settings&&W.jsxs(vc,{sx:{p:2,mb:3,bgcolor:d=>cn(d.palette.primary.main,.04)},children:[W.jsx(Nt,{variant:"overline",color:"text.secondary",children:"World Settings"}),W.jsxs(gs,{direction:"row",spacing:2,flexWrap:"wrap",useFlexGap:!0,mt:1,children:[c.settings.scale&&W.jsx(Un,{label:`Scale: ${c.settings.scale}`,size:"small"}),c.settings.techLevel&&W.jsx(Un,{label:`Tech: ${c.settings.techLevel}`,size:"small"}),c.settings.tone&&W.jsx(Un,{label:`Tone: ${c.settings.tone}`,size:"small"}),c.settings.timelineStart&&W.jsx(Un,{label:`${c.settings.timelineStart}  ${c.settings.timelineEnd??"?"}`,size:"small"}),c.settings.themes?.map(d=>W.jsx(Un,{label:d,size:"small",variant:"outlined"},d))]})]}),W.jsx(R0,{sx:{mb:3}}),W.jsx(Nt,{variant:"h5",mb:2,children:"Explore Entities"}),W.jsx(xr,{container:!0,spacing:2,mb:4,children:BR.map(d=>{const m=f[d]??0;return W.jsx(xr,{size:{xs:6,sm:4,md:3},children:W.jsx(kp,{children:W.jsx(Hp,{onClick:()=>e(`/worlds/${i}/${d}`),sx:{height:"100%"},children:W.jsxs(Gp,{sx:{textAlign:"center",py:3},children:[W.jsx(yn,{sx:{color:"primary.main",mb:1},children:JP[d]}),W.jsx(Nt,{variant:"subtitle2",fontWeight:600,children:nM[d]}),W.jsx(Nt,{variant:"h5",color:"text.secondary",fontWeight:700,mt:.5,children:m})]})})})},d)})}),W.jsxs(xr,{container:!0,spacing:2,mb:4,children:[W.jsx(xr,{size:{xs:12,sm:4},children:W.jsx(kp,{children:W.jsx(Hp,{onClick:()=>e(`/worlds/${i}/timeline`),children:W.jsxs(Gp,{sx:{display:"flex",alignItems:"center",gap:2},children:[W.jsx(NR,{color:"secondary",sx:{fontSize:36}}),W.jsxs(yn,{children:[W.jsx(Nt,{variant:"subtitle1",fontWeight:600,children:"Timeline"}),W.jsx(Nt,{variant:"body2",color:"text.secondary",children:"View events in chronological order"})]})]})})})}),W.jsx(xr,{size:{xs:12,sm:4},children:W.jsx(kp,{children:W.jsx(Hp,{onClick:()=>e(`/worlds/${i}/graph`),children:W.jsxs(Gp,{sx:{display:"flex",alignItems:"center",gap:2},children:[W.jsx(tM,{color:"secondary",sx:{fontSize:36}}),W.jsxs(yn,{children:[W.jsx(Nt,{variant:"subtitle1",fontWeight:600,children:"Relationship Graph"}),W.jsx(Nt,{variant:"body2",color:"text.secondary",children:"Explore entity connections"})]})]})})})}),W.jsx(xr,{size:{xs:12,sm:4},children:W.jsx(kp,{children:W.jsx(Hp,{onClick:()=>e(`/worlds/${i}/galaxy`),children:W.jsxs(Gp,{sx:{display:"flex",alignItems:"center",gap:2},children:[W.jsx(gP,{color:"secondary",sx:{fontSize:36}}),W.jsxs(yn,{children:[W.jsx(Nt,{variant:"subtitle1",fontWeight:600,children:"Galaxy Map"}),W.jsx(Nt,{variant:"body2",color:"text.secondary",children:"Explore star systems in 3D"})]})]})})})})]}),t?.notableCharacters&&t.notableCharacters.length>0&&W.jsxs(yn,{mb:3,children:[W.jsx(Nt,{variant:"h6",mb:1,children:"Notable Characters"}),W.jsx(gs,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:t.notableCharacters.map(d=>W.jsx(Un,{label:d.name??d.id,onClick:()=>e(`/worlds/${i}/characters/${d.id}`),clickable:!0},d.id))})]}),t?.keyFactions&&t.keyFactions.length>0&&W.jsxs(yn,{mb:3,children:[W.jsx(Nt,{variant:"h6",mb:1,children:"Key Factions"}),W.jsx(gs,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:t.keyFactions.map(d=>W.jsx(Un,{label:d.name??d.id,onClick:()=>e(`/worlds/${i}/factions/${d.id}`),clickable:!0,color:"secondary",variant:"outlined"},d.id))})]})]})})})}function tL({entity:i,entityType:e,worldId:t}){const n=fd(),s=VR[e],a=i.name||i.title||i.id,c=i.type||i.role||i.category;return W.jsx(kp,{children:W.jsx(Hp,{onClick:()=>n(`/worlds/${t}/${e}/${i.id}`,{state:{entity:i}}),sx:{height:"100%"},children:W.jsxs(Gp,{children:[W.jsxs(yn,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1,children:[W.jsx(Nt,{variant:"subtitle1",fontWeight:600,noWrap:!0,sx:{flex:1,mr:1},children:a}),W.jsx(Un,{label:s,size:"small",sx:f=>({bgcolor:cn(f.palette.primary.main,.15),color:f.palette.primary.light,fontSize:"0.7rem",textTransform:"capitalize"})})]}),c&&W.jsx(Nt,{variant:"caption",color:"text.secondary",gutterBottom:!0,children:c}),i.description&&W.jsx(Nt,{variant:"body2",color:"text.secondary",sx:{mt:1,display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",overflow:"hidden"},children:i.description}),i.tags&&i.tags.length>0&&W.jsxs(gs,{direction:"row",spacing:.5,mt:1.5,flexWrap:"wrap",useFlexGap:!0,children:[i.tags.slice(0,4).map(f=>W.jsx(Un,{label:f,size:"small",variant:"outlined",sx:{fontSize:"0.65rem"}},f)),i.tags.length>4&&W.jsx(Un,{label:`+${i.tags.length-4}`,size:"small",variant:"outlined",sx:{fontSize:"0.65rem"}})]}),i.status&&W.jsx(Un,{label:String(i.status),size:"small",color:i.status==="alive"||i.status==="active"?"success":"default",sx:{mt:1.5,textTransform:"capitalize"}})]})})})}function nL(){const{worldId:i,entityType:e}=vm(),t=e,n=nM[t]??e,[s,a]=Ve.useState(),[c,f]=Ve.useState(""),{data:d,loading:m,error:y,refetch:v,nextPageToken:x,totalCount:E}=_m(`list_${e}`,{worldId:i,limit:50,startAfter:s},[i,e,s]),T=d?.filter(I=>{if(!c)return!0;const w=c.toLowerCase(),A=(I.name||I.title||"").toLowerCase(),N=(I.description||"").toLowerCase();return A.includes(w)||N.includes(w)});return W.jsxs(yn,{children:[W.jsxs(yn,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2,mb:3,children:[W.jsx(Nt,{variant:"h4",children:n}),E!==void 0&&W.jsxs(Nt,{variant:"body2",color:"text.secondary",children:[E," total"]})]}),W.jsx(PR,{size:"small",placeholder:`Filter ${n.toLowerCase()}`,value:c,onChange:I=>f(I.target.value),InputProps:{startAdornment:W.jsx(PP,{position:"start",children:W.jsx(LR,{fontSize:"small"})})},sx:{mb:3,width:{xs:"100%",sm:350}}}),W.jsxs(xm,{loading:m,error:y,onRetry:v,children:[W.jsxs(xr,{container:!0,spacing:2,children:[T?.map(I=>W.jsx(xr,{size:{xs:12,sm:6,md:4},children:W.jsx(tL,{entity:I,entityType:t,worldId:i})},I.id)),T&&T.length===0&&W.jsx(xr,{size:12,children:W.jsx(Nt,{color:"text.secondary",textAlign:"center",py:6,children:c?"No matches found.":`No ${n.toLowerCase()} in this world yet.`})})]}),x&&W.jsx(yn,{display:"flex",justifyContent:"center",mt:3,children:W.jsx(ey,{variant:"outlined",onClick:()=>a(x),children:"Load More"})})]})]})}function iL({label:i,value:e}){if(e==null||e===""||["id","createdAt","updatedAt","worldId"].includes(i))return null;const n=Array.isArray(e)?e.length===0?null:typeof e[0]=="object"?W.jsx(yn,{component:"pre",sx:{fontSize:"0.8rem",whiteSpace:"pre-wrap",m:0},children:JSON.stringify(e,null,2)}):W.jsx(gs,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,children:e.map((s,a)=>W.jsx(Un,{label:String(s),size:"small",variant:"outlined"},a))}):typeof e=="object"?W.jsx(yn,{component:"pre",sx:s=>({fontSize:"0.8rem",whiteSpace:"pre-wrap",m:0,p:1.5,borderRadius:1,bgcolor:cn(s.palette.primary.main,.05)}),children:JSON.stringify(e,null,2)}):typeof e=="boolean"?W.jsx(Un,{label:e?"Yes":"No",size:"small",color:e?"success":"default"}):typeof e=="string"&&e.length>120?W.jsx(Nt,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-wrap"},children:e}):W.jsx(Nt,{variant:"body2",color:"text.primary",children:String(e)});return n?W.jsxs(yn,{mb:2,children:[W.jsx(Nt,{variant:"overline",color:"text.secondary",sx:{letterSpacing:1.5,fontSize:"0.65rem"},children:sL(i)}),W.jsx(yn,{mt:.25,children:n})]}):null}function sL(i){return i.replace(/([A-Z])/g," $1").replace(/[_-]/g," ").trim().toUpperCase()}const rL=["name","title","description","type","status","role","category"];function aL(){const{worldId:i,entityType:e,entityId:t}=vm(),n=zR(),a=VR[e],c=n.state?.entity,{data:f,loading:d,error:m,refetch:y}=_m(`get_${a}`,{worldId:i,id:t},[i,e,t]),v=f??c,x=v?Object.entries(v).filter(([E])=>!rL.includes(E)&&!["id","createdAt","updatedAt","worldId"].includes(E)):[];return W.jsx(yn,{children:W.jsx(xm,{loading:d&&!c,error:m,onRetry:y,children:v&&W.jsxs(W.Fragment,{children:[W.jsxs(yn,{mb:3,children:[W.jsxs(gs,{direction:"row",spacing:1,alignItems:"center",mb:1,children:[W.jsx(Un,{label:a,size:"small",sx:E=>({bgcolor:cn(E.palette.primary.main,.15),color:E.palette.primary.light,textTransform:"capitalize"})}),W.jsx(Nt,{variant:"caption",color:"text.secondary",children:v.id})]}),W.jsx(Nt,{variant:"h4",children:v.name||v.title||v.id}),v.description&&W.jsx(Nt,{variant:"body1",color:"text.secondary",mt:1,sx:{whiteSpace:"pre-wrap"},children:v.description}),W.jsxs(gs,{direction:"row",spacing:1,mt:2,flexWrap:"wrap",useFlexGap:!0,children:[v.type?W.jsx(Un,{label:String(v.type),size:"small",color:"secondary"}):null,v.status?W.jsx(Un,{label:String(v.status),size:"small",color:v.status==="alive"||v.status==="active"?"success":"default",sx:{textTransform:"capitalize"}}):null,v.role?W.jsx(Un,{label:String(v.role),size:"small",variant:"outlined"}):null]})]}),W.jsx(R0,{sx:{mb:3}}),W.jsxs(xr,{container:!0,spacing:3,children:[W.jsx(xr,{size:{xs:12,md:8},children:W.jsxs(vc,{sx:{p:3},children:[W.jsx(Nt,{variant:"h6",mb:2,children:"Details"}),x.map(([E,T])=>W.jsx(iL,{label:E,value:T},E)),x.length===0&&W.jsx(Nt,{color:"text.secondary",children:"No additional details."})]})}),W.jsxs(xr,{size:{xs:12,md:4},children:[v.tags&&v.tags.length>0&&W.jsxs(vc,{sx:{p:3,mb:2},children:[W.jsx(Nt,{variant:"h6",mb:1,children:"Tags"}),W.jsx(gs,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,children:v.tags.map(E=>W.jsx(Un,{label:E,size:"small",variant:"outlined"},E))})]}),W.jsxs(vc,{sx:{p:3},children:[W.jsx(Nt,{variant:"h6",mb:1,children:"Metadata"}),W.jsxs(Nt,{variant:"caption",color:"text.secondary",display:"block",children:["ID: ",v.id]}),v.createdAt&&W.jsxs(Nt,{variant:"caption",color:"text.secondary",display:"block",children:["Created: ",new Date(v.createdAt).toLocaleString()]}),v.updatedAt&&W.jsxs(Nt,{variant:"caption",color:"text.secondary",display:"block",children:["Updated: ",new Date(v.updatedAt).toLocaleString()]})]})]})]})]})})})}function oL(){const{worldId:i}=vm(),[e,t]=Ve.useState(""),[n,s]=Ve.useState(""),a={worldId:i,limit:100,sortBy:"sortOrder",sortDirection:"asc"};e&&(a.era=e),n&&(a.significance=n);const{data:c,loading:f,error:d,refetch:m}=_m("list_events",a,[i,e,n]),y=c?[...c].sort((x,E)=>{const T=x.sortOrder,I=E.sortOrder;if(T!=null&&I!=null)return T-I;if(T!=null)return-1;if(I!=null)return 1;const w=_A(x.date),A=_A(E.date);return w-A}):null,v=[...new Set(y?.map(x=>x.era).filter(Boolean))];return W.jsxs(yn,{children:[W.jsxs(yn,{display:"flex",alignItems:"center",gap:1,mb:3,children:[W.jsx(NR,{color:"secondary",sx:{fontSize:32}}),W.jsx(Nt,{variant:"h4",children:"Timeline"})]}),W.jsxs(gs,{direction:"row",spacing:2,mb:3,flexWrap:"wrap",useFlexGap:!0,children:[v.length>0&&W.jsxs($_,{size:"small",sx:{minWidth:150},children:[W.jsx(J_,{children:"Era"}),W.jsxs(ex,{value:e,label:"Era",onChange:x=>t(x.target.value),children:[W.jsx(_l,{value:"",children:"All"}),v.map(x=>W.jsx(_l,{value:x,children:x},x))]})]}),W.jsxs($_,{size:"small",sx:{minWidth:150},children:[W.jsx(J_,{children:"Significance"}),W.jsxs(ex,{value:n,label:"Significance",onChange:x=>s(x.target.value),children:[W.jsx(_l,{value:"",children:"All"}),W.jsx(_l,{value:"minor",children:"Minor"}),W.jsx(_l,{value:"moderate",children:"Moderate"}),W.jsx(_l,{value:"major",children:"Major"}),W.jsx(_l,{value:"world-changing",children:"World-Changing"})]})]})]}),W.jsxs(xm,{loading:f,error:d,onRetry:m,children:[y&&y.length===0&&W.jsx(Nt,{color:"text.secondary",textAlign:"center",py:6,children:"No events found."}),y?.map((x,E)=>W.jsxs(yn,{display:"flex",mb:0,children:[W.jsxs(yn,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mr:2,minWidth:24},children:[W.jsx(yn,{sx:T=>({width:12,height:12,borderRadius:"50%",bgcolor:jS(x.significance),border:`2px solid ${cn(T.palette.background.paper,.5)}`,zIndex:1})}),E<y.length-1&&W.jsx(yn,{sx:T=>({width:2,flex:1,bgcolor:cn(T.palette.divider,.4)})})]}),W.jsxs(vc,{sx:{p:2,mb:2,flex:1},children:[W.jsxs(yn,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",flexWrap:"wrap",gap:1,children:[W.jsx(Nt,{variant:"subtitle1",fontWeight:600,children:x.name}),W.jsxs(gs,{direction:"row",spacing:.5,children:[x.date&&W.jsx(Un,{label:x.date,size:"small",variant:"outlined"}),x.era&&W.jsx(Un,{label:x.era,size:"small"}),x.significance&&W.jsx(Un,{label:x.significance,size:"small",sx:{bgcolor:cn(jS(x.significance),.2),color:jS(x.significance),textTransform:"capitalize"}})]})]}),x.type&&W.jsx(Un,{label:x.type,size:"small",sx:{mt:.5,textTransform:"capitalize"}}),x.description&&W.jsx(Nt,{variant:"body2",color:"text.secondary",mt:1,children:x.description}),x.outcome&&W.jsxs(Nt,{variant:"body2",mt:1,children:[W.jsx("strong",{children:"Outcome:"})," ",x.outcome]}),x.consequences&&x.consequences.length>0&&W.jsxs(yn,{mt:1,children:[W.jsx(Nt,{variant:"caption",color:"text.secondary",children:"Consequences:"}),W.jsx(gs,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,mt:.5,children:x.consequences.map((T,I)=>W.jsx(Un,{label:T,size:"small",variant:"outlined"},I))})]})]})]},x.id))]})]})}function jS(i){switch(i){case"world-changing":return"#ff1744";case"major":return"#ff9100";case"moderate":return"#00e5ff";default:return"#90a4ae"}}function _A(i){if(!i)return 1/0;const e=i.match(/(\d+)/);return e?Number(e[1]):1/0}const lL=["ALLIED_WITH","ENEMY_OF","MEMBER_OF","LEADER_OF","LOCATED_AT","LOCATED_ON","PARENT_OF","CHILD_OF","TRADES_WITH","CONTROLS","CREATED_BY","OWNS","SERVES","WORSHIPS","MENTORS","PROTECTS","THREATENS","INHABITS","CUSTOM"];function cL(){const{worldId:i}=vm(),e=fd(),[t,n]=Ve.useState(""),[s,a]=Ve.useState(""),[c,f]=Ve.useState(""),[d,m]=Ve.useState(!1),y=d&&!!t,v={worldId:i,entityId:t,limit:100};s&&(v.entityType=s),c&&(v.relationshipType=c);const{data:x,loading:E,error:T,refetch:I}=_m("find_entity_relationships",y?v:{worldId:i,entityId:"__none__"},[i,t,s,c,d]),w=()=>{m(!0)};return W.jsxs(yn,{children:[W.jsxs(yn,{display:"flex",alignItems:"center",gap:1,mb:3,children:[W.jsx(tM,{color:"secondary",sx:{fontSize:32}}),W.jsx(Nt,{variant:"h4",children:"Relationship Graph"})]}),W.jsxs(vc,{sx:{p:3,mb:3},children:[W.jsx(Nt,{variant:"subtitle2",mb:2,children:"Find relationships for an entity"}),W.jsxs(gs,{direction:"row",spacing:2,flexWrap:"wrap",useFlexGap:!0,alignItems:"flex-end",children:[W.jsx(PR,{label:"Entity ID",size:"small",value:t,onChange:A=>{n(A.target.value),m(!1)},sx:{minWidth:250},placeholder:"e.g. commander-kira-voss"}),W.jsxs($_,{size:"small",sx:{minWidth:150},children:[W.jsx(J_,{children:"Entity Type"}),W.jsxs(ex,{value:s,label:"Entity Type",onChange:A=>{a(A.target.value),m(!1)},children:[W.jsx(_l,{value:"",children:"Any"}),BR.map(A=>W.jsx(_l,{value:A,children:nM[A]},A))]})]}),W.jsxs($_,{size:"small",sx:{minWidth:180},children:[W.jsx(J_,{children:"Relationship Type"}),W.jsxs(ex,{value:c,label:"Relationship Type",onChange:A=>{f(A.target.value),m(!1)},children:[W.jsx(_l,{value:"",children:"Any"}),lL.map(A=>W.jsx(_l,{value:A,children:A.replace(/_/g," ")},A))]})]}),W.jsx(ey,{variant:"contained",startIcon:W.jsx(LR,{}),onClick:w,disabled:!t,children:"Search"})]})]}),y&&W.jsxs(xm,{loading:E,error:T,onRetry:I,children:[x&&x.length===0&&W.jsx(Nt,{color:"text.secondary",textAlign:"center",py:6,children:"No relationships found for this entity."}),W.jsx(xr,{container:!0,spacing:2,children:x?.map(A=>W.jsx(xr,{size:{xs:12,sm:6,md:4},children:W.jsxs(vc,{sx:{p:2,height:"100%"},children:[W.jsx(Un,{label:(A.type||"CUSTOM").replace(/_/g," "),size:"small",color:"primary",sx:{mb:1.5,fontWeight:600}}),W.jsxs(yn,{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",children:[W.jsx(Un,{label:`${A.sourceType}/${A.sourceId}`,size:"small",variant:"outlined",clickable:!0,onClick:()=>e(`/worlds/${i}/${A.sourceType}/${A.sourceId}`)}),W.jsx(Nt,{variant:"body2",color:"text.secondary",children:A.bidirectional?"":""}),W.jsx(Un,{label:`${A.targetType}/${A.targetId}`,size:"small",variant:"outlined",clickable:!0,onClick:()=>e(`/worlds/${i}/${A.targetType}/${A.targetId}`)})]}),A.strength!==void 0&&W.jsxs(yn,{mt:1,children:[W.jsxs(Nt,{variant:"caption",color:"text.secondary",children:["Strength: ",A.strength,"/10"]}),W.jsx(yn,{sx:N=>({height:4,borderRadius:2,bgcolor:cn(N.palette.divider,.3),mt:.5}),children:W.jsx(yn,{sx:{height:"100%",width:`${(A.strength??0)/10*100}%`,borderRadius:2,bgcolor:"primary.main"}})})]}),A.description&&W.jsx(Nt,{variant:"body2",color:"text.secondary",mt:1,children:A.description}),A.status&&W.jsx(Un,{label:A.status,size:"small",sx:{mt:1,textTransform:"capitalize"},color:A.status==="active"?"success":"default"})]})},A.id))})]})]})}const bm="183",Gf={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},jf={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},kR=0,rE=1,HR=2,uL=3,GR=0,Xp=1,f0=2,Yf=3,vu=0,jr=1,bl=2,_c=0,Jf=1,tx=2,aE=3,oE=4,jR=5,hL=6,_h=100,WR=101,qR=102,XR=103,YR=104,ZR=200,KR=201,QR=202,$R=203,nx=204,ix=205,JR=206,e3=207,t3=208,n3=209,i3=210,s3=211,r3=212,a3=213,o3=214,sx=0,rx=1,ax=2,rd=3,ox=4,lx=5,cx=6,ux=7,ty=0,l3=1,c3=2,jo=0,iM=1,sM=2,rM=3,ny=4,aM=5,oM=6,lM=7,lE="attached",u3="detached",db=300,bc=301,Dh=302,d0=303,p0=304,Sm=306,I0=1e3,Ha=1001,D0=1002,vs=1003,cM=1004,fL=1004,jp=1005,dL=1005,zi=1006,m0=1007,pL=1007,gc=1008,mL=1008,ca=1009,uM=1010,hM=1011,nm=1012,pb=1013,Wo=1014,fa=1015,Sc=1016,mb=1017,gb=1018,im=1020,fM=35902,dM=35899,pM=1021,mM=1022,Gr=1023,Ec=1026,bh=1027,yb=1028,iy=1029,ad=1030,vb=1031,gL=1032,_b=1033,g0=33776,y0=33777,v0=33778,_0=33779,hx=35840,fx=35841,dx=35842,px=35843,mx=36196,gx=37492,yx=37496,vx=37488,_x=37489,xx=37490,bx=37491,Sx=37808,Ex=37809,Mx=37810,Tx=37811,Ax=37812,wx=37813,Cx=37814,Rx=37815,Ix=37816,Dx=37817,Nx=37818,Px=37819,Lx=37820,Ox=37821,Ux=36492,zx=36494,Fx=36495,Bx=36283,Vx=36284,kx=36285,Hx=36286,h3=2200,f3=2201,d3=2202,N0=2300,Gx=2301,H_=2302,cE=2303,Zf=2400,Kf=2401,P0=2402,xb=2500,gM=2501,yL=0,vL=1,_L=2,p3=3200,xL=3201,bL=3202,SL=3203,kh=0,m3=1,pu="",kr="srgb",Nh="srgb-linear",L0="linear",hi="srgb",EL="",ML="rg",TL="ga",AL=0,Wf=7680,wL=7681,CL=7682,RL=7683,IL=34055,DL=34056,NL=5386,PL=512,LL=513,OL=514,UL=515,zL=516,FL=517,BL=518,uE=519,g3=512,y3=513,v3=514,bb=515,_3=516,x3=517,Sb=518,b3=519,O0=35044,VL=35048,kL=35040,HL=35045,GL=35049,jL=35041,WL=35046,qL=35050,XL=35042,YL="100",hE="300 es",ao=2e3,od=2001,ZL={COMPUTE:"compute",RENDER:"render"},KL={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},QL={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"},$L={TEXTURE_COMPARE:"depthTextureCompare"};function JL(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const eO={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Wp(i,e){return new eO[i](e)}function S3(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function U0(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function E3(){const i=U0("canvas");return i.style.display="block",i}const xA={};let Ph=null;function tO(i){Ph=i}function nO(){return Ph}function z0(...i){const e="THREE."+i.shift();Ph?Ph("log",e,...i):console.log(e,...i)}function M3(i){const e=i[0];if(typeof e=="string"&&e.startsWith("TSL:")){const t=i[1];t&&t.isStackTrace?i[0]+=" "+t.getLocation():i[1]='Stack trace not available. Enable "THREE.Node.captureStackTrace" to capture stack traces.'}return i}function St(...i){i=M3(i);const e="THREE."+i.shift();if(Ph)Ph("warn",e,...i);else{const t=i[0];t&&t.isStackTrace?console.warn(t.getError(e)):console.warn(e,...i)}}function Gt(...i){i=M3(i);const e="THREE."+i.shift();if(Ph)Ph("error",e,...i);else{const t=i[0];t&&t.isStackTrace?console.error(t.getError(e)):console.error(e,...i)}}function F0(...i){const e=i.join(" ");e in xA||(xA[e]=!0,St(...i))}function iO(i,e,t){return new Promise(function(n,s){function a(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:s();break;case i.TIMEOUT_EXPIRED:setTimeout(a,t);break;default:n()}}setTimeout(a,t)})}const sO={[sx]:rx,[ax]:cx,[ox]:ux,[rd]:lx,[rx]:sx,[cx]:ax,[ux]:ox,[lx]:rd};let Ac=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const s=n[e];if(s!==void 0){const a=s.indexOf(t);a!==-1&&s.splice(a,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let a=0,c=s.length;a<c;a++)s[a].call(this,e);e.target=null}}};const Ur=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let bA=1234567;const ed=Math.PI/180,sm=180/Math.PI;function lo(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Ur[i&255]+Ur[i>>8&255]+Ur[i>>16&255]+Ur[i>>24&255]+"-"+Ur[e&255]+Ur[e>>8&255]+"-"+Ur[e>>16&15|64]+Ur[e>>24&255]+"-"+Ur[t&63|128]+Ur[t>>8&255]+"-"+Ur[t>>16&255]+Ur[t>>24&255]+Ur[n&255]+Ur[n>>8&255]+Ur[n>>16&255]+Ur[n>>24&255]).toLowerCase()}function rn(i,e,t){return Math.max(e,Math.min(t,i))}function yM(i,e){return(i%e+e)%e}function rO(i,e,t,n,s){return n+(i-e)*(s-n)/(t-e)}function aO(i,e,t){return i!==e?(t-i)/(e-i):0}function x0(i,e,t){return(1-t)*i+t*e}function oO(i,e,t,n){return x0(i,e,1-Math.exp(-t*n))}function lO(i,e=1){return e-Math.abs(yM(i,e*2)-e)}function cO(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function uO(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function hO(i,e){return i+Math.floor(Math.random()*(e-i+1))}function fO(i,e){return i+Math.random()*(e-i)}function dO(i){return i*(.5-Math.random())}function pO(i){i!==void 0&&(bA=i);let e=bA+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function mO(i){return i*ed}function gO(i){return i*sm}function yO(i){return(i&i-1)===0&&i!==0}function vO(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function _O(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function xO(i,e,t,n,s){const a=Math.cos,c=Math.sin,f=a(t/2),d=c(t/2),m=a((e+n)/2),y=c((e+n)/2),v=a((e-n)/2),x=c((e-n)/2),E=a((n-e)/2),T=c((n-e)/2);switch(s){case"XYX":i.set(f*y,d*v,d*x,f*m);break;case"YZY":i.set(d*x,f*y,d*v,f*m);break;case"ZXZ":i.set(d*v,d*x,f*y,f*m);break;case"XZX":i.set(f*y,d*T,d*E,f*m);break;case"YXY":i.set(d*E,f*y,d*T,f*m);break;case"ZYZ":i.set(d*T,d*E,f*y,f*m);break;default:St("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function ua(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Tn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const T3={DEG2RAD:ed,RAD2DEG:sm,generateUUID:lo,clamp:rn,euclideanModulo:yM,mapLinear:rO,inverseLerp:aO,lerp:x0,damp:oO,pingpong:lO,smoothstep:cO,smootherstep:uO,randInt:hO,randFloat:fO,randFloatSpread:dO,seededRandom:pO,degToRad:mO,radToDeg:gO,isPowerOfTwo:yO,ceilPowerOfTwo:vO,floorPowerOfTwo:_O,setQuaternionFromProperEuler:xO,normalize:Tn,denormalize:ua};class ke{constructor(e=0,t=0){ke.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6],this.y=s[1]*t+s[4]*n+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=rn(this.x,e.x,t.x),this.y=rn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=rn(this.x,e,t),this.y=rn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(rn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),s=Math.sin(t),a=this.x-e.x,c=this.y-e.y;return this.x=a*n-c*s+e.x,this.y=a*s+c*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class br{constructor(e=0,t=0,n=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=s}static slerpFlat(e,t,n,s,a,c,f){let d=n[s+0],m=n[s+1],y=n[s+2],v=n[s+3],x=a[c+0],E=a[c+1],T=a[c+2],I=a[c+3];if(v!==I||d!==x||m!==E||y!==T){let w=d*x+m*E+y*T+v*I;w<0&&(x=-x,E=-E,T=-T,I=-I,w=-w);let A=1-f;if(w<.9995){const N=Math.acos(w),O=Math.sin(N);A=Math.sin(A*N)/O,f=Math.sin(f*N)/O,d=d*A+x*f,m=m*A+E*f,y=y*A+T*f,v=v*A+I*f}else{d=d*A+x*f,m=m*A+E*f,y=y*A+T*f,v=v*A+I*f;const N=1/Math.sqrt(d*d+m*m+y*y+v*v);d*=N,m*=N,y*=N,v*=N}}e[t]=d,e[t+1]=m,e[t+2]=y,e[t+3]=v}static multiplyQuaternionsFlat(e,t,n,s,a,c){const f=n[s],d=n[s+1],m=n[s+2],y=n[s+3],v=a[c],x=a[c+1],E=a[c+2],T=a[c+3];return e[t]=f*T+y*v+d*E-m*x,e[t+1]=d*T+y*x+m*v-f*E,e[t+2]=m*T+y*E+f*x-d*v,e[t+3]=y*T-f*v-d*x-m*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,s){return this._x=e,this._y=t,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,s=e._y,a=e._z,c=e._order,f=Math.cos,d=Math.sin,m=f(n/2),y=f(s/2),v=f(a/2),x=d(n/2),E=d(s/2),T=d(a/2);switch(c){case"XYZ":this._x=x*y*v+m*E*T,this._y=m*E*v-x*y*T,this._z=m*y*T+x*E*v,this._w=m*y*v-x*E*T;break;case"YXZ":this._x=x*y*v+m*E*T,this._y=m*E*v-x*y*T,this._z=m*y*T-x*E*v,this._w=m*y*v+x*E*T;break;case"ZXY":this._x=x*y*v-m*E*T,this._y=m*E*v+x*y*T,this._z=m*y*T+x*E*v,this._w=m*y*v-x*E*T;break;case"ZYX":this._x=x*y*v-m*E*T,this._y=m*E*v+x*y*T,this._z=m*y*T-x*E*v,this._w=m*y*v+x*E*T;break;case"YZX":this._x=x*y*v+m*E*T,this._y=m*E*v+x*y*T,this._z=m*y*T-x*E*v,this._w=m*y*v-x*E*T;break;case"XZY":this._x=x*y*v-m*E*T,this._y=m*E*v-x*y*T,this._z=m*y*T+x*E*v,this._w=m*y*v+x*E*T;break;default:St("Quaternion: .setFromEuler() encountered an unknown order: "+c)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],s=t[4],a=t[8],c=t[1],f=t[5],d=t[9],m=t[2],y=t[6],v=t[10],x=n+f+v;if(x>0){const E=.5/Math.sqrt(x+1);this._w=.25/E,this._x=(y-d)*E,this._y=(a-m)*E,this._z=(c-s)*E}else if(n>f&&n>v){const E=2*Math.sqrt(1+n-f-v);this._w=(y-d)/E,this._x=.25*E,this._y=(s+c)/E,this._z=(a+m)/E}else if(f>v){const E=2*Math.sqrt(1+f-n-v);this._w=(a-m)/E,this._x=(s+c)/E,this._y=.25*E,this._z=(d+y)/E}else{const E=2*Math.sqrt(1+v-n-f);this._w=(c-s)/E,this._x=(a+m)/E,this._y=(d+y)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(rn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const s=Math.min(1,t/n);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,s=e._y,a=e._z,c=e._w,f=t._x,d=t._y,m=t._z,y=t._w;return this._x=n*y+c*f+s*m-a*d,this._y=s*y+c*d+a*f-n*m,this._z=a*y+c*m+n*d-s*f,this._w=c*y-n*f-s*d-a*m,this._onChangeCallback(),this}slerp(e,t){let n=e._x,s=e._y,a=e._z,c=e._w,f=this.dot(e);f<0&&(n=-n,s=-s,a=-a,c=-c,f=-f);let d=1-t;if(f<.9995){const m=Math.acos(f),y=Math.sin(m);d=Math.sin(d*m)/y,t=Math.sin(t*m)/y,this._x=this._x*d+n*t,this._y=this._y*d+s*t,this._z=this._z*d+a*t,this._w=this._w*d+c*t,this._onChangeCallback()}else this._x=this._x*d+n*t,this._y=this._y*d+s*t,this._z=this._z*d+a*t,this._w=this._w*d+c*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),s=Math.sqrt(1-n),a=Math.sqrt(n);return this.set(s*Math.sin(e),s*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class J{constructor(e=0,t=0,n=0){J.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(SA.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(SA.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*s,this.y=a[1]*t+a[4]*n+a[7]*s,this.z=a[2]*t+a[5]*n+a[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,a=e.elements,c=1/(a[3]*t+a[7]*n+a[11]*s+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*s+a[12])*c,this.y=(a[1]*t+a[5]*n+a[9]*s+a[13])*c,this.z=(a[2]*t+a[6]*n+a[10]*s+a[14])*c,this}applyQuaternion(e){const t=this.x,n=this.y,s=this.z,a=e.x,c=e.y,f=e.z,d=e.w,m=2*(c*s-f*n),y=2*(f*t-a*s),v=2*(a*n-c*t);return this.x=t+d*m+c*v-f*y,this.y=n+d*y+f*m-a*v,this.z=s+d*v+a*y-c*m,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,s=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*s,this.y=a[1]*t+a[5]*n+a[9]*s,this.z=a[2]*t+a[6]*n+a[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=rn(this.x,e.x,t.x),this.y=rn(this.y,e.y,t.y),this.z=rn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=rn(this.x,e,t),this.y=rn(this.y,e,t),this.z=rn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,s=e.y,a=e.z,c=t.x,f=t.y,d=t.z;return this.x=s*d-a*f,this.y=a*c-n*d,this.z=n*f-s*c,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return WS.copy(this).projectOnVector(e),this.sub(WS)}reflect(e){return this.sub(WS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(rn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,s=this.z-e.z;return t*t+n*n+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const s=Math.sin(t)*e;return this.x=s*Math.sin(n),this.y=Math.cos(t)*e,this.z=s*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const WS=new J,SA=new br;class xn{constructor(e,t,n,s,a,c,f,d,m){xn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,s,a,c,f,d,m)}set(e,t,n,s,a,c,f,d,m){const y=this.elements;return y[0]=e,y[1]=s,y[2]=f,y[3]=t,y[4]=a,y[5]=d,y[6]=n,y[7]=c,y[8]=m,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,a=this.elements,c=n[0],f=n[3],d=n[6],m=n[1],y=n[4],v=n[7],x=n[2],E=n[5],T=n[8],I=s[0],w=s[3],A=s[6],N=s[1],O=s[4],U=s[7],q=s[2],j=s[5],F=s[8];return a[0]=c*I+f*N+d*q,a[3]=c*w+f*O+d*j,a[6]=c*A+f*U+d*F,a[1]=m*I+y*N+v*q,a[4]=m*w+y*O+v*j,a[7]=m*A+y*U+v*F,a[2]=x*I+E*N+T*q,a[5]=x*w+E*O+T*j,a[8]=x*A+E*U+T*F,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],s=e[2],a=e[3],c=e[4],f=e[5],d=e[6],m=e[7],y=e[8];return t*c*y-t*f*m-n*a*y+n*f*d+s*a*m-s*c*d}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],a=e[3],c=e[4],f=e[5],d=e[6],m=e[7],y=e[8],v=y*c-f*m,x=f*d-y*a,E=m*a-c*d,T=t*v+n*x+s*E;if(T===0)return this.set(0,0,0,0,0,0,0,0,0);const I=1/T;return e[0]=v*I,e[1]=(s*m-y*n)*I,e[2]=(f*n-s*c)*I,e[3]=x*I,e[4]=(y*t-s*d)*I,e[5]=(s*a-f*t)*I,e[6]=E*I,e[7]=(n*d-m*t)*I,e[8]=(c*t-n*a)*I,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,s,a,c,f){const d=Math.cos(a),m=Math.sin(a);return this.set(n*d,n*m,-n*(d*c+m*f)+c+e,-s*m,s*d,-s*(-m*c+d*f)+f+t,0,0,1),this}scale(e,t){return this.premultiply(qS.makeScale(e,t)),this}rotate(e){return this.premultiply(qS.makeRotation(-e)),this}translate(e,t){return this.premultiply(qS.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<9;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const qS=new xn,EA=new xn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),MA=new xn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function bO(){const i={enabled:!0,workingColorSpace:Nh,spaces:{},convert:function(s,a,c){return this.enabled===!1||a===c||!a||!c||(this.spaces[a].transfer===hi&&(s.r=gu(s.r),s.g=gu(s.g),s.b=gu(s.b)),this.spaces[a].primaries!==this.spaces[c].primaries&&(s.applyMatrix3(this.spaces[a].toXYZ),s.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===hi&&(s.r=Yp(s.r),s.g=Yp(s.g),s.b=Yp(s.b))),s},workingToColorSpace:function(s,a){return this.convert(s,this.workingColorSpace,a)},colorSpaceToWorking:function(s,a){return this.convert(s,a,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===pu?L0:this.spaces[s].transfer},getToneMappingMode:function(s){return this.spaces[s].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(s,a=this.workingColorSpace){return s.fromArray(this.spaces[a].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,a,c){return s.copy(this.spaces[a].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,a){return F0("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(s,a)},toWorkingColorSpace:function(s,a){return F0("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(s,a)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[Nh]:{primaries:e,whitePoint:n,transfer:L0,toXYZ:EA,fromXYZ:MA,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:kr},outputColorSpaceConfig:{drawingBufferColorSpace:kr}},[kr]:{primaries:e,whitePoint:n,transfer:hi,toXYZ:EA,fromXYZ:MA,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:kr}}}),i}const Gn=bO();function gu(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Yp(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let dp;class A3{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{dp===void 0&&(dp=U0("canvas")),dp.width=e.width,dp.height=e.height;const s=dp.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),n=dp}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=U0("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const s=n.getImageData(0,0,e.width,e.height),a=s.data;for(let c=0;c<a.length;c++)a[c]=gu(a[c]/255)*255;return n.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(gu(t[n]/255)*255):t[n]=gu(t[n]);return{data:t,width:e.width,height:e.height}}else return St("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let SO=0;class Sh{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:SO++}),this.uuid=lo(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let a;if(Array.isArray(s)){a=[];for(let c=0,f=s.length;c<f;c++)s[c].isDataTexture?a.push(XS(s[c].image)):a.push(XS(s[c]))}else a=XS(s);n.url=a}return t||(e.images[this.uuid]=n),n}}function XS(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?A3.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(St("Texture: Unable to serialize Texture."),{})}let EO=0;const YS=new J;class ls extends Ac{constructor(e=ls.DEFAULT_IMAGE,t=ls.DEFAULT_MAPPING,n=Ha,s=Ha,a=zi,c=gc,f=Gr,d=ca,m=ls.DEFAULT_ANISOTROPY,y=pu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:EO++}),this.uuid=lo(),this.name="",this.source=new Sh(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=a,this.minFilter=c,this.anisotropy=m,this.format=f,this.internalFormat=null,this.type=d,this.offset=new ke(0,0),this.repeat=new ke(1,1),this.center=new ke(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new xn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(YS).x}get height(){return this.source.getSize(YS).y}get depth(){return this.source.getSize(YS).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){St(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){St(`Texture.setValues(): property '${t}' does not exist.`);continue}s&&n&&s.isVector2&&n.isVector2||s&&n&&s.isVector3&&n.isVector3||s&&n&&s.isMatrix3&&n.isMatrix3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==db)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case I0:e.x=e.x-Math.floor(e.x);break;case Ha:e.x=e.x<0?0:1;break;case D0:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case I0:e.y=e.y-Math.floor(e.y);break;case Ha:e.y=e.y<0?0:1;break;case D0:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}ls.DEFAULT_IMAGE=null;ls.DEFAULT_MAPPING=db;ls.DEFAULT_ANISOTROPY=1;class Jn{constructor(e=0,t=0,n=0,s=1){Jn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,s){return this.x=e,this.y=t,this.z=n,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,s=this.z,a=this.w,c=e.elements;return this.x=c[0]*t+c[4]*n+c[8]*s+c[12]*a,this.y=c[1]*t+c[5]*n+c[9]*s+c[13]*a,this.z=c[2]*t+c[6]*n+c[10]*s+c[14]*a,this.w=c[3]*t+c[7]*n+c[11]*s+c[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,s,a;const d=e.elements,m=d[0],y=d[4],v=d[8],x=d[1],E=d[5],T=d[9],I=d[2],w=d[6],A=d[10];if(Math.abs(y-x)<.01&&Math.abs(v-I)<.01&&Math.abs(T-w)<.01){if(Math.abs(y+x)<.1&&Math.abs(v+I)<.1&&Math.abs(T+w)<.1&&Math.abs(m+E+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const O=(m+1)/2,U=(E+1)/2,q=(A+1)/2,j=(y+x)/4,F=(v+I)/4,R=(T+w)/4;return O>U&&O>q?O<.01?(n=0,s=.707106781,a=.707106781):(n=Math.sqrt(O),s=j/n,a=F/n):U>q?U<.01?(n=.707106781,s=0,a=.707106781):(s=Math.sqrt(U),n=j/s,a=R/s):q<.01?(n=.707106781,s=.707106781,a=0):(a=Math.sqrt(q),n=F/a,s=R/a),this.set(n,s,a,t),this}let N=Math.sqrt((w-T)*(w-T)+(v-I)*(v-I)+(x-y)*(x-y));return Math.abs(N)<.001&&(N=1),this.x=(w-T)/N,this.y=(v-I)/N,this.z=(x-y)/N,this.w=Math.acos((m+E+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=rn(this.x,e.x,t.x),this.y=rn(this.y,e.y,t.y),this.z=rn(this.z,e.z,t.z),this.w=rn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=rn(this.x,e,t),this.y=rn(this.y,e,t),this.z=rn(this.z,e,t),this.w=rn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(rn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class vM extends Ac{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:zi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Jn(0,0,e,t),this.scissorTest=!1,this.viewport=new Jn(0,0,e,t),this.textures=[];const s={width:e,height:t,depth:n.depth},a=new ls(s),c=n.count;for(let f=0;f<c;f++)this.textures[f]=a.clone(),this.textures[f].isRenderTargetTexture=!0,this.textures[f].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:zi,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let s=0,a=this.textures.length;s<a;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=n,this.textures[s].isData3DTexture!==!0&&(this.textures[s].isArrayTexture=this.textures[s].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new Sh(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class co extends vM{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class Eb extends ls{constructor(e=null,t=1,n=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=vs,this.minFilter=vs,this.wrapR=Ha,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class MO extends co{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Eb(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class Mb extends ls{constructor(e=null,t=1,n=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:s},this.magFilter=vs,this.minFilter=vs,this.wrapR=Ha,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class TO extends co{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Mb(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class on{constructor(e,t,n,s,a,c,f,d,m,y,v,x,E,T,I,w){on.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,s,a,c,f,d,m,y,v,x,E,T,I,w)}set(e,t,n,s,a,c,f,d,m,y,v,x,E,T,I,w){const A=this.elements;return A[0]=e,A[4]=t,A[8]=n,A[12]=s,A[1]=a,A[5]=c,A[9]=f,A[13]=d,A[2]=m,A[6]=y,A[10]=v,A[14]=x,A[3]=E,A[7]=T,A[11]=I,A[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new on().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,s=1/pp.setFromMatrixColumn(e,0).length(),a=1/pp.setFromMatrixColumn(e,1).length(),c=1/pp.setFromMatrixColumn(e,2).length();return t[0]=n[0]*s,t[1]=n[1]*s,t[2]=n[2]*s,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*c,t[9]=n[9]*c,t[10]=n[10]*c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,s=e.y,a=e.z,c=Math.cos(n),f=Math.sin(n),d=Math.cos(s),m=Math.sin(s),y=Math.cos(a),v=Math.sin(a);if(e.order==="XYZ"){const x=c*y,E=c*v,T=f*y,I=f*v;t[0]=d*y,t[4]=-d*v,t[8]=m,t[1]=E+T*m,t[5]=x-I*m,t[9]=-f*d,t[2]=I-x*m,t[6]=T+E*m,t[10]=c*d}else if(e.order==="YXZ"){const x=d*y,E=d*v,T=m*y,I=m*v;t[0]=x+I*f,t[4]=T*f-E,t[8]=c*m,t[1]=c*v,t[5]=c*y,t[9]=-f,t[2]=E*f-T,t[6]=I+x*f,t[10]=c*d}else if(e.order==="ZXY"){const x=d*y,E=d*v,T=m*y,I=m*v;t[0]=x-I*f,t[4]=-c*v,t[8]=T+E*f,t[1]=E+T*f,t[5]=c*y,t[9]=I-x*f,t[2]=-c*m,t[6]=f,t[10]=c*d}else if(e.order==="ZYX"){const x=c*y,E=c*v,T=f*y,I=f*v;t[0]=d*y,t[4]=T*m-E,t[8]=x*m+I,t[1]=d*v,t[5]=I*m+x,t[9]=E*m-T,t[2]=-m,t[6]=f*d,t[10]=c*d}else if(e.order==="YZX"){const x=c*d,E=c*m,T=f*d,I=f*m;t[0]=d*y,t[4]=I-x*v,t[8]=T*v+E,t[1]=v,t[5]=c*y,t[9]=-f*y,t[2]=-m*y,t[6]=E*v+T,t[10]=x-I*v}else if(e.order==="XZY"){const x=c*d,E=c*m,T=f*d,I=f*m;t[0]=d*y,t[4]=-v,t[8]=m*y,t[1]=x*v+I,t[5]=c*y,t[9]=E*v-T,t[2]=T*v-E,t[6]=f*y,t[10]=I*v+x}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(AO,e,wO)}lookAt(e,t,n){const s=this.elements;return so.subVectors(e,t),so.lengthSq()===0&&(so.z=1),so.normalize(),fh.crossVectors(n,so),fh.lengthSq()===0&&(Math.abs(n.z)===1?so.x+=1e-4:so.z+=1e-4,so.normalize(),fh.crossVectors(n,so)),fh.normalize(),zv.crossVectors(so,fh),s[0]=fh.x,s[4]=zv.x,s[8]=so.x,s[1]=fh.y,s[5]=zv.y,s[9]=so.y,s[2]=fh.z,s[6]=zv.z,s[10]=so.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,s=t.elements,a=this.elements,c=n[0],f=n[4],d=n[8],m=n[12],y=n[1],v=n[5],x=n[9],E=n[13],T=n[2],I=n[6],w=n[10],A=n[14],N=n[3],O=n[7],U=n[11],q=n[15],j=s[0],F=s[4],R=s[8],P=s[12],H=s[1],B=s[5],X=s[9],k=s[13],ue=s[2],he=s[6],ee=s[10],ie=s[14],ye=s[3],be=s[7],Be=s[11],Oe=s[15];return a[0]=c*j+f*H+d*ue+m*ye,a[4]=c*F+f*B+d*he+m*be,a[8]=c*R+f*X+d*ee+m*Be,a[12]=c*P+f*k+d*ie+m*Oe,a[1]=y*j+v*H+x*ue+E*ye,a[5]=y*F+v*B+x*he+E*be,a[9]=y*R+v*X+x*ee+E*Be,a[13]=y*P+v*k+x*ie+E*Oe,a[2]=T*j+I*H+w*ue+A*ye,a[6]=T*F+I*B+w*he+A*be,a[10]=T*R+I*X+w*ee+A*Be,a[14]=T*P+I*k+w*ie+A*Oe,a[3]=N*j+O*H+U*ue+q*ye,a[7]=N*F+O*B+U*he+q*be,a[11]=N*R+O*X+U*ee+q*Be,a[15]=N*P+O*k+U*ie+q*Oe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],s=e[8],a=e[12],c=e[1],f=e[5],d=e[9],m=e[13],y=e[2],v=e[6],x=e[10],E=e[14],T=e[3],I=e[7],w=e[11],A=e[15],N=d*E-m*x,O=f*E-m*v,U=f*x-d*v,q=c*E-m*y,j=c*x-d*y,F=c*v-f*y;return t*(I*N-w*O+A*U)-n*(T*N-w*q+A*j)+s*(T*O-I*q+A*F)-a*(T*U-I*j+w*F)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],s=e[2],a=e[3],c=e[4],f=e[5],d=e[6],m=e[7],y=e[8],v=e[9],x=e[10],E=e[11],T=e[12],I=e[13],w=e[14],A=e[15],N=t*f-n*c,O=t*d-s*c,U=t*m-a*c,q=n*d-s*f,j=n*m-a*f,F=s*m-a*d,R=y*I-v*T,P=y*w-x*T,H=y*A-E*T,B=v*w-x*I,X=v*A-E*I,k=x*A-E*w,ue=N*k-O*X+U*B+q*H-j*P+F*R;if(ue===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const he=1/ue;return e[0]=(f*k-d*X+m*B)*he,e[1]=(s*X-n*k-a*B)*he,e[2]=(I*F-w*j+A*q)*he,e[3]=(x*j-v*F-E*q)*he,e[4]=(d*H-c*k-m*P)*he,e[5]=(t*k-s*H+a*P)*he,e[6]=(w*U-T*F-A*O)*he,e[7]=(y*F-x*U+E*O)*he,e[8]=(c*X-f*H+m*R)*he,e[9]=(n*H-t*X-a*R)*he,e[10]=(T*j-I*U+A*N)*he,e[11]=(v*U-y*j-E*N)*he,e[12]=(f*P-c*B-d*R)*he,e[13]=(t*B-n*P+s*R)*he,e[14]=(I*O-T*q-w*N)*he,e[15]=(y*q-v*O+x*N)*he,this}scale(e){const t=this.elements,n=e.x,s=e.y,a=e.z;return t[0]*=n,t[4]*=s,t[8]*=a,t[1]*=n,t[5]*=s,t[9]*=a,t[2]*=n,t[6]*=s,t[10]*=a,t[3]*=n,t[7]*=s,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,s))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),s=Math.sin(t),a=1-n,c=e.x,f=e.y,d=e.z,m=a*c,y=a*f;return this.set(m*c+n,m*f-s*d,m*d+s*f,0,m*f+s*d,y*f+n,y*d-s*c,0,m*d-s*f,y*d+s*c,a*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,s,a,c){return this.set(1,n,a,0,e,1,c,0,t,s,1,0,0,0,0,1),this}compose(e,t,n){const s=this.elements,a=t._x,c=t._y,f=t._z,d=t._w,m=a+a,y=c+c,v=f+f,x=a*m,E=a*y,T=a*v,I=c*y,w=c*v,A=f*v,N=d*m,O=d*y,U=d*v,q=n.x,j=n.y,F=n.z;return s[0]=(1-(I+A))*q,s[1]=(E+U)*q,s[2]=(T-O)*q,s[3]=0,s[4]=(E-U)*j,s[5]=(1-(x+A))*j,s[6]=(w+N)*j,s[7]=0,s[8]=(T+O)*F,s[9]=(w-N)*F,s[10]=(1-(x+I))*F,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,n){const s=this.elements;e.x=s[12],e.y=s[13],e.z=s[14];const a=this.determinant();if(a===0)return n.set(1,1,1),t.identity(),this;let c=pp.set(s[0],s[1],s[2]).length();const f=pp.set(s[4],s[5],s[6]).length(),d=pp.set(s[8],s[9],s[10]).length();a<0&&(c=-c),ml.copy(this);const m=1/c,y=1/f,v=1/d;return ml.elements[0]*=m,ml.elements[1]*=m,ml.elements[2]*=m,ml.elements[4]*=y,ml.elements[5]*=y,ml.elements[6]*=y,ml.elements[8]*=v,ml.elements[9]*=v,ml.elements[10]*=v,t.setFromRotationMatrix(ml),n.x=c,n.y=f,n.z=d,this}makePerspective(e,t,n,s,a,c,f=ao,d=!1){const m=this.elements,y=2*a/(t-e),v=2*a/(n-s),x=(t+e)/(t-e),E=(n+s)/(n-s);let T,I;if(d)T=a/(c-a),I=c*a/(c-a);else if(f===ao)T=-(c+a)/(c-a),I=-2*c*a/(c-a);else if(f===od)T=-c/(c-a),I=-c*a/(c-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+f);return m[0]=y,m[4]=0,m[8]=x,m[12]=0,m[1]=0,m[5]=v,m[9]=E,m[13]=0,m[2]=0,m[6]=0,m[10]=T,m[14]=I,m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this}makeOrthographic(e,t,n,s,a,c,f=ao,d=!1){const m=this.elements,y=2/(t-e),v=2/(n-s),x=-(t+e)/(t-e),E=-(n+s)/(n-s);let T,I;if(d)T=1/(c-a),I=c/(c-a);else if(f===ao)T=-2/(c-a),I=-(c+a)/(c-a);else if(f===od)T=-1/(c-a),I=-a/(c-a);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+f);return m[0]=y,m[4]=0,m[8]=0,m[12]=x,m[1]=0,m[5]=v,m[9]=0,m[13]=E,m[2]=0,m[6]=0,m[10]=T,m[14]=I,m[3]=0,m[7]=0,m[11]=0,m[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let s=0;s<16;s++)if(t[s]!==n[s])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const pp=new J,ml=new on,AO=new J(0,0,0),wO=new J(1,1,1),fh=new J,zv=new J,so=new J,TA=new on,AA=new br;class uo{constructor(e=0,t=0,n=0,s=uo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,s=this._order){return this._x=e,this._y=t,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const s=e.elements,a=s[0],c=s[4],f=s[8],d=s[1],m=s[5],y=s[9],v=s[2],x=s[6],E=s[10];switch(t){case"XYZ":this._y=Math.asin(rn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-y,E),this._z=Math.atan2(-c,a)):(this._x=Math.atan2(x,m),this._z=0);break;case"YXZ":this._x=Math.asin(-rn(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(f,E),this._z=Math.atan2(d,m)):(this._y=Math.atan2(-v,a),this._z=0);break;case"ZXY":this._x=Math.asin(rn(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(-v,E),this._z=Math.atan2(-c,m)):(this._y=0,this._z=Math.atan2(d,a));break;case"ZYX":this._y=Math.asin(-rn(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(x,E),this._z=Math.atan2(d,a)):(this._x=0,this._z=Math.atan2(-c,m));break;case"YZX":this._z=Math.asin(rn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-y,m),this._y=Math.atan2(-v,a)):(this._x=0,this._y=Math.atan2(f,E));break;case"XZY":this._z=Math.asin(-rn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(x,m),this._y=Math.atan2(f,a)):(this._x=Math.atan2(-y,E),this._y=0);break;default:St("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return TA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(TA,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return AA.setFromEuler(this),this.setFromQuaternion(AA,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}uo.DEFAULT_ORDER="XYZ";class rm{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let CO=0;const wA=new J,mp=new br,ou=new on,Fv=new J,qg=new J,RO=new J,IO=new br,CA=new J(1,0,0),RA=new J(0,1,0),IA=new J(0,0,1),DA={type:"added"},DO={type:"removed"},gp={type:"childadded",child:null},ZS={type:"childremoved",child:null};class ei extends Ac{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:CO++}),this.uuid=lo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ei.DEFAULT_UP.clone();const e=new J,t=new uo,n=new br,s=new J(1,1,1);function a(){n.setFromEuler(t,!1)}function c(){t.setFromQuaternion(n,void 0,!1)}t._onChange(a),n._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new on},normalMatrix:{value:new xn}}),this.matrix=new on,this.matrixWorld=new on,this.matrixAutoUpdate=ei.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ei.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new rm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.static=!1,this.userData={},this.pivot=null}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return mp.setFromAxisAngle(e,t),this.quaternion.multiply(mp),this}rotateOnWorldAxis(e,t){return mp.setFromAxisAngle(e,t),this.quaternion.premultiply(mp),this}rotateX(e){return this.rotateOnAxis(CA,e)}rotateY(e){return this.rotateOnAxis(RA,e)}rotateZ(e){return this.rotateOnAxis(IA,e)}translateOnAxis(e,t){return wA.copy(e).applyQuaternion(this.quaternion),this.position.add(wA.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(CA,e)}translateY(e){return this.translateOnAxis(RA,e)}translateZ(e){return this.translateOnAxis(IA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ou.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Fv.copy(e):Fv.set(e,t,n);const s=this.parent;this.updateWorldMatrix(!0,!1),qg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ou.lookAt(qg,Fv,this.up):ou.lookAt(Fv,qg,this.up),this.quaternion.setFromRotationMatrix(ou),s&&(ou.extractRotation(s.matrixWorld),mp.setFromRotationMatrix(ou),this.quaternion.premultiply(mp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Gt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(DA),gp.child=e,this.dispatchEvent(gp),gp.child=null):Gt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(DO),ZS.child=e,this.dispatchEvent(ZS),ZS.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ou.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ou.multiply(e.parent.matrixWorld)),e.applyMatrix4(ou),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(DA),gp.child=e,this.dispatchEvent(gp),gp.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,s=this.children.length;n<s;n++){const c=this.children[n].getObjectByProperty(e,t);if(c!==void 0)return c}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const s=this.children;for(let a=0,c=s.length;a<c;a++)s[a].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qg,e,RO),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(qg,IO,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale);const e=this.pivot;if(e!==null){const t=e.x,n=e.y,s=e.z,a=this.matrix.elements;a[12]+=t-a[0]*t-a[4]*n-a[8]*s,a[13]+=n-a[1]*t-a[5]*n-a[9]*s,a[14]+=s-a[2]*t-a[6]*n-a[10]*s}this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,s=t.length;n<s;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let a=0,c=s.length;a<c;a++)s[a].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),this.static!==!1&&(s.static=this.static),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.pivot!==null&&(s.pivot=this.pivot.toArray()),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.morphTargetDictionary!==void 0&&(s.morphTargetDictionary=Object.assign({},this.morphTargetDictionary)),this.morphTargetInfluences!==void 0&&(s.morphTargetInfluences=this.morphTargetInfluences.slice()),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(f=>({...f,boundingBox:f.boundingBox?f.boundingBox.toJSON():void 0,boundingSphere:f.boundingSphere?f.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(f=>({...f})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function a(f,d){return f[d.uuid]===void 0&&(f[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=a(e.geometries,this.geometry);const f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){const d=f.shapes;if(Array.isArray(d))for(let m=0,y=d.length;m<y;m++){const v=d[m];a(e.shapes,v)}else a(e.shapes,d)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const f=[];for(let d=0,m=this.material.length;d<m;d++)f.push(a(e.materials,this.material[d]));s.material=f}else s.material=a(e.materials,this.material);if(this.children.length>0){s.children=[];for(let f=0;f<this.children.length;f++)s.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let f=0;f<this.animations.length;f++){const d=this.animations[f];s.animations.push(a(e.animations,d))}}if(t){const f=c(e.geometries),d=c(e.materials),m=c(e.textures),y=c(e.images),v=c(e.shapes),x=c(e.skeletons),E=c(e.animations),T=c(e.nodes);f.length>0&&(n.geometries=f),d.length>0&&(n.materials=d),m.length>0&&(n.textures=m),y.length>0&&(n.images=y),v.length>0&&(n.shapes=v),x.length>0&&(n.skeletons=x),E.length>0&&(n.animations=E),T.length>0&&(n.nodes=T)}return n.object=s,n;function c(f){const d=[];for(const m in f){const y=f[m];delete y.metadata,d.push(y)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),e.pivot!==null&&(this.pivot=e.pivot.clone()),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.static=e.static,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const s=e.children[n];this.add(s.clone())}return this}}ei.DEFAULT_UP=new J(0,1,0);ei.DEFAULT_MATRIX_AUTO_UPDATE=!0;ei.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;class qp extends ei{constructor(){super(),this.isGroup=!0,this.type="Group"}}const NO={type:"move"};class G_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new qp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new qp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new J,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new J),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new qp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new J,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new J),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let s=null,a=null,c=null;const f=this._targetRay,d=this._grip,m=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(m&&e.hand){c=!0;for(const I of e.hand.values()){const w=t.getJointPose(I,n),A=this._getHandJoint(m,I);w!==null&&(A.matrix.fromArray(w.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=w.radius),A.visible=w!==null}const y=m.joints["index-finger-tip"],v=m.joints["thumb-tip"],x=y.position.distanceTo(v.position),E=.02,T=.005;m.inputState.pinching&&x>E+T?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&x<=E-T&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(a=t.getPose(e.gripSpace,n),a!==null&&(d.matrix.fromArray(a.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,a.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(a.linearVelocity)):d.hasLinearVelocity=!1,a.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(a.angularVelocity)):d.hasAngularVelocity=!1));f!==null&&(s=t.getPose(e.targetRaySpace,n),s===null&&a!==null&&(s=a),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1,this.dispatchEvent(NO)))}return f!==null&&(f.visible=s!==null),d!==null&&(d.visible=a!==null),m!==null&&(m.visible=c!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new qp;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}const w3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dh={h:0,s:0,l:0},Bv={h:0,s:0,l:0};function KS(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class wt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=kr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Gn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,s=Gn.workingColorSpace){return this.r=e,this.g=t,this.b=n,Gn.colorSpaceToWorking(this,s),this}setHSL(e,t,n,s=Gn.workingColorSpace){if(e=yM(e,1),t=rn(t,0,1),n=rn(n,0,1),t===0)this.r=this.g=this.b=n;else{const a=n<=.5?n*(1+t):n+t-n*t,c=2*n-a;this.r=KS(c,a,e+1/3),this.g=KS(c,a,e),this.b=KS(c,a,e-1/3)}return Gn.colorSpaceToWorking(this,s),this}setStyle(e,t=kr){function n(a){a!==void 0&&parseFloat(a)<1&&St("Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const c=s[1],f=s[2];switch(c){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:St("Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=s[1],c=a.length;if(c===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(c===6)return this.setHex(parseInt(a,16),t);St("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=kr){const n=w3[e.toLowerCase()];return n!==void 0?this.setHex(n,t):St("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=gu(e.r),this.g=gu(e.g),this.b=gu(e.b),this}copyLinearToSRGB(e){return this.r=Yp(e.r),this.g=Yp(e.g),this.b=Yp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=kr){return Gn.workingToColorSpace(zr.copy(this),e),Math.round(rn(zr.r*255,0,255))*65536+Math.round(rn(zr.g*255,0,255))*256+Math.round(rn(zr.b*255,0,255))}getHexString(e=kr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Gn.workingColorSpace){Gn.workingToColorSpace(zr.copy(this),t);const n=zr.r,s=zr.g,a=zr.b,c=Math.max(n,s,a),f=Math.min(n,s,a);let d,m;const y=(f+c)/2;if(f===c)d=0,m=0;else{const v=c-f;switch(m=y<=.5?v/(c+f):v/(2-c-f),c){case n:d=(s-a)/v+(s<a?6:0);break;case s:d=(a-n)/v+2;break;case a:d=(n-s)/v+4;break}d/=6}return e.h=d,e.s=m,e.l=y,e}getRGB(e,t=Gn.workingColorSpace){return Gn.workingToColorSpace(zr.copy(this),t),e.r=zr.r,e.g=zr.g,e.b=zr.b,e}getStyle(e=kr){Gn.workingToColorSpace(zr.copy(this),e);const t=zr.r,n=zr.g,s=zr.b;return e!==kr?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(e,t,n){return this.getHSL(dh),this.setHSL(dh.h+e,dh.s+t,dh.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(dh),e.getHSL(Bv);const n=x0(dh.h,Bv.h,t),s=x0(dh.s,Bv.s,t),a=x0(dh.l,Bv.l,t);return this.setHSL(n,s,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,s=this.b,a=e.elements;return this.r=a[0]*t+a[3]*n+a[6]*s,this.g=a[1]*t+a[4]*n+a[7]*s,this.b=a[2]*t+a[5]*n+a[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const zr=new wt;wt.NAMES=w3;class Tb{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new wt(e),this.density=t}clone(){return new Tb(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Ab{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new wt(e),this.near=t,this.far=n}clone(){return new Ab(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class _M extends ei{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new uo,this.environmentIntensity=1,this.environmentRotation=new uo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}const gl=new J,lu=new J,QS=new J,cu=new J,yp=new J,vp=new J,NA=new J,$S=new J,JS=new J,e1=new J,t1=new Jn,n1=new Jn,i1=new Jn;class ka{constructor(e=new J,t=new J,n=new J){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,s){s.subVectors(n,t),gl.subVectors(e,t),s.cross(gl);const a=s.lengthSq();return a>0?s.multiplyScalar(1/Math.sqrt(a)):s.set(0,0,0)}static getBarycoord(e,t,n,s,a){gl.subVectors(s,t),lu.subVectors(n,t),QS.subVectors(e,t);const c=gl.dot(gl),f=gl.dot(lu),d=gl.dot(QS),m=lu.dot(lu),y=lu.dot(QS),v=c*m-f*f;if(v===0)return a.set(0,0,0),null;const x=1/v,E=(m*d-f*y)*x,T=(c*y-f*d)*x;return a.set(1-E-T,T,E)}static containsPoint(e,t,n,s){return this.getBarycoord(e,t,n,s,cu)===null?!1:cu.x>=0&&cu.y>=0&&cu.x+cu.y<=1}static getInterpolation(e,t,n,s,a,c,f,d){return this.getBarycoord(e,t,n,s,cu)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(a,cu.x),d.addScaledVector(c,cu.y),d.addScaledVector(f,cu.z),d)}static getInterpolatedAttribute(e,t,n,s,a,c){return t1.setScalar(0),n1.setScalar(0),i1.setScalar(0),t1.fromBufferAttribute(e,t),n1.fromBufferAttribute(e,n),i1.fromBufferAttribute(e,s),c.setScalar(0),c.addScaledVector(t1,a.x),c.addScaledVector(n1,a.y),c.addScaledVector(i1,a.z),c}static isFrontFacing(e,t,n,s){return gl.subVectors(n,t),lu.subVectors(e,t),gl.cross(lu).dot(s)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,s){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,n,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return gl.subVectors(this.c,this.b),lu.subVectors(this.a,this.b),gl.cross(lu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ka.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ka.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,s,a){return ka.getInterpolation(e,this.a,this.b,this.c,t,n,s,a)}containsPoint(e){return ka.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ka.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,s=this.b,a=this.c;let c,f;yp.subVectors(s,n),vp.subVectors(a,n),$S.subVectors(e,n);const d=yp.dot($S),m=vp.dot($S);if(d<=0&&m<=0)return t.copy(n);JS.subVectors(e,s);const y=yp.dot(JS),v=vp.dot(JS);if(y>=0&&v<=y)return t.copy(s);const x=d*v-y*m;if(x<=0&&d>=0&&y<=0)return c=d/(d-y),t.copy(n).addScaledVector(yp,c);e1.subVectors(e,a);const E=yp.dot(e1),T=vp.dot(e1);if(T>=0&&E<=T)return t.copy(a);const I=E*m-d*T;if(I<=0&&m>=0&&T<=0)return f=m/(m-T),t.copy(n).addScaledVector(vp,f);const w=y*T-E*v;if(w<=0&&v-y>=0&&E-T>=0)return NA.subVectors(a,s),f=(v-y)/(v-y+(E-T)),t.copy(s).addScaledVector(NA,f);const A=1/(w+I+x);return c=I*A,f=x*A,t.copy(n).addScaledVector(yp,c).addScaledVector(vp,f)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}class Vs{constructor(e=new J(1/0,1/0,1/0),t=new J(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(yl.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(yl.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=yl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const a=n.getAttribute("position");if(t===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let c=0,f=a.count;c<f;c++)e.isMesh===!0?e.getVertexPosition(c,yl):yl.fromBufferAttribute(a,c),yl.applyMatrix4(e.matrixWorld),this.expandByPoint(yl);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Vv.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Vv.copy(n.boundingBox)),Vv.applyMatrix4(e.matrixWorld),this.union(Vv)}const s=e.children;for(let a=0,c=s.length;a<c;a++)this.expandByObject(s[a],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,yl),yl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Xg),kv.subVectors(this.max,Xg),_p.subVectors(e.a,Xg),xp.subVectors(e.b,Xg),bp.subVectors(e.c,Xg),ph.subVectors(xp,_p),mh.subVectors(bp,xp),Rf.subVectors(_p,bp);let t=[0,-ph.z,ph.y,0,-mh.z,mh.y,0,-Rf.z,Rf.y,ph.z,0,-ph.x,mh.z,0,-mh.x,Rf.z,0,-Rf.x,-ph.y,ph.x,0,-mh.y,mh.x,0,-Rf.y,Rf.x,0];return!s1(t,_p,xp,bp,kv)||(t=[1,0,0,0,1,0,0,0,1],!s1(t,_p,xp,bp,kv))?!1:(Hv.crossVectors(ph,mh),t=[Hv.x,Hv.y,Hv.z],s1(t,_p,xp,bp,kv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,yl).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(yl).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(uu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),uu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),uu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),uu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),uu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),uu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),uu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),uu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(uu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const uu=[new J,new J,new J,new J,new J,new J,new J,new J],yl=new J,Vv=new Vs,_p=new J,xp=new J,bp=new J,ph=new J,mh=new J,Rf=new J,Xg=new J,kv=new J,Hv=new J,If=new J;function s1(i,e,t,n,s){for(let a=0,c=i.length-3;a<=c;a+=3){If.fromArray(i,a);const f=s.x*Math.abs(If.x)+s.y*Math.abs(If.y)+s.z*Math.abs(If.z),d=e.dot(If),m=t.dot(If),y=n.dot(If);if(Math.max(-Math.max(d,m,y),Math.min(d,m,y))>f)return!1}return!0}const mu=PO();function PO(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),s=new Uint32Array(512);for(let d=0;d<256;++d){const m=d-127;m<-27?(n[d]=0,n[d|256]=32768,s[d]=24,s[d|256]=24):m<-14?(n[d]=1024>>-m-14,n[d|256]=1024>>-m-14|32768,s[d]=-m-1,s[d|256]=-m-1):m<=15?(n[d]=m+15<<10,n[d|256]=m+15<<10|32768,s[d]=13,s[d|256]=13):m<128?(n[d]=31744,n[d|256]=64512,s[d]=24,s[d|256]=24):(n[d]=31744,n[d|256]=64512,s[d]=13,s[d|256]=13)}const a=new Uint32Array(2048),c=new Uint32Array(64),f=new Uint32Array(64);for(let d=1;d<1024;++d){let m=d<<13,y=0;for(;(m&8388608)===0;)m<<=1,y-=8388608;m&=-8388609,y+=947912704,a[d]=m|y}for(let d=1024;d<2048;++d)a[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)c[d]=d<<23;c[31]=1199570944,c[32]=2147483648;for(let d=33;d<63;++d)c[d]=2147483648+(d-32<<23);c[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(f[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:s,mantissaTable:a,exponentTable:c,offsetTable:f}}function Fa(i){Math.abs(i)>65504&&St("DataUtils.toHalfFloat(): Value out of range."),i=rn(i,-65504,65504),mu.floatView[0]=i;const e=mu.uint32View[0],t=e>>23&511;return mu.baseTable[t]+((e&8388607)>>mu.shiftTable[t])}function a0(i){const e=i>>10;return mu.uint32View[0]=mu.mantissaTable[mu.offsetTable[e]+(i&1023)]+mu.exponentTable[e],mu.floatView[0]}class LO{static toHalfFloat(e){return Fa(e)}static fromHalfFloat(e){return a0(e)}}const Is=new J,Gv=new ke;let OO=0;class vi{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:OO++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=O0,this.updateRanges=[],this.gpuType=fa,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let s=0,a=this.itemSize;s<a;s++)this.array[e+s]=t.array[n+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Gv.fromBufferAttribute(this,t),Gv.applyMatrix3(e),this.setXY(t,Gv.x,Gv.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Is.fromBufferAttribute(this,t),Is.applyMatrix3(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Is.fromBufferAttribute(this,t),Is.applyMatrix4(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Is.fromBufferAttribute(this,t),Is.applyNormalMatrix(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Is.fromBufferAttribute(this,t),Is.transformDirection(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=ua(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Tn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ua(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ua(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ua(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ua(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array),s=Tn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this}setXYZW(e,t,n,s,a){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array),s=Tn(s,this.array),a=Tn(a,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=s,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==O0&&(e.usage=this.usage),e}}class UO extends vi{constructor(e,t,n){super(new Int8Array(e),t,n)}}class zO extends vi{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class FO extends vi{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class BO extends vi{constructor(e,t,n){super(new Int16Array(e),t,n)}}class xM extends vi{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class VO extends vi{constructor(e,t,n){super(new Int32Array(e),t,n)}}class bM extends vi{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class kO extends vi{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=a0(this.array[e*this.itemSize]);return this.normalized&&(t=ua(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize]=Fa(t),this}getY(e){let t=a0(this.array[e*this.itemSize+1]);return this.normalized&&(t=ua(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+1]=Fa(t),this}getZ(e){let t=a0(this.array[e*this.itemSize+2]);return this.normalized&&(t=ua(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+2]=Fa(t),this}getW(e){let t=a0(this.array[e*this.itemSize+3]);return this.normalized&&(t=ua(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+3]=Fa(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array)),this.array[e+0]=Fa(t),this.array[e+1]=Fa(n),this}setXYZ(e,t,n,s){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array),s=Tn(s,this.array)),this.array[e+0]=Fa(t),this.array[e+1]=Fa(n),this.array[e+2]=Fa(s),this}setXYZW(e,t,n,s,a){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array),s=Tn(s,this.array),a=Tn(a,this.array)),this.array[e+0]=Fa(t),this.array[e+1]=Fa(n),this.array[e+2]=Fa(s),this.array[e+3]=Fa(a),this}}class Ct extends vi{constructor(e,t,n){super(new Float32Array(e),t,n)}}const HO=new Vs,Yg=new J,r1=new J;class ks{constructor(e=new J,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):HO.setFromPoints(e).getCenter(n);let s=0;for(let a=0,c=e.length;a<c;a++)s=Math.max(s,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Yg.subVectors(e,this.center);const t=Yg.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),s=(n-this.radius)*.5;this.center.addScaledVector(Yg,s/n),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(r1.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Yg.copy(e.center).add(r1)),this.expandByPoint(Yg.copy(e.center).sub(r1))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}let GO=0;const Ho=new on,a1=new ei,Sp=new J,ro=new Vs,Zg=new Vs,$s=new J;class vn extends Ac{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:GO++}),this.uuid=lo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(JL(e)?bM:xM)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const a=new xn().getNormalMatrix(e);n.applyNormalMatrix(a),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ho.makeRotationFromQuaternion(e),this.applyMatrix4(Ho),this}rotateX(e){return Ho.makeRotationX(e),this.applyMatrix4(Ho),this}rotateY(e){return Ho.makeRotationY(e),this.applyMatrix4(Ho),this}rotateZ(e){return Ho.makeRotationZ(e),this.applyMatrix4(Ho),this}translate(e,t,n){return Ho.makeTranslation(e,t,n),this.applyMatrix4(Ho),this}scale(e,t,n){return Ho.makeScale(e,t,n),this.applyMatrix4(Ho),this}lookAt(e){return a1.lookAt(e),a1.updateMatrix(),this.applyMatrix4(a1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Sp).negate(),this.translate(Sp.x,Sp.y,Sp.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let s=0,a=e.length;s<a;s++){const c=e[s];n.push(c.x,c.y,c.z||0)}this.setAttribute("position",new Ct(n,3))}else{const n=Math.min(e.length,t.count);for(let s=0;s<n;s++){const a=e[s];t.setXYZ(s,a.x,a.y,a.z||0)}e.length>t.count&&St("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Gt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new J(-1/0,-1/0,-1/0),new J(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){const a=t[n];ro.setFromBufferAttribute(a),this.morphTargetsRelative?($s.addVectors(this.boundingBox.min,ro.min),this.boundingBox.expandByPoint($s),$s.addVectors(this.boundingBox.max,ro.max),this.boundingBox.expandByPoint($s)):(this.boundingBox.expandByPoint(ro.min),this.boundingBox.expandByPoint(ro.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Gt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ks);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Gt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new J,1/0);return}if(e){const n=this.boundingSphere.center;if(ro.setFromBufferAttribute(e),t)for(let a=0,c=t.length;a<c;a++){const f=t[a];Zg.setFromBufferAttribute(f),this.morphTargetsRelative?($s.addVectors(ro.min,Zg.min),ro.expandByPoint($s),$s.addVectors(ro.max,Zg.max),ro.expandByPoint($s)):(ro.expandByPoint(Zg.min),ro.expandByPoint(Zg.max))}ro.getCenter(n);let s=0;for(let a=0,c=e.count;a<c;a++)$s.fromBufferAttribute(e,a),s=Math.max(s,n.distanceToSquared($s));if(t)for(let a=0,c=t.length;a<c;a++){const f=t[a],d=this.morphTargetsRelative;for(let m=0,y=f.count;m<y;m++)$s.fromBufferAttribute(f,m),d&&(Sp.fromBufferAttribute(e,m),$s.add(Sp)),s=Math.max(s,n.distanceToSquared($s))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&Gt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Gt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,s=t.normal,a=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new vi(new Float32Array(4*n.count),4));const c=this.getAttribute("tangent"),f=[],d=[];for(let R=0;R<n.count;R++)f[R]=new J,d[R]=new J;const m=new J,y=new J,v=new J,x=new ke,E=new ke,T=new ke,I=new J,w=new J;function A(R,P,H){m.fromBufferAttribute(n,R),y.fromBufferAttribute(n,P),v.fromBufferAttribute(n,H),x.fromBufferAttribute(a,R),E.fromBufferAttribute(a,P),T.fromBufferAttribute(a,H),y.sub(m),v.sub(m),E.sub(x),T.sub(x);const B=1/(E.x*T.y-T.x*E.y);isFinite(B)&&(I.copy(y).multiplyScalar(T.y).addScaledVector(v,-E.y).multiplyScalar(B),w.copy(v).multiplyScalar(E.x).addScaledVector(y,-T.x).multiplyScalar(B),f[R].add(I),f[P].add(I),f[H].add(I),d[R].add(w),d[P].add(w),d[H].add(w))}let N=this.groups;N.length===0&&(N=[{start:0,count:e.count}]);for(let R=0,P=N.length;R<P;++R){const H=N[R],B=H.start,X=H.count;for(let k=B,ue=B+X;k<ue;k+=3)A(e.getX(k+0),e.getX(k+1),e.getX(k+2))}const O=new J,U=new J,q=new J,j=new J;function F(R){q.fromBufferAttribute(s,R),j.copy(q);const P=f[R];O.copy(P),O.sub(q.multiplyScalar(q.dot(P))).normalize(),U.crossVectors(j,P);const B=U.dot(d[R])<0?-1:1;c.setXYZW(R,O.x,O.y,O.z,B)}for(let R=0,P=N.length;R<P;++R){const H=N[R],B=H.start,X=H.count;for(let k=B,ue=B+X;k<ue;k+=3)F(e.getX(k+0)),F(e.getX(k+1)),F(e.getX(k+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new vi(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let x=0,E=n.count;x<E;x++)n.setXYZ(x,0,0,0);const s=new J,a=new J,c=new J,f=new J,d=new J,m=new J,y=new J,v=new J;if(e)for(let x=0,E=e.count;x<E;x+=3){const T=e.getX(x+0),I=e.getX(x+1),w=e.getX(x+2);s.fromBufferAttribute(t,T),a.fromBufferAttribute(t,I),c.fromBufferAttribute(t,w),y.subVectors(c,a),v.subVectors(s,a),y.cross(v),f.fromBufferAttribute(n,T),d.fromBufferAttribute(n,I),m.fromBufferAttribute(n,w),f.add(y),d.add(y),m.add(y),n.setXYZ(T,f.x,f.y,f.z),n.setXYZ(I,d.x,d.y,d.z),n.setXYZ(w,m.x,m.y,m.z)}else for(let x=0,E=t.count;x<E;x+=3)s.fromBufferAttribute(t,x+0),a.fromBufferAttribute(t,x+1),c.fromBufferAttribute(t,x+2),y.subVectors(c,a),v.subVectors(s,a),y.cross(v),n.setXYZ(x+0,y.x,y.y,y.z),n.setXYZ(x+1,y.x,y.y,y.z),n.setXYZ(x+2,y.x,y.y,y.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)$s.fromBufferAttribute(e,t),$s.normalize(),e.setXYZ(t,$s.x,$s.y,$s.z)}toNonIndexed(){function e(f,d){const m=f.array,y=f.itemSize,v=f.normalized,x=new m.constructor(d.length*y);let E=0,T=0;for(let I=0,w=d.length;I<w;I++){f.isInterleavedBufferAttribute?E=d[I]*f.data.stride+f.offset:E=d[I]*y;for(let A=0;A<y;A++)x[T++]=m[E++]}return new vi(x,y,v)}if(this.index===null)return St("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vn,n=this.index.array,s=this.attributes;for(const f in s){const d=s[f],m=e(d,n);t.setAttribute(f,m)}const a=this.morphAttributes;for(const f in a){const d=[],m=a[f];for(let y=0,v=m.length;y<v;y++){const x=m[y],E=e(x,n);d.push(E)}t.morphAttributes[f]=d}t.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let f=0,d=c.length;f<d;f++){const m=c[f];t.addGroup(m.start,m.count,m.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const m in d)d[m]!==void 0&&(e[m]=d[m]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n){const m=n[d];e.data.attributes[d]=m.toJSON(e.data)}const s={};let a=!1;for(const d in this.morphAttributes){const m=this.morphAttributes[d],y=[];for(let v=0,x=m.length;v<x;v++){const E=m[v];y.push(E.toJSON(e.data))}y.length>0&&(s[d]=y,a=!0)}a&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const f=this.boundingSphere;return f!==null&&(e.data.boundingSphere=f.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const s=e.attributes;for(const m in s){const y=s[m];this.setAttribute(m,y.clone(t))}const a=e.morphAttributes;for(const m in a){const y=[],v=a[m];for(let x=0,E=v.length;x<E;x++)y.push(v[x].clone(t));this.morphAttributes[m]=y}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let m=0,y=c.length;m<y;m++){const v=c[m];this.addGroup(v.start,v.count,v.materialIndex)}const f=e.boundingBox;f!==null&&(this.boundingBox=f.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}class wb{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=O0,this.updateRanges=[],this.version=0,this.uuid=lo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let s=0,a=this.stride;s<a;s++)this.array[e+s]=t.array[n+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=lo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=lo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const oa=new J;class oo{constructor(e,t,n,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)oa.fromBufferAttribute(this,t),oa.applyMatrix4(e),this.setXYZ(t,oa.x,oa.y,oa.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)oa.fromBufferAttribute(this,t),oa.applyNormalMatrix(e),this.setXYZ(t,oa.x,oa.y,oa.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)oa.fromBufferAttribute(this,t),oa.transformDirection(e),this.setXYZ(t,oa.x,oa.y,oa.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=ua(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Tn(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ua(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ua(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ua(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ua(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array),s=Tn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this}setXYZW(e,t,n,s,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),n=Tn(n,this.array),s=Tn(s,this.array),a=Tn(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=s,this.data.array[e+3]=a,this}clone(e){if(e===void 0){z0("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[s+a])}return new vi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new oo(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){z0("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const s=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[s+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}let jO=0;class Wr extends Ac{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:jO++}),this.uuid=lo(),this.name="",this.type="Material",this.blending=Jf,this.side=vu,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=nx,this.blendDst=ix,this.blendEquation=_h,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new wt(0,0,0),this.blendAlpha=0,this.depthFunc=rd,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=uE,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Wf,this.stencilZFail=Wf,this.stencilZPass=Wf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){St(`Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){St(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Jf&&(n.blending=this.blending),this.side!==vu&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==nx&&(n.blendSrc=this.blendSrc),this.blendDst!==ix&&(n.blendDst=this.blendDst),this.blendEquation!==_h&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==rd&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==uE&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Wf&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Wf&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Wf&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(a){const c=[];for(const f in a){const d=a[f];delete d.metadata,c.push(d)}return c}if(t){const a=s(e.textures),c=s(e.images);a.length>0&&(n.textures=a),c.length>0&&(n.images=c)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const s=t.length;n=new Array(s);for(let a=0;a!==s;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class SM extends Wr{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new wt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ep;const Kg=new J,Mp=new J,Tp=new J,Ap=new ke,Qg=new ke,C3=new on,jv=new J,$g=new J,Wv=new J,PA=new ke,o1=new ke,LA=new ke;class R3 extends ei{constructor(e=new SM){if(super(),this.isSprite=!0,this.type="Sprite",Ep===void 0){Ep=new vn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new wb(t,5);Ep.setIndex([0,1,2,0,2,3]),Ep.setAttribute("position",new oo(n,3,0,!1)),Ep.setAttribute("uv",new oo(n,2,3,!1))}this.geometry=Ep,this.material=e,this.center=new ke(.5,.5),this.count=1}raycast(e,t){e.camera===null&&Gt('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Mp.setFromMatrixScale(this.matrixWorld),C3.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Tp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Mp.multiplyScalar(-Tp.z);const n=this.material.rotation;let s,a;n!==0&&(a=Math.cos(n),s=Math.sin(n));const c=this.center;qv(jv.set(-.5,-.5,0),Tp,c,Mp,s,a),qv($g.set(.5,-.5,0),Tp,c,Mp,s,a),qv(Wv.set(.5,.5,0),Tp,c,Mp,s,a),PA.set(0,0),o1.set(1,0),LA.set(1,1);let f=e.ray.intersectTriangle(jv,$g,Wv,!1,Kg);if(f===null&&(qv($g.set(-.5,.5,0),Tp,c,Mp,s,a),o1.set(0,1),f=e.ray.intersectTriangle(jv,Wv,$g,!1,Kg),f===null))return;const d=e.ray.origin.distanceTo(Kg);d<e.near||d>e.far||t.push({distance:d,point:Kg.clone(),uv:ka.getInterpolation(Kg,jv,$g,Wv,PA,o1,LA,new ke),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function qv(i,e,t,n,s,a){Ap.subVectors(i,t).addScalar(.5).multiply(n),s!==void 0?(Qg.x=a*Ap.x-s*Ap.y,Qg.y=s*Ap.x+a*Ap.y):Qg.copy(Ap),i.copy(e),i.x+=Qg.x,i.y+=Qg.y,i.applyMatrix4(C3)}const Xv=new J,OA=new J;class I3 extends ei{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,s=t.length;n<s;n++){const a=t[n];this.addLevel(a.object.clone(),a.distance,a.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const s=this.levels;let a;for(a=0;a<s.length&&!(t<s[a].distance);a++);return s.splice(a,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const s=t.splice(n,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,s;for(n=1,s=t.length;n<s;n++){let a=t[n].distance;if(t[n].object.visible&&(a-=a*t[n].hysteresis),e<a)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Xv.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(Xv);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Xv.setFromMatrixPosition(e.matrixWorld),OA.setFromMatrixPosition(this.matrixWorld);const n=Xv.distanceTo(OA)/e.zoom;t[0].object.visible=!0;let s,a;for(s=1,a=t.length;s<a;s++){let c=t[s].distance;if(t[s].object.visible&&(c-=c*t[s].hysteresis),n>=c)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<a;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let s=0,a=n.length;s<a;s++){const c=n[s];t.object.levels.push({object:c.object.uuid,distance:c.distance,hysteresis:c.hysteresis})}return t}}const hu=new J,l1=new J,Yv=new J,gh=new J,c1=new J,Zv=new J,u1=new J;class dd{constructor(e=new J,t=new J(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,hu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=hu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(hu.copy(this.origin).addScaledVector(this.direction,t),hu.distanceToSquared(e))}distanceSqToSegment(e,t,n,s){l1.copy(e).add(t).multiplyScalar(.5),Yv.copy(t).sub(e).normalize(),gh.copy(this.origin).sub(l1);const a=e.distanceTo(t)*.5,c=-this.direction.dot(Yv),f=gh.dot(this.direction),d=-gh.dot(Yv),m=gh.lengthSq(),y=Math.abs(1-c*c);let v,x,E,T;if(y>0)if(v=c*d-f,x=c*f-d,T=a*y,v>=0)if(x>=-T)if(x<=T){const I=1/y;v*=I,x*=I,E=v*(v+c*x+2*f)+x*(c*v+x+2*d)+m}else x=a,v=Math.max(0,-(c*x+f)),E=-v*v+x*(x+2*d)+m;else x=-a,v=Math.max(0,-(c*x+f)),E=-v*v+x*(x+2*d)+m;else x<=-T?(v=Math.max(0,-(-c*a+f)),x=v>0?-a:Math.min(Math.max(-a,-d),a),E=-v*v+x*(x+2*d)+m):x<=T?(v=0,x=Math.min(Math.max(-a,-d),a),E=x*(x+2*d)+m):(v=Math.max(0,-(c*a+f)),x=v>0?a:Math.min(Math.max(-a,-d),a),E=-v*v+x*(x+2*d)+m);else x=c>0?-a:a,v=Math.max(0,-(c*x+f)),E=-v*v+x*(x+2*d)+m;return n&&n.copy(this.origin).addScaledVector(this.direction,v),s&&s.copy(l1).addScaledVector(Yv,x),E}intersectSphere(e,t){hu.subVectors(e.center,this.origin);const n=hu.dot(this.direction),s=hu.dot(hu)-n*n,a=e.radius*e.radius;if(s>a)return null;const c=Math.sqrt(a-s),f=n-c,d=n+c;return d<0?null:f<0?this.at(d,t):this.at(f,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,s,a,c,f,d;const m=1/this.direction.x,y=1/this.direction.y,v=1/this.direction.z,x=this.origin;return m>=0?(n=(e.min.x-x.x)*m,s=(e.max.x-x.x)*m):(n=(e.max.x-x.x)*m,s=(e.min.x-x.x)*m),y>=0?(a=(e.min.y-x.y)*y,c=(e.max.y-x.y)*y):(a=(e.max.y-x.y)*y,c=(e.min.y-x.y)*y),n>c||a>s||((a>n||isNaN(n))&&(n=a),(c<s||isNaN(s))&&(s=c),v>=0?(f=(e.min.z-x.z)*v,d=(e.max.z-x.z)*v):(f=(e.max.z-x.z)*v,d=(e.min.z-x.z)*v),n>d||f>s)||((f>n||n!==n)&&(n=f),(d<s||s!==s)&&(s=d),s<0)?null:this.at(n>=0?n:s,t)}intersectsBox(e){return this.intersectBox(e,hu)!==null}intersectTriangle(e,t,n,s,a){c1.subVectors(t,e),Zv.subVectors(n,e),u1.crossVectors(c1,Zv);let c=this.direction.dot(u1),f;if(c>0){if(s)return null;f=1}else if(c<0)f=-1,c=-c;else return null;gh.subVectors(this.origin,e);const d=f*this.direction.dot(Zv.crossVectors(gh,Zv));if(d<0)return null;const m=f*this.direction.dot(c1.cross(gh));if(m<0||d+m>c)return null;const y=-f*gh.dot(u1);return y<0?null:this.at(y/c,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Hh extends Wr{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new wt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new uo,this.combine=ty,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const UA=new on,Df=new dd,Kv=new ks,zA=new J,Qv=new J,$v=new J,Jv=new J,h1=new J,e_=new J,FA=new J,t_=new J;class _s extends ei{constructor(e=new vn,t=new Hh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=s.length;a<c;a++){const f=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=a}}}}getVertexPosition(e,t){const n=this.geometry,s=n.attributes.position,a=n.morphAttributes.position,c=n.morphTargetsRelative;t.fromBufferAttribute(s,e);const f=this.morphTargetInfluences;if(a&&f){e_.set(0,0,0);for(let d=0,m=a.length;d<m;d++){const y=f[d],v=a[d];y!==0&&(h1.fromBufferAttribute(v,e),c?e_.addScaledVector(h1,y):e_.addScaledVector(h1.sub(t),y))}t.add(e_)}return t}raycast(e,t){const n=this.geometry,s=this.material,a=this.matrixWorld;s!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Kv.copy(n.boundingSphere),Kv.applyMatrix4(a),Df.copy(e.ray).recast(e.near),!(Kv.containsPoint(Df.origin)===!1&&(Df.intersectSphere(Kv,zA)===null||Df.origin.distanceToSquared(zA)>(e.far-e.near)**2))&&(UA.copy(a).invert(),Df.copy(e.ray).applyMatrix4(UA),!(n.boundingBox!==null&&Df.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Df)))}_computeIntersections(e,t,n){let s;const a=this.geometry,c=this.material,f=a.index,d=a.attributes.position,m=a.attributes.uv,y=a.attributes.uv1,v=a.attributes.normal,x=a.groups,E=a.drawRange;if(f!==null)if(Array.isArray(c))for(let T=0,I=x.length;T<I;T++){const w=x[T],A=c[w.materialIndex],N=Math.max(w.start,E.start),O=Math.min(f.count,Math.min(w.start+w.count,E.start+E.count));for(let U=N,q=O;U<q;U+=3){const j=f.getX(U),F=f.getX(U+1),R=f.getX(U+2);s=n_(this,A,e,n,m,y,v,j,F,R),s&&(s.faceIndex=Math.floor(U/3),s.face.materialIndex=w.materialIndex,t.push(s))}}else{const T=Math.max(0,E.start),I=Math.min(f.count,E.start+E.count);for(let w=T,A=I;w<A;w+=3){const N=f.getX(w),O=f.getX(w+1),U=f.getX(w+2);s=n_(this,c,e,n,m,y,v,N,O,U),s&&(s.faceIndex=Math.floor(w/3),t.push(s))}}else if(d!==void 0)if(Array.isArray(c))for(let T=0,I=x.length;T<I;T++){const w=x[T],A=c[w.materialIndex],N=Math.max(w.start,E.start),O=Math.min(d.count,Math.min(w.start+w.count,E.start+E.count));for(let U=N,q=O;U<q;U+=3){const j=U,F=U+1,R=U+2;s=n_(this,A,e,n,m,y,v,j,F,R),s&&(s.faceIndex=Math.floor(U/3),s.face.materialIndex=w.materialIndex,t.push(s))}}else{const T=Math.max(0,E.start),I=Math.min(d.count,E.start+E.count);for(let w=T,A=I;w<A;w+=3){const N=w,O=w+1,U=w+2;s=n_(this,c,e,n,m,y,v,N,O,U),s&&(s.faceIndex=Math.floor(w/3),t.push(s))}}}}function WO(i,e,t,n,s,a,c,f){let d;if(e.side===jr?d=n.intersectTriangle(c,a,s,!0,f):d=n.intersectTriangle(s,a,c,e.side===vu,f),d===null)return null;t_.copy(f),t_.applyMatrix4(i.matrixWorld);const m=t.ray.origin.distanceTo(t_);return m<t.near||m>t.far?null:{distance:m,point:t_.clone(),object:i}}function n_(i,e,t,n,s,a,c,f,d,m){i.getVertexPosition(f,Qv),i.getVertexPosition(d,$v),i.getVertexPosition(m,Jv);const y=WO(i,e,t,n,Qv,$v,Jv,FA);if(y){const v=new J;ka.getBarycoord(FA,Qv,$v,Jv,v),s&&(y.uv=ka.getInterpolatedAttribute(s,f,d,m,v,new ke)),a&&(y.uv1=ka.getInterpolatedAttribute(a,f,d,m,v,new ke)),c&&(y.normal=ka.getInterpolatedAttribute(c,f,d,m,v,new J),y.normal.dot(n.direction)>0&&y.normal.multiplyScalar(-1));const x={a:f,b:d,c:m,normal:new J,materialIndex:0};ka.getNormal(Qv,$v,Jv,x.normal),y.face=x,y.barycoord=v}return y}const BA=new J,VA=new Jn,kA=new Jn,qO=new J,HA=new on,i_=new J,f1=new ks,GA=new on,d1=new dd;class D3 extends _s{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=lE,this.bindMatrix=new on,this.bindMatrixInverse=new on,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Vs),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,i_),this.boundingBox.expandByPoint(i_)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ks),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,i_),this.boundingSphere.expandByPoint(i_)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,s=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),f1.copy(this.boundingSphere),f1.applyMatrix4(s),e.ray.intersectsSphere(f1)!==!1&&(GA.copy(s).invert(),d1.copy(e.ray).applyMatrix4(GA),!(this.boundingBox!==null&&d1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,d1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Jn,t=this.geometry.attributes.skinWeight;for(let n=0,s=t.count;n<s;n++){e.fromBufferAttribute(t,n);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===lE?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===u3?this.bindMatrixInverse.copy(this.bindMatrix).invert():St("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,s=this.geometry;VA.fromBufferAttribute(s.attributes.skinIndex,e),kA.fromBufferAttribute(s.attributes.skinWeight,e),BA.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const c=kA.getComponent(a);if(c!==0){const f=VA.getComponent(a);HA.multiplyMatrices(n.bones[f].matrixWorld,n.boneInverses[f]),t.addScaledVector(qO.copy(BA).applyMatrix4(HA),c)}}return t.applyMatrix4(this.bindMatrixInverse)}}class EM extends ei{constructor(){super(),this.isBone=!0,this.type="Bone"}}class El extends ls{constructor(e=null,t=1,n=1,s,a,c,f,d,m=vs,y=vs,v,x){super(null,c,f,d,m,y,s,a,v,x),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const jA=new on,XO=new on;class Cb{constructor(e=[],t=[]){this.uuid=lo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){St("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,s=this.bones.length;n<s;n++)this.boneInverses.push(new on)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new on;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,s=this.boneTexture;for(let a=0,c=e.length;a<c;a++){const f=e[a]?e[a].matrixWorld:XO;jA.multiplyMatrices(f,t[a]),jA.toArray(n,a*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new Cb(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new El(t,e,e,Gr,fa);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,s=e.bones.length;n<s;n++){const a=e.bones[n];let c=t[a];c===void 0&&(St("Skeleton: No bone found with UUID:",a),c=new EM),this.bones.push(c),this.boneInverses.push(new on().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let s=0,a=t.length;s<a;s++){const c=t[s];e.bones.push(c.uuid);const f=n[s];e.boneInverses.push(f.toArray())}return e}}class am extends vi{constructor(e,t,n,s=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const wp=new on,WA=new on,s_=[],qA=new Vs,YO=new on,Jg=new _s,e0=new ks;class N3 extends _s{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new am(new Float32Array(n*16),16),this.previousInstanceMatrix=null,this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<n;s++)this.setMatrixAt(s,YO)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Vs),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,wp),qA.copy(e.boundingBox).applyMatrix4(wp),this.boundingBox.union(qA)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new ks),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,wp),e0.copy(e.boundingSphere).applyMatrix4(wp),this.boundingSphere.union(e0)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.previousInstanceMatrix!==null&&(this.previousInstanceMatrix=e.previousInstanceMatrix.clone()),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,s=this.morphTexture.source.data.data,a=n.length+1,c=e*a+1;for(let f=0;f<n.length;f++)n[f]=s[c+f]}raycast(e,t){const n=this.matrixWorld,s=this.count;if(Jg.geometry=this.geometry,Jg.material=this.material,Jg.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),e0.copy(this.boundingSphere),e0.applyMatrix4(n),e.ray.intersectsSphere(e0)!==!1))for(let a=0;a<s;a++){this.getMatrixAt(a,wp),WA.multiplyMatrices(n,wp),Jg.matrixWorld=WA,Jg.raycast(e,s_);for(let c=0,f=s_.length;c<f;c++){const d=s_[c];d.instanceId=a,d.object=this,t.push(d)}s_.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new am(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,s=n.length+1;this.morphTexture===null&&(this.morphTexture=new El(new Float32Array(s*this.count),s,this.count,yb,fa));const a=this.morphTexture.source.data.data;let c=0;for(let m=0;m<n.length;m++)c+=n[m];const f=this.geometry.morphTargetsRelative?1:1-c,d=s*e;a[d]=f,a.set(n,d+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const p1=new J,ZO=new J,KO=new xn;class du{constructor(e=new J(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,s){return this.normal.set(e,t,n),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const s=p1.subVectors(n,t).cross(ZO.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(p1),s=this.normal.dot(n);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/s;return a<0||a>1?null:t.copy(e.start).addScaledVector(n,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||KO.getNormalMatrix(e),s=this.coplanarPoint(p1).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-s.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Nf=new ks,QO=new ke(.5,.5),r_=new J;class Em{constructor(e=new du,t=new du,n=new du,s=new du,a=new du,c=new du){this.planes=[e,t,n,s,a,c]}set(e,t,n,s,a,c){const f=this.planes;return f[0].copy(e),f[1].copy(t),f[2].copy(n),f[3].copy(s),f[4].copy(a),f[5].copy(c),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=ao,n=!1){const s=this.planes,a=e.elements,c=a[0],f=a[1],d=a[2],m=a[3],y=a[4],v=a[5],x=a[6],E=a[7],T=a[8],I=a[9],w=a[10],A=a[11],N=a[12],O=a[13],U=a[14],q=a[15];if(s[0].setComponents(m-c,E-y,A-T,q-N).normalize(),s[1].setComponents(m+c,E+y,A+T,q+N).normalize(),s[2].setComponents(m+f,E+v,A+I,q+O).normalize(),s[3].setComponents(m-f,E-v,A-I,q-O).normalize(),n)s[4].setComponents(d,x,w,U).normalize(),s[5].setComponents(m-d,E-x,A-w,q-U).normalize();else if(s[4].setComponents(m-d,E-x,A-w,q-U).normalize(),t===ao)s[5].setComponents(m+d,E+x,A+w,q+U).normalize();else if(t===od)s[5].setComponents(d,x,w,U).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Nf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Nf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Nf)}intersectsSprite(e){Nf.center.set(0,0,0);const t=QO.distanceTo(e.center);return Nf.radius=.7071067811865476+t,Nf.applyMatrix4(e.matrixWorld),this.intersectsSphere(Nf)}intersectsSphere(e){const t=this.planes,n=e.center,s=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(n)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const s=t[n];if(r_.x=s.normal.x>0?e.max.x:e.min.x,r_.y=s.normal.y>0?e.max.y:e.min.y,r_.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(r_)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const ac=new on,oc=new Em;class Rb{constructor(){this.coordinateSystem=ao}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(ac.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),oc.setFromProjectionMatrix(ac,s.coordinateSystem,s.reversedDepth),oc.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(ac.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),oc.setFromProjectionMatrix(ac,s.coordinateSystem,s.reversedDepth),oc.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(ac.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),oc.setFromProjectionMatrix(ac,s.coordinateSystem,s.reversedDepth),oc.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(ac.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),oc.setFromProjectionMatrix(ac,s.coordinateSystem,s.reversedDepth),oc.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const s=t.cameras[n];if(ac.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),oc.setFromProjectionMatrix(ac,s.coordinateSystem,s.reversedDepth),oc.containsPoint(e))return!0}return!1}clone(){return new Rb}}function m1(i,e){return i-e}function $O(i,e){return i.z-e.z}function JO(i,e){return e.z-i.z}class eU{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,s){const a=this.pool,c=this.list;this.index>=a.length&&a.push({start:-1,count:-1,z:-1,index:-1});const f=a[this.index];c.push(f),this.index++,f.start=e,f.count=t,f.z=n,f.index=s}reset(){this.list.length=0,this.index=0}}const za=new on,tU=new wt(1,1,1),XA=new Em,nU=new Rb,a_=new Vs,Pf=new ks,t0=new J,YA=new J,iU=new J,g1=new eU,Fr=new _s,o_=[];function sU(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const s=i.count;for(let a=0;a<s;a++)for(let c=0;c<n;c++)e.setComponent(a+t,c,i.getComponent(a,c))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function Lf(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class P3 extends _s{constructor(e,t,n=t*2,s){super(new vn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new El(t,e,e,Gr,fa);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new El(t,e,e,iy,Wo);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new El(t,e,e,Gr,fa);n.colorSpace=Gn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const c=e.getAttribute(a),{array:f,itemSize:d,normalized:m}=c,y=new f.constructor(n*d),v=new vi(y,d,m);t.setAttribute(a,v)}if(e.getIndex()!==null){const a=n>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new vi(a,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const s=e.getAttribute(n),a=t.getAttribute(n);if(s.itemSize!==a.itemSize||s.normalized!==a.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vs);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const a=t[n].geometryIndex;this.getMatrixAt(n,za),this.getBoundingBoxAt(a,a_).applyMatrix4(za),e.union(a_)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ks);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,s=t.length;n<s;n++){if(t[n].active===!1)continue;const a=t[n].geometryIndex;this.getMatrixAt(n,za),this.getBoundingSphereAt(a,Pf).applyMatrix4(za),e.union(Pf)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(m1),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=n):(s=this._instanceInfo.length,this._instanceInfo.push(n));const a=this._matricesTexture;za.identity().toArray(a.image.data,s*16),a.needsUpdate=!0;const c=this._colorsTexture;return c&&(tU.toArray(c.image.data,s*4),c.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const c=e.getIndex();if(c!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=n===-1?c.count:n),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let d;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(m1),d=this._availableGeometryIds.shift(),a[d]=s):(d=this._geometryCount,this._geometryCount++,a.push(s)),this.setGeometryAt(d,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,d}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,s=n.getIndex()!==null,a=n.getIndex(),c=t.getIndex(),f=this._geometryInfo[e];if(s&&c.count>f.reservedIndexCount||t.attributes.position.count>f.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const d=f.vertexStart,m=f.reservedVertexCount;f.vertexCount=t.getAttribute("position").count;for(const y in n.attributes){const v=t.getAttribute(y),x=n.getAttribute(y);sU(v,x,d);const E=v.itemSize;for(let T=v.count,I=m;T<I;T++){const w=d+T;for(let A=0;A<E;A++)x.setComponent(w,A,0)}x.needsUpdate=!0,x.addUpdateRange(d*E,m*E)}if(s){const y=f.indexStart,v=f.reservedIndexCount;f.indexCount=t.getIndex().count;for(let x=0;x<c.count;x++)a.setX(y+x,d+c.getX(x));for(let x=c.count,E=v;x<E;x++)a.setX(y+x,d);a.needsUpdate=!0,a.addUpdateRange(y,f.reservedIndexCount)}return f.start=s?f.indexStart:f.vertexStart,f.count=s?f.indexCount:f.vertexCount,f.boundingBox=null,t.boundingBox!==null&&(f.boundingBox=t.boundingBox.clone()),f.boundingSphere=null,t.boundingSphere!==null&&(f.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let s=0,a=n.length;s<a;s++)n[s].active&&n[s].geometryIndex===e&&this.deleteInstance(s);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,s=n.map((c,f)=>f).sort((c,f)=>n[c].vertexStart-n[f].vertexStart),a=this.geometry;for(let c=0,f=n.length;c<f;c++){const d=s[c],m=n[d];if(m.active!==!1){if(a.index!==null){if(m.indexStart!==t){const{indexStart:y,vertexStart:v,reservedIndexCount:x}=m,E=a.index,T=E.array,I=e-v;for(let w=y;w<y+x;w++)T[w]=T[w]+I;E.array.copyWithin(t,y,y+x),E.addUpdateRange(t,x),E.needsUpdate=!0,m.indexStart=t}t+=m.reservedIndexCount}if(m.vertexStart!==e){const{vertexStart:y,reservedVertexCount:v}=m,x=a.attributes;for(const E in x){const T=x[E],{array:I,itemSize:w}=T;I.copyWithin(e*w,y*w,(y+v)*w),T.addUpdateRange(e*w,v*w),T.needsUpdate=!0}m.vertexStart=e}e+=m.reservedVertexCount,m.start=a.index?m.indexStart:m.vertexStart}}return this._nextIndexStart=t,this._nextVertexStart=e,this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const a=new Vs,c=n.index,f=n.attributes.position;for(let d=s.start,m=s.start+s.count;d<m;d++){let y=d;c&&(y=c.getX(y)),a.expandByPoint(t0.fromBufferAttribute(f,y))}s.boundingBox=a}return t.copy(s.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const a=new ks;this.getBoundingBoxAt(e,a_),a_.getCenter(a.center);const c=n.index,f=n.attributes.position;let d=0;for(let m=s.start,y=s.start+s.count;m<y;m++){let v=m;c&&(v=c.getX(v)),t0.fromBufferAttribute(f,v),d=Math.max(d,a.center.distanceToSquared(t0))}a.radius=Math.sqrt(d),s.boundingSphere=a}return t.copy(s.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,s=this._matricesTexture.image.data;return t.toArray(s,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(m1);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),a=new Int32Array(e);Lf(this._multiDrawCounts,s),Lf(this._multiDrawStarts,a),this._multiDrawCounts=s,this._multiDrawStarts=a,this._maxInstanceCount=e;const c=this._indirectTexture,f=this._matricesTexture,d=this._colorsTexture;c.dispose(),this._initIndirectTexture(),Lf(c.image.data,this._indirectTexture.image.data),f.dispose(),this._initMatricesTexture(),Lf(f.image.data,this._matricesTexture.image.data),d&&(d.dispose(),this._initColorsTexture(),Lf(d.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(f=>f.active);if(Math.max(...n.map(f=>f.vertexStart+f.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(d=>d.indexStart+d.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const a=this.geometry;a.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new vn,this._initializeGeometry(a));const c=this.geometry;a.index&&Lf(a.index.array,c.index.array);for(const f in a.attributes)Lf(a.attributes[f].array,c.attributes[f].array)}raycast(e,t){const n=this._instanceInfo,s=this._geometryInfo,a=this.matrixWorld,c=this.geometry;Fr.material=this.material,Fr.geometry.index=c.index,Fr.geometry.attributes=c.attributes,Fr.geometry.boundingBox===null&&(Fr.geometry.boundingBox=new Vs),Fr.geometry.boundingSphere===null&&(Fr.geometry.boundingSphere=new ks);for(let f=0,d=n.length;f<d;f++){if(!n[f].visible||!n[f].active)continue;const m=n[f].geometryIndex,y=s[m];Fr.geometry.setDrawRange(y.start,y.count),this.getMatrixAt(f,Fr.matrixWorld).premultiply(a),this.getBoundingBoxAt(m,Fr.geometry.boundingBox),this.getBoundingSphereAt(m,Fr.geometry.boundingSphere),Fr.raycast(e,o_);for(let v=0,x=o_.length;v<x;v++){const E=o_[v];E.object=this,E.batchId=f,t.push(E)}o_.length=0}Fr.material=null,Fr.geometry.index=null,Fr.geometry.attributes={},Fr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,s,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const c=s.getIndex();let f=c===null?1:c.array.BYTES_PER_ELEMENT,d=1;a.wireframe&&(d=2,f=s.attributes.position.count>65535?4:2);const m=this._instanceInfo,y=this._multiDrawStarts,v=this._multiDrawCounts,x=this._geometryInfo,E=this.perObjectFrustumCulled,T=this._indirectTexture,I=T.image.data,w=n.isArrayCamera?nU:XA;E&&!n.isArrayCamera&&(za.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),XA.setFromProjectionMatrix(za,n.coordinateSystem,n.reversedDepth));let A=0;if(this.sortObjects){za.copy(this.matrixWorld).invert(),t0.setFromMatrixPosition(n.matrixWorld).applyMatrix4(za),YA.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(za);for(let U=0,q=m.length;U<q;U++)if(m[U].visible&&m[U].active){const j=m[U].geometryIndex;this.getMatrixAt(U,za),this.getBoundingSphereAt(j,Pf).applyMatrix4(za);let F=!1;if(E&&(F=!w.intersectsSphere(Pf,n)),!F){const R=x[j],P=iU.subVectors(Pf.center,t0).dot(YA);g1.push(R.start,R.count,P,U)}}const N=g1.list,O=this.customSort;O===null?N.sort(a.transparent?JO:$O):O.call(this,N,n);for(let U=0,q=N.length;U<q;U++){const j=N[U];y[A]=j.start*f*d,v[A]=j.count*d,I[A]=j.index,A++}g1.reset()}else for(let N=0,O=m.length;N<O;N++)if(m[N].visible&&m[N].active){const U=m[N].geometryIndex;let q=!1;if(E&&(this.getMatrixAt(N,za),this.getBoundingSphereAt(U,Pf).applyMatrix4(za),q=!w.intersectsSphere(Pf,n)),!q){const j=x[U];y[A]=j.start*f*d,v[A]=j.count*d,I[A]=N,A++}}T.needsUpdate=!0,this._multiDrawCount=A,this._visibilityChanged=!1}onBeforeShadow(e,t,n,s,a,c){this.onBeforeRender(e,null,s,a,c)}}class da extends Wr{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new wt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const jx=new J,Wx=new J,ZA=new on,n0=new dd,l_=new ks,y1=new J,KA=new J;let Lh=class extends ei{constructor(e=new vn,t=new da){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let s=1,a=t.count;s<a;s++)jx.fromBufferAttribute(t,s-1),Wx.fromBufferAttribute(t,s),n[s]=n[s-1],n[s]+=jx.distanceTo(Wx);e.setAttribute("lineDistance",new Ct(n,1))}else St("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,a=e.params.Line.threshold,c=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),l_.copy(n.boundingSphere),l_.applyMatrix4(s),l_.radius+=a,e.ray.intersectsSphere(l_)===!1)return;ZA.copy(s).invert(),n0.copy(e.ray).applyMatrix4(ZA);const f=a/((this.scale.x+this.scale.y+this.scale.z)/3),d=f*f,m=this.isLineSegments?2:1,y=n.index,x=n.attributes.position;if(y!==null){const E=Math.max(0,c.start),T=Math.min(y.count,c.start+c.count);for(let I=E,w=T-1;I<w;I+=m){const A=y.getX(I),N=y.getX(I+1),O=c_(this,e,n0,d,A,N,I);O&&t.push(O)}if(this.isLineLoop){const I=y.getX(T-1),w=y.getX(E),A=c_(this,e,n0,d,I,w,T-1);A&&t.push(A)}}else{const E=Math.max(0,c.start),T=Math.min(x.count,c.start+c.count);for(let I=E,w=T-1;I<w;I+=m){const A=c_(this,e,n0,d,I,I+1,I);A&&t.push(A)}if(this.isLineLoop){const I=c_(this,e,n0,d,T-1,E,T-1);I&&t.push(I)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=s.length;a<c;a++){const f=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=a}}}}};function c_(i,e,t,n,s,a,c){const f=i.geometry.attributes.position;if(jx.fromBufferAttribute(f,s),Wx.fromBufferAttribute(f,a),t.distanceSqToSegment(jx,Wx,y1,KA)>n)return;y1.applyMatrix4(i.matrixWorld);const m=e.ray.origin.distanceTo(y1);if(!(m<e.near||m>e.far))return{distance:m,point:KA.clone().applyMatrix4(i.matrixWorld),index:c,face:null,faceIndex:null,barycoord:null,object:i}}const QA=new J,$A=new J;class wc extends Lh{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let s=0,a=t.count;s<a;s+=2)QA.fromBufferAttribute(t,s),$A.fromBufferAttribute(t,s+1),n[s]=s===0?0:n[s-1],n[s+1]=n[s]+QA.distanceTo($A);e.setAttribute("lineDistance",new Ct(n,1))}else St("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class L3 extends Lh{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class MM extends Wr{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new wt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const JA=new on,fE=new dd,u_=new ks,h_=new J;class O3 extends ei{constructor(e=new vn,t=new MM){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,s=this.matrixWorld,a=e.params.Points.threshold,c=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),u_.copy(n.boundingSphere),u_.applyMatrix4(s),u_.radius+=a,e.ray.intersectsSphere(u_)===!1)return;JA.copy(s).invert(),fE.copy(e.ray).applyMatrix4(JA);const f=a/((this.scale.x+this.scale.y+this.scale.z)/3),d=f*f,m=n.index,v=n.attributes.position;if(m!==null){const x=Math.max(0,c.start),E=Math.min(m.count,c.start+c.count);for(let T=x,I=E;T<I;T++){const w=m.getX(T);h_.fromBufferAttribute(v,w),ew(h_,w,d,s,e,t,this)}}else{const x=Math.max(0,c.start),E=Math.min(v.count,c.start+c.count);for(let T=x,I=E;T<I;T++)h_.fromBufferAttribute(v,T),ew(h_,T,d,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const s=t[n[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=s.length;a<c;a++){const f=s[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=a}}}}}function ew(i,e,t,n,s,a,c){const f=fE.distanceSqToPoint(i);if(f<t){const d=new J;fE.closestPointToPoint(i,d),d.applyMatrix4(n);const m=s.ray.origin.distanceTo(d);if(m<s.near||m>s.far)return;a.push({distance:m,distanceToRay:Math.sqrt(f),point:d,index:e,face:null,faceIndex:null,barycoord:null,object:c})}}class U3 extends ls{constructor(e,t,n,s,a=zi,c=zi,f,d,m){super(e,t,n,s,a,c,f,d,m),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const y=this;function v(){y.needsUpdate=!0,y._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class rU extends U3{constructor(e,t,n,s,a,c,f,d){super({},e,t,n,s,a,c,f,d),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class aU extends ls{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=vs,this.minFilter=vs,this.generateMipmaps=!1,this.needsUpdate=!0}}class Ib extends ls{constructor(e,t,n,s,a,c,f,d,m,y,v,x){super(null,c,f,d,m,y,s,a,v,x),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class oU extends Ib{constructor(e,t,n,s,a,c){super(e,t,n,a,c),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Ha,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class lU extends Ib{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,bc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class sy extends ls{constructor(e=[],t=bc,n,s,a,c,f,d,m,y){super(e,t,n,s,a,c,f,d,m,y),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class cU extends ls{constructor(e,t,n,s,a,c,f,d,m){super(e,t,n,s,a,c,f,d,m),this.isCanvasTexture=!0,this.needsUpdate=!0}}class om extends ls{constructor(e,t,n=Wo,s,a,c,f=vs,d=vs,m,y=Ec,v=1){if(y!==Ec&&y!==bh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const x={width:e,height:t,depth:v};super(x,s,a,c,f,d,y,n,m),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Sh(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class z3 extends om{constructor(e,t=Wo,n=bc,s,a,c=vs,f=vs,d,m=Ec){const y={width:e,height:e,depth:1},v=[y,y,y,y,y,y];super(e,e,t,n,s,a,c,f,d,m),this.image=v,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class TM extends ls{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class pd extends vn{constructor(e=1,t=1,n=1,s=1,a=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:s,heightSegments:a,depthSegments:c};const f=this;s=Math.floor(s),a=Math.floor(a),c=Math.floor(c);const d=[],m=[],y=[],v=[];let x=0,E=0;T("z","y","x",-1,-1,n,t,e,c,a,0),T("z","y","x",1,-1,n,t,-e,c,a,1),T("x","z","y",1,1,e,n,t,s,c,2),T("x","z","y",1,-1,e,n,-t,s,c,3),T("x","y","z",1,-1,e,t,n,s,a,4),T("x","y","z",-1,-1,e,t,-n,s,a,5),this.setIndex(d),this.setAttribute("position",new Ct(m,3)),this.setAttribute("normal",new Ct(y,3)),this.setAttribute("uv",new Ct(v,2));function T(I,w,A,N,O,U,q,j,F,R,P){const H=U/F,B=q/R,X=U/2,k=q/2,ue=j/2,he=F+1,ee=R+1;let ie=0,ye=0;const be=new J;for(let Be=0;Be<ee;Be++){const Oe=Be*B-k;for(let Pe=0;Pe<he;Pe++){const $e=Pe*H-X;be[I]=$e*N,be[w]=Oe*O,be[A]=ue,m.push(be.x,be.y,be.z),be[I]=0,be[w]=0,be[A]=j>0?1:-1,y.push(be.x,be.y,be.z),v.push(Pe/F),v.push(1-Be/R),ie+=1}}for(let Be=0;Be<R;Be++)for(let Oe=0;Oe<F;Oe++){const Pe=x+Oe+he*Be,$e=x+Oe+he*(Be+1),Mt=x+(Oe+1)+he*(Be+1),Yt=x+(Oe+1)+he*Be;d.push(Pe,$e,Yt),d.push($e,Mt,Yt),ye+=6}f.addGroup(E,ye,P),E+=ye,x+=ie}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}class Db extends vn{constructor(e=1,t=1,n=4,s=8,a=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:s,heightSegments:a},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),s=Math.max(3,Math.floor(s)),a=Math.max(1,Math.floor(a));const c=[],f=[],d=[],m=[],y=t/2,v=Math.PI/2*e,x=t,E=2*v+x,T=n*2+a,I=s+1,w=new J,A=new J;for(let N=0;N<=T;N++){let O=0,U=0,q=0,j=0;if(N<=n){const P=N/n,H=P*Math.PI/2;U=-y-e*Math.cos(H),q=e*Math.sin(H),j=-e*Math.cos(H),O=P*v}else if(N<=n+a){const P=(N-n)/a;U=-y+P*t,q=e,j=0,O=v+P*x}else{const P=(N-n-a)/n,H=P*Math.PI/2;U=y+e*Math.sin(H),q=e*Math.cos(H),j=e*Math.sin(H),O=v+x+P*v}const F=Math.max(0,Math.min(1,O/E));let R=0;N===0?R=.5/s:N===T&&(R=-.5/s);for(let P=0;P<=s;P++){const H=P/s,B=H*Math.PI*2,X=Math.sin(B),k=Math.cos(B);A.x=-q*k,A.y=U,A.z=q*X,f.push(A.x,A.y,A.z),w.set(-q*k,j,q*X),w.normalize(),d.push(w.x,w.y,w.z),m.push(H+R,F)}if(N>0){const P=(N-1)*I;for(let H=0;H<s;H++){const B=P+H,X=P+H+1,k=N*I+H,ue=N*I+H+1;c.push(B,X,k),c.push(X,ue,k)}}}this.setIndex(c),this.setAttribute("position",new Ct(f,3)),this.setAttribute("normal",new Ct(d,3)),this.setAttribute("uv",new Ct(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Db(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Nb extends vn{constructor(e=1,t=32,n=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:s},t=Math.max(3,t);const a=[],c=[],f=[],d=[],m=new J,y=new ke;c.push(0,0,0),f.push(0,0,1),d.push(.5,.5);for(let v=0,x=3;v<=t;v++,x+=3){const E=n+v/t*s;m.x=e*Math.cos(E),m.y=e*Math.sin(E),c.push(m.x,m.y,m.z),f.push(0,0,1),y.x=(c[x]/e+1)/2,y.y=(c[x+1]/e+1)/2,d.push(y.x,y.y)}for(let v=1;v<=t;v++)a.push(v,v+1,0);this.setIndex(a),this.setAttribute("position",new Ct(c,3)),this.setAttribute("normal",new Ct(f,3)),this.setAttribute("uv",new Ct(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nb(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class ry extends vn{constructor(e=1,t=1,n=1,s=32,a=1,c=!1,f=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:s,heightSegments:a,openEnded:c,thetaStart:f,thetaLength:d};const m=this;s=Math.floor(s),a=Math.floor(a);const y=[],v=[],x=[],E=[];let T=0;const I=[],w=n/2;let A=0;N(),c===!1&&(e>0&&O(!0),t>0&&O(!1)),this.setIndex(y),this.setAttribute("position",new Ct(v,3)),this.setAttribute("normal",new Ct(x,3)),this.setAttribute("uv",new Ct(E,2));function N(){const U=new J,q=new J;let j=0;const F=(t-e)/n;for(let R=0;R<=a;R++){const P=[],H=R/a,B=H*(t-e)+e;for(let X=0;X<=s;X++){const k=X/s,ue=k*d+f,he=Math.sin(ue),ee=Math.cos(ue);q.x=B*he,q.y=-H*n+w,q.z=B*ee,v.push(q.x,q.y,q.z),U.set(he,F,ee).normalize(),x.push(U.x,U.y,U.z),E.push(k,1-H),P.push(T++)}I.push(P)}for(let R=0;R<s;R++)for(let P=0;P<a;P++){const H=I[P][R],B=I[P+1][R],X=I[P+1][R+1],k=I[P][R+1];(e>0||P!==0)&&(y.push(H,B,k),j+=3),(t>0||P!==a-1)&&(y.push(B,X,k),j+=3)}m.addGroup(A,j,0),A+=j}function O(U){const q=T,j=new ke,F=new J;let R=0;const P=U===!0?e:t,H=U===!0?1:-1;for(let X=1;X<=s;X++)v.push(0,w*H,0),x.push(0,H,0),E.push(.5,.5),T++;const B=T;for(let X=0;X<=s;X++){const ue=X/s*d+f,he=Math.cos(ue),ee=Math.sin(ue);F.x=P*ee,F.y=w*H,F.z=P*he,v.push(F.x,F.y,F.z),x.push(0,H,0),j.x=he*.5+.5,j.y=ee*.5*H+.5,E.push(j.x,j.y),T++}for(let X=0;X<s;X++){const k=q+X,ue=B+X;U===!0?y.push(ue,ue+1,k):y.push(ue+1,ue,k),R+=3}m.addGroup(A,R,U===!0?1:2),A+=R}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ry(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ay extends ry{constructor(e=1,t=1,n=32,s=1,a=!1,c=0,f=Math.PI*2){super(0,e,t,n,s,a,c,f),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:c,thetaLength:f}}static fromJSON(e){return new ay(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Gh extends vn{constructor(e=[],t=[],n=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:s};const a=[],c=[];f(s),m(n),y(),this.setAttribute("position",new Ct(a,3)),this.setAttribute("normal",new Ct(a.slice(),3)),this.setAttribute("uv",new Ct(c,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function f(N){const O=new J,U=new J,q=new J;for(let j=0;j<t.length;j+=3)E(t[j+0],O),E(t[j+1],U),E(t[j+2],q),d(O,U,q,N)}function d(N,O,U,q){const j=q+1,F=[];for(let R=0;R<=j;R++){F[R]=[];const P=N.clone().lerp(U,R/j),H=O.clone().lerp(U,R/j),B=j-R;for(let X=0;X<=B;X++)X===0&&R===j?F[R][X]=P:F[R][X]=P.clone().lerp(H,X/B)}for(let R=0;R<j;R++)for(let P=0;P<2*(j-R)-1;P++){const H=Math.floor(P/2);P%2===0?(x(F[R][H+1]),x(F[R+1][H]),x(F[R][H])):(x(F[R][H+1]),x(F[R+1][H+1]),x(F[R+1][H]))}}function m(N){const O=new J;for(let U=0;U<a.length;U+=3)O.x=a[U+0],O.y=a[U+1],O.z=a[U+2],O.normalize().multiplyScalar(N),a[U+0]=O.x,a[U+1]=O.y,a[U+2]=O.z}function y(){const N=new J;for(let O=0;O<a.length;O+=3){N.x=a[O+0],N.y=a[O+1],N.z=a[O+2];const U=w(N)/2/Math.PI+.5,q=A(N)/Math.PI+.5;c.push(U,1-q)}T(),v()}function v(){for(let N=0;N<c.length;N+=6){const O=c[N+0],U=c[N+2],q=c[N+4],j=Math.max(O,U,q),F=Math.min(O,U,q);j>.9&&F<.1&&(O<.2&&(c[N+0]+=1),U<.2&&(c[N+2]+=1),q<.2&&(c[N+4]+=1))}}function x(N){a.push(N.x,N.y,N.z)}function E(N,O){const U=N*3;O.x=e[U+0],O.y=e[U+1],O.z=e[U+2]}function T(){const N=new J,O=new J,U=new J,q=new J,j=new ke,F=new ke,R=new ke;for(let P=0,H=0;P<a.length;P+=9,H+=6){N.set(a[P+0],a[P+1],a[P+2]),O.set(a[P+3],a[P+4],a[P+5]),U.set(a[P+6],a[P+7],a[P+8]),j.set(c[H+0],c[H+1]),F.set(c[H+2],c[H+3]),R.set(c[H+4],c[H+5]),q.copy(N).add(O).add(U).divideScalar(3);const B=w(q);I(j,H+0,N,B),I(F,H+2,O,B),I(R,H+4,U,B)}}function I(N,O,U,q){q<0&&N.x===1&&(c[O]=N.x-1),U.x===0&&U.z===0&&(c[O]=q/2/Math.PI+.5)}function w(N){return Math.atan2(N.z,-N.x)}function A(N){return Math.atan2(-N.y,Math.sqrt(N.x*N.x+N.z*N.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gh(e.vertices,e.indices,e.radius,e.detail)}}class Pb extends Gh{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=1/n,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-n,0,-s,n,0,s,-n,0,s,n,-s,-n,0,-s,n,0,s,-n,0,s,n,0,-n,0,-s,n,0,-s,-n,0,s,n,0,s],c=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(a,c,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Pb(e.radius,e.detail)}}const f_=new J,d_=new J,v1=new J,p_=new ka;class F3 extends vn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),a=Math.cos(ed*t),c=e.getIndex(),f=e.getAttribute("position"),d=c?c.count:f.count,m=[0,0,0],y=["a","b","c"],v=new Array(3),x={},E=[];for(let T=0;T<d;T+=3){c?(m[0]=c.getX(T),m[1]=c.getX(T+1),m[2]=c.getX(T+2)):(m[0]=T,m[1]=T+1,m[2]=T+2);const{a:I,b:w,c:A}=p_;if(I.fromBufferAttribute(f,m[0]),w.fromBufferAttribute(f,m[1]),A.fromBufferAttribute(f,m[2]),p_.getNormal(v1),v[0]=`${Math.round(I.x*s)},${Math.round(I.y*s)},${Math.round(I.z*s)}`,v[1]=`${Math.round(w.x*s)},${Math.round(w.y*s)},${Math.round(w.z*s)}`,v[2]=`${Math.round(A.x*s)},${Math.round(A.y*s)},${Math.round(A.z*s)}`,!(v[0]===v[1]||v[1]===v[2]||v[2]===v[0]))for(let N=0;N<3;N++){const O=(N+1)%3,U=v[N],q=v[O],j=p_[y[N]],F=p_[y[O]],R=`${U}_${q}`,P=`${q}_${U}`;P in x&&x[P]?(v1.dot(x[P].normal)<=a&&(E.push(j.x,j.y,j.z),E.push(F.x,F.y,F.z)),x[P]=null):R in x||(x[R]={index0:m[N],index1:m[O],normal:v1.clone()})}}for(const T in x)if(x[T]){const{index0:I,index1:w}=x[T];f_.fromBufferAttribute(f,I),d_.fromBufferAttribute(f,w),E.push(f_.x,f_.y,f_.z),E.push(d_.x,d_.y,d_.z)}this.setAttribute("position",new Ct(E,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Ml{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){St("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,s=this.getPoint(0),a=0;t.push(0);for(let c=1;c<=e;c++)n=this.getPoint(c/e),a+=n.distanceTo(s),t.push(a),s=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let s=0;const a=n.length;let c;t?c=t:c=e*n[a-1];let f=0,d=a-1,m;for(;f<=d;)if(s=Math.floor(f+(d-f)/2),m=n[s]-c,m<0)f=s+1;else if(m>0)d=s-1;else{d=s;break}if(s=d,n[s]===c)return s/(a-1);const y=n[s],x=n[s+1]-y,E=(c-y)/x;return(s+E)/(a-1)}getTangent(e,t){let s=e-1e-4,a=e+1e-4;s<0&&(s=0),a>1&&(a=1);const c=this.getPoint(s),f=this.getPoint(a),d=t||(c.isVector2?new ke:new J);return d.copy(f).sub(c).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new J,s=[],a=[],c=[],f=new J,d=new on;for(let E=0;E<=e;E++){const T=E/e;s[E]=this.getTangentAt(T,new J)}a[0]=new J,c[0]=new J;let m=Number.MAX_VALUE;const y=Math.abs(s[0].x),v=Math.abs(s[0].y),x=Math.abs(s[0].z);y<=m&&(m=y,n.set(1,0,0)),v<=m&&(m=v,n.set(0,1,0)),x<=m&&n.set(0,0,1),f.crossVectors(s[0],n).normalize(),a[0].crossVectors(s[0],f),c[0].crossVectors(s[0],a[0]);for(let E=1;E<=e;E++){if(a[E]=a[E-1].clone(),c[E]=c[E-1].clone(),f.crossVectors(s[E-1],s[E]),f.length()>Number.EPSILON){f.normalize();const T=Math.acos(rn(s[E-1].dot(s[E]),-1,1));a[E].applyMatrix4(d.makeRotationAxis(f,T))}c[E].crossVectors(s[E],a[E])}if(t===!0){let E=Math.acos(rn(a[0].dot(a[e]),-1,1));E/=e,s[0].dot(f.crossVectors(a[0],a[e]))>0&&(E=-E);for(let T=1;T<=e;T++)a[T].applyMatrix4(d.makeRotationAxis(s[T],E*T)),c[T].crossVectors(s[T],a[T])}return{tangents:s,normals:a,binormals:c}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Lb extends Ml{constructor(e=0,t=0,n=1,s=1,a=0,c=Math.PI*2,f=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=s,this.aStartAngle=a,this.aEndAngle=c,this.aClockwise=f,this.aRotation=d}getPoint(e,t=new ke){const n=t,s=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const c=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=s;for(;a>s;)a-=s;a<Number.EPSILON&&(c?a=0:a=s),this.aClockwise===!0&&!c&&(a===s?a=-s:a=a-s);const f=this.aStartAngle+e*a;let d=this.aX+this.xRadius*Math.cos(f),m=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){const y=Math.cos(this.aRotation),v=Math.sin(this.aRotation),x=d-this.aX,E=m-this.aY;d=x*y-E*v+this.aX,m=x*v+E*y+this.aY}return n.set(d,m)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class B3 extends Lb{constructor(e,t,n,s,a,c){super(e,t,n,n,s,a,c),this.isArcCurve=!0,this.type="ArcCurve"}}function AM(){let i=0,e=0,t=0,n=0;function s(a,c,f,d){i=a,e=f,t=-3*a+3*c-2*f-d,n=2*a-2*c+f+d}return{initCatmullRom:function(a,c,f,d,m){s(c,f,m*(f-a),m*(d-c))},initNonuniformCatmullRom:function(a,c,f,d,m,y,v){let x=(c-a)/m-(f-a)/(m+y)+(f-c)/y,E=(f-c)/y-(d-c)/(y+v)+(d-f)/v;x*=y,E*=y,s(c,f,x,E)},calc:function(a){const c=a*a,f=c*a;return i+e*a+t*c+n*f}}}const m_=new J,_1=new AM,x1=new AM,b1=new AM;class V3 extends Ml{constructor(e=[],t=!1,n="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=s}getPoint(e,t=new J){const n=t,s=this.points,a=s.length,c=(a-(this.closed?0:1))*e;let f=Math.floor(c),d=c-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/a)+1)*a:d===0&&f===a-1&&(f=a-2,d=1);let m,y;this.closed||f>0?m=s[(f-1)%a]:(m_.subVectors(s[0],s[1]).add(s[0]),m=m_);const v=s[f%a],x=s[(f+1)%a];if(this.closed||f+2<a?y=s[(f+2)%a]:(m_.subVectors(s[a-1],s[a-2]).add(s[a-1]),y=m_),this.curveType==="centripetal"||this.curveType==="chordal"){const E=this.curveType==="chordal"?.5:.25;let T=Math.pow(m.distanceToSquared(v),E),I=Math.pow(v.distanceToSquared(x),E),w=Math.pow(x.distanceToSquared(y),E);I<1e-4&&(I=1),T<1e-4&&(T=I),w<1e-4&&(w=I),_1.initNonuniformCatmullRom(m.x,v.x,x.x,y.x,T,I,w),x1.initNonuniformCatmullRom(m.y,v.y,x.y,y.y,T,I,w),b1.initNonuniformCatmullRom(m.z,v.z,x.z,y.z,T,I,w)}else this.curveType==="catmullrom"&&(_1.initCatmullRom(m.x,v.x,x.x,y.x,this.tension),x1.initCatmullRom(m.y,v.y,x.y,y.y,this.tension),b1.initCatmullRom(m.z,v.z,x.z,y.z,this.tension));return n.set(_1.calc(d),x1.calc(d),b1.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new J().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function tw(i,e,t,n,s){const a=(n-e)*.5,c=(s-t)*.5,f=i*i,d=i*f;return(2*t-2*n+a+c)*d+(-3*t+3*n-2*a-c)*f+a*i+t}function uU(i,e){const t=1-i;return t*t*e}function hU(i,e){return 2*(1-i)*i*e}function fU(i,e){return i*i*e}function b0(i,e,t,n){return uU(i,e)+hU(i,t)+fU(i,n)}function dU(i,e){const t=1-i;return t*t*t*e}function pU(i,e){const t=1-i;return 3*t*t*i*e}function mU(i,e){return 3*(1-i)*i*i*e}function gU(i,e){return i*i*i*e}function S0(i,e,t,n,s){return dU(i,e)+pU(i,t)+mU(i,n)+gU(i,s)}class wM extends Ml{constructor(e=new ke,t=new ke,n=new ke,s=new ke){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new ke){const n=t,s=this.v0,a=this.v1,c=this.v2,f=this.v3;return n.set(S0(e,s.x,a.x,c.x,f.x),S0(e,s.y,a.y,c.y,f.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class k3 extends Ml{constructor(e=new J,t=new J,n=new J,s=new J){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=s}getPoint(e,t=new J){const n=t,s=this.v0,a=this.v1,c=this.v2,f=this.v3;return n.set(S0(e,s.x,a.x,c.x,f.x),S0(e,s.y,a.y,c.y,f.y),S0(e,s.z,a.z,c.z,f.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class CM extends Ml{constructor(e=new ke,t=new ke){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new ke){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ke){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class H3 extends Ml{constructor(e=new J,t=new J){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new J){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new J){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class RM extends Ml{constructor(e=new ke,t=new ke,n=new ke){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ke){const n=t,s=this.v0,a=this.v1,c=this.v2;return n.set(b0(e,s.x,a.x,c.x),b0(e,s.y,a.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class IM extends Ml{constructor(e=new J,t=new J,n=new J){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new J){const n=t,s=this.v0,a=this.v1,c=this.v2;return n.set(b0(e,s.x,a.x,c.x),b0(e,s.y,a.y,c.y),b0(e,s.z,a.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class DM extends Ml{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new ke){const n=t,s=this.points,a=(s.length-1)*e,c=Math.floor(a),f=a-c,d=s[c===0?c:c-1],m=s[c],y=s[c>s.length-2?s.length-1:c+1],v=s[c>s.length-3?s.length-1:c+2];return n.set(tw(f,d.x,m.x,y.x,v.x),tw(f,d.y,m.y,y.y,v.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const s=e.points[t];this.points.push(new ke().fromArray(s))}return this}}var qx=Object.freeze({__proto__:null,ArcCurve:B3,CatmullRomCurve3:V3,CubicBezierCurve:wM,CubicBezierCurve3:k3,EllipseCurve:Lb,LineCurve:CM,LineCurve3:H3,QuadraticBezierCurve:RM,QuadraticBezierCurve3:IM,SplineCurve:DM});class G3 extends Ml{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new qx[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),s=this.getCurveLengths();let a=0;for(;a<s.length;){if(s[a]>=n){const c=s[a]-n,f=this.curves[a],d=f.getLength(),m=d===0?0:1-c/d;return f.getPointAt(m,t)}a++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,s=this.curves.length;n<s;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let s=0,a=this.curves;s<a.length;s++){const c=a[s],f=c.isEllipseCurve?e*2:c.isLineCurve||c.isLineCurve3?1:c.isSplineCurve?e*c.points.length:e,d=c.getPoints(f);for(let m=0;m<d.length;m++){const y=d[m];n&&n.equals(y)||(t.push(y),n=y)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const s=e.curves[t];this.curves.push(new qx[s.type]().fromJSON(s))}return this}}class Xx extends G3{constructor(e){super(),this.type="Path",this.currentPoint=new ke,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new CM(this.currentPoint.clone(),new ke(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,s){const a=new RM(this.currentPoint.clone(),new ke(e,t),new ke(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}bezierCurveTo(e,t,n,s,a,c){const f=new wM(this.currentPoint.clone(),new ke(e,t),new ke(n,s),new ke(a,c));return this.curves.push(f),this.currentPoint.set(a,c),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new DM(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,s,a,c){const f=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+f,t+d,n,s,a,c),this}absarc(e,t,n,s,a,c){return this.absellipse(e,t,n,n,s,a,c),this}ellipse(e,t,n,s,a,c,f,d){const m=this.currentPoint.x,y=this.currentPoint.y;return this.absellipse(e+m,t+y,n,s,a,c,f,d),this}absellipse(e,t,n,s,a,c,f,d){const m=new Lb(e,t,n,s,a,c,f,d);if(this.curves.length>0){const v=m.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(m);const y=m.getPoint(1);return this.currentPoint.copy(y),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class td extends Xx{constructor(e){super(e),this.uuid=lo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,s=this.holes.length;n<s;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const s=e.holes[t];this.holes.push(new Xx().fromJSON(s))}return this}}function yU(i,e,t=2){const n=e&&e.length,s=n?e[0]*t:i.length;let a=j3(i,0,s,t,!0);const c=[];if(!a||a.next===a.prev)return c;let f,d,m;if(n&&(a=SU(i,e,a,t)),i.length>80*t){f=i[0],d=i[1];let y=f,v=d;for(let x=t;x<s;x+=t){const E=i[x],T=i[x+1];E<f&&(f=E),T<d&&(d=T),E>y&&(y=E),T>v&&(v=T)}m=Math.max(y-f,v-d),m=m!==0?32767/m:0}return B0(a,c,t,f,d,m,0),c}function j3(i,e,t,n,s){let a;if(s===PU(i,e,t,n)>0)for(let c=e;c<t;c+=n)a=nw(c/n|0,i[c],i[c+1],a);else for(let c=t-n;c>=e;c-=n)a=nw(c/n|0,i[c],i[c+1],a);return a&&lm(a,a.next)&&(k0(a),a=a.next),a}function ld(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(lm(t,t.next)||ts(t.prev,t,t.next)===0)){if(k0(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function B0(i,e,t,n,s,a,c){if(!i)return;!c&&a&&wU(i,n,s,a);let f=i;for(;i.prev!==i.next;){const d=i.prev,m=i.next;if(a?_U(i,n,s,a):vU(i)){e.push(d.i,i.i,m.i),k0(i),i=m.next,f=m.next;continue}if(i=m,i===f){c?c===1?(i=xU(ld(i),e),B0(i,e,t,n,s,a,2)):c===2&&bU(i,e,t,n,s,a):B0(ld(i),e,t,n,s,a,1);break}}}function vU(i){const e=i.prev,t=i,n=i.next;if(ts(e,t,n)>=0)return!1;const s=e.x,a=t.x,c=n.x,f=e.y,d=t.y,m=n.y,y=Math.min(s,a,c),v=Math.min(f,d,m),x=Math.max(s,a,c),E=Math.max(f,d,m);let T=n.next;for(;T!==e;){if(T.x>=y&&T.x<=x&&T.y>=v&&T.y<=E&&o0(s,f,a,d,c,m,T.x,T.y)&&ts(T.prev,T,T.next)>=0)return!1;T=T.next}return!0}function _U(i,e,t,n){const s=i.prev,a=i,c=i.next;if(ts(s,a,c)>=0)return!1;const f=s.x,d=a.x,m=c.x,y=s.y,v=a.y,x=c.y,E=Math.min(f,d,m),T=Math.min(y,v,x),I=Math.max(f,d,m),w=Math.max(y,v,x),A=dE(E,T,e,t,n),N=dE(I,w,e,t,n);let O=i.prevZ,U=i.nextZ;for(;O&&O.z>=A&&U&&U.z<=N;){if(O.x>=E&&O.x<=I&&O.y>=T&&O.y<=w&&O!==s&&O!==c&&o0(f,y,d,v,m,x,O.x,O.y)&&ts(O.prev,O,O.next)>=0||(O=O.prevZ,U.x>=E&&U.x<=I&&U.y>=T&&U.y<=w&&U!==s&&U!==c&&o0(f,y,d,v,m,x,U.x,U.y)&&ts(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;O&&O.z>=A;){if(O.x>=E&&O.x<=I&&O.y>=T&&O.y<=w&&O!==s&&O!==c&&o0(f,y,d,v,m,x,O.x,O.y)&&ts(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;U&&U.z<=N;){if(U.x>=E&&U.x<=I&&U.y>=T&&U.y<=w&&U!==s&&U!==c&&o0(f,y,d,v,m,x,U.x,U.y)&&ts(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function xU(i,e){let t=i;do{const n=t.prev,s=t.next.next;!lm(n,s)&&q3(n,t,t.next,s)&&V0(n,s)&&V0(s,n)&&(e.push(n.i,t.i,s.i),k0(t),k0(t.next),t=i=s),t=t.next}while(t!==i);return ld(t)}function bU(i,e,t,n,s,a){let c=i;do{let f=c.next.next;for(;f!==c.prev;){if(c.i!==f.i&&IU(c,f)){let d=X3(c,f);c=ld(c,c.next),d=ld(d,d.next),B0(c,e,t,n,s,a,0),B0(d,e,t,n,s,a,0);return}f=f.next}c=c.next}while(c!==i)}function SU(i,e,t,n){const s=[];for(let a=0,c=e.length;a<c;a++){const f=e[a]*n,d=a<c-1?e[a+1]*n:i.length,m=j3(i,f,d,n,!1);m===m.next&&(m.steiner=!0),s.push(RU(m))}s.sort(EU);for(let a=0;a<s.length;a++)t=MU(s[a],t);return t}function EU(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),s=(e.next.y-e.y)/(e.next.x-e.x);t=n-s}return t}function MU(i,e){const t=TU(i,e);if(!t)return e;const n=X3(t,i);return ld(n,n.next),ld(t,t.next)}function TU(i,e){let t=e;const n=i.x,s=i.y;let a=-1/0,c;if(lm(i,t))return t;do{if(lm(i,t.next))return t.next;if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const v=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(v<=n&&v>a&&(a=v,c=t.x<t.next.x?t:t.next,v===n))return c}t=t.next}while(t!==e);if(!c)return null;const f=c,d=c.x,m=c.y;let y=1/0;t=c;do{if(n>=t.x&&t.x>=d&&n!==t.x&&W3(s<m?n:a,s,d,m,s<m?a:n,s,t.x,t.y)){const v=Math.abs(s-t.y)/(n-t.x);V0(t,i)&&(v<y||v===y&&(t.x>c.x||t.x===c.x&&AU(c,t)))&&(c=t,y=v)}t=t.next}while(t!==f);return c}function AU(i,e){return ts(i.prev,i,e.prev)<0&&ts(e.next,i,i.next)<0}function wU(i,e,t,n){let s=i;do s.z===0&&(s.z=dE(s.x,s.y,e,t,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,CU(s)}function CU(i){let e,t=1;do{let n=i,s;i=null;let a=null;for(e=0;n;){e++;let c=n,f=0;for(let m=0;m<t&&(f++,c=c.nextZ,!!c);m++);let d=t;for(;f>0||d>0&&c;)f!==0&&(d===0||!c||n.z<=c.z)?(s=n,n=n.nextZ,f--):(s=c,c=c.nextZ,d--),a?a.nextZ=s:i=s,s.prevZ=a,a=s;n=c}a.nextZ=null,t*=2}while(e>1);return i}function dE(i,e,t,n,s){return i=(i-t)*s|0,e=(e-n)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function RU(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function W3(i,e,t,n,s,a,c,f){return(s-c)*(e-f)>=(i-c)*(a-f)&&(i-c)*(n-f)>=(t-c)*(e-f)&&(t-c)*(a-f)>=(s-c)*(n-f)}function o0(i,e,t,n,s,a,c,f){return!(i===c&&e===f)&&W3(i,e,t,n,s,a,c,f)}function IU(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!DU(i,e)&&(V0(i,e)&&V0(e,i)&&NU(i,e)&&(ts(i.prev,i,e.prev)||ts(i,e.prev,e))||lm(i,e)&&ts(i.prev,i,i.next)>0&&ts(e.prev,e,e.next)>0)}function ts(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function lm(i,e){return i.x===e.x&&i.y===e.y}function q3(i,e,t,n){const s=y_(ts(i,e,t)),a=y_(ts(i,e,n)),c=y_(ts(t,n,i)),f=y_(ts(t,n,e));return!!(s!==a&&c!==f||s===0&&g_(i,t,e)||a===0&&g_(i,n,e)||c===0&&g_(t,i,n)||f===0&&g_(t,e,n))}function g_(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function y_(i){return i>0?1:i<0?-1:0}function DU(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&q3(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function V0(i,e){return ts(i.prev,i,i.next)<0?ts(i,e,i.next)>=0&&ts(i,i.prev,e)>=0:ts(i,e,i.prev)<0||ts(i,i.next,e)<0}function NU(i,e){let t=i,n=!1;const s=(i.x+e.x)/2,a=(i.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&s<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function X3(i,e){const t=pE(i.i,i.x,i.y),n=pE(e.i,e.x,e.y),s=i.next,a=e.prev;return i.next=e,e.prev=i,t.next=s,s.prev=t,n.next=t,t.prev=n,a.next=n,n.prev=a,n}function nw(i,e,t,n){const s=pE(i,e,t);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function k0(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function pE(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function PU(i,e,t,n){let s=0;for(let a=e,c=t-n;a<t;a+=n)s+=(i[c]-i[a])*(i[a+1]+i[c+1]),c=a;return s}class LU{static triangulate(e,t,n=2){return yU(e,t,n)}}class Sl{static area(e){const t=e.length;let n=0;for(let s=t-1,a=0;a<t;s=a++)n+=e[s].x*e[a].y-e[a].x*e[s].y;return n*.5}static isClockWise(e){return Sl.area(e)<0}static triangulateShape(e,t){const n=[],s=[],a=[];iw(e),sw(n,e);let c=e.length;t.forEach(iw);for(let d=0;d<t.length;d++)s.push(c),c+=t[d].length,sw(n,t[d]);const f=LU.triangulate(n,s);for(let d=0;d<f.length;d+=3)a.push(f.slice(d,d+3));return a}}function iw(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function sw(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class Ob extends vn{constructor(e=new td([new ke(.5,.5),new ke(-.5,.5),new ke(-.5,-.5),new ke(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,s=[],a=[];for(let f=0,d=e.length;f<d;f++){const m=e[f];c(m)}this.setAttribute("position",new Ct(s,3)),this.setAttribute("uv",new Ct(a,2)),this.computeVertexNormals();function c(f){const d=[],m=t.curveSegments!==void 0?t.curveSegments:12,y=t.steps!==void 0?t.steps:1,v=t.depth!==void 0?t.depth:1;let x=t.bevelEnabled!==void 0?t.bevelEnabled:!0,E=t.bevelThickness!==void 0?t.bevelThickness:.2,T=t.bevelSize!==void 0?t.bevelSize:E-.1,I=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const A=t.extrudePath,N=t.UVGenerator!==void 0?t.UVGenerator:OU;let O,U=!1,q,j,F,R;if(A){O=A.getSpacedPoints(y),U=!0,x=!1;const Ue=A.isCatmullRomCurve3?A.closed:!1;q=A.computeFrenetFrames(y,Ue),j=new J,F=new J,R=new J}x||(w=0,E=0,T=0,I=0);const P=f.extractPoints(m);let H=P.shape;const B=P.holes;if(!Sl.isClockWise(H)){H=H.reverse();for(let Ue=0,Ye=B.length;Ue<Ye;Ue++){const ze=B[Ue];Sl.isClockWise(ze)&&(B[Ue]=ze.reverse())}}function k(Ue){const ze=10000000000000001e-36;let ot=Ue[0];for(let te=1;te<=Ue.length;te++){const yt=te%Ue.length,it=Ue[yt],Rt=it.x-ot.x,st=it.y-ot.y,Q=Rt*Rt+st*st,G=Math.max(Math.abs(it.x),Math.abs(it.y),Math.abs(ot.x),Math.abs(ot.y)),oe=ze*G*G;if(Q<=oe){Ue.splice(yt,1),te--;continue}ot=it}}k(H),B.forEach(k);const ue=B.length,he=H;for(let Ue=0;Ue<ue;Ue++){const Ye=B[Ue];H=H.concat(Ye)}function ee(Ue,Ye,ze){return Ye||Gt("ExtrudeGeometry: vec does not exist"),Ue.clone().addScaledVector(Ye,ze)}const ie=H.length;function ye(Ue,Ye,ze){let ot,te,yt;const it=Ue.x-Ye.x,Rt=Ue.y-Ye.y,st=ze.x-Ue.x,Q=ze.y-Ue.y,G=it*it+Rt*Rt,oe=it*Q-Rt*st;if(Math.abs(oe)>Number.EPSILON){const Ae=Math.sqrt(G),Fe=Math.sqrt(st*st+Q*Q),we=Ye.x-Rt/Ae,vt=Ye.y+it/Ae,rt=ze.x-Q/Fe,It=ze.y+st/Fe,Ft=((rt-we)*Q-(It-vt)*st)/(it*Q-Rt*st);ot=we+it*Ft-Ue.x,te=vt+Rt*Ft-Ue.y;const We=ot*ot+te*te;if(We<=2)return new ke(ot,te);yt=Math.sqrt(We/2)}else{let Ae=!1;it>Number.EPSILON?st>Number.EPSILON&&(Ae=!0):it<-Number.EPSILON?st<-Number.EPSILON&&(Ae=!0):Math.sign(Rt)===Math.sign(Q)&&(Ae=!0),Ae?(ot=-Rt,te=it,yt=Math.sqrt(G)):(ot=it,te=Rt,yt=Math.sqrt(G/2))}return new ke(ot/yt,te/yt)}const be=[];for(let Ue=0,Ye=he.length,ze=Ye-1,ot=Ue+1;Ue<Ye;Ue++,ze++,ot++)ze===Ye&&(ze=0),ot===Ye&&(ot=0),be[Ue]=ye(he[Ue],he[ze],he[ot]);const Be=[];let Oe,Pe=be.concat();for(let Ue=0,Ye=ue;Ue<Ye;Ue++){const ze=B[Ue];Oe=[];for(let ot=0,te=ze.length,yt=te-1,it=ot+1;ot<te;ot++,yt++,it++)yt===te&&(yt=0),it===te&&(it=0),Oe[ot]=ye(ze[ot],ze[yt],ze[it]);Be.push(Oe),Pe=Pe.concat(Oe)}let $e;if(w===0)$e=Sl.triangulateShape(he,B);else{const Ue=[],Ye=[];for(let ze=0;ze<w;ze++){const ot=ze/w,te=E*Math.cos(ot*Math.PI/2),yt=T*Math.sin(ot*Math.PI/2)+I;for(let it=0,Rt=he.length;it<Rt;it++){const st=ee(he[it],be[it],yt);Tt(st.x,st.y,-te),ot===0&&Ue.push(st)}for(let it=0,Rt=ue;it<Rt;it++){const st=B[it];Oe=Be[it];const Q=[];for(let G=0,oe=st.length;G<oe;G++){const Ae=ee(st[G],Oe[G],yt);Tt(Ae.x,Ae.y,-te),ot===0&&Q.push(Ae)}ot===0&&Ye.push(Q)}}$e=Sl.triangulateShape(Ue,Ye)}const Mt=$e.length,Yt=T+I;for(let Ue=0;Ue<ie;Ue++){const Ye=x?ee(H[Ue],Pe[Ue],Yt):H[Ue];U?(F.copy(q.normals[0]).multiplyScalar(Ye.x),j.copy(q.binormals[0]).multiplyScalar(Ye.y),R.copy(O[0]).add(F).add(j),Tt(R.x,R.y,R.z)):Tt(Ye.x,Ye.y,0)}for(let Ue=1;Ue<=y;Ue++)for(let Ye=0;Ye<ie;Ye++){const ze=x?ee(H[Ye],Pe[Ye],Yt):H[Ye];U?(F.copy(q.normals[Ue]).multiplyScalar(ze.x),j.copy(q.binormals[Ue]).multiplyScalar(ze.y),R.copy(O[Ue]).add(F).add(j),Tt(R.x,R.y,R.z)):Tt(ze.x,ze.y,v/y*Ue)}for(let Ue=w-1;Ue>=0;Ue--){const Ye=Ue/w,ze=E*Math.cos(Ye*Math.PI/2),ot=T*Math.sin(Ye*Math.PI/2)+I;for(let te=0,yt=he.length;te<yt;te++){const it=ee(he[te],be[te],ot);Tt(it.x,it.y,v+ze)}for(let te=0,yt=B.length;te<yt;te++){const it=B[te];Oe=Be[te];for(let Rt=0,st=it.length;Rt<st;Rt++){const Q=ee(it[Rt],Oe[Rt],ot);U?Tt(Q.x,Q.y+O[y-1].y,O[y-1].x+ze):Tt(Q.x,Q.y,v+ze)}}}Ie(),tt();function Ie(){const Ue=s.length/3;if(x){let Ye=0,ze=ie*Ye;for(let ot=0;ot<Mt;ot++){const te=$e[ot];Lt(te[2]+ze,te[1]+ze,te[0]+ze)}Ye=y+w*2,ze=ie*Ye;for(let ot=0;ot<Mt;ot++){const te=$e[ot];Lt(te[0]+ze,te[1]+ze,te[2]+ze)}}else{for(let Ye=0;Ye<Mt;Ye++){const ze=$e[Ye];Lt(ze[2],ze[1],ze[0])}for(let Ye=0;Ye<Mt;Ye++){const ze=$e[Ye];Lt(ze[0]+ie*y,ze[1]+ie*y,ze[2]+ie*y)}}n.addGroup(Ue,s.length/3-Ue,0)}function tt(){const Ue=s.length/3;let Ye=0;nt(he,Ye),Ye+=he.length;for(let ze=0,ot=B.length;ze<ot;ze++){const te=B[ze];nt(te,Ye),Ye+=te.length}n.addGroup(Ue,s.length/3-Ue,1)}function nt(Ue,Ye){let ze=Ue.length;for(;--ze>=0;){const ot=ze;let te=ze-1;te<0&&(te=Ue.length-1);for(let yt=0,it=y+w*2;yt<it;yt++){const Rt=ie*yt,st=ie*(yt+1),Q=Ye+ot+Rt,G=Ye+te+Rt,oe=Ye+te+st,Ae=Ye+ot+st;Ht(Q,G,oe,Ae)}}}function Tt(Ue,Ye,ze){d.push(Ue),d.push(Ye),d.push(ze)}function Lt(Ue,Ye,ze){un(Ue),un(Ye),un(ze);const ot=s.length/3,te=N.generateTopUV(n,s,ot-3,ot-2,ot-1);zt(te[0]),zt(te[1]),zt(te[2])}function Ht(Ue,Ye,ze,ot){un(Ue),un(Ye),un(ot),un(Ye),un(ze),un(ot);const te=s.length/3,yt=N.generateSideWallUV(n,s,te-6,te-3,te-2,te-1);zt(yt[0]),zt(yt[1]),zt(yt[3]),zt(yt[1]),zt(yt[2]),zt(yt[3])}function un(Ue){s.push(d[Ue*3+0]),s.push(d[Ue*3+1]),s.push(d[Ue*3+2])}function zt(Ue){a.push(Ue.x),a.push(Ue.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return UU(t,n,e)}static fromJSON(e,t){const n=[];for(let a=0,c=e.shapes.length;a<c;a++){const f=t[e.shapes[a]];n.push(f)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new qx[s.type]().fromJSON(s)),new Ob(n,e.options)}}const OU={generateTopUV:function(i,e,t,n,s){const a=e[t*3],c=e[t*3+1],f=e[n*3],d=e[n*3+1],m=e[s*3],y=e[s*3+1];return[new ke(a,c),new ke(f,d),new ke(m,y)]},generateSideWallUV:function(i,e,t,n,s,a){const c=e[t*3],f=e[t*3+1],d=e[t*3+2],m=e[n*3],y=e[n*3+1],v=e[n*3+2],x=e[s*3],E=e[s*3+1],T=e[s*3+2],I=e[a*3],w=e[a*3+1],A=e[a*3+2];return Math.abs(f-y)<Math.abs(c-m)?[new ke(c,1-d),new ke(m,1-v),new ke(x,1-T),new ke(I,1-A)]:[new ke(f,1-d),new ke(y,1-v),new ke(E,1-T),new ke(w,1-A)]}};function UU(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,s=i.length;n<s;n++){const a=i[n];t.shapes.push(a.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Ub extends Gh{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,s=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,a,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ub(e.radius,e.detail)}}class zb extends vn{constructor(e=[new ke(0,-.5),new ke(.5,0),new ke(0,.5)],t=12,n=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:s},t=Math.floor(t),s=rn(s,0,Math.PI*2);const a=[],c=[],f=[],d=[],m=[],y=1/t,v=new J,x=new ke,E=new J,T=new J,I=new J;let w=0,A=0;for(let N=0;N<=e.length-1;N++)switch(N){case 0:w=e[N+1].x-e[N].x,A=e[N+1].y-e[N].y,E.x=A*1,E.y=-w,E.z=A*0,I.copy(E),E.normalize(),d.push(E.x,E.y,E.z);break;case e.length-1:d.push(I.x,I.y,I.z);break;default:w=e[N+1].x-e[N].x,A=e[N+1].y-e[N].y,E.x=A*1,E.y=-w,E.z=A*0,T.copy(E),E.x+=I.x,E.y+=I.y,E.z+=I.z,E.normalize(),d.push(E.x,E.y,E.z),I.copy(T)}for(let N=0;N<=t;N++){const O=n+N*y*s,U=Math.sin(O),q=Math.cos(O);for(let j=0;j<=e.length-1;j++){v.x=e[j].x*U,v.y=e[j].y,v.z=e[j].x*q,c.push(v.x,v.y,v.z),x.x=N/t,x.y=j/(e.length-1),f.push(x.x,x.y);const F=d[3*j+0]*U,R=d[3*j+1],P=d[3*j+0]*q;m.push(F,R,P)}}for(let N=0;N<t;N++)for(let O=0;O<e.length-1;O++){const U=O+N*e.length,q=U,j=U+e.length,F=U+e.length+1,R=U+1;a.push(q,j,R),a.push(F,R,j)}this.setIndex(a),this.setAttribute("position",new Ct(c,3)),this.setAttribute("uv",new Ct(f,2)),this.setAttribute("normal",new Ct(m,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zb(e.points,e.segments,e.phiStart,e.phiLength)}}class oy extends Gh{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new oy(e.radius,e.detail)}}class Mm extends vn{constructor(e=1,t=1,n=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:s};const a=e/2,c=t/2,f=Math.floor(n),d=Math.floor(s),m=f+1,y=d+1,v=e/f,x=t/d,E=[],T=[],I=[],w=[];for(let A=0;A<y;A++){const N=A*x-c;for(let O=0;O<m;O++){const U=O*v-a;T.push(U,-N,0),I.push(0,0,1),w.push(O/f),w.push(1-A/d)}}for(let A=0;A<d;A++)for(let N=0;N<f;N++){const O=N+m*A,U=N+m*(A+1),q=N+1+m*(A+1),j=N+1+m*A;E.push(O,U,j),E.push(U,q,j)}this.setIndex(E),this.setAttribute("position",new Ct(T,3)),this.setAttribute("normal",new Ct(I,3)),this.setAttribute("uv",new Ct(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mm(e.width,e.height,e.widthSegments,e.heightSegments)}}class Fb extends vn{constructor(e=.5,t=1,n=32,s=1,a=0,c=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:s,thetaStart:a,thetaLength:c},n=Math.max(3,n),s=Math.max(1,s);const f=[],d=[],m=[],y=[];let v=e;const x=(t-e)/s,E=new J,T=new ke;for(let I=0;I<=s;I++){for(let w=0;w<=n;w++){const A=a+w/n*c;E.x=v*Math.cos(A),E.y=v*Math.sin(A),d.push(E.x,E.y,E.z),m.push(0,0,1),T.x=(E.x/t+1)/2,T.y=(E.y/t+1)/2,y.push(T.x,T.y)}v+=x}for(let I=0;I<s;I++){const w=I*(n+1);for(let A=0;A<n;A++){const N=A+w,O=N,U=N+n+1,q=N+n+2,j=N+1;f.push(O,U,j),f.push(U,q,j)}}this.setIndex(f),this.setAttribute("position",new Ct(d,3)),this.setAttribute("normal",new Ct(m,3)),this.setAttribute("uv",new Ct(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fb(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Bb extends vn{constructor(e=new td([new ke(0,.5),new ke(-.5,-.5),new ke(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],s=[],a=[],c=[];let f=0,d=0;if(Array.isArray(e)===!1)m(e);else for(let y=0;y<e.length;y++)m(e[y]),this.addGroup(f,d,y),f+=d,d=0;this.setIndex(n),this.setAttribute("position",new Ct(s,3)),this.setAttribute("normal",new Ct(a,3)),this.setAttribute("uv",new Ct(c,2));function m(y){const v=s.length/3,x=y.extractPoints(t);let E=x.shape;const T=x.holes;Sl.isClockWise(E)===!1&&(E=E.reverse());for(let w=0,A=T.length;w<A;w++){const N=T[w];Sl.isClockWise(N)===!0&&(T[w]=N.reverse())}const I=Sl.triangulateShape(E,T);for(let w=0,A=T.length;w<A;w++){const N=T[w];E=E.concat(N)}for(let w=0,A=E.length;w<A;w++){const N=E[w];s.push(N.x,N.y,0),a.push(0,0,1),c.push(N.x,N.y)}for(let w=0,A=I.length;w<A;w++){const N=I[w],O=N[0]+v,U=N[1]+v,q=N[2]+v;n.push(O,U,q),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return zU(t,e)}static fromJSON(e,t){const n=[];for(let s=0,a=e.shapes.length;s<a;s++){const c=t[e.shapes[s]];n.push(c)}return new Bb(n,e.curveSegments)}}function zU(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const s=i[t];e.shapes.push(s.uuid)}else e.shapes.push(i.uuid);return e}class ly extends vn{constructor(e=1,t=32,n=16,s=0,a=Math.PI*2,c=0,f=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:s,phiLength:a,thetaStart:c,thetaLength:f},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(c+f,Math.PI);let m=0;const y=[],v=new J,x=new J,E=[],T=[],I=[],w=[];for(let A=0;A<=n;A++){const N=[],O=A/n;let U=0;A===0&&c===0?U=.5/t:A===n&&d===Math.PI&&(U=-.5/t);for(let q=0;q<=t;q++){const j=q/t;v.x=-e*Math.cos(s+j*a)*Math.sin(c+O*f),v.y=e*Math.cos(c+O*f),v.z=e*Math.sin(s+j*a)*Math.sin(c+O*f),T.push(v.x,v.y,v.z),x.copy(v).normalize(),I.push(x.x,x.y,x.z),w.push(j+U,1-O),N.push(m++)}y.push(N)}for(let A=0;A<n;A++)for(let N=0;N<t;N++){const O=y[A][N+1],U=y[A][N],q=y[A+1][N],j=y[A+1][N+1];(A!==0||c>0)&&E.push(O,U,j),(A!==n-1||d<Math.PI)&&E.push(U,q,j)}this.setIndex(E),this.setAttribute("position",new Ct(T,3)),this.setAttribute("normal",new Ct(I,3)),this.setAttribute("uv",new Ct(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ly(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Vb extends Gh{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Vb(e.radius,e.detail)}}class kb extends vn{constructor(e=1,t=.4,n=12,s=48,a=Math.PI*2,c=0,f=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:s,arc:a,thetaStart:c,thetaLength:f},n=Math.floor(n),s=Math.floor(s);const d=[],m=[],y=[],v=[],x=new J,E=new J,T=new J;for(let I=0;I<=n;I++){const w=c+I/n*f;for(let A=0;A<=s;A++){const N=A/s*a;E.x=(e+t*Math.cos(w))*Math.cos(N),E.y=(e+t*Math.cos(w))*Math.sin(N),E.z=t*Math.sin(w),m.push(E.x,E.y,E.z),x.x=e*Math.cos(N),x.y=e*Math.sin(N),T.subVectors(E,x).normalize(),y.push(T.x,T.y,T.z),v.push(A/s),v.push(I/n)}}for(let I=1;I<=n;I++)for(let w=1;w<=s;w++){const A=(s+1)*I+w-1,N=(s+1)*(I-1)+w-1,O=(s+1)*(I-1)+w,U=(s+1)*I+w;d.push(A,N,U),d.push(N,O,U)}this.setIndex(d),this.setAttribute("position",new Ct(m,3)),this.setAttribute("normal",new Ct(y,3)),this.setAttribute("uv",new Ct(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kb(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Hb extends vn{constructor(e=1,t=.4,n=64,s=8,a=2,c=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:s,p:a,q:c},n=Math.floor(n),s=Math.floor(s);const f=[],d=[],m=[],y=[],v=new J,x=new J,E=new J,T=new J,I=new J,w=new J,A=new J;for(let O=0;O<=n;++O){const U=O/n*a*Math.PI*2;N(U,a,c,e,E),N(U+.01,a,c,e,T),w.subVectors(T,E),A.addVectors(T,E),I.crossVectors(w,A),A.crossVectors(I,w),I.normalize(),A.normalize();for(let q=0;q<=s;++q){const j=q/s*Math.PI*2,F=-t*Math.cos(j),R=t*Math.sin(j);v.x=E.x+(F*A.x+R*I.x),v.y=E.y+(F*A.y+R*I.y),v.z=E.z+(F*A.z+R*I.z),d.push(v.x,v.y,v.z),x.subVectors(v,E).normalize(),m.push(x.x,x.y,x.z),y.push(O/n),y.push(q/s)}}for(let O=1;O<=n;O++)for(let U=1;U<=s;U++){const q=(s+1)*(O-1)+(U-1),j=(s+1)*O+(U-1),F=(s+1)*O+U,R=(s+1)*(O-1)+U;f.push(q,j,R),f.push(j,F,R)}this.setIndex(f),this.setAttribute("position",new Ct(d,3)),this.setAttribute("normal",new Ct(m,3)),this.setAttribute("uv",new Ct(y,2));function N(O,U,q,j,F){const R=Math.cos(O),P=Math.sin(O),H=q/U*O,B=Math.cos(H);F.x=j*(2+B)*.5*R,F.y=j*(2+B)*P*.5,F.z=j*Math.sin(H)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hb(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Gb extends vn{constructor(e=new IM(new J(-1,-1,0),new J(-1,1,0),new J(1,1,0)),t=64,n=1,s=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:s,closed:a};const c=e.computeFrenetFrames(t,a);this.tangents=c.tangents,this.normals=c.normals,this.binormals=c.binormals;const f=new J,d=new J,m=new ke;let y=new J;const v=[],x=[],E=[],T=[];I(),this.setIndex(T),this.setAttribute("position",new Ct(v,3)),this.setAttribute("normal",new Ct(x,3)),this.setAttribute("uv",new Ct(E,2));function I(){for(let O=0;O<t;O++)w(O);w(a===!1?t:0),N(),A()}function w(O){y=e.getPointAt(O/t,y);const U=c.normals[O],q=c.binormals[O];for(let j=0;j<=s;j++){const F=j/s*Math.PI*2,R=Math.sin(F),P=-Math.cos(F);d.x=P*U.x+R*q.x,d.y=P*U.y+R*q.y,d.z=P*U.z+R*q.z,d.normalize(),x.push(d.x,d.y,d.z),f.x=y.x+n*d.x,f.y=y.y+n*d.y,f.z=y.z+n*d.z,v.push(f.x,f.y,f.z)}}function A(){for(let O=1;O<=t;O++)for(let U=1;U<=s;U++){const q=(s+1)*(O-1)+(U-1),j=(s+1)*O+(U-1),F=(s+1)*O+U,R=(s+1)*(O-1)+U;T.push(q,j,R),T.push(j,F,R)}}function N(){for(let O=0;O<=t;O++)for(let U=0;U<=s;U++)m.x=O/t,m.y=U/s,E.push(m.x,m.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Gb(new qx[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class NM extends vn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,s=new J,a=new J;if(e.index!==null){const c=e.attributes.position,f=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:f.count,materialIndex:0}]);for(let m=0,y=d.length;m<y;++m){const v=d[m],x=v.start,E=v.count;for(let T=x,I=x+E;T<I;T+=3)for(let w=0;w<3;w++){const A=f.getX(T+w),N=f.getX(T+(w+1)%3);s.fromBufferAttribute(c,A),a.fromBufferAttribute(c,N),rw(s,a,n)===!0&&(t.push(s.x,s.y,s.z),t.push(a.x,a.y,a.z))}}}else{const c=e.attributes.position;for(let f=0,d=c.count/3;f<d;f++)for(let m=0;m<3;m++){const y=3*f+m,v=3*f+(m+1)%3;s.fromBufferAttribute(c,y),a.fromBufferAttribute(c,v),rw(s,a,n)===!0&&(t.push(s.x,s.y,s.z),t.push(a.x,a.y,a.z))}}this.setAttribute("position",new Ct(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function rw(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(s)===!0?!1:(t.add(n),t.add(s),!0)}var aw=Object.freeze({__proto__:null,BoxGeometry:pd,CapsuleGeometry:Db,CircleGeometry:Nb,ConeGeometry:ay,CylinderGeometry:ry,DodecahedronGeometry:Pb,EdgesGeometry:F3,ExtrudeGeometry:Ob,IcosahedronGeometry:Ub,LatheGeometry:zb,OctahedronGeometry:oy,PlaneGeometry:Mm,PolyhedronGeometry:Gh,RingGeometry:Fb,ShapeGeometry:Bb,SphereGeometry:ly,TetrahedronGeometry:Vb,TorusGeometry:kb,TorusKnotGeometry:Hb,TubeGeometry:Gb,WireframeGeometry:NM});class Y3 extends Wr{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new wt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}function cm(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const s=i[t][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(St("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=s.clone():Array.isArray(s)?e[t][n]=s.slice():e[t][n]=s}}return e}function la(i){const e={};for(let t=0;t<i.length;t++){const n=cm(i[t]);for(const s in n)e[s]=n[s]}return e}function FU(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function Z3(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Gn.workingColorSpace}const Yx={clone:cm,merge:la};var BU=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,VU=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ga extends Wr{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=BU,this.fragmentShader=VU,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cm(e.uniforms),this.uniformsGroups=FU(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const c=this.uniforms[s].value;c&&c.isTexture?t.uniforms[s]={type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?t.uniforms[s]={type:"c",value:c.getHex()}:c&&c.isVector2?t.uniforms[s]={type:"v2",value:c.toArray()}:c&&c.isVector3?t.uniforms[s]={type:"v3",value:c.toArray()}:c&&c.isVector4?t.uniforms[s]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?t.uniforms[s]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?t.uniforms[s]={type:"m4",value:c.toArray()}:t.uniforms[s]={value:c}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const s in this.extensions)this.extensions[s]===!0&&(n[s]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class PM extends Ga{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class LM extends Wr{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new wt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kh,this.normalScale=new ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new uo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class K3 extends LM{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ke(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return rn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new wt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new wt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new wt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Q3 extends Wr{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new wt(16777215),this.specular=new wt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kh,this.normalScale=new ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new uo,this.combine=ty,this.reflectivity=1,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $3 extends Wr{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new wt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kh,this.normalScale=new ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class J3 extends Wr{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kh,this.normalScale=new ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class eI extends Wr{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new wt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kh,this.normalScale=new ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new uo,this.combine=ty,this.reflectivity=1,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class OM extends Wr{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=p3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class UM extends Wr{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class tI extends Wr{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new wt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kh,this.normalScale=new ke(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class nI extends da{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Qf(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function iI(i){function e(s,a){return i[s]-i[a]}const t=i.length,n=new Array(t);for(let s=0;s!==t;++s)n[s]=s;return n.sort(e),n}function mE(i,e,t){const n=i.length,s=new i.constructor(n);for(let a=0,c=0;c!==n;++a){const f=t[a]*e;for(let d=0;d!==e;++d)s[c++]=i[f+d]}return s}function zM(i,e,t,n){let s=1,a=i[0];for(;a!==void 0&&a[n]===void 0;)a=i[s++];if(a===void 0)return;let c=a[n];if(c!==void 0)if(Array.isArray(c))do c=a[n],c!==void 0&&(e.push(a.time),t.push(...c)),a=i[s++];while(a!==void 0);else if(c.toArray!==void 0)do c=a[n],c!==void 0&&(e.push(a.time),c.toArray(t,t.length)),a=i[s++];while(a!==void 0);else do c=a[n],c!==void 0&&(e.push(a.time),t.push(c)),a=i[s++];while(a!==void 0)}function kU(i,e,t,n,s=30){const a=i.clone();a.name=e;const c=[];for(let d=0;d<a.tracks.length;++d){const m=a.tracks[d],y=m.getValueSize(),v=[],x=[];for(let E=0;E<m.times.length;++E){const T=m.times[E]*s;if(!(T<t||T>=n)){v.push(m.times[E]);for(let I=0;I<y;++I)x.push(m.values[E*y+I])}}v.length!==0&&(m.times=Qf(v,m.times.constructor),m.values=Qf(x,m.values.constructor),c.push(m))}a.tracks=c;let f=1/0;for(let d=0;d<a.tracks.length;++d)f>a.tracks[d].times[0]&&(f=a.tracks[d].times[0]);for(let d=0;d<a.tracks.length;++d)a.tracks[d].shift(-1*f);return a.resetDuration(),a}function HU(i,e=0,t=i,n=30){n<=0&&(n=30);const s=t.tracks.length,a=e/n;for(let c=0;c<s;++c){const f=t.tracks[c],d=f.ValueTypeName;if(d==="bool"||d==="string")continue;const m=i.tracks.find(function(A){return A.name===f.name&&A.ValueTypeName===d});if(m===void 0)continue;let y=0;const v=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=v/3);let x=0;const E=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(x=E/3);const T=f.times.length-1;let I;if(a<=f.times[0]){const A=y,N=v-y;I=f.values.slice(A,N)}else if(a>=f.times[T]){const A=T*v+y,N=A+v-y;I=f.values.slice(A,N)}else{const A=f.createInterpolant(),N=y,O=v-y;A.evaluate(a),I=A.resultBuffer.slice(N,O)}d==="quaternion"&&new br().fromArray(I).normalize().conjugate().toArray(I);const w=m.times.length;for(let A=0;A<w;++A){const N=A*E+x;if(d==="quaternion")br.multiplyQuaternionsFlat(m.values,N,I,0,m.values,N);else{const O=E-x*2;for(let U=0;U<O;++U)m.values[N+U]-=I[U]}}}return i.blendMode=gM,i}class GU{static convertArray(e,t){return Qf(e,t)}static isTypedArray(e){return S3(e)}static getKeyframeOrder(e){return iI(e)}static sortedArray(e,t,n){return mE(e,t,n)}static flattenJSON(e,t,n,s){zM(e,t,n,s)}static subclip(e,t,n,s,a=30){return kU(e,t,n,s,a)}static makeClipAdditive(e,t=0,n=e,s=30){return HU(e,t,n,s)}}class Tm{constructor(e,t,n,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,s=t[n],a=t[n-1];e:{t:{let c;n:{i:if(!(e<s)){for(let f=n+2;;){if(s===void 0){if(e<a)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===f)break;if(a=s,s=t[++n],e<s)break t}c=t.length;break n}if(!(e>=a)){const f=t[1];e<f&&(n=2,a=f);for(let d=n-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(s=a,a=t[--n-1],e>=a)break t}c=n,n=0;break n}break e}for(;n<c;){const f=n+c>>>1;e<t[f]?c=f:n=f+1}if(s=t[n],a=t[n-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,s)}return this.interpolate_(n,a,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,s=this.valueSize,a=e*s;for(let c=0;c!==s;++c)t[c]=n[a+c];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class sI extends Tm{constructor(e,t,n,s){super(e,t,n,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Zf,endingEnd:Zf}}intervalChanged_(e,t,n){const s=this.parameterPositions;let a=e-2,c=e+1,f=s[a],d=s[c];if(f===void 0)switch(this.getSettings_().endingStart){case Kf:a=e,f=2*t-n;break;case P0:a=s.length-2,f=t+s[a]-s[a+1];break;default:a=e,f=n}if(d===void 0)switch(this.getSettings_().endingEnd){case Kf:c=e,d=2*n-t;break;case P0:c=1,d=n+s[1]-s[0];break;default:c=e-1,d=t}const m=(n-t)*.5,y=this.valueSize;this._weightPrev=m/(t-f),this._weightNext=m/(d-n),this._offsetPrev=a*y,this._offsetNext=c*y}interpolate_(e,t,n,s){const a=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=d-f,y=this._offsetPrev,v=this._offsetNext,x=this._weightPrev,E=this._weightNext,T=(n-t)/(s-t),I=T*T,w=I*T,A=-x*w+2*x*I-x*T,N=(1+x)*w+(-1.5-2*x)*I+(-.5+x)*T+1,O=(-1-E)*w+(1.5+E)*I+.5*T,U=E*w-E*I;for(let q=0;q!==f;++q)a[q]=A*c[y+q]+N*c[m+q]+O*c[d+q]+U*c[v+q];return a}}class FM extends Tm{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const a=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=d-f,y=(n-t)/(s-t),v=1-y;for(let x=0;x!==f;++x)a[x]=c[m+x]*v+c[d+x]*y;return a}}class rI extends Tm{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class aI extends Tm{interpolate_(e,t,n,s){const a=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=d-f,y=this.settings||this.DefaultSettings_,v=y.inTangents,x=y.outTangents;if(!v||!x){const I=(n-t)/(s-t),w=1-I;for(let A=0;A!==f;++A)a[A]=c[m+A]*w+c[d+A]*I;return a}const E=f*2,T=e-1;for(let I=0;I!==f;++I){const w=c[m+I],A=c[d+I],N=T*E+I*2,O=x[N],U=x[N+1],q=e*E+I*2,j=v[q],F=v[q+1];let R=(n-t)/(s-t),P,H,B,X,k;for(let ue=0;ue<8;ue++){P=R*R,H=P*R,B=1-R,X=B*B,k=X*B;const ee=k*t+3*X*R*O+3*B*P*j+H*s-n;if(Math.abs(ee)<1e-10)break;const ie=3*X*(O-t)+6*B*R*(j-O)+3*P*(s-j);if(Math.abs(ie)<1e-10)break;R=R-ee/ie,R=Math.max(0,Math.min(1,R))}a[I]=k*w+3*X*R*U+3*B*P*F+H*A}return a}}class qo{constructor(e,t,n,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Qf(t,this.TimeBufferType),this.values=Qf(n,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Qf(e.times,Array),values:Qf(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(n.interpolation=s)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new rI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new FM(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new sI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodBezier(e){const t=new aI(this.times,this.values,this.getValueSize(),e);return this.settings&&(t.settings=this.settings),t}setInterpolation(e){let t;switch(e){case N0:t=this.InterpolantFactoryMethodDiscrete;break;case Gx:t=this.InterpolantFactoryMethodLinear;break;case H_:t=this.InterpolantFactoryMethodSmooth;break;case cE:t=this.InterpolantFactoryMethodBezier;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return St("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return N0;case this.InterpolantFactoryMethodLinear:return Gx;case this.InterpolantFactoryMethodSmooth:return H_;case this.InterpolantFactoryMethodBezier:return cE}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,s=t.length;n!==s;++n)t[n]*=e}return this}trim(e,t){const n=this.times,s=n.length;let a=0,c=s-1;for(;a!==s&&n[a]<e;)++a;for(;c!==-1&&n[c]>t;)--c;if(++c,a!==0||c!==s){a>=c&&(c=Math.max(c,1),a=c-1);const f=this.getValueSize();this.times=n.slice(a,c),this.values=this.values.slice(a*f,c*f)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(Gt("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,s=this.values,a=n.length;a===0&&(Gt("KeyframeTrack: Track is empty.",this),e=!1);let c=null;for(let f=0;f!==a;f++){const d=n[f];if(typeof d=="number"&&isNaN(d)){Gt("KeyframeTrack: Time is not a valid number.",this,f,d),e=!1;break}if(c!==null&&c>d){Gt("KeyframeTrack: Out of order keys.",this,f,d,c),e=!1;break}c=d}if(s!==void 0&&S3(s))for(let f=0,d=s.length;f!==d;++f){const m=s[f];if(isNaN(m)){Gt("KeyframeTrack: Value is not a valid number.",this,f,m),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),s=this.getInterpolation()===H_,a=e.length-1;let c=1;for(let f=1;f<a;++f){let d=!1;const m=e[f],y=e[f+1];if(m!==y&&(f!==1||m!==e[0]))if(s)d=!0;else{const v=f*n,x=v-n,E=v+n;for(let T=0;T!==n;++T){const I=t[v+T];if(I!==t[x+T]||I!==t[E+T]){d=!0;break}}}if(d){if(f!==c){e[c]=e[f];const v=f*n,x=c*n;for(let E=0;E!==n;++E)t[x+E]=t[v+E]}++c}}if(a>0){e[c]=e[a];for(let f=a*n,d=c*n,m=0;m!==n;++m)t[d+m]=t[f+m];++c}return c!==e.length?(this.times=e.slice(0,c),this.values=t.slice(0,c*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,s=new n(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}qo.prototype.ValueTypeName="";qo.prototype.TimeBufferType=Float32Array;qo.prototype.ValueBufferType=Float32Array;qo.prototype.DefaultInterpolation=Gx;class md extends qo{constructor(e,t,n){super(e,t,n)}}md.prototype.ValueTypeName="bool";md.prototype.ValueBufferType=Array;md.prototype.DefaultInterpolation=N0;md.prototype.InterpolantFactoryMethodLinear=void 0;md.prototype.InterpolantFactoryMethodSmooth=void 0;class BM extends qo{constructor(e,t,n,s){super(e,t,n,s)}}BM.prototype.ValueTypeName="color";class H0 extends qo{constructor(e,t,n,s){super(e,t,n,s)}}H0.prototype.ValueTypeName="number";class oI extends Tm{constructor(e,t,n,s){super(e,t,n,s)}interpolate_(e,t,n,s){const a=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=(n-t)/(s-t);let m=e*f;for(let y=m+f;m!==y;m+=4)br.slerpFlat(a,0,c,m-f,c,m,d);return a}}class cy extends qo{constructor(e,t,n,s){super(e,t,n,s)}InterpolantFactoryMethodLinear(e){return new oI(this.times,this.values,this.getValueSize(),e)}}cy.prototype.ValueTypeName="quaternion";cy.prototype.InterpolantFactoryMethodSmooth=void 0;class gd extends qo{constructor(e,t,n){super(e,t,n)}}gd.prototype.ValueTypeName="string";gd.prototype.ValueBufferType=Array;gd.prototype.DefaultInterpolation=N0;gd.prototype.InterpolantFactoryMethodLinear=void 0;gd.prototype.InterpolantFactoryMethodSmooth=void 0;class G0 extends qo{constructor(e,t,n,s){super(e,t,n,s)}}G0.prototype.ValueTypeName="vector";class j0{constructor(e="",t=-1,n=[],s=xb){this.name=e,this.tracks=n,this.duration=t,this.blendMode=s,this.uuid=lo(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,s=1/(e.fps||1);for(let c=0,f=n.length;c!==f;++c)t.push(WU(n[c]).scale(s));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a.userData=JSON.parse(e.userData||"{}"),a}static toJSON(e){const t=[],n=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let a=0,c=n.length;a!==c;++a)t.push(qo.toJSON(n[a]));return s}static CreateFromMorphTargetSequence(e,t,n,s){const a=t.length,c=[];for(let f=0;f<a;f++){let d=[],m=[];d.push((f+a-1)%a,f,(f+1)%a),m.push(0,1,0);const y=iI(d);d=mE(d,1,y),m=mE(m,1,y),!s&&d[0]===0&&(d.push(a),m.push(m[0])),c.push(new H0(".morphTargetInfluences["+t[f].name+"]",d,m).scale(1/n))}return new this(e,-1,c)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const s=e;n=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<n.length;s++)if(n[s].name===t)return n[s];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const s={},a=/^([\w-]*?)([\d]+)$/;for(let f=0,d=e.length;f<d;f++){const m=e[f],y=m.name.match(a);if(y&&y.length>1){const v=y[1];let x=s[v];x||(s[v]=x=[]),x.push(m)}}const c=[];for(const f in s)c.push(this.CreateFromMorphTargetSequence(f,s[f],t,n));return c}static parseAnimation(e,t){if(St("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Gt("AnimationClip: No animation in JSONLoader data."),null;const n=function(v,x,E,T,I){if(E.length!==0){const w=[],A=[];zM(E,w,A,T),w.length!==0&&I.push(new v(x,w,A))}},s=[],a=e.name||"default",c=e.fps||30,f=e.blendMode;let d=e.length||-1;const m=e.hierarchy||[];for(let v=0;v<m.length;v++){const x=m[v].keys;if(!(!x||x.length===0))if(x[0].morphTargets){const E={};let T;for(T=0;T<x.length;T++)if(x[T].morphTargets)for(let I=0;I<x[T].morphTargets.length;I++)E[x[T].morphTargets[I]]=-1;for(const I in E){const w=[],A=[];for(let N=0;N!==x[T].morphTargets.length;++N){const O=x[T];w.push(O.time),A.push(O.morphTarget===I?1:0)}s.push(new H0(".morphTargetInfluence["+I+"]",w,A))}d=E.length*c}else{const E=".bones["+t[v].name+"]";n(G0,E+".position",x,"pos",s),n(cy,E+".quaternion",x,"rot",s),n(G0,E+".scale",x,"scl",s)}}return s.length===0?null:new this(a,d,s,f)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,s=e.length;n!==s;++n){const a=this.tracks[n];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function jU(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return H0;case"vector":case"vector2":case"vector3":case"vector4":return G0;case"color":return BM;case"quaternion":return cy;case"bool":case"boolean":return md;case"string":return gd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function WU(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=jU(i.type);if(i.times===void 0){const t=[],n=[];zM(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const yc={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(ow(i)||(this.files[i]=e))},get:function(i){if(this.enabled!==!1&&!ow(i))return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};function ow(i){try{const e=i.slice(i.indexOf(":")+1);return new URL(e).protocol==="blob:"}catch{return!1}}class VM{constructor(e,t,n){const s=this;let a=!1,c=0,f=0,d;const m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(y){f++,a===!1&&s.onStart!==void 0&&s.onStart(y,c,f),a=!0},this.itemEnd=function(y){c++,s.onProgress!==void 0&&s.onProgress(y,c,f),c===f&&(a=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(y){s.onError!==void 0&&s.onError(y)},this.resolveURL=function(y){return d?d(y):y},this.setURLModifier=function(y){return d=y,this},this.addHandler=function(y,v){return m.push(y,v),this},this.removeHandler=function(y){const v=m.indexOf(y);return v!==-1&&m.splice(v,2),this},this.getHandler=function(y){for(let v=0,x=m.length;v<x;v+=2){const E=m[v],T=m[v+1];if(E.global&&(E.lastIndex=0),E.test(y))return T}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const lI=new VM;class ja{constructor(e){this.manager=e!==void 0?e:lI,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}load(){}loadAsync(e,t){const n=this;return new Promise(function(s,a){n.load(e,s,t,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}ja.DEFAULT_MATERIAL_NAME="__DEFAULT";const fu={};class qU extends Error{constructor(e,t){super(e),this.response=t}}class _u extends ja{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=yc.get(`file:${e}`);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(fu[e]!==void 0){fu[e].push({onLoad:t,onProgress:n,onError:s});return}fu[e]=[],fu[e].push({onLoad:t,onProgress:n,onError:s});const c=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),f=this.mimeType,d=this.responseType;fetch(c).then(m=>{if(m.status===200||m.status===0){if(m.status===0&&St("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||m.body===void 0||m.body.getReader===void 0)return m;const y=fu[e],v=m.body.getReader(),x=m.headers.get("X-File-Size")||m.headers.get("Content-Length"),E=x?parseInt(x):0,T=E!==0;let I=0;const w=new ReadableStream({start(A){N();function N(){v.read().then(({done:O,value:U})=>{if(O)A.close();else{I+=U.byteLength;const q=new ProgressEvent("progress",{lengthComputable:T,loaded:I,total:E});for(let j=0,F=y.length;j<F;j++){const R=y[j];R.onProgress&&R.onProgress(q)}A.enqueue(U),N()}},O=>{A.error(O)})}}});return new Response(w)}else throw new qU(`fetch for "${m.url}" responded with ${m.status}: ${m.statusText}`,m)}).then(m=>{switch(d){case"arraybuffer":return m.arrayBuffer();case"blob":return m.blob();case"document":return m.text().then(y=>new DOMParser().parseFromString(y,f));case"json":return m.json();default:if(f==="")return m.text();{const v=/charset="?([^;"\s]*)"?/i.exec(f),x=v&&v[1]?v[1].toLowerCase():void 0,E=new TextDecoder(x);return m.arrayBuffer().then(T=>E.decode(T))}}}).then(m=>{yc.add(`file:${e}`,m);const y=fu[e];delete fu[e];for(let v=0,x=y.length;v<x;v++){const E=y[v];E.onLoad&&E.onLoad(m)}}).catch(m=>{const y=fu[e];if(y===void 0)throw this.manager.itemError(e),m;delete fu[e];for(let v=0,x=y.length;v<x;v++){const E=y[v];E.onError&&E.onError(m)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class XU extends ja{constructor(e){super(e)}load(e,t,n,s){const a=this,c=new _u(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(f){try{t(a.parse(JSON.parse(f)))}catch(d){s?s(d):Gt(d),a.manager.itemError(e)}},n,s)}parse(e){const t=[];for(let n=0;n<e.length;n++){const s=j0.parse(e[n]);t.push(s)}return t}}class YU extends ja{constructor(e){super(e)}load(e,t,n,s){const a=this,c=[],f=new Ib,d=new _u(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(a.withCredentials);let m=0;function y(v){d.load(e[v],function(x){const E=a.parse(x,!0);c[v]={width:E.width,height:E.height,format:E.format,mipmaps:E.mipmaps},m+=1,m===6&&(E.mipmapCount===1&&(f.minFilter=zi),f.image=c,f.format=E.format,f.needsUpdate=!0,t&&t(f))},n,s)}if(Array.isArray(e))for(let v=0,x=e.length;v<x;++v)y(v);else d.load(e,function(v){const x=a.parse(v,!0);if(x.isCubemap){const E=x.mipmaps.length/x.mipmapCount;for(let T=0;T<E;T++){c[T]={mipmaps:[]};for(let I=0;I<x.mipmapCount;I++)c[T].mipmaps.push(x.mipmaps[T*x.mipmapCount+I]),c[T].format=x.format,c[T].width=x.width,c[T].height=x.height}f.image=c}else f.image.width=x.width,f.image.height=x.height,f.mipmaps=x.mipmaps;x.mipmapCount===1&&(f.minFilter=zi),f.format=x.format,f.needsUpdate=!0,t&&t(f)},n,s);return f}}const Cp=new WeakMap;class W0 extends ja{constructor(e){super(e)}load(e,t,n,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=yc.get(`image:${e}`);if(c!==void 0){if(c.complete===!0)a.manager.itemStart(e),setTimeout(function(){t&&t(c),a.manager.itemEnd(e)},0);else{let v=Cp.get(c);v===void 0&&(v=[],Cp.set(c,v)),v.push({onLoad:t,onError:s})}return c}const f=U0("img");function d(){y(),t&&t(this);const v=Cp.get(this)||[];for(let x=0;x<v.length;x++){const E=v[x];E.onLoad&&E.onLoad(this)}Cp.delete(this),a.manager.itemEnd(e)}function m(v){y(),s&&s(v),yc.remove(`image:${e}`);const x=Cp.get(this)||[];for(let E=0;E<x.length;E++){const T=x[E];T.onError&&T.onError(v)}Cp.delete(this),a.manager.itemError(e),a.manager.itemEnd(e)}function y(){f.removeEventListener("load",d,!1),f.removeEventListener("error",m,!1)}return f.addEventListener("load",d,!1),f.addEventListener("error",m,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),yc.add(`image:${e}`,f),a.manager.itemStart(e),f.src=e,f}}class ZU extends ja{constructor(e){super(e)}load(e,t,n,s){const a=new sy;a.colorSpace=kr;const c=new W0(this.manager);c.setCrossOrigin(this.crossOrigin),c.setPath(this.path);let f=0;function d(m){c.load(e[m],function(y){a.images[m]=y,f++,f===6&&(a.needsUpdate=!0,t&&t(a))},void 0,s)}for(let m=0;m<e.length;++m)d(m);return a}}class KU extends ja{constructor(e){super(e)}load(e,t,n,s){const a=this,c=new El,f=new _u(this.manager);return f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(a.withCredentials),f.load(e,function(d){let m;try{m=a.parse(d)}catch(y){if(s!==void 0)s(y);else{y(y);return}}m.image!==void 0?c.image=m.image:m.data!==void 0&&(c.image.width=m.width,c.image.height=m.height,c.image.data=m.data),c.wrapS=m.wrapS!==void 0?m.wrapS:Ha,c.wrapT=m.wrapT!==void 0?m.wrapT:Ha,c.magFilter=m.magFilter!==void 0?m.magFilter:zi,c.minFilter=m.minFilter!==void 0?m.minFilter:zi,c.anisotropy=m.anisotropy!==void 0?m.anisotropy:1,m.colorSpace!==void 0&&(c.colorSpace=m.colorSpace),m.flipY!==void 0&&(c.flipY=m.flipY),m.format!==void 0&&(c.format=m.format),m.type!==void 0&&(c.type=m.type),m.mipmaps!==void 0&&(c.mipmaps=m.mipmaps,c.minFilter=gc),m.mipmapCount===1&&(c.minFilter=zi),m.generateMipmaps!==void 0&&(c.generateMipmaps=m.generateMipmaps),c.needsUpdate=!0,t&&t(c,m)},n,s),c}}class QU extends ja{constructor(e){super(e)}load(e,t,n,s){const a=new ls,c=new W0(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(f){a.image=f,a.needsUpdate=!0,t!==void 0&&t(a)},n,s),a}}class jh extends ei{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new wt(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class cI extends jh{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ei.DEFAULT_UP),this.updateMatrix(),this.groundColor=new wt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const S1=new on,lw=new J,cw=new J;class kM{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.biasNode=null,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ke(512,512),this.mapType=ca,this.map=null,this.mapPass=null,this.matrix=new on,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Em,this._frameExtents=new ke(1,1),this._viewportCount=1,this._viewports=[new Jn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;lw.setFromMatrixPosition(e.matrixWorld),t.position.copy(lw),cw.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(cw),t.updateMatrixWorld(),S1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(S1,t.coordinateSystem,t.reversedDepth),t.coordinateSystem===od||t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(S1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this.biasNode=e.biasNode,this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const v_=new J,__=new br,lc=new J;class jb extends ei{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new on,this.projectionMatrix=new on,this.projectionMatrixInverse=new on,this.coordinateSystem=ao,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorld.decompose(v_,__,lc),lc.x===1&&lc.y===1&&lc.z===1?this.matrixWorldInverse.copy(this.matrixWorld).invert():this.matrixWorldInverse.compose(v_,__,lc.set(1,1,1)).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorld.decompose(v_,__,lc),lc.x===1&&lc.y===1&&lc.z===1?this.matrixWorldInverse.copy(this.matrixWorld).invert():this.matrixWorldInverse.compose(v_,__,lc.set(1,1,1)).invert()}clone(){return new this.constructor().copy(this)}}const yh=new J,uw=new ke,hw=new ke;class ys extends jb{constructor(e=50,t=1,n=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=sm*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ed*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return sm*2*Math.atan(Math.tan(ed*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){yh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(yh.x,yh.y).multiplyScalar(-e/yh.z),yh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(yh.x,yh.y).multiplyScalar(-e/yh.z)}getViewSize(e,t){return this.getViewBounds(e,uw,hw),t.subVectors(hw,uw)}setViewOffset(e,t,n,s,a,c){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(ed*.5*this.fov)/this.zoom,n=2*t,s=this.aspect*n,a=-.5*s;const c=this.view;if(this.view!==null&&this.view.enabled){const d=c.fullWidth,m=c.fullHeight;a+=c.offsetX*s/d,t-=c.offsetY*n/m,s*=c.width/d,n*=c.height/m}const f=this.filmOffset;f!==0&&(a+=e*f/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+s,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class $U extends kM{constructor(){super(new ys(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=sm*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height*this.aspect,a=e.distance||t.far;(n!==t.fov||s!==t.aspect||a!==t.far)&&(t.fov=n,t.aspect=s,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class uI extends jh{constructor(e,t,n=0,s=Math.PI/3,a=0,c=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ei.DEFAULT_UP),this.updateMatrix(),this.target=new ei,this.distance=n,this.angle=s,this.penumbra=a,this.decay=c,this.map=null,this.shadow=new $U}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class JU extends kM{constructor(){super(new ys(90,1,.5,500)),this.isPointLightShadow=!0}}class hI extends jh{constructor(e,t,n=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=s,this.shadow=new JU}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class yu extends jb{constructor(e=-1,t=1,n=1,s=-1,a=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=s,this.near=a,this.far=c,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,s,a,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=s,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let a=n-e,c=n+e,f=s+t,d=s-t;if(this.view!==null&&this.view.enabled){const m=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=m*this.view.offsetX,c=a+m*this.view.width,f-=y*this.view.offsetY,d=f-y*this.view.height}this.projectionMatrix.makeOrthographic(a,c,f,d,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class e4 extends kM{constructor(){super(new yu(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class fI extends jh{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ei.DEFAULT_UP),this.updateMatrix(),this.target=new ei,this.shadow=new e4}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class dI extends jh{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class pI extends jh{constructor(e,t,n=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class HM{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new J)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,s=e.y,a=e.z,c=this.coefficients;return t.copy(c[0]).multiplyScalar(.282095),t.addScaledVector(c[1],.488603*s),t.addScaledVector(c[2],.488603*a),t.addScaledVector(c[3],.488603*n),t.addScaledVector(c[4],1.092548*(n*s)),t.addScaledVector(c[5],1.092548*(s*a)),t.addScaledVector(c[6],.315392*(3*a*a-1)),t.addScaledVector(c[7],1.092548*(n*a)),t.addScaledVector(c[8],.546274*(n*n-s*s)),t}getIrradianceAt(e,t){const n=e.x,s=e.y,a=e.z,c=this.coefficients;return t.copy(c[0]).multiplyScalar(.886227),t.addScaledVector(c[1],2*.511664*s),t.addScaledVector(c[2],2*.511664*a),t.addScaledVector(c[3],2*.511664*n),t.addScaledVector(c[4],2*.429043*n*s),t.addScaledVector(c[5],2*.429043*s*a),t.addScaledVector(c[6],.743125*a*a-.247708),t.addScaledVector(c[7],2*.429043*n*a),t.addScaledVector(c[8],.429043*(n*n-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let s=0;s<9;s++)n[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const n=e.x,s=e.y,a=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*a,t[3]=.488603*n,t[4]=1.092548*n*s,t[5]=1.092548*s*a,t[6]=.315392*(3*a*a-1),t[7]=1.092548*n*a,t[8]=.546274*(n*n-s*s)}}class mI extends jh{constructor(e=new HM,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Wb extends ja{constructor(e){super(e),this.textures={}}load(e,t,n,s){const a=this,c=new _u(a.manager);c.setPath(a.path),c.setRequestHeader(a.requestHeader),c.setWithCredentials(a.withCredentials),c.load(e,function(f){try{t(a.parse(JSON.parse(f)))}catch(d){s?s(d):Gt(d),a.manager.itemError(e)}},n,s)}parse(e){const t=this.textures;function n(a){return t[a]===void 0&&St("MaterialLoader: Undefined texture",a),t[a]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new wt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(s.allowOverride=e.allowOverride),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const a in e.uniforms){const c=e.uniforms[a];switch(s.uniforms[a]={},c.type){case"t":s.uniforms[a].value=n(c.value);break;case"c":s.uniforms[a].value=new wt().setHex(c.value);break;case"v2":s.uniforms[a].value=new ke().fromArray(c.value);break;case"v3":s.uniforms[a].value=new J().fromArray(c.value);break;case"v4":s.uniforms[a].value=new Jn().fromArray(c.value);break;case"m3":s.uniforms[a].value=new xn().fromArray(c.value);break;case"m4":s.uniforms[a].value=new on().fromArray(c.value);break;default:s.uniforms[a].value=c.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const a in e.extensions)s.extensions[a]=e.extensions[a];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=n(e.map)),e.matcap!==void 0&&(s.matcap=n(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let a=e.normalScale;Array.isArray(a)===!1&&(a=[a,a]),s.normalScale=new ke().fromArray(a)}return e.displacementMap!==void 0&&(s.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=n(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new ke().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=n(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return Wb.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:Y3,SpriteMaterial:SM,RawShaderMaterial:PM,ShaderMaterial:Ga,PointsMaterial:MM,MeshPhysicalMaterial:K3,MeshStandardMaterial:LM,MeshPhongMaterial:Q3,MeshToonMaterial:$3,MeshNormalMaterial:J3,MeshLambertMaterial:eI,MeshDepthMaterial:OM,MeshDistanceMaterial:UM,MeshBasicMaterial:Hh,MeshMatcapMaterial:tI,LineDashedMaterial:nI,LineBasicMaterial:da,Material:Wr};return new t[e]}}class gE{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class GM extends vn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class gI extends ja{constructor(e){super(e)}load(e,t,n,s){const a=this,c=new _u(a.manager);c.setPath(a.path),c.setRequestHeader(a.requestHeader),c.setWithCredentials(a.withCredentials),c.load(e,function(f){try{t(a.parse(JSON.parse(f)))}catch(d){s?s(d):Gt(d),a.manager.itemError(e)}},n,s)}parse(e){const t={},n={};function s(E,T){if(t[T]!==void 0)return t[T];const w=E.interleavedBuffers[T],A=a(E,w.buffer),N=Wp(w.type,A),O=new wb(N,w.stride);return O.uuid=w.uuid,t[T]=O,O}function a(E,T){if(n[T]!==void 0)return n[T];const w=E.arrayBuffers[T],A=new Uint32Array(w).buffer;return n[T]=A,A}const c=e.isInstancedBufferGeometry?new GM:new vn,f=e.data.index;if(f!==void 0){const E=Wp(f.type,f.array);c.setIndex(new vi(E,1))}const d=e.data.attributes;for(const E in d){const T=d[E];let I;if(T.isInterleavedBufferAttribute){const w=s(e.data,T.data);I=new oo(w,T.itemSize,T.offset,T.normalized)}else{const w=Wp(T.type,T.array),A=T.isInstancedBufferAttribute?am:vi;I=new A(w,T.itemSize,T.normalized)}T.name!==void 0&&(I.name=T.name),T.usage!==void 0&&I.setUsage(T.usage),c.setAttribute(E,I)}const m=e.data.morphAttributes;if(m)for(const E in m){const T=m[E],I=[];for(let w=0,A=T.length;w<A;w++){const N=T[w];let O;if(N.isInterleavedBufferAttribute){const U=s(e.data,N.data);O=new oo(U,N.itemSize,N.offset,N.normalized)}else{const U=Wp(N.type,N.array);O=new vi(U,N.itemSize,N.normalized)}N.name!==void 0&&(O.name=N.name),I.push(O)}c.morphAttributes[E]=I}e.data.morphTargetsRelative&&(c.morphTargetsRelative=!0);const v=e.data.groups||e.data.drawcalls||e.data.offsets;if(v!==void 0)for(let E=0,T=v.length;E!==T;++E){const I=v[E];c.addGroup(I.start,I.count,I.materialIndex)}const x=e.data.boundingSphere;return x!==void 0&&(c.boundingSphere=new ks().fromJSON(x)),e.name&&(c.name=e.name),e.userData&&(c.userData=e.userData),c}}class t4 extends ja{constructor(e){super(e)}load(e,t,n,s){const a=this,c=this.path===""?gE.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||c;const f=new _u(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(d){let m=null;try{m=JSON.parse(d)}catch(v){s!==void 0&&s(v),v("ObjectLoader: Can't parse "+e+".",v.message);return}const y=m.metadata;if(y===void 0||y.type===void 0||y.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),Gt("ObjectLoader: Can't load "+e);return}a.parse(m,t)},n,s)}async loadAsync(e,t){const n=this,s=this.path===""?gE.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const a=new _u(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials);const c=await a.loadAsync(e,t);let f;try{f=JSON.parse(c)}catch(m){throw new Error("ObjectLoader: Can't parse "+e+". "+m.message)}const d=f.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(f)}parse(e,t){const n=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,s),c=this.parseImages(e.images,function(){t!==void 0&&t(m)}),f=this.parseTextures(e.textures,c),d=this.parseMaterials(e.materials,f),m=this.parseObject(e.object,a,d,f,n),y=this.parseSkeletons(e.skeletons,m);if(this.bindSkeletons(m,y),this.bindLightTargets(m),t!==void 0){let v=!1;for(const x in c)if(c[x].data instanceof HTMLImageElement){v=!0;break}v===!1&&t(m)}return m}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,n),a=await this.parseImagesAsync(e.images),c=this.parseTextures(e.textures,a),f=this.parseMaterials(e.materials,c),d=this.parseObject(e.object,s,f,c,t),m=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,m),this.bindLightTargets(d),d}parseShapes(e){const t={};if(e!==void 0)for(let n=0,s=e.length;n<s;n++){const a=new td().fromJSON(e[n]);t[a.uuid]=a}return t}parseSkeletons(e,t){const n={},s={};if(t.traverse(function(a){a.isBone&&(s[a.uuid]=a)}),e!==void 0)for(let a=0,c=e.length;a<c;a++){const f=new Cb().fromJSON(e[a],s);n[f.uuid]=f}return n}parseGeometries(e,t){const n={};if(e!==void 0){const s=new gI;for(let a=0,c=e.length;a<c;a++){let f;const d=e[a];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":f=s.parse(d);break;default:d.type in aw?f=aw[d.type].fromJSON(d,t):St(`ObjectLoader: Unsupported geometry type "${d.type}"`)}f.uuid=d.uuid,d.name!==void 0&&(f.name=d.name),d.userData!==void 0&&(f.userData=d.userData),n[d.uuid]=f}}return n}parseMaterials(e,t){const n={},s={};if(e!==void 0){const a=new Wb;a.setTextures(t);for(let c=0,f=e.length;c<f;c++){const d=e[c];n[d.uuid]===void 0&&(n[d.uuid]=a.parse(d)),s[d.uuid]=n[d.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const s=e[n],a=j0.parse(s);t[a.uuid]=a}return t}parseImages(e,t){const n=this,s={};let a;function c(d){return n.manager.itemStart(d),a.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}function f(d){if(typeof d=="string"){const m=d,y=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(m)?m:n.resourcePath+m;return c(y)}else return d.data?{data:Wp(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new VM(t);a=new W0(d),a.setCrossOrigin(this.crossOrigin);for(let m=0,y=e.length;m<y;m++){const v=e[m],x=v.url;if(Array.isArray(x)){const E=[];for(let T=0,I=x.length;T<I;T++){const w=x[T],A=f(w);A!==null&&(A instanceof HTMLImageElement?E.push(A):E.push(new El(A.data,A.width,A.height)))}s[v.uuid]=new Sh(E)}else{const E=f(v.url);s[v.uuid]=new Sh(E)}}}return s}async parseImagesAsync(e){const t=this,n={};let s;async function a(c){if(typeof c=="string"){const f=c,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:t.resourcePath+f;return await s.loadAsync(d)}else return c.data?{data:Wp(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){s=new W0(this.manager),s.setCrossOrigin(this.crossOrigin);for(let c=0,f=e.length;c<f;c++){const d=e[c],m=d.url;if(Array.isArray(m)){const y=[];for(let v=0,x=m.length;v<x;v++){const E=m[v],T=await a(E);T!==null&&(T instanceof HTMLImageElement?y.push(T):y.push(new El(T.data,T.width,T.height)))}n[d.uuid]=new Sh(y)}else{const y=await a(d.url);n[d.uuid]=new Sh(y)}}}return n}parseTextures(e,t){function n(a,c){return typeof a=="number"?a:(St("ObjectLoader.parseTexture: Constant should be in numeric form.",a),c[a])}const s={};if(e!==void 0)for(let a=0,c=e.length;a<c;a++){const f=e[a];f.image===void 0&&St('ObjectLoader: No "image" specified for',f.uuid),t[f.image]===void 0&&St("ObjectLoader: Undefined image",f.image);const d=t[f.image],m=d.data;let y;Array.isArray(m)?(y=new sy,m.length===6&&(y.needsUpdate=!0)):(m&&m.data?y=new El:y=new ls,m&&(y.needsUpdate=!0)),y.source=d,y.uuid=f.uuid,f.name!==void 0&&(y.name=f.name),f.mapping!==void 0&&(y.mapping=n(f.mapping,n4)),f.channel!==void 0&&(y.channel=f.channel),f.offset!==void 0&&y.offset.fromArray(f.offset),f.repeat!==void 0&&y.repeat.fromArray(f.repeat),f.center!==void 0&&y.center.fromArray(f.center),f.rotation!==void 0&&(y.rotation=f.rotation),f.wrap!==void 0&&(y.wrapS=n(f.wrap[0],fw),y.wrapT=n(f.wrap[1],fw)),f.format!==void 0&&(y.format=f.format),f.internalFormat!==void 0&&(y.internalFormat=f.internalFormat),f.type!==void 0&&(y.type=f.type),f.colorSpace!==void 0&&(y.colorSpace=f.colorSpace),f.minFilter!==void 0&&(y.minFilter=n(f.minFilter,dw)),f.magFilter!==void 0&&(y.magFilter=n(f.magFilter,dw)),f.anisotropy!==void 0&&(y.anisotropy=f.anisotropy),f.flipY!==void 0&&(y.flipY=f.flipY),f.generateMipmaps!==void 0&&(y.generateMipmaps=f.generateMipmaps),f.premultiplyAlpha!==void 0&&(y.premultiplyAlpha=f.premultiplyAlpha),f.unpackAlignment!==void 0&&(y.unpackAlignment=f.unpackAlignment),f.compareFunction!==void 0&&(y.compareFunction=f.compareFunction),f.userData!==void 0&&(y.userData=f.userData),s[f.uuid]=y}return s}parseObject(e,t,n,s,a){let c;function f(x){return t[x]===void 0&&St("ObjectLoader: Undefined geometry",x),t[x]}function d(x){if(x!==void 0){if(Array.isArray(x)){const E=[];for(let T=0,I=x.length;T<I;T++){const w=x[T];n[w]===void 0&&St("ObjectLoader: Undefined material",w),E.push(n[w])}return E}return n[x]===void 0&&St("ObjectLoader: Undefined material",x),n[x]}}function m(x){return s[x]===void 0&&St("ObjectLoader: Undefined texture",x),s[x]}let y,v;switch(e.type){case"Scene":c=new _M,e.background!==void 0&&(Number.isInteger(e.background)?c.background=new wt(e.background):c.background=m(e.background)),e.environment!==void 0&&(c.environment=m(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?c.fog=new Ab(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(c.fog=new Tb(e.fog.color,e.fog.density)),e.fog.name!==""&&(c.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(c.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(c.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&c.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(c.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&c.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":c=new ys(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(c.focus=e.focus),e.zoom!==void 0&&(c.zoom=e.zoom),e.filmGauge!==void 0&&(c.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(c.filmOffset=e.filmOffset),e.view!==void 0&&(c.view=Object.assign({},e.view));break;case"OrthographicCamera":c=new yu(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(c.zoom=e.zoom),e.view!==void 0&&(c.view=Object.assign({},e.view));break;case"AmbientLight":c=new dI(e.color,e.intensity);break;case"DirectionalLight":c=new fI(e.color,e.intensity),c.target=e.target||"";break;case"PointLight":c=new hI(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":c=new pI(e.color,e.intensity,e.width,e.height);break;case"SpotLight":c=new uI(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),c.target=e.target||"";break;case"HemisphereLight":c=new cI(e.color,e.groundColor,e.intensity);break;case"LightProbe":const x=new HM().fromArray(e.sh);c=new mI(x,e.intensity);break;case"SkinnedMesh":y=f(e.geometry),v=d(e.material),c=new D3(y,v),e.bindMode!==void 0&&(c.bindMode=e.bindMode),e.bindMatrix!==void 0&&c.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(c.skeleton=e.skeleton);break;case"Mesh":y=f(e.geometry),v=d(e.material),c=new _s(y,v);break;case"InstancedMesh":y=f(e.geometry),v=d(e.material);const E=e.count,T=e.instanceMatrix,I=e.instanceColor;c=new N3(y,v,E),c.instanceMatrix=new am(new Float32Array(T.array),16),I!==void 0&&(c.instanceColor=new am(new Float32Array(I.array),I.itemSize));break;case"BatchedMesh":y=f(e.geometry),v=d(e.material),c=new P3(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,v),c.geometry=y,c.perObjectFrustumCulled=e.perObjectFrustumCulled,c.sortObjects=e.sortObjects,c._drawRanges=e.drawRanges,c._reservedRanges=e.reservedRanges,c._geometryInfo=e.geometryInfo.map(w=>{let A=null,N=null;return w.boundingBox!==void 0&&(A=new Vs().fromJSON(w.boundingBox)),w.boundingSphere!==void 0&&(N=new ks().fromJSON(w.boundingSphere)),{...w,boundingBox:A,boundingSphere:N}}),c._instanceInfo=e.instanceInfo,c._availableInstanceIds=e._availableInstanceIds,c._availableGeometryIds=e._availableGeometryIds,c._nextIndexStart=e.nextIndexStart,c._nextVertexStart=e.nextVertexStart,c._geometryCount=e.geometryCount,c._maxInstanceCount=e.maxInstanceCount,c._maxVertexCount=e.maxVertexCount,c._maxIndexCount=e.maxIndexCount,c._geometryInitialized=e.geometryInitialized,c._matricesTexture=m(e.matricesTexture.uuid),c._indirectTexture=m(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(c._colorsTexture=m(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(c.boundingSphere=new ks().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(c.boundingBox=new Vs().fromJSON(e.boundingBox));break;case"LOD":c=new I3;break;case"Line":c=new Lh(f(e.geometry),d(e.material));break;case"LineLoop":c=new L3(f(e.geometry),d(e.material));break;case"LineSegments":c=new wc(f(e.geometry),d(e.material));break;case"PointCloud":case"Points":c=new O3(f(e.geometry),d(e.material));break;case"Sprite":c=new R3(d(e.material));break;case"Group":c=new qp;break;case"Bone":c=new EM;break;default:c=new ei}if(c.uuid=e.uuid,e.name!==void 0&&(c.name=e.name),e.matrix!==void 0?(c.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(c.matrixAutoUpdate=e.matrixAutoUpdate),c.matrixAutoUpdate&&c.matrix.decompose(c.position,c.quaternion,c.scale)):(e.position!==void 0&&c.position.fromArray(e.position),e.rotation!==void 0&&c.rotation.fromArray(e.rotation),e.quaternion!==void 0&&c.quaternion.fromArray(e.quaternion),e.scale!==void 0&&c.scale.fromArray(e.scale)),e.up!==void 0&&c.up.fromArray(e.up),e.pivot!==void 0&&(c.pivot=new J().fromArray(e.pivot)),e.morphTargetDictionary!==void 0&&(c.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),e.morphTargetInfluences!==void 0&&(c.morphTargetInfluences=e.morphTargetInfluences.slice()),e.castShadow!==void 0&&(c.castShadow=e.castShadow),e.receiveShadow!==void 0&&(c.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(c.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(c.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(c.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(c.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&c.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(c.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(c.visible=e.visible),e.frustumCulled!==void 0&&(c.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(c.renderOrder=e.renderOrder),e.static!==void 0&&(c.static=e.static),e.userData!==void 0&&(c.userData=e.userData),e.layers!==void 0&&(c.layers.mask=e.layers),e.children!==void 0){const x=e.children;for(let E=0;E<x.length;E++)c.add(this.parseObject(x[E],t,n,s,a))}if(e.animations!==void 0){const x=e.animations;for(let E=0;E<x.length;E++){const T=x[E];c.animations.push(a[T])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(c.autoUpdate=e.autoUpdate);const x=e.levels;for(let E=0;E<x.length;E++){const T=x[E],I=c.getObjectByProperty("uuid",T.object);I!==void 0&&c.addLevel(I,T.distance,T.hysteresis)}}return c}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const s=t[n.skeleton];s===void 0?St("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(s,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,s=e.getObjectByProperty("uuid",n);s!==void 0?t.target=s:t.target=new ei}})}}const n4={UVMapping:db,CubeReflectionMapping:bc,CubeRefractionMapping:Dh,EquirectangularReflectionMapping:d0,EquirectangularRefractionMapping:p0,CubeUVReflectionMapping:Sm},fw={RepeatWrapping:I0,ClampToEdgeWrapping:Ha,MirroredRepeatWrapping:D0},dw={NearestFilter:vs,NearestMipmapNearestFilter:cM,NearestMipmapLinearFilter:jp,LinearFilter:zi,LinearMipmapNearestFilter:m0,LinearMipmapLinearFilter:gc},E1=new WeakMap;class i4 extends ja{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&St("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&St("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,c=yc.get(`image-bitmap:${e}`);if(c!==void 0){if(a.manager.itemStart(e),c.then){c.then(m=>{if(E1.has(c)===!0)s&&s(E1.get(c)),a.manager.itemError(e),a.manager.itemEnd(e);else return t&&t(m),a.manager.itemEnd(e),m});return}return setTimeout(function(){t&&t(c),a.manager.itemEnd(e)},0),c}const f={};f.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",f.headers=this.requestHeader,f.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const d=fetch(e,f).then(function(m){return m.blob()}).then(function(m){return createImageBitmap(m,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(m){return yc.add(`image-bitmap:${e}`,m),t&&t(m),a.manager.itemEnd(e),m}).catch(function(m){s&&s(m),E1.set(d,m),yc.remove(`image-bitmap:${e}`),a.manager.itemError(e),a.manager.itemEnd(e)});yc.add(`image-bitmap:${e}`,d),a.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let x_;class jM{static getContext(){return x_===void 0&&(x_=new(window.AudioContext||window.webkitAudioContext)),x_}static setContext(e){x_=e}}class s4 extends ja{constructor(e){super(e)}load(e,t,n,s){const a=this,c=new _u(this.manager);c.setResponseType("arraybuffer"),c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(d){try{const m=d.slice(0);jM.getContext().decodeAudioData(m,function(v){t(v)}).catch(f)}catch(m){f(m)}},n,s);function f(d){s?s(d):Gt(d),a.manager.itemError(e)}}}const pw=new on,mw=new on,Of=new on;class r4{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ys,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ys,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Of.copy(e.projectionMatrix);const s=t.eyeSep/2,a=s*t.near/t.focus,c=t.near*Math.tan(ed*t.fov*.5)/t.zoom;let f,d;mw.elements[12]=-s,pw.elements[12]=s,f=-c*t.aspect+a,d=c*t.aspect+a,Of.elements[0]=2*t.near/(d-f),Of.elements[8]=(d+f)/(d-f),this.cameraL.projectionMatrix.copy(Of),f=-c*t.aspect-a,d=c*t.aspect-a,Of.elements[0]=2*t.near/(d-f),Of.elements[8]=(d+f)/(d-f),this.cameraR.projectionMatrix.copy(Of)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(mw),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(pw)}}const Rp=-90,Ip=1;class yI extends ei{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new ys(Rp,Ip,e,t);s.layers=this.layers,this.add(s);const a=new ys(Rp,Ip,e,t);a.layers=this.layers,this.add(a);const c=new ys(Rp,Ip,e,t);c.layers=this.layers,this.add(c);const f=new ys(Rp,Ip,e,t);f.layers=this.layers,this.add(f);const d=new ys(Rp,Ip,e,t);d.layers=this.layers,this.add(d);const m=new ys(Rp,Ip,e,t);m.layers=this.layers,this.add(m)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,s,a,c,f,d]=t;for(const m of t)this.remove(m);if(e===ao)n.up.set(0,1,0),n.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),f.up.set(0,1,0),f.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===od)n.up.set(0,-1,0),n.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),f.up.set(0,-1,0),f.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const m of t)this.add(m),m.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,c,f,d,m,y]=this.children,v=e.getRenderTarget(),x=e.getActiveCubeFace(),E=e.getActiveMipmapLevel(),T=e.xr.enabled;e.xr.enabled=!1;const I=n.texture.generateMipmaps;n.texture.generateMipmaps=!1;let w=!1;e.isWebGLRenderer===!0?w=e.state.buffers.depth.getReversed():w=e.reversedDepthBuffer,e.setRenderTarget(n,0,s),w&&e.autoClear===!1&&e.clearDepth(),e.render(t,a),e.setRenderTarget(n,1,s),w&&e.autoClear===!1&&e.clearDepth(),e.render(t,c),e.setRenderTarget(n,2,s),w&&e.autoClear===!1&&e.clearDepth(),e.render(t,f),e.setRenderTarget(n,3,s),w&&e.autoClear===!1&&e.clearDepth(),e.render(t,d),e.setRenderTarget(n,4,s),w&&e.autoClear===!1&&e.clearDepth(),e.render(t,m),n.texture.generateMipmaps=I,e.setRenderTarget(n,5,s),w&&e.autoClear===!1&&e.clearDepth(),e.render(t,y),e.setRenderTarget(v,x,E),e.xr.enabled=T,n.texture.needsPMREMUpdate=!0}}class vI extends ys{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class _I{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=a4.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function a4(){this._document.hidden===!1&&this.reset()}const Uf=new J,M1=new br,o4=new J,zf=new J,Ff=new J;class l4 extends ei{constructor(){super(),this.type="AudioListener",this.context=jM.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._timer=new _I}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this._timer.update();const t=this.context.listener;if(this.timeDelta=this._timer.getDelta(),this.matrixWorld.decompose(Uf,M1,o4),zf.set(0,0,-1).applyQuaternion(M1),Ff.set(0,1,0).applyQuaternion(M1),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Uf.x,n),t.positionY.linearRampToValueAtTime(Uf.y,n),t.positionZ.linearRampToValueAtTime(Uf.z,n),t.forwardX.linearRampToValueAtTime(zf.x,n),t.forwardY.linearRampToValueAtTime(zf.y,n),t.forwardZ.linearRampToValueAtTime(zf.z,n),t.upX.linearRampToValueAtTime(Ff.x,n),t.upY.linearRampToValueAtTime(Ff.y,n),t.upZ.linearRampToValueAtTime(Ff.z,n)}else t.setPosition(Uf.x,Uf.y,Uf.z),t.setOrientation(zf.x,zf.y,zf.z,Ff.x,Ff.y,Ff.z)}}class xI extends ei{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){St("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){St("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){St("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){St("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){St("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(St("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){St("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(St("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Bf=new J,gw=new br,c4=new J,Vf=new J;class u4 extends xI{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Bf,gw,c4),Vf.set(0,0,1).applyQuaternion(gw);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Bf.x,n),t.positionY.linearRampToValueAtTime(Bf.y,n),t.positionZ.linearRampToValueAtTime(Bf.z,n),t.orientationX.linearRampToValueAtTime(Vf.x,n),t.orientationY.linearRampToValueAtTime(Vf.y,n),t.orientationZ.linearRampToValueAtTime(Vf.z,n)}else t.setPosition(Bf.x,Bf.y,Bf.z),t.setOrientation(Vf.x,Vf.y,Vf.z)}}class h4{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class bI{constructor(e,t,n){this.binding=e,this.valueSize=n;let s,a,c;switch(t){case"quaternion":s=this._slerp,a=this._slerpAdditive,c=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":s=this._select,a=this._select,c=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:s=this._lerp,a=this._lerpAdditive,c=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=a,this._setIdentity=c,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,s=this.valueSize,a=e*s+s;let c=this.cumulativeWeight;if(c===0){for(let f=0;f!==s;++f)n[a+f]=n[f];c=t}else{c+=t;const f=t/c;this._mixBufferRegion(n,a,0,f,s)}this.cumulativeWeight=c}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,s=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,s=e*t+t,a=this.cumulativeWeight,c=this.cumulativeWeightAdditive,f=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const d=t*this._origIndex;this._mixBufferRegion(n,s,d,1-a,t)}c>0&&this._mixBufferRegionAdditive(n,s,this._addIndex*t,1,t);for(let d=t,m=t+t;d!==m;++d)if(n[d]!==n[d+t]){f.setValue(n,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,s=n*this._origIndex;e.getValue(t,s);for(let a=n,c=s;a!==c;++a)t[a]=t[s+a%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,s,a){if(s>=.5)for(let c=0;c!==a;++c)e[t+c]=e[n+c]}_slerp(e,t,n,s){br.slerpFlat(e,t,e,t,e,n,s)}_slerpAdditive(e,t,n,s,a){const c=this._workIndex*a;br.multiplyQuaternionsFlat(e,c,e,t,e,n),br.slerpFlat(e,t,e,t,e,c,s)}_lerp(e,t,n,s,a){const c=1-s;for(let f=0;f!==a;++f){const d=t+f;e[d]=e[d]*c+e[n+f]*s}}_lerpAdditive(e,t,n,s,a){for(let c=0;c!==a;++c){const f=t+c;e[f]=e[f]+e[n+c]*s}}}const WM="\\[\\]\\.:\\/",f4=new RegExp("["+WM+"]","g"),qM="[^"+WM+"]",d4="[^"+WM.replace("\\.","")+"]",p4=/((?:WC+[\/:])*)/.source.replace("WC",qM),m4=/(WCOD+)?/.source.replace("WCOD",d4),g4=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",qM),y4=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",qM),v4=new RegExp("^"+p4+m4+g4+y4+"$"),_4=["material","materials","bones","map"];class x4{constructor(e,t,n){const s=n||Qn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,s=this._bindings[n];s!==void 0&&s.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=n.length;s!==a;++s)n[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Qn{constructor(e,t,n){this.path=t,this.parsedPath=n||Qn.parseTrackName(t),this.node=Qn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Qn.Composite(e,t,n):new Qn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(f4,"")}static parseTrackName(e){const t=v4.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=n.nodeName&&n.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const a=n.nodeName.substring(s+1);_4.indexOf(a)!==-1&&(n.nodeName=n.nodeName.substring(0,s),n.objectName=a)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(a){for(let c=0;c<a.length;c++){const f=a[c];if(f.name===t||f.uuid===t)return f;const d=n(f.children);if(d)return d}return null},s=n(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let s=0,a=n.length;s!==a;++s)e[t++]=n[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let s=0,a=n.length;s!==a;++s)n[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,a=n.length;s!==a;++s)n[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let s=0,a=n.length;s!==a;++s)n[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,s=t.propertyName;let a=t.propertyIndex;if(e||(e=Qn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){St("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let m=t.objectIndex;switch(n){case"materials":if(!e.material){Gt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Gt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Gt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let y=0;y<e.length;y++)if(e[y].name===m){m=y;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Gt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Gt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){Gt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(m!==void 0){if(e[m]===void 0){Gt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[m]}}const c=e[s];if(c===void 0){const m=t.nodeName;Gt("PropertyBinding: Trying to update property for track: "+m+"."+s+" but it wasn't found.",e);return}let f=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?f=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(f=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(a!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){Gt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Gt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}d=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=a}else c.fromArray!==void 0&&c.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(d=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=s;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Qn.Composite=x4;Qn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Qn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Qn.prototype.GetterByBindingType=[Qn.prototype._getValue_direct,Qn.prototype._getValue_array,Qn.prototype._getValue_arrayElement,Qn.prototype._getValue_toArray];Qn.prototype.SetterByBindingTypeAndVersioning=[[Qn.prototype._setValue_direct,Qn.prototype._setValue_direct_setNeedsUpdate,Qn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_array,Qn.prototype._setValue_array_setNeedsUpdate,Qn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_arrayElement,Qn.prototype._setValue_arrayElement_setNeedsUpdate,Qn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Qn.prototype._setValue_fromArray,Qn.prototype._setValue_fromArray_setNeedsUpdate,Qn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class b4{constructor(){this.isAnimationObjectGroup=!0,this.uuid=lo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,s=arguments.length;n!==s;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,s=this._parsedPaths,a=this._bindings,c=a.length;let f,d=e.length,m=this.nCachedObjects_;for(let y=0,v=arguments.length;y!==v;++y){const x=arguments[y],E=x.uuid;let T=t[E];if(T===void 0){T=d++,t[E]=T,e.push(x);for(let I=0,w=c;I!==w;++I)a[I].push(new Qn(x,n[I],s[I]))}else if(T<m){f=e[T];const I=--m,w=e[I];t[w.uuid]=T,e[T]=w,t[E]=I,e[I]=x;for(let A=0,N=c;A!==N;++A){const O=a[A],U=O[I];let q=O[T];O[T]=U,q===void 0&&(q=new Qn(x,n[A],s[A])),O[I]=q}}else e[T]!==f&&Gt("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=m}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let a=this.nCachedObjects_;for(let c=0,f=arguments.length;c!==f;++c){const d=arguments[c],m=d.uuid,y=t[m];if(y!==void 0&&y>=a){const v=a++,x=e[v];t[x.uuid]=y,e[y]=x,t[m]=v,e[v]=d;for(let E=0,T=s;E!==T;++E){const I=n[E],w=I[v],A=I[y];I[y]=w,I[v]=A}}}this.nCachedObjects_=a}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,s=n.length;let a=this.nCachedObjects_,c=e.length;for(let f=0,d=arguments.length;f!==d;++f){const m=arguments[f],y=m.uuid,v=t[y];if(v!==void 0)if(delete t[y],v<a){const x=--a,E=e[x],T=--c,I=e[T];t[E.uuid]=v,e[v]=E,t[I.uuid]=x,e[x]=I,e.pop();for(let w=0,A=s;w!==A;++w){const N=n[w],O=N[x],U=N[T];N[v]=O,N[x]=U,N.pop()}}else{const x=--c,E=e[x];x>0&&(t[E.uuid]=v),e[v]=E,e.pop();for(let T=0,I=s;T!==I;++T){const w=n[T];w[v]=w[x],w.pop()}}}this.nCachedObjects_=a}subscribe_(e,t){const n=this._bindingsIndicesByPath;let s=n[e];const a=this._bindings;if(s!==void 0)return a[s];const c=this._paths,f=this._parsedPaths,d=this._objects,m=d.length,y=this.nCachedObjects_,v=new Array(m);s=a.length,n[e]=s,c.push(e),f.push(t),a.push(v);for(let x=y,E=d.length;x!==E;++x){const T=d[x];v[x]=new Qn(T,e,t)}return v}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const s=this._paths,a=this._parsedPaths,c=this._bindings,f=c.length-1,d=c[f],m=e[f];t[m]=n,c[n]=d,c.pop(),a[n]=a[f],a.pop(),s[n]=s[f],s.pop()}}}class SI{constructor(e,t,n=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=s;const a=t.tracks,c=a.length,f=new Array(c),d={endingStart:Zf,endingEnd:Zf};for(let m=0;m!==c;++m){const y=a[m].createInterpolant(null);f[m]=y,y.settings=d}this._interpolantSettings=d,this._interpolants=f,this._propertyBindings=new Array(c),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=f3,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const s=this._clip.duration,a=e._clip.duration,c=a/s,f=s/a;e.warp(1,c,t),this.warp(f,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const s=this._mixer,a=s.time,c=this.timeScale;let f=this._timeScaleInterpolant;f===null&&(f=s._lendControlInterpolant(),this._timeScaleInterpolant=f);const d=f.parameterPositions,m=f.sampleValues;return d[0]=a,d[1]=a+n,m[0]=e/c,m[1]=t/c,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,s){if(!this.enabled){this._updateWeight(e);return}const a=this._startTime;if(a!==null){const d=(e-a)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);const c=this._updateTime(t),f=this._updateWeight(e);if(f>0){const d=this._interpolants,m=this._propertyBindings;switch(this.blendMode){case gM:for(let y=0,v=d.length;y!==v;++y)d[y].evaluate(c),m[y].accumulateAdditive(f);break;case xb:default:for(let y=0,v=d.length;y!==v;++y)d[y].evaluate(c),m[y].accumulate(s,f)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const s=n.evaluate(e)[0];t*=s,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let s=this.time+e,a=this._loopCount;const c=n===d3;if(e===0)return a===-1?s:c&&(a&1)===1?t-s:s;if(n===h3){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,c)):this._setEndings(this.repetitions===0,!0,c)),s>=t||s<0){const f=Math.floor(s/t);s-=t*f,a+=Math.abs(f);const d=this.repetitions-a;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const m=e<0;this._setEndings(m,!m,c)}else this._setEndings(!1,!1,c);this._loopCount=a,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f})}}else this.time=s;if(c&&(a&1)===1)return t-s}return s}_setEndings(e,t,n){const s=this._interpolantSettings;n?(s.endingStart=Kf,s.endingEnd=Kf):(e?s.endingStart=this.zeroSlopeAtStart?Kf:Zf:s.endingStart=P0,t?s.endingEnd=this.zeroSlopeAtEnd?Kf:Zf:s.endingEnd=P0)}_scheduleFading(e,t,n){const s=this._mixer,a=s.time;let c=this._weightInterpolant;c===null&&(c=s._lendControlInterpolant(),this._weightInterpolant=c);const f=c.parameterPositions,d=c.sampleValues;return f[0]=a,d[0]=t,f[1]=a+e,d[1]=n,this}}const S4=new Float32Array(1);class E4 extends Ac{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}_bindAction(e,t){const n=e._localRoot||this._root,s=e._clip.tracks,a=s.length,c=e._propertyBindings,f=e._interpolants,d=n.uuid,m=this._bindingsByRootAndName;let y=m[d];y===void 0&&(y={},m[d]=y);for(let v=0;v!==a;++v){const x=s[v],E=x.name;let T=y[E];if(T!==void 0)++T.referenceCount,c[v]=T;else{if(T=c[v],T!==void 0){T._cacheIndex===null&&(++T.referenceCount,this._addInactiveBinding(T,d,E));continue}const I=t&&t._propertyBindings[v].binding.parsedPath;T=new bI(Qn.create(n,E,I),x.ValueTypeName,x.getValueSize()),++T.referenceCount,this._addInactiveBinding(T,d,E),c[v]=T}f[v].resultBuffer=T.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,s=e._clip.uuid,a=this._actionsByClip[s];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,s,n)}const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const a=t[n];a.useCount++===0&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const a=t[n];--a.useCount===0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const s=this._actions,a=this._actionsByClip;let c=a[t];if(c===void 0)c={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=c;else{const f=c.knownActions;e._byClipCacheIndex=f.length,f.push(e)}e._cacheIndex=s.length,s.push(e),c.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],s=e._cacheIndex;n._cacheIndex=s,t[s]=n,t.pop(),e._cacheIndex=null;const a=e._clip.uuid,c=this._actionsByClip,f=c[a],d=f.knownActions,m=d[d.length-1],y=e._byClipCacheIndex;m._byClipCacheIndex=y,d[y]=m,d.pop(),e._byClipCacheIndex=null;const v=f.actionByRoot,x=(e._localRoot||this._root).uuid;delete v[x],d.length===0&&delete c[a],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,s=t.length;n!==s;++n){const a=t[n];--a.referenceCount===0&&this._removeInactiveBinding(a)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,s=this._nActiveActions++,a=t[s];e._cacheIndex=s,t[s]=e,a._cacheIndex=n,t[n]=a}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,s=--this._nActiveActions,a=t[s];e._cacheIndex=s,t[s]=e,a._cacheIndex=n,t[n]=a}_addInactiveBinding(e,t,n){const s=this._bindingsByRootAndName,a=this._bindings;let c=s[t];c===void 0&&(c={},s[t]=c),c[n]=e,e._cacheIndex=a.length,a.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,s=n.rootNode.uuid,a=n.path,c=this._bindingsByRootAndName,f=c[s],d=t[t.length-1],m=e._cacheIndex;d._cacheIndex=m,t[m]=d,t.pop(),delete f[a],Object.keys(f).length===0&&delete c[s]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,s=this._nActiveBindings++,a=t[s];e._cacheIndex=s,t[s]=e,a._cacheIndex=n,t[n]=a}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,s=--this._nActiveBindings,a=t[s];e._cacheIndex=s,t[s]=e,a._cacheIndex=n,t[n]=a}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new FM(new Float32Array(2),new Float32Array(2),1,S4),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,s=--this._nActiveControlInterpolants,a=t[s];e.__cacheIndex=s,t[s]=e,a.__cacheIndex=n,t[n]=a}clipAction(e,t,n){const s=t||this._root,a=s.uuid;let c=typeof e=="string"?j0.findByName(s,e):e;const f=c!==null?c.uuid:e,d=this._actionsByClip[f];let m=null;if(n===void 0&&(c!==null?n=c.blendMode:n=xb),d!==void 0){const v=d.actionByRoot[a];if(v!==void 0&&v.blendMode===n)return v;m=d.knownActions[0],c===null&&(c=m._clip)}if(c===null)return null;const y=new SI(this,c,t,n);return this._bindAction(y,m),this._addInactiveAction(y,f,a),y}existingAction(e,t){const n=t||this._root,s=n.uuid,a=typeof e=="string"?j0.findByName(n,e):e,c=a?a.uuid:e,f=this._actionsByClip[c];return f!==void 0&&f.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,s=this.time+=e,a=Math.sign(e),c=this._accuIndex^=1;for(let m=0;m!==n;++m)t[m]._update(s,e,a,c);const f=this._bindings,d=this._nActiveBindings;for(let m=0;m!==d;++m)f[m].apply(c);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,s=this._actionsByClip,a=s[n];if(a!==void 0){const c=a.knownActions;for(let f=0,d=c.length;f!==d;++f){const m=c[f];this._deactivateAction(m);const y=m._cacheIndex,v=t[t.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,v._cacheIndex=y,t[y]=v,t.pop(),this._removeInactiveBindingsForAction(m)}delete s[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const c in n){const f=n[c].actionByRoot,d=f[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const s=this._bindingsByRootAndName,a=s[t];if(a!==void 0)for(const c in a){const f=a[c];f.restoreOriginalState(),this._removeInactiveBinding(f)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class M4 extends vM{constructor(e=1,t=1,n=1,s={}){super(e,t,s),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Mb(null,e,t,n),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class XM{constructor(e){this.value=e}clone(){return new XM(this.value.clone===void 0?this.value:this.value.clone())}}let T4=0;class A4 extends Ac{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:T4++}),this.name="",this.usage=O0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,s=t.length;n<s;n++){const a=Array.isArray(t[n])?t[n]:[t[n]];for(let c=0;c<a.length;c++)this.uniforms.push(a[c].clone())}return this}clone(){return new this.constructor().copy(this)}}class Zx extends wb{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class w4{constructor(e,t,n,s,a,c=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=s,this.count=a,this.normalized=c,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const yw=new on;class EI{constructor(e,t,n=0,s=1/0){this.ray=new dd(e,t),this.near=n,this.far=s,this.camera=null,this.layers=new rm,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Gt("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return yw.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(yw),this}intersectObject(e,t=!0,n=[]){return yE(e,this,n,t),n.sort(vw),n}intersectObjects(e,t=!0,n=[]){for(let s=0,a=e.length;s<a;s++)yE(e[s],this,n,t);return n.sort(vw),n}}function vw(i,e){return i.distance-e.distance}function yE(i,e,t,n){let s=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(s=!1),s===!0&&n===!0){const a=i.children;for(let c=0,f=a.length;c<f;c++)yE(a[c],e,t,!0)}}class MI{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1,St("THREE.Clock: This module has been deprecated. Please use THREE.Timer instead.")}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}class Kx{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=rn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(rn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class C4{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class YM{constructor(e,t,n,s){YM.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,s){const a=this.elements;return a[0]=e,a[2]=t,a[1]=n,a[3]=s,this}}const _w=new ke;class R4{constructor(e=new ke(1/0,1/0),t=new ke(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=_w.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,_w).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const xw=new J,b_=new J,Dp=new J,Np=new J,T1=new J,I4=new J,D4=new J;class TI{constructor(e=new J,t=new J){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){xw.subVectors(e,this.start),b_.subVectors(this.end,this.start);const n=b_.dot(b_);let a=b_.dot(xw)/n;return t&&(a=rn(a,0,1)),a}closestPointToPoint(e,t,n){const s=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(s).add(this.start)}distanceSqToLine3(e,t=I4,n=D4){const s=10000000000000001e-32;let a,c;const f=this.start,d=e.start,m=this.end,y=e.end;Dp.subVectors(m,f),Np.subVectors(y,d),T1.subVectors(f,d);const v=Dp.dot(Dp),x=Np.dot(Np),E=Np.dot(T1);if(v<=s&&x<=s)return t.copy(f),n.copy(d),t.sub(n),t.dot(t);if(v<=s)a=0,c=E/x,c=rn(c,0,1);else{const T=Dp.dot(T1);if(x<=s)c=0,a=rn(-T/v,0,1);else{const I=Dp.dot(Np),w=v*x-I*I;w!==0?a=rn((I*E-T*x)/w,0,1):a=0,c=(I*a+E)/x,c<0?(c=0,a=rn(-T/v,0,1)):c>1&&(c=1,a=rn((I-T)/v,0,1))}}return t.copy(f).addScaledVector(Dp,a),n.copy(d).addScaledVector(Np,c),t.distanceToSquared(n)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const bw=new J;class N4 extends ei{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new vn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let c=0,f=1,d=32;c<d;c++,f++){const m=c/d*Math.PI*2,y=f/d*Math.PI*2;s.push(Math.cos(m),Math.sin(m),1,Math.cos(y),Math.sin(y),1)}n.setAttribute("position",new Ct(s,3));const a=new da({fog:!1,toneMapped:!1});this.cone=new wc(n,a),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),bw.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(bw),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const vh=new J,S_=new on,A1=new on;class P4 extends wc{constructor(e){const t=AI(e),n=new vn,s=[],a=[];for(let m=0;m<t.length;m++){const y=t[m];y.parent&&y.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),a.push(0,0,0),a.push(0,0,0))}n.setAttribute("position",new Ct(s,3)),n.setAttribute("color",new Ct(a,3));const c=new da({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const f=new wt(255),d=new wt(65280);this.setColors(f,d)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,s=n.getAttribute("position");A1.copy(this.root.matrixWorld).invert();for(let a=0,c=0;a<t.length;a++){const f=t[a];f.parent&&f.parent.isBone&&(S_.multiplyMatrices(A1,f.matrixWorld),vh.setFromMatrixPosition(S_),s.setXYZ(c,vh.x,vh.y,vh.z),S_.multiplyMatrices(A1,f.parent.matrixWorld),vh.setFromMatrixPosition(S_),s.setXYZ(c+1,vh.x,vh.y,vh.z),c+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const s=this.geometry.getAttribute("color");for(let a=0;a<s.count;a+=2)s.setXYZ(a,e.r,e.g,e.b),s.setXYZ(a+1,t.r,t.g,t.b);return s.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function AI(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...AI(i.children[t]));return e}class L4 extends _s{constructor(e,t,n){const s=new ly(t,4,2),a=new Hh({wireframe:!0,fog:!1,toneMapped:!1});super(s,a),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const O4=new J,Sw=new wt,Ew=new wt;class U4 extends ei{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const s=new oy(t);s.rotateY(Math.PI*.5),this.material=new Hh({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const a=s.getAttribute("position"),c=new Float32Array(a.count*3);s.setAttribute("color",new vi(c,3)),this.add(new _s(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Sw.copy(this.light.color),Ew.copy(this.light.groundColor);for(let n=0,s=t.count;n<s;n++){const a=n<s/2?Sw:Ew;t.setXYZ(n,a.r,a.g,a.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(O4.setFromMatrixPosition(this.light.matrixWorld).negate())}}class z4 extends wc{constructor(e=10,t=10,n=4473924,s=8947848){n=new wt(n),s=new wt(s);const a=t/2,c=e/t,f=e/2,d=[],m=[];for(let x=0,E=0,T=-f;x<=t;x++,T+=c){d.push(-f,0,T,f,0,T),d.push(T,0,-f,T,0,f);const I=x===a?n:s;I.toArray(m,E),E+=3,I.toArray(m,E),E+=3,I.toArray(m,E),E+=3,I.toArray(m,E),E+=3}const y=new vn;y.setAttribute("position",new Ct(d,3)),y.setAttribute("color",new Ct(m,3));const v=new da({vertexColors:!0,toneMapped:!1});super(y,v),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class F4 extends wc{constructor(e=10,t=16,n=8,s=64,a=4473924,c=8947848){a=new wt(a),c=new wt(c);const f=[],d=[];if(t>1)for(let v=0;v<t;v++){const x=v/t*(Math.PI*2),E=Math.sin(x)*e,T=Math.cos(x)*e;f.push(0,0,0),f.push(E,0,T);const I=v&1?a:c;d.push(I.r,I.g,I.b),d.push(I.r,I.g,I.b)}for(let v=0;v<n;v++){const x=v&1?a:c,E=e-e/n*v;for(let T=0;T<s;T++){let I=T/s*(Math.PI*2),w=Math.sin(I)*E,A=Math.cos(I)*E;f.push(w,0,A),d.push(x.r,x.g,x.b),I=(T+1)/s*(Math.PI*2),w=Math.sin(I)*E,A=Math.cos(I)*E,f.push(w,0,A),d.push(x.r,x.g,x.b)}}const m=new vn;m.setAttribute("position",new Ct(f,3)),m.setAttribute("color",new Ct(d,3));const y=new da({vertexColors:!0,toneMapped:!1});super(m,y),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const Mw=new J,E_=new J,Tw=new J;class B4 extends ei{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new vn;s.setAttribute("position",new Ct([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const a=new da({fog:!1,toneMapped:!1});this.lightPlane=new Lh(s,a),this.add(this.lightPlane),s=new vn,s.setAttribute("position",new Ct([0,0,0,0,0,1],3)),this.targetLine=new Lh(s,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Mw.setFromMatrixPosition(this.light.matrixWorld),E_.setFromMatrixPosition(this.light.target.matrixWorld),Tw.subVectors(E_,Mw),this.lightPlane.lookAt(E_),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(E_),this.targetLine.scale.z=Tw.length()}}const M_=new J,os=new jb;class V4 extends wc{constructor(e){const t=new vn,n=new da({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],a=[],c={};f("n1","n2"),f("n2","n4"),f("n4","n3"),f("n3","n1"),f("f1","f2"),f("f2","f4"),f("f4","f3"),f("f3","f1"),f("n1","f1"),f("n2","f2"),f("n3","f3"),f("n4","f4"),f("p","n1"),f("p","n2"),f("p","n3"),f("p","n4"),f("u1","u2"),f("u2","u3"),f("u3","u1"),f("c","t"),f("p","c"),f("cn1","cn2"),f("cn3","cn4"),f("cf1","cf2"),f("cf3","cf4");function f(T,I){d(T),d(I)}function d(T){s.push(0,0,0),a.push(0,0,0),c[T]===void 0&&(c[T]=[]),c[T].push(s.length/3-1)}t.setAttribute("position",new Ct(s,3)),t.setAttribute("color",new Ct(a,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=c,this.update();const m=new wt(16755200),y=new wt(16711680),v=new wt(43775),x=new wt(16777215),E=new wt(3355443);this.setColors(m,y,v,x,E)}setColors(e,t,n,s,a){const f=this.geometry.getAttribute("color");return f.setXYZ(0,e.r,e.g,e.b),f.setXYZ(1,e.r,e.g,e.b),f.setXYZ(2,e.r,e.g,e.b),f.setXYZ(3,e.r,e.g,e.b),f.setXYZ(4,e.r,e.g,e.b),f.setXYZ(5,e.r,e.g,e.b),f.setXYZ(6,e.r,e.g,e.b),f.setXYZ(7,e.r,e.g,e.b),f.setXYZ(8,e.r,e.g,e.b),f.setXYZ(9,e.r,e.g,e.b),f.setXYZ(10,e.r,e.g,e.b),f.setXYZ(11,e.r,e.g,e.b),f.setXYZ(12,e.r,e.g,e.b),f.setXYZ(13,e.r,e.g,e.b),f.setXYZ(14,e.r,e.g,e.b),f.setXYZ(15,e.r,e.g,e.b),f.setXYZ(16,e.r,e.g,e.b),f.setXYZ(17,e.r,e.g,e.b),f.setXYZ(18,e.r,e.g,e.b),f.setXYZ(19,e.r,e.g,e.b),f.setXYZ(20,e.r,e.g,e.b),f.setXYZ(21,e.r,e.g,e.b),f.setXYZ(22,e.r,e.g,e.b),f.setXYZ(23,e.r,e.g,e.b),f.setXYZ(24,t.r,t.g,t.b),f.setXYZ(25,t.r,t.g,t.b),f.setXYZ(26,t.r,t.g,t.b),f.setXYZ(27,t.r,t.g,t.b),f.setXYZ(28,t.r,t.g,t.b),f.setXYZ(29,t.r,t.g,t.b),f.setXYZ(30,t.r,t.g,t.b),f.setXYZ(31,t.r,t.g,t.b),f.setXYZ(32,n.r,n.g,n.b),f.setXYZ(33,n.r,n.g,n.b),f.setXYZ(34,n.r,n.g,n.b),f.setXYZ(35,n.r,n.g,n.b),f.setXYZ(36,n.r,n.g,n.b),f.setXYZ(37,n.r,n.g,n.b),f.setXYZ(38,s.r,s.g,s.b),f.setXYZ(39,s.r,s.g,s.b),f.setXYZ(40,a.r,a.g,a.b),f.setXYZ(41,a.r,a.g,a.b),f.setXYZ(42,a.r,a.g,a.b),f.setXYZ(43,a.r,a.g,a.b),f.setXYZ(44,a.r,a.g,a.b),f.setXYZ(45,a.r,a.g,a.b),f.setXYZ(46,a.r,a.g,a.b),f.setXYZ(47,a.r,a.g,a.b),f.setXYZ(48,a.r,a.g,a.b),f.setXYZ(49,a.r,a.g,a.b),f.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,s=1;let a,c;if(os.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)a=1,c=0;else if(this.camera.coordinateSystem===ao)a=-1,c=1;else if(this.camera.coordinateSystem===od)a=0,c=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);ps("c",t,e,os,0,0,a),ps("t",t,e,os,0,0,c),ps("n1",t,e,os,-n,-s,a),ps("n2",t,e,os,n,-s,a),ps("n3",t,e,os,-n,s,a),ps("n4",t,e,os,n,s,a),ps("f1",t,e,os,-n,-s,c),ps("f2",t,e,os,n,-s,c),ps("f3",t,e,os,-n,s,c),ps("f4",t,e,os,n,s,c),ps("u1",t,e,os,n*.7,s*1.1,a),ps("u2",t,e,os,-n*.7,s*1.1,a),ps("u3",t,e,os,0,s*2,a),ps("cf1",t,e,os,-n,0,c),ps("cf2",t,e,os,n,0,c),ps("cf3",t,e,os,0,-s,c),ps("cf4",t,e,os,0,s,c),ps("cn1",t,e,os,-n,0,a),ps("cn2",t,e,os,n,0,a),ps("cn3",t,e,os,0,-s,a),ps("cn4",t,e,os,0,s,a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ps(i,e,t,n,s,a,c){M_.set(s,a,c).unproject(n);const f=e[i];if(f!==void 0){const d=t.getAttribute("position");for(let m=0,y=f.length;m<y;m++)d.setXYZ(f[m],M_.x,M_.y,M_.z)}}const T_=new Vs;class k4 extends wc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),a=new vn;a.setIndex(new vi(n,1)),a.setAttribute("position",new vi(s,3)),super(a,new da({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&T_.setFromObject(this.object),T_.isEmpty())return;const e=T_.min,t=T_.max,n=this.geometry.attributes.position,s=n.array;s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=e.x,s[4]=t.y,s[5]=t.z,s[6]=e.x,s[7]=e.y,s[8]=t.z,s[9]=t.x,s[10]=e.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=e.z,s[15]=e.x,s[16]=t.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=t.x,s[22]=e.y,s[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class H4 extends wc{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],a=new vn;a.setIndex(new vi(n,1)),a.setAttribute("position",new Ct(s,3)),super(a,new da({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class G4 extends Lh{constructor(e,t=1,n=16776960){const s=n,a=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],c=new vn;c.setAttribute("position",new Ct(a,3)),c.computeBoundingSphere(),super(c,new da({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const f=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new vn;d.setAttribute("position",new Ct(f,3)),d.computeBoundingSphere(),this.add(new _s(d,new Hh({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const Aw=new J;let A_,w1;class j4 extends ei{constructor(e=new J(0,0,1),t=new J(0,0,0),n=1,s=16776960,a=n*.2,c=a*.2){super(),this.type="ArrowHelper",A_===void 0&&(A_=new vn,A_.setAttribute("position",new Ct([0,0,0,0,1,0],3)),w1=new ay(.5,1,5,1),w1.translate(0,-.5,0)),this.position.copy(t),this.line=new Lh(A_,new da({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new _s(w1,new Hh({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,a,c)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Aw.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Aw,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class W4 extends wc{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new vn;s.setAttribute("position",new Ct(t,3)),s.setAttribute("color",new Ct(n,3));const a=new da({vertexColors:!0,toneMapped:!1});super(s,a),this.type="AxesHelper"}setColors(e,t,n){const s=new wt,a=this.geometry.attributes.color.array;return s.set(e),s.toArray(a,0),s.toArray(a,3),s.set(t),s.toArray(a,6),s.toArray(a,9),s.set(n),s.toArray(a,12),s.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class q4{constructor(){this.type="ShapePath",this.color=new wt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Xx,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,s){return this.currentPath.quadraticCurveTo(e,t,n,s),this}bezierCurveTo(e,t,n,s,a,c){return this.currentPath.bezierCurveTo(e,t,n,s,a,c),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(A){const N=[];for(let O=0,U=A.length;O<U;O++){const q=A[O],j=new td;j.curves=q.curves,N.push(j)}return N}function n(A,N){const O=N.length;let U=!1;for(let q=O-1,j=0;j<O;q=j++){let F=N[q],R=N[j],P=R.x-F.x,H=R.y-F.y;if(Math.abs(H)>Number.EPSILON){if(H<0&&(F=N[j],P=-P,R=N[q],H=-H),A.y<F.y||A.y>R.y)continue;if(A.y===F.y){if(A.x===F.x)return!0}else{const B=H*(A.x-F.x)-P*(A.y-F.y);if(B===0)return!0;if(B<0)continue;U=!U}}else{if(A.y!==F.y)continue;if(R.x<=A.x&&A.x<=F.x||F.x<=A.x&&A.x<=R.x)return!0}}return U}const s=Sl.isClockWise,a=this.subPaths;if(a.length===0)return[];let c,f,d;const m=[];if(a.length===1)return f=a[0],d=new td,d.curves=f.curves,m.push(d),m;let y=!s(a[0].getPoints());y=e?!y:y;const v=[],x=[];let E=[],T=0,I;x[T]=void 0,E[T]=[];for(let A=0,N=a.length;A<N;A++)f=a[A],I=f.getPoints(),c=s(I),c=e?!c:c,c?(!y&&x[T]&&T++,x[T]={s:new td,p:I},x[T].s.curves=f.curves,y&&T++,E[T]=[]):E[T].push({h:f,p:I[0]});if(!x[0])return t(a);if(x.length>1){let A=!1,N=0;for(let O=0,U=x.length;O<U;O++)v[O]=[];for(let O=0,U=x.length;O<U;O++){const q=E[O];for(let j=0;j<q.length;j++){const F=q[j];let R=!0;for(let P=0;P<x.length;P++)n(F.p,x[P].p)&&(O!==P&&N++,R?(R=!1,v[P].push(F)):A=!0);R&&v[O].push(F)}}N>0&&A===!1&&(E=v)}let w;for(let A=0,N=x.length;A<N;A++){d=x[A].s,m.push(d),w=E[A];for(let O=0,U=w.length;O<U;O++)d.holes.push(w[O].h)}return m}}class X4 extends Ac{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){St("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function Y4(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function Z4(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function K4(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function vE(i,e,t,n){const s=Q4(n);switch(t){case pM:return i*e;case yb:return i*e/s.components*s.byteLength;case iy:return i*e/s.components*s.byteLength;case ad:return i*e*2/s.components*s.byteLength;case vb:return i*e*2/s.components*s.byteLength;case mM:return i*e*3/s.components*s.byteLength;case Gr:return i*e*4/s.components*s.byteLength;case _b:return i*e*4/s.components*s.byteLength;case g0:case y0:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case v0:case _0:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case fx:case px:return Math.max(i,16)*Math.max(e,8)/4;case hx:case dx:return Math.max(i,8)*Math.max(e,8)/2;case mx:case gx:case vx:case _x:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case yx:case xx:case bx:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Sx:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Ex:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case Mx:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case Tx:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case Ax:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case wx:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Cx:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case Rx:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case Ix:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case Dx:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Nx:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case Px:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case Lx:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case Ox:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Ux:case zx:case Fx:return Math.ceil(i/4)*Math.ceil(e/4)*16;case Bx:case Vx:return Math.ceil(i/4)*Math.ceil(e/4)*8;case kx:case Hx:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Q4(i){switch(i){case ca:case uM:return{byteLength:1,components:1};case nm:case hM:case Sc:return{byteLength:2,components:1};case mb:case gb:return{byteLength:2,components:4};case Wo:case pb:case fa:return{byteLength:4,components:1};case fM:case dM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class $4{static contain(e,t){return Y4(e,t)}static cover(e,t){return Z4(e,t)}static fill(e){return K4(e)}static getByteLength(e,t,n,s){return vE(e,t,n,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:bm}}));typeof window<"u"&&(window.__THREE__?St("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=bm);function wI(){let i=null,e=!1,t=null,n=null;function s(a,c){t(a,c),n=i.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(s),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){i=a}}}function J4(i){const e=new WeakMap;function t(f,d){const m=f.array,y=f.usage,v=m.byteLength,x=i.createBuffer();i.bindBuffer(d,x),i.bufferData(d,m,y),f.onUploadCallback();let E;if(m instanceof Float32Array)E=i.FLOAT;else if(typeof Float16Array<"u"&&m instanceof Float16Array)E=i.HALF_FLOAT;else if(m instanceof Uint16Array)f.isFloat16BufferAttribute?E=i.HALF_FLOAT:E=i.UNSIGNED_SHORT;else if(m instanceof Int16Array)E=i.SHORT;else if(m instanceof Uint32Array)E=i.UNSIGNED_INT;else if(m instanceof Int32Array)E=i.INT;else if(m instanceof Int8Array)E=i.BYTE;else if(m instanceof Uint8Array)E=i.UNSIGNED_BYTE;else if(m instanceof Uint8ClampedArray)E=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+m);return{buffer:x,type:E,bytesPerElement:m.BYTES_PER_ELEMENT,version:f.version,size:v}}function n(f,d,m){const y=d.array,v=d.updateRanges;if(i.bindBuffer(m,f),v.length===0)i.bufferSubData(m,0,y);else{v.sort((E,T)=>E.start-T.start);let x=0;for(let E=1;E<v.length;E++){const T=v[x],I=v[E];I.start<=T.start+T.count+1?T.count=Math.max(T.count,I.start+I.count-T.start):(++x,v[x]=I)}v.length=x+1;for(let E=0,T=v.length;E<T;E++){const I=v[E];i.bufferSubData(m,I.start*y.BYTES_PER_ELEMENT,y,I.start,I.count)}d.clearUpdateRanges()}d.onUploadCallback()}function s(f){return f.isInterleavedBufferAttribute&&(f=f.data),e.get(f)}function a(f){f.isInterleavedBufferAttribute&&(f=f.data);const d=e.get(f);d&&(i.deleteBuffer(d.buffer),e.delete(f))}function c(f,d){if(f.isInterleavedBufferAttribute&&(f=f.data),f.isGLBufferAttribute){const y=e.get(f);(!y||y.version<f.version)&&e.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}const m=e.get(f);if(m===void 0)e.set(f,t(f,d));else if(m.version<f.version){if(m.size!==f.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(m.buffer,f,d),m.version=f.version}}return{get:s,remove:a,update:c}}var ez=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,tz=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,nz=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,iz=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,sz=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,rz=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,az=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,oz=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,lz=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec4 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 );
	}
#endif`,cz=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,uz=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,hz=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,fz=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,dz=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,pz=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,mz=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,gz=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,yz=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,vz=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,_z=`#if defined( USE_COLOR ) || defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#endif`,xz=`#if defined( USE_COLOR ) || defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#endif`,bz=`#if defined( USE_COLOR ) || defined( USE_COLOR_ALPHA ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec4 vColor;
#endif`,Sz=`#if defined( USE_COLOR ) || defined( USE_COLOR_ALPHA ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec4( 1.0 );
#endif
#ifdef USE_COLOR_ALPHA
	vColor *= color;
#elif defined( USE_COLOR )
	vColor.rgb *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.rgb *= instanceColor.rgb;
#endif
#ifdef USE_BATCHING_COLOR
	vColor *= getBatchingColor( getIndirectIndex( gl_DrawID ) );
#endif`,Ez=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Mz=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Tz=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Az=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,wz=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Cz=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Rz=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Iz="gl_FragColor = linearToOutputTexel( gl_FragColor );",Dz=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Nz=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
		#ifdef ENVMAP_BLENDING_MULTIPLY
			outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
		#elif defined( ENVMAP_BLENDING_MIX )
			outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
		#elif defined( ENVMAP_BLENDING_ADD )
			outgoingLight += envColor.xyz * specularStrength * reflectivity;
		#endif
	#endif
#endif`,Pz=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,Lz=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Oz=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Uz=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,zz=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Fz=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Bz=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Vz=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,kz=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Hz=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Gz=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,jz=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Wz=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,qz=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Xz=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Yz=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Zz=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Kz=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Qz=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,$z=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( material.specularF90 - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
		#ifdef USE_CLEARCOAT
			vec3 Ncc = geometryClearcoatNormal;
			vec2 uvClearcoat = LTC_Uv( Ncc, viewDir, material.clearcoatRoughness );
			vec4 t1Clearcoat = texture2D( ltc_1, uvClearcoat );
			vec4 t2Clearcoat = texture2D( ltc_2, uvClearcoat );
			mat3 mInvClearcoat = mat3(
				vec3( t1Clearcoat.x, 0, t1Clearcoat.y ),
				vec3(             0, 1,             0 ),
				vec3( t1Clearcoat.z, 0, t1Clearcoat.w )
			);
			vec3 fresnelClearcoat = material.clearcoatF0 * t2Clearcoat.x + ( material.clearcoatF90 - material.clearcoatF0 ) * t2Clearcoat.y;
			clearcoatSpecularDirect += lightColor * fresnelClearcoat * LTC_Evaluate( Ncc, viewDir, position, mInvClearcoat, rectCoords );
		#endif
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Jz=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,eF=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( ENVMAP_TYPE_CUBE_UV )
		#if defined( STANDARD ) || defined( LAMBERT ) || defined( PHONG )
			iblIrradiance += getIBLIrradiance( geometryNormal );
		#endif
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,tF=`#if defined( RE_IndirectDiffuse )
	#if defined( LAMBERT ) || defined( PHONG )
		irradiance += iblIrradiance;
	#endif
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,nF=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,iF=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sF=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,rF=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,aF=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,oF=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,lF=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,cF=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,uF=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,hF=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,fF=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,dF=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,pF=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,mF=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,gF=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,yF=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,vF=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,_F=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,xF=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,bF=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,SF=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,EF=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,MF=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,TF=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,AF=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,wF=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,CF=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	#ifdef USE_REVERSED_DEPTH_BUFFER
	
		return depth * ( far - near ) - far;
	#else
		return depth * ( near - far ) - near;
	#endif
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	
	#ifdef USE_REVERSED_DEPTH_BUFFER
		return ( near * far ) / ( ( near - far ) * depth - near );
	#else
		return ( near * far ) / ( ( far - near ) * depth - far );
	#endif
}`,RF=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,IF=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,DF=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,NF=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,PF=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,LF=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,OF=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * PI2;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadowCoord.z -= shadowBias;
			#else
				shadowCoord.z += shadowBias;
			#endif
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadowCoord.z -= shadowBias;
			#else
				shadowCoord.z += shadowBias;
			#endif
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			#ifdef USE_REVERSED_DEPTH_BUFFER
				float dp = ( shadowCameraNear * ( shadowCameraFar - viewSpaceZ ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
				dp -= shadowBias;
			#else
				float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
				dp += shadowBias;
			#endif
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * PI2;
			vec2 sample0 = vogelDiskSample( 0, 5, phi );
			vec2 sample1 = vogelDiskSample( 1, 5, phi );
			vec2 sample2 = vogelDiskSample( 2, 5, phi );
			vec2 sample3 = vogelDiskSample( 3, 5, phi );
			vec2 sample4 = vogelDiskSample( 4, 5, phi );
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * sample0.x + bitangent * sample0.y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * sample1.x + bitangent * sample1.y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * sample2.x + bitangent * sample2.y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * sample3.x + bitangent * sample3.y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * sample4.x + bitangent * sample4.y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				depth = 1.0 - depth;
			#endif
			shadow = step( dp, depth );
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,UF=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,zF=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,FF=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,BF=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,VF=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,kF=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,HF=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,GF=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,jF=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,WF=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,qF=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,XF=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,YF=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,ZF=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,KF=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,QF=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,$F=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const JF=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,eB=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,nB=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,iB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,sB=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rB=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,aB=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,oB=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,lB=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,cB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,uB=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,hB=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fB=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,dB=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,pB=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mB=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gB=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yB=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,vB=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_B=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,xB=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,bB=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,SB=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,EB=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,MB=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,TB=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,AB=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wB=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,CB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,RB=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,IB=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,DB=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,NB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,wn={alphahash_fragment:ez,alphahash_pars_fragment:tz,alphamap_fragment:nz,alphamap_pars_fragment:iz,alphatest_fragment:sz,alphatest_pars_fragment:rz,aomap_fragment:az,aomap_pars_fragment:oz,batching_pars_vertex:lz,batching_vertex:cz,begin_vertex:uz,beginnormal_vertex:hz,bsdfs:fz,iridescence_fragment:dz,bumpmap_pars_fragment:pz,clipping_planes_fragment:mz,clipping_planes_pars_fragment:gz,clipping_planes_pars_vertex:yz,clipping_planes_vertex:vz,color_fragment:_z,color_pars_fragment:xz,color_pars_vertex:bz,color_vertex:Sz,common:Ez,cube_uv_reflection_fragment:Mz,defaultnormal_vertex:Tz,displacementmap_pars_vertex:Az,displacementmap_vertex:wz,emissivemap_fragment:Cz,emissivemap_pars_fragment:Rz,colorspace_fragment:Iz,colorspace_pars_fragment:Dz,envmap_fragment:Nz,envmap_common_pars_fragment:Pz,envmap_pars_fragment:Lz,envmap_pars_vertex:Oz,envmap_physical_pars_fragment:qz,envmap_vertex:Uz,fog_vertex:zz,fog_pars_vertex:Fz,fog_fragment:Bz,fog_pars_fragment:Vz,gradientmap_pars_fragment:kz,lightmap_pars_fragment:Hz,lights_lambert_fragment:Gz,lights_lambert_pars_fragment:jz,lights_pars_begin:Wz,lights_toon_fragment:Xz,lights_toon_pars_fragment:Yz,lights_phong_fragment:Zz,lights_phong_pars_fragment:Kz,lights_physical_fragment:Qz,lights_physical_pars_fragment:$z,lights_fragment_begin:Jz,lights_fragment_maps:eF,lights_fragment_end:tF,logdepthbuf_fragment:nF,logdepthbuf_pars_fragment:iF,logdepthbuf_pars_vertex:sF,logdepthbuf_vertex:rF,map_fragment:aF,map_pars_fragment:oF,map_particle_fragment:lF,map_particle_pars_fragment:cF,metalnessmap_fragment:uF,metalnessmap_pars_fragment:hF,morphinstance_vertex:fF,morphcolor_vertex:dF,morphnormal_vertex:pF,morphtarget_pars_vertex:mF,morphtarget_vertex:gF,normal_fragment_begin:yF,normal_fragment_maps:vF,normal_pars_fragment:_F,normal_pars_vertex:xF,normal_vertex:bF,normalmap_pars_fragment:SF,clearcoat_normal_fragment_begin:EF,clearcoat_normal_fragment_maps:MF,clearcoat_pars_fragment:TF,iridescence_pars_fragment:AF,opaque_fragment:wF,packing:CF,premultiplied_alpha_fragment:RF,project_vertex:IF,dithering_fragment:DF,dithering_pars_fragment:NF,roughnessmap_fragment:PF,roughnessmap_pars_fragment:LF,shadowmap_pars_fragment:OF,shadowmap_pars_vertex:UF,shadowmap_vertex:zF,shadowmask_pars_fragment:FF,skinbase_vertex:BF,skinning_pars_vertex:VF,skinning_vertex:kF,skinnormal_vertex:HF,specularmap_fragment:GF,specularmap_pars_fragment:jF,tonemapping_fragment:WF,tonemapping_pars_fragment:qF,transmission_fragment:XF,transmission_pars_fragment:YF,uv_pars_fragment:ZF,uv_pars_vertex:KF,uv_vertex:QF,worldpos_vertex:$F,background_vert:JF,background_frag:eB,backgroundCube_vert:tB,backgroundCube_frag:nB,cube_vert:iB,cube_frag:sB,depth_vert:rB,depth_frag:aB,distance_vert:oB,distance_frag:lB,equirect_vert:cB,equirect_frag:uB,linedashed_vert:hB,linedashed_frag:fB,meshbasic_vert:dB,meshbasic_frag:pB,meshlambert_vert:mB,meshlambert_frag:gB,meshmatcap_vert:yB,meshmatcap_frag:vB,meshnormal_vert:_B,meshnormal_frag:xB,meshphong_vert:bB,meshphong_frag:SB,meshphysical_vert:EB,meshphysical_frag:MB,meshtoon_vert:TB,meshtoon_frag:AB,points_vert:wB,points_frag:CB,shadow_vert:RB,shadow_frag:IB,sprite_vert:DB,sprite_frag:NB},Et={common:{diffuse:{value:new wt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new xn},alphaMap:{value:null},alphaMapTransform:{value:new xn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new xn}},envmap:{envMap:{value:null},envMapRotation:{value:new xn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new xn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new xn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new xn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new xn},normalScale:{value:new ke(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new xn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new xn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new xn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new xn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new wt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new wt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new xn},alphaTest:{value:0},uvTransform:{value:new xn}},sprite:{diffuse:{value:new wt(16777215)},opacity:{value:1},center:{value:new ke(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new xn},alphaMap:{value:null},alphaMapTransform:{value:new xn},alphaTest:{value:0}}},xl={basic:{uniforms:la([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.fog]),vertexShader:wn.meshbasic_vert,fragmentShader:wn.meshbasic_frag},lambert:{uniforms:la([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,Et.lights,{emissive:{value:new wt(0)},envMapIntensity:{value:1}}]),vertexShader:wn.meshlambert_vert,fragmentShader:wn.meshlambert_frag},phong:{uniforms:la([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,Et.lights,{emissive:{value:new wt(0)},specular:{value:new wt(1118481)},shininess:{value:30},envMapIntensity:{value:1}}]),vertexShader:wn.meshphong_vert,fragmentShader:wn.meshphong_frag},standard:{uniforms:la([Et.common,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.roughnessmap,Et.metalnessmap,Et.fog,Et.lights,{emissive:{value:new wt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:wn.meshphysical_vert,fragmentShader:wn.meshphysical_frag},toon:{uniforms:la([Et.common,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.gradientmap,Et.fog,Et.lights,{emissive:{value:new wt(0)}}]),vertexShader:wn.meshtoon_vert,fragmentShader:wn.meshtoon_frag},matcap:{uniforms:la([Et.common,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,{matcap:{value:null}}]),vertexShader:wn.meshmatcap_vert,fragmentShader:wn.meshmatcap_frag},points:{uniforms:la([Et.points,Et.fog]),vertexShader:wn.points_vert,fragmentShader:wn.points_frag},dashed:{uniforms:la([Et.common,Et.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:wn.linedashed_vert,fragmentShader:wn.linedashed_frag},depth:{uniforms:la([Et.common,Et.displacementmap]),vertexShader:wn.depth_vert,fragmentShader:wn.depth_frag},normal:{uniforms:la([Et.common,Et.bumpmap,Et.normalmap,Et.displacementmap,{opacity:{value:1}}]),vertexShader:wn.meshnormal_vert,fragmentShader:wn.meshnormal_frag},sprite:{uniforms:la([Et.sprite,Et.fog]),vertexShader:wn.sprite_vert,fragmentShader:wn.sprite_frag},background:{uniforms:{uvTransform:{value:new xn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:wn.background_vert,fragmentShader:wn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new xn}},vertexShader:wn.backgroundCube_vert,fragmentShader:wn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:wn.cube_vert,fragmentShader:wn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:wn.equirect_vert,fragmentShader:wn.equirect_frag},distance:{uniforms:la([Et.common,Et.displacementmap,{referencePosition:{value:new J},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:wn.distance_vert,fragmentShader:wn.distance_frag},shadow:{uniforms:la([Et.lights,Et.fog,{color:{value:new wt(0)},opacity:{value:1}}]),vertexShader:wn.shadow_vert,fragmentShader:wn.shadow_frag}};xl.physical={uniforms:la([xl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new xn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new xn},clearcoatNormalScale:{value:new ke(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new xn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new xn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new xn},sheen:{value:0},sheenColor:{value:new wt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new xn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new xn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new xn},transmissionSamplerSize:{value:new ke},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new xn},attenuationDistance:{value:0},attenuationColor:{value:new wt(0)},specularColor:{value:new wt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new xn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new xn},anisotropyVector:{value:new ke},anisotropyMap:{value:null},anisotropyMapTransform:{value:new xn}}]),vertexShader:wn.meshphysical_vert,fragmentShader:wn.meshphysical_frag};const w_={r:0,b:0,g:0},kf=new uo,PB=new on;function LB(i,e,t,n,s,a){const c=new wt(0);let f=s===!0?0:1,d,m,y=null,v=0,x=null;function E(N){let O=N.isScene===!0?N.background:null;if(O&&O.isTexture){const U=N.backgroundBlurriness>0;O=e.get(O,U)}return O}function T(N){let O=!1;const U=E(N);U===null?w(c,f):U&&U.isColor&&(w(U,1),O=!0);const q=i.xr.getEnvironmentBlendMode();q==="additive"?t.buffers.color.setClear(0,0,0,1,a):q==="alpha-blend"&&t.buffers.color.setClear(0,0,0,0,a),(i.autoClear||O)&&(t.buffers.depth.setTest(!0),t.buffers.depth.setMask(!0),t.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function I(N,O){const U=E(O);U&&(U.isCubeTexture||U.mapping===Sm)?(m===void 0&&(m=new _s(new pd(1,1,1),new Ga({name:"BackgroundCubeMaterial",uniforms:cm(xl.backgroundCube.uniforms),vertexShader:xl.backgroundCube.vertexShader,fragmentShader:xl.backgroundCube.fragmentShader,side:jr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(q,j,F){this.matrixWorld.copyPosition(F.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(m)),kf.copy(O.backgroundRotation),kf.x*=-1,kf.y*=-1,kf.z*=-1,U.isCubeTexture&&U.isRenderTargetTexture===!1&&(kf.y*=-1,kf.z*=-1),m.material.uniforms.envMap.value=U,m.material.uniforms.flipEnvMap.value=U.isCubeTexture&&U.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=O.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=O.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(PB.makeRotationFromEuler(kf)),m.material.toneMapped=Gn.getTransfer(U.colorSpace)!==hi,(y!==U||v!==U.version||x!==i.toneMapping)&&(m.material.needsUpdate=!0,y=U,v=U.version,x=i.toneMapping),m.layers.enableAll(),N.unshift(m,m.geometry,m.material,0,0,null)):U&&U.isTexture&&(d===void 0&&(d=new _s(new Mm(2,2),new Ga({name:"BackgroundMaterial",uniforms:cm(xl.background.uniforms),vertexShader:xl.background.vertexShader,fragmentShader:xl.background.fragmentShader,side:vu,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(d)),d.material.uniforms.t2D.value=U,d.material.uniforms.backgroundIntensity.value=O.backgroundIntensity,d.material.toneMapped=Gn.getTransfer(U.colorSpace)!==hi,U.matrixAutoUpdate===!0&&U.updateMatrix(),d.material.uniforms.uvTransform.value.copy(U.matrix),(y!==U||v!==U.version||x!==i.toneMapping)&&(d.material.needsUpdate=!0,y=U,v=U.version,x=i.toneMapping),d.layers.enableAll(),N.unshift(d,d.geometry,d.material,0,0,null))}function w(N,O){N.getRGB(w_,Z3(i)),t.buffers.color.setClear(w_.r,w_.g,w_.b,O,a)}function A(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),d!==void 0&&(d.geometry.dispose(),d.material.dispose(),d=void 0)}return{getClearColor:function(){return c},setClearColor:function(N,O=1){c.set(N),f=O,w(c,f)},getClearAlpha:function(){return f},setClearAlpha:function(N){f=N,w(c,f)},render:T,addToRenderList:I,dispose:A}}function OB(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},s=x(null);let a=s,c=!1;function f(B,X,k,ue,he){let ee=!1;const ie=v(B,ue,k,X);a!==ie&&(a=ie,m(a.object)),ee=E(B,ue,k,he),ee&&T(B,ue,k,he),he!==null&&e.update(he,i.ELEMENT_ARRAY_BUFFER),(ee||c)&&(c=!1,U(B,X,k,ue),he!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(he).buffer))}function d(){return i.createVertexArray()}function m(B){return i.bindVertexArray(B)}function y(B){return i.deleteVertexArray(B)}function v(B,X,k,ue){const he=ue.wireframe===!0;let ee=n[X.id];ee===void 0&&(ee={},n[X.id]=ee);const ie=B.isInstancedMesh===!0?B.id:0;let ye=ee[ie];ye===void 0&&(ye={},ee[ie]=ye);let be=ye[k.id];be===void 0&&(be={},ye[k.id]=be);let Be=be[he];return Be===void 0&&(Be=x(d()),be[he]=Be),Be}function x(B){const X=[],k=[],ue=[];for(let he=0;he<t;he++)X[he]=0,k[he]=0,ue[he]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:X,enabledAttributes:k,attributeDivisors:ue,object:B,attributes:{},index:null}}function E(B,X,k,ue){const he=a.attributes,ee=X.attributes;let ie=0;const ye=k.getAttributes();for(const be in ye)if(ye[be].location>=0){const Oe=he[be];let Pe=ee[be];if(Pe===void 0&&(be==="instanceMatrix"&&B.instanceMatrix&&(Pe=B.instanceMatrix),be==="instanceColor"&&B.instanceColor&&(Pe=B.instanceColor)),Oe===void 0||Oe.attribute!==Pe||Pe&&Oe.data!==Pe.data)return!0;ie++}return a.attributesNum!==ie||a.index!==ue}function T(B,X,k,ue){const he={},ee=X.attributes;let ie=0;const ye=k.getAttributes();for(const be in ye)if(ye[be].location>=0){let Oe=ee[be];Oe===void 0&&(be==="instanceMatrix"&&B.instanceMatrix&&(Oe=B.instanceMatrix),be==="instanceColor"&&B.instanceColor&&(Oe=B.instanceColor));const Pe={};Pe.attribute=Oe,Oe&&Oe.data&&(Pe.data=Oe.data),he[be]=Pe,ie++}a.attributes=he,a.attributesNum=ie,a.index=ue}function I(){const B=a.newAttributes;for(let X=0,k=B.length;X<k;X++)B[X]=0}function w(B){A(B,0)}function A(B,X){const k=a.newAttributes,ue=a.enabledAttributes,he=a.attributeDivisors;k[B]=1,ue[B]===0&&(i.enableVertexAttribArray(B),ue[B]=1),he[B]!==X&&(i.vertexAttribDivisor(B,X),he[B]=X)}function N(){const B=a.newAttributes,X=a.enabledAttributes;for(let k=0,ue=X.length;k<ue;k++)X[k]!==B[k]&&(i.disableVertexAttribArray(k),X[k]=0)}function O(B,X,k,ue,he,ee,ie){ie===!0?i.vertexAttribIPointer(B,X,k,he,ee):i.vertexAttribPointer(B,X,k,ue,he,ee)}function U(B,X,k,ue){I();const he=ue.attributes,ee=k.getAttributes(),ie=X.defaultAttributeValues;for(const ye in ee){const be=ee[ye];if(be.location>=0){let Be=he[ye];if(Be===void 0&&(ye==="instanceMatrix"&&B.instanceMatrix&&(Be=B.instanceMatrix),ye==="instanceColor"&&B.instanceColor&&(Be=B.instanceColor)),Be!==void 0){const Oe=Be.normalized,Pe=Be.itemSize,$e=e.get(Be);if($e===void 0)continue;const Mt=$e.buffer,Yt=$e.type,Ie=$e.bytesPerElement,tt=Yt===i.INT||Yt===i.UNSIGNED_INT||Be.gpuType===pb;if(Be.isInterleavedBufferAttribute){const nt=Be.data,Tt=nt.stride,Lt=Be.offset;if(nt.isInstancedInterleavedBuffer){for(let Ht=0;Ht<be.locationSize;Ht++)A(be.location+Ht,nt.meshPerAttribute);B.isInstancedMesh!==!0&&ue._maxInstanceCount===void 0&&(ue._maxInstanceCount=nt.meshPerAttribute*nt.count)}else for(let Ht=0;Ht<be.locationSize;Ht++)w(be.location+Ht);i.bindBuffer(i.ARRAY_BUFFER,Mt);for(let Ht=0;Ht<be.locationSize;Ht++)O(be.location+Ht,Pe/be.locationSize,Yt,Oe,Tt*Ie,(Lt+Pe/be.locationSize*Ht)*Ie,tt)}else{if(Be.isInstancedBufferAttribute){for(let nt=0;nt<be.locationSize;nt++)A(be.location+nt,Be.meshPerAttribute);B.isInstancedMesh!==!0&&ue._maxInstanceCount===void 0&&(ue._maxInstanceCount=Be.meshPerAttribute*Be.count)}else for(let nt=0;nt<be.locationSize;nt++)w(be.location+nt);i.bindBuffer(i.ARRAY_BUFFER,Mt);for(let nt=0;nt<be.locationSize;nt++)O(be.location+nt,Pe/be.locationSize,Yt,Oe,Pe*Ie,Pe/be.locationSize*nt*Ie,tt)}}else if(ie!==void 0){const Oe=ie[ye];if(Oe!==void 0)switch(Oe.length){case 2:i.vertexAttrib2fv(be.location,Oe);break;case 3:i.vertexAttrib3fv(be.location,Oe);break;case 4:i.vertexAttrib4fv(be.location,Oe);break;default:i.vertexAttrib1fv(be.location,Oe)}}}}N()}function q(){P();for(const B in n){const X=n[B];for(const k in X){const ue=X[k];for(const he in ue){const ee=ue[he];for(const ie in ee)y(ee[ie].object),delete ee[ie];delete ue[he]}}delete n[B]}}function j(B){if(n[B.id]===void 0)return;const X=n[B.id];for(const k in X){const ue=X[k];for(const he in ue){const ee=ue[he];for(const ie in ee)y(ee[ie].object),delete ee[ie];delete ue[he]}}delete n[B.id]}function F(B){for(const X in n){const k=n[X];for(const ue in k){const he=k[ue];if(he[B.id]===void 0)continue;const ee=he[B.id];for(const ie in ee)y(ee[ie].object),delete ee[ie];delete he[B.id]}}}function R(B){for(const X in n){const k=n[X],ue=B.isInstancedMesh===!0?B.id:0,he=k[ue];if(he!==void 0){for(const ee in he){const ie=he[ee];for(const ye in ie)y(ie[ye].object),delete ie[ye];delete he[ee]}delete k[ue],Object.keys(k).length===0&&delete n[X]}}}function P(){H(),c=!0,a!==s&&(a=s,m(a.object))}function H(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:f,reset:P,resetDefaultState:H,dispose:q,releaseStatesOfGeometry:j,releaseStatesOfObject:R,releaseStatesOfProgram:F,initAttributes:I,enableAttribute:w,disableUnusedAttributes:N}}function UB(i,e,t){let n;function s(m){n=m}function a(m,y){i.drawArrays(n,m,y),t.update(y,n,1)}function c(m,y,v){v!==0&&(i.drawArraysInstanced(n,m,y,v),t.update(y,n,v))}function f(m,y,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,m,0,y,0,v);let E=0;for(let T=0;T<v;T++)E+=y[T];t.update(E,n,1)}function d(m,y,v,x){if(v===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let T=0;T<m.length;T++)c(m[T],y[T],x[T]);else{E.multiDrawArraysInstancedWEBGL(n,m,0,y,0,x,0,v);let T=0;for(let I=0;I<v;I++)T+=y[I]*x[I];t.update(T,n,1)}}this.setMode=s,this.render=a,this.renderInstances=c,this.renderMultiDraw=f,this.renderMultiDrawInstances=d}function zB(i,e,t,n){let s;function a(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const F=e.get("EXT_texture_filter_anisotropic");s=i.getParameter(F.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function c(F){return!(F!==Gr&&n.convert(F)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function f(F){const R=F===Sc&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(F!==ca&&n.convert(F)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&F!==fa&&!R)}function d(F){if(F==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";F="mediump"}return F==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let m=t.precision!==void 0?t.precision:"highp";const y=d(m);y!==m&&(St("WebGLRenderer:",m,"not supported, using",y,"instead."),m=y);const v=t.logarithmicDepthBuffer===!0,x=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),E=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),T=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),I=i.getParameter(i.MAX_TEXTURE_SIZE),w=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),A=i.getParameter(i.MAX_VERTEX_ATTRIBS),N=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),O=i.getParameter(i.MAX_VARYING_VECTORS),U=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),q=i.getParameter(i.MAX_SAMPLES),j=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:d,textureFormatReadable:c,textureTypeReadable:f,precision:m,logarithmicDepthBuffer:v,reversedDepthBuffer:x,maxTextures:E,maxVertexTextures:T,maxTextureSize:I,maxCubemapSize:w,maxAttributes:A,maxVertexUniforms:N,maxVaryings:O,maxFragmentUniforms:U,maxSamples:q,samples:j}}function FB(i){const e=this;let t=null,n=0,s=!1,a=!1;const c=new du,f=new xn,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(v,x){const E=v.length!==0||x||n!==0||s;return s=x,n=v.length,E},this.beginShadows=function(){a=!0,y(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(v,x){t=y(v,x,0)},this.setState=function(v,x,E){const T=v.clippingPlanes,I=v.clipIntersection,w=v.clipShadows,A=i.get(v);if(!s||T===null||T.length===0||a&&!w)a?y(null):m();else{const N=a?0:n,O=N*4;let U=A.clippingState||null;d.value=U,U=y(T,x,O,E);for(let q=0;q!==O;++q)U[q]=t[q];A.clippingState=U,this.numIntersection=I?this.numPlanes:0,this.numPlanes+=N}};function m(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function y(v,x,E,T){const I=v!==null?v.length:0;let w=null;if(I!==0){if(w=d.value,T!==!0||w===null){const A=E+I*4,N=x.matrixWorldInverse;f.getNormalMatrix(N),(w===null||w.length<A)&&(w=new Float32Array(A));for(let O=0,U=E;O!==I;++O,U+=4)c.copy(v[O]).applyMatrix4(N,f),c.normal.toArray(w,U),w[U+3]=c.constant}d.value=w,d.needsUpdate=!0}return e.numPlanes=I,e.numIntersection=0,w}}const Eh=4,ww=[.125,.215,.35,.446,.526,.582],Xf=20,BB=256,i0=new yu,Cw=new wt;let C1=null,R1=0,I1=0,D1=!1;const VB=new J;class _E{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,s=100,a={}){const{size:c=256,position:f=VB}=a;C1=this._renderer.getRenderTarget(),R1=this._renderer.getActiveCubeFace(),I1=this._renderer.getActiveMipmapLevel(),D1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(c);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,n,s,d,f),t>0&&this._blur(d,0,0,t),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Dw(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Iw(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(C1,R1,I1),this._renderer.xr.enabled=D1,e.scissorTest=!1,Pp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===bc||e.mapping===Dh?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),C1=this._renderer.getRenderTarget(),R1=this._renderer.getActiveCubeFace(),I1=this._renderer.getActiveMipmapLevel(),D1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:zi,minFilter:zi,generateMipmaps:!1,type:Sc,format:Gr,colorSpace:Nh,depthBuffer:!1},s=Rw(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Rw(e,t,n);const{_lodMax:a}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=kB(a)),this._blurMaterial=GB(a,e,t),this._ggxMaterial=HB(a,e,t)}return s}_compileMaterial(e){const t=new _s(new vn,e);this._renderer.compile(t,i0)}_sceneToCubeUV(e,t,n,s,a){const d=new ys(90,1,t,n),m=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],v=this._renderer,x=v.autoClear,E=v.toneMapping;v.getClearColor(Cw),v.toneMapping=jo,v.autoClear=!1,v.state.buffers.depth.getReversed()&&(v.setRenderTarget(s),v.clearDepth(),v.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new _s(new pd,new Hh({name:"PMREM.Background",side:jr,depthWrite:!1,depthTest:!1})));const I=this._backgroundBox,w=I.material;let A=!1;const N=e.background;N?N.isColor&&(w.color.copy(N),e.background=null,A=!0):(w.color.copy(Cw),A=!0);for(let O=0;O<6;O++){const U=O%3;U===0?(d.up.set(0,m[O],0),d.position.set(a.x,a.y,a.z),d.lookAt(a.x+y[O],a.y,a.z)):U===1?(d.up.set(0,0,m[O]),d.position.set(a.x,a.y,a.z),d.lookAt(a.x,a.y+y[O],a.z)):(d.up.set(0,m[O],0),d.position.set(a.x,a.y,a.z),d.lookAt(a.x,a.y,a.z+y[O]));const q=this._cubeSize;Pp(s,U*q,O>2?q:0,q,q),v.setRenderTarget(s),A&&v.render(I,d),v.render(e,d)}v.toneMapping=E,v.autoClear=x,e.background=N}_textureToCubeUV(e,t){const n=this._renderer,s=e.mapping===bc||e.mapping===Dh;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=Dw()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Iw());const a=s?this._cubemapMaterial:this._equirectMaterial,c=this._lodMeshes[0];c.material=a;const f=a.uniforms;f.envMap.value=e;const d=this._cubeSize;Pp(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(c,i0)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const s=this._lodMeshes.length;for(let a=1;a<s;a++)this._applyGGXFilter(e,a-1,a);t.autoClear=n}_applyGGXFilter(e,t,n){const s=this._renderer,a=this._pingPongRenderTarget,c=this._ggxMaterial,f=this._lodMeshes[n];f.material=c;const d=c.uniforms,m=n/(this._lodMeshes.length-1),y=t/(this._lodMeshes.length-1),v=Math.sqrt(m*m-y*y),x=0+m*1.25,E=v*x,{_lodMax:T}=this,I=this._sizeLods[n],w=3*I*(n>T-Eh?n-T+Eh:0),A=4*(this._cubeSize-I);d.envMap.value=e.texture,d.roughness.value=E,d.mipInt.value=T-t,Pp(a,w,A,3*I,2*I),s.setRenderTarget(a),s.render(f,i0),d.envMap.value=a.texture,d.roughness.value=0,d.mipInt.value=T-n,Pp(e,w,A,3*I,2*I),s.setRenderTarget(e),s.render(f,i0)}_blur(e,t,n,s,a){const c=this._pingPongRenderTarget;this._halfBlur(e,c,t,n,s,"latitudinal",a),this._halfBlur(c,e,n,n,s,"longitudinal",a)}_halfBlur(e,t,n,s,a,c,f){const d=this._renderer,m=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&Gt("blur direction must be either latitudinal or longitudinal!");const y=3,v=this._lodMeshes[s];v.material=m;const x=m.uniforms,E=this._sizeLods[n]-1,T=isFinite(a)?Math.PI/(2*E):2*Math.PI/(2*Xf-1),I=a/T,w=isFinite(a)?1+Math.floor(y*I):Xf;w>Xf&&St(`sigmaRadians, ${a}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Xf}`);const A=[];let N=0;for(let F=0;F<Xf;++F){const R=F/I,P=Math.exp(-R*R/2);A.push(P),F===0?N+=P:F<w&&(N+=2*P)}for(let F=0;F<A.length;F++)A[F]=A[F]/N;x.envMap.value=e.texture,x.samples.value=w,x.weights.value=A,x.latitudinal.value=c==="latitudinal",f&&(x.poleAxis.value=f);const{_lodMax:O}=this;x.dTheta.value=T,x.mipInt.value=O-n;const U=this._sizeLods[s],q=3*U*(s>O-Eh?s-O+Eh:0),j=4*(this._cubeSize-U);Pp(t,q,j,3*U,2*U),d.setRenderTarget(t),d.render(v,i0)}}function kB(i){const e=[],t=[],n=[];let s=i;const a=i-Eh+1+ww.length;for(let c=0;c<a;c++){const f=Math.pow(2,s);e.push(f);let d=1/f;c>i-Eh?d=ww[c-i+Eh-1]:c===0&&(d=0),t.push(d);const m=1/(f-2),y=-m,v=1+m,x=[y,y,v,y,v,v,y,y,v,v,y,v],E=6,T=6,I=3,w=2,A=1,N=new Float32Array(I*T*E),O=new Float32Array(w*T*E),U=new Float32Array(A*T*E);for(let j=0;j<E;j++){const F=j%3*2/3-1,R=j>2?0:-1,P=[F,R,0,F+2/3,R,0,F+2/3,R+1,0,F,R,0,F+2/3,R+1,0,F,R+1,0];N.set(P,I*T*j),O.set(x,w*T*j);const H=[j,j,j,j,j,j];U.set(H,A*T*j)}const q=new vn;q.setAttribute("position",new vi(N,I)),q.setAttribute("uv",new vi(O,w)),q.setAttribute("faceIndex",new vi(U,A)),n.push(new _s(q,null)),s>Eh&&s--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function Rw(i,e,t){const n=new co(i,e,t);return n.texture.mapping=Sm,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Pp(i,e,t,n,s){i.viewport.set(e,t,n,s),i.scissor.set(e,t,n,s)}function HB(i,e,t){return new Ga({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:BB,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:qb(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 4.1: Orthonormal basis
				vec3 T1 = vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(V, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + V.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * V;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:_c,depthTest:!1,depthWrite:!1})}function GB(i,e,t){const n=new Float32Array(Xf),s=new J(0,1,0);return new Ga({name:"SphericalGaussianBlur",defines:{n:Xf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:qb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:_c,depthTest:!1,depthWrite:!1})}function Iw(){return new Ga({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:qb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:_c,depthTest:!1,depthWrite:!1})}function Dw(){return new Ga({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:qb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:_c,depthTest:!1,depthWrite:!1})}function qb(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}class ZM extends co{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},s=[n,n,n,n,n,n];this.texture=new sy(s),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new pd(5,5,5),a=new Ga({name:"CubemapFromEquirect",uniforms:cm(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:jr,blending:_c});a.uniforms.tEquirect.value=t;const c=new _s(s,a),f=t.minFilter;return t.minFilter===gc&&(t.minFilter=zi),new yI(1,10,this).update(e,c),t.minFilter=f,c.geometry.dispose(),c.material.dispose(),this}clear(e,t=!0,n=!0,s=!0){const a=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(t,n,s);e.setRenderTarget(a)}}function jB(i){let e=new WeakMap,t=new WeakMap,n=null;function s(x,E=!1){return x==null?null:E?c(x):a(x)}function a(x){if(x&&x.isTexture){const E=x.mapping;if(E===d0||E===p0)if(e.has(x)){const T=e.get(x).texture;return f(T,x.mapping)}else{const T=x.image;if(T&&T.height>0){const I=new ZM(T.height);return I.fromEquirectangularTexture(i,x),e.set(x,I),x.addEventListener("dispose",m),f(I.texture,x.mapping)}else return null}}return x}function c(x){if(x&&x.isTexture){const E=x.mapping,T=E===d0||E===p0,I=E===bc||E===Dh;if(T||I){let w=t.get(x);const A=w!==void 0?w.texture.pmremVersion:0;if(x.isRenderTargetTexture&&x.pmremVersion!==A)return n===null&&(n=new _E(i)),w=T?n.fromEquirectangular(x,w):n.fromCubemap(x,w),w.texture.pmremVersion=x.pmremVersion,t.set(x,w),w.texture;if(w!==void 0)return w.texture;{const N=x.image;return T&&N&&N.height>0||I&&N&&d(N)?(n===null&&(n=new _E(i)),w=T?n.fromEquirectangular(x):n.fromCubemap(x),w.texture.pmremVersion=x.pmremVersion,t.set(x,w),x.addEventListener("dispose",y),w.texture):null}}}return x}function f(x,E){return E===d0?x.mapping=bc:E===p0&&(x.mapping=Dh),x}function d(x){let E=0;const T=6;for(let I=0;I<T;I++)x[I]!==void 0&&E++;return E===T}function m(x){const E=x.target;E.removeEventListener("dispose",m);const T=e.get(E);T!==void 0&&(e.delete(E),T.dispose())}function y(x){const E=x.target;E.removeEventListener("dispose",y);const T=t.get(E);T!==void 0&&(t.delete(E),T.dispose())}function v(){e=new WeakMap,t=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:s,dispose:v}}function WB(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const s=i.getExtension(n);return e[n]=s,s}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const s=t(n);return s===null&&F0("WebGLRenderer: "+n+" extension not supported."),s}}}function qB(i,e,t,n){const s={},a=new WeakMap;function c(v){const x=v.target;x.index!==null&&e.remove(x.index);for(const T in x.attributes)e.remove(x.attributes[T]);x.removeEventListener("dispose",c),delete s[x.id];const E=a.get(x);E&&(e.remove(E),a.delete(x)),n.releaseStatesOfGeometry(x),x.isInstancedBufferGeometry===!0&&delete x._maxInstanceCount,t.memory.geometries--}function f(v,x){return s[x.id]===!0||(x.addEventListener("dispose",c),s[x.id]=!0,t.memory.geometries++),x}function d(v){const x=v.attributes;for(const E in x)e.update(x[E],i.ARRAY_BUFFER)}function m(v){const x=[],E=v.index,T=v.attributes.position;let I=0;if(T===void 0)return;if(E!==null){const N=E.array;I=E.version;for(let O=0,U=N.length;O<U;O+=3){const q=N[O+0],j=N[O+1],F=N[O+2];x.push(q,j,j,F,F,q)}}else{const N=T.array;I=T.version;for(let O=0,U=N.length/3-1;O<U;O+=3){const q=O+0,j=O+1,F=O+2;x.push(q,j,j,F,F,q)}}const w=new(T.count>=65535?bM:xM)(x,1);w.version=I;const A=a.get(v);A&&e.remove(A),a.set(v,w)}function y(v){const x=a.get(v);if(x){const E=v.index;E!==null&&x.version<E.version&&m(v)}else m(v);return a.get(v)}return{get:f,update:d,getWireframeAttribute:y}}function XB(i,e,t){let n;function s(x){n=x}let a,c;function f(x){a=x.type,c=x.bytesPerElement}function d(x,E){i.drawElements(n,E,a,x*c),t.update(E,n,1)}function m(x,E,T){T!==0&&(i.drawElementsInstanced(n,E,a,x*c,T),t.update(E,n,T))}function y(x,E,T){if(T===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,E,0,a,x,0,T);let w=0;for(let A=0;A<T;A++)w+=E[A];t.update(w,n,1)}function v(x,E,T,I){if(T===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let A=0;A<x.length;A++)m(x[A]/c,E[A],I[A]);else{w.multiDrawElementsInstancedWEBGL(n,E,0,a,x,0,I,0,T);let A=0;for(let N=0;N<T;N++)A+=E[N]*I[N];t.update(A,n,1)}}this.setMode=s,this.setIndex=f,this.render=d,this.renderInstances=m,this.renderMultiDraw=y,this.renderMultiDrawInstances=v}function YB(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(a,c,f){switch(t.calls++,c){case i.TRIANGLES:t.triangles+=f*(a/3);break;case i.LINES:t.lines+=f*(a/2);break;case i.LINE_STRIP:t.lines+=f*(a-1);break;case i.LINE_LOOP:t.lines+=f*a;break;case i.POINTS:t.points+=f*a;break;default:Gt("WebGLInfo: Unknown draw mode:",c);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:n}}function ZB(i,e,t){const n=new WeakMap,s=new Jn;function a(c,f,d){const m=c.morphTargetInfluences,y=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,v=y!==void 0?y.length:0;let x=n.get(f);if(x===void 0||x.count!==v){let P=function(){F.dispose(),n.delete(f),f.removeEventListener("dispose",P)};x!==void 0&&x.texture.dispose();const E=f.morphAttributes.position!==void 0,T=f.morphAttributes.normal!==void 0,I=f.morphAttributes.color!==void 0,w=f.morphAttributes.position||[],A=f.morphAttributes.normal||[],N=f.morphAttributes.color||[];let O=0;E===!0&&(O=1),T===!0&&(O=2),I===!0&&(O=3);let U=f.attributes.position.count*O,q=1;U>e.maxTextureSize&&(q=Math.ceil(U/e.maxTextureSize),U=e.maxTextureSize);const j=new Float32Array(U*q*4*v),F=new Eb(j,U,q,v);F.type=fa,F.needsUpdate=!0;const R=O*4;for(let H=0;H<v;H++){const B=w[H],X=A[H],k=N[H],ue=U*q*4*H;for(let he=0;he<B.count;he++){const ee=he*R;E===!0&&(s.fromBufferAttribute(B,he),j[ue+ee+0]=s.x,j[ue+ee+1]=s.y,j[ue+ee+2]=s.z,j[ue+ee+3]=0),T===!0&&(s.fromBufferAttribute(X,he),j[ue+ee+4]=s.x,j[ue+ee+5]=s.y,j[ue+ee+6]=s.z,j[ue+ee+7]=0),I===!0&&(s.fromBufferAttribute(k,he),j[ue+ee+8]=s.x,j[ue+ee+9]=s.y,j[ue+ee+10]=s.z,j[ue+ee+11]=k.itemSize===4?s.w:1)}}x={count:v,texture:F,size:new ke(U,q)},n.set(f,x),f.addEventListener("dispose",P)}if(c.isInstancedMesh===!0&&c.morphTexture!==null)d.getUniforms().setValue(i,"morphTexture",c.morphTexture,t);else{let E=0;for(let I=0;I<m.length;I++)E+=m[I];const T=f.morphTargetsRelative?1:1-E;d.getUniforms().setValue(i,"morphTargetBaseInfluence",T),d.getUniforms().setValue(i,"morphTargetInfluences",m)}d.getUniforms().setValue(i,"morphTargetsTexture",x.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",x.size)}return{update:a}}function KB(i,e,t,n,s){let a=new WeakMap;function c(m){const y=s.render.frame,v=m.geometry,x=e.get(m,v);if(a.get(x)!==y&&(e.update(x),a.set(x,y)),m.isInstancedMesh&&(m.hasEventListener("dispose",d)===!1&&m.addEventListener("dispose",d),a.get(m)!==y&&(t.update(m.instanceMatrix,i.ARRAY_BUFFER),m.instanceColor!==null&&t.update(m.instanceColor,i.ARRAY_BUFFER),a.set(m,y))),m.isSkinnedMesh){const E=m.skeleton;a.get(E)!==y&&(E.update(),a.set(E,y))}return x}function f(){a=new WeakMap}function d(m){const y=m.target;y.removeEventListener("dispose",d),n.releaseStatesOfObject(y),t.remove(y.instanceMatrix),y.instanceColor!==null&&t.remove(y.instanceColor)}return{update:c,dispose:f}}const QB={[iM]:"LINEAR_TONE_MAPPING",[sM]:"REINHARD_TONE_MAPPING",[rM]:"CINEON_TONE_MAPPING",[ny]:"ACES_FILMIC_TONE_MAPPING",[oM]:"AGX_TONE_MAPPING",[lM]:"NEUTRAL_TONE_MAPPING",[aM]:"CUSTOM_TONE_MAPPING"};function $B(i,e,t,n,s){const a=new co(e,t,{type:i,depthBuffer:n,stencilBuffer:s}),c=new co(e,t,{type:Sc,depthBuffer:!1,stencilBuffer:!1}),f=new vn;f.setAttribute("position",new Ct([-1,3,0,-1,-1,0,3,-1,0],3)),f.setAttribute("uv",new Ct([0,2,0,0,2,0],2));const d=new PM({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),m=new _s(f,d),y=new yu(-1,1,1,-1,0,1);let v=null,x=null,E=!1,T,I=null,w=[],A=!1;this.setSize=function(N,O){a.setSize(N,O),c.setSize(N,O);for(let U=0;U<w.length;U++){const q=w[U];q.setSize&&q.setSize(N,O)}},this.setEffects=function(N){w=N,A=w.length>0&&w[0].isRenderPass===!0;const O=a.width,U=a.height;for(let q=0;q<w.length;q++){const j=w[q];j.setSize&&j.setSize(O,U)}},this.begin=function(N,O){if(E||N.toneMapping===jo&&w.length===0)return!1;if(I=O,O!==null){const U=O.width,q=O.height;(a.width!==U||a.height!==q)&&this.setSize(U,q)}return A===!1&&N.setRenderTarget(a),T=N.toneMapping,N.toneMapping=jo,!0},this.hasRenderPass=function(){return A},this.end=function(N,O){N.toneMapping=T,E=!0;let U=a,q=c;for(let j=0;j<w.length;j++){const F=w[j];if(F.enabled!==!1&&(F.render(N,q,U,O),F.needsSwap!==!1)){const R=U;U=q,q=R}}if(v!==N.outputColorSpace||x!==N.toneMapping){v=N.outputColorSpace,x=N.toneMapping,d.defines={},Gn.getTransfer(v)===hi&&(d.defines.SRGB_TRANSFER="");const j=QB[x];j&&(d.defines[j]=""),d.needsUpdate=!0}d.uniforms.tDiffuse.value=U.texture,N.setRenderTarget(I),N.render(m,y),I=null,E=!1},this.isCompositing=function(){return E},this.dispose=function(){a.dispose(),c.dispose(),f.dispose(),d.dispose()}}const CI=new ls,xE=new om(1,1),RI=new Eb,II=new Mb,DI=new sy,Nw=[],Pw=[],Lw=new Float32Array(16),Ow=new Float32Array(9),Uw=new Float32Array(4);function Am(i,e,t){const n=i[0];if(n<=0||n>0)return i;const s=e*t;let a=Nw[s];if(a===void 0&&(a=new Float32Array(s),Nw[s]=a),e!==0){n.toArray(a,0);for(let c=1,f=0;c!==e;++c)f+=t,i[c].toArray(a,f)}return a}function Gs(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function js(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function Xb(i,e){let t=Pw[e];t===void 0&&(t=new Int32Array(e),Pw[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function JB(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function eV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gs(t,e))return;i.uniform2fv(this.addr,e),js(t,e)}}function tV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Gs(t,e))return;i.uniform3fv(this.addr,e),js(t,e)}}function nV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gs(t,e))return;i.uniform4fv(this.addr,e),js(t,e)}}function iV(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Gs(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),js(t,e)}else{if(Gs(t,n))return;Uw.set(n),i.uniformMatrix2fv(this.addr,!1,Uw),js(t,n)}}function sV(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Gs(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),js(t,e)}else{if(Gs(t,n))return;Ow.set(n),i.uniformMatrix3fv(this.addr,!1,Ow),js(t,n)}}function rV(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(Gs(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),js(t,e)}else{if(Gs(t,n))return;Lw.set(n),i.uniformMatrix4fv(this.addr,!1,Lw),js(t,n)}}function aV(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function oV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gs(t,e))return;i.uniform2iv(this.addr,e),js(t,e)}}function lV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Gs(t,e))return;i.uniform3iv(this.addr,e),js(t,e)}}function cV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gs(t,e))return;i.uniform4iv(this.addr,e),js(t,e)}}function uV(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function hV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Gs(t,e))return;i.uniform2uiv(this.addr,e),js(t,e)}}function fV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Gs(t,e))return;i.uniform3uiv(this.addr,e),js(t,e)}}function dV(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Gs(t,e))return;i.uniform4uiv(this.addr,e),js(t,e)}}function pV(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s);let a;this.type===i.SAMPLER_2D_SHADOW?(xE.compareFunction=t.isReversedDepthBuffer()?Sb:bb,a=xE):a=CI,t.setTexture2D(e||a,s)}function mV(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture3D(e||II,s)}function gV(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTextureCube(e||DI,s)}function yV(i,e,t){const n=this.cache,s=t.allocateTextureUnit();n[0]!==s&&(i.uniform1i(this.addr,s),n[0]=s),t.setTexture2DArray(e||RI,s)}function vV(i){switch(i){case 5126:return JB;case 35664:return eV;case 35665:return tV;case 35666:return nV;case 35674:return iV;case 35675:return sV;case 35676:return rV;case 5124:case 35670:return aV;case 35667:case 35671:return oV;case 35668:case 35672:return lV;case 35669:case 35673:return cV;case 5125:return uV;case 36294:return hV;case 36295:return fV;case 36296:return dV;case 35678:case 36198:case 36298:case 36306:case 35682:return pV;case 35679:case 36299:case 36307:return mV;case 35680:case 36300:case 36308:case 36293:return gV;case 36289:case 36303:case 36311:case 36292:return yV}}function _V(i,e){i.uniform1fv(this.addr,e)}function xV(i,e){const t=Am(e,this.size,2);i.uniform2fv(this.addr,t)}function bV(i,e){const t=Am(e,this.size,3);i.uniform3fv(this.addr,t)}function SV(i,e){const t=Am(e,this.size,4);i.uniform4fv(this.addr,t)}function EV(i,e){const t=Am(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function MV(i,e){const t=Am(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function TV(i,e){const t=Am(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function AV(i,e){i.uniform1iv(this.addr,e)}function wV(i,e){i.uniform2iv(this.addr,e)}function CV(i,e){i.uniform3iv(this.addr,e)}function RV(i,e){i.uniform4iv(this.addr,e)}function IV(i,e){i.uniform1uiv(this.addr,e)}function DV(i,e){i.uniform2uiv(this.addr,e)}function NV(i,e){i.uniform3uiv(this.addr,e)}function PV(i,e){i.uniform4uiv(this.addr,e)}function LV(i,e,t){const n=this.cache,s=e.length,a=Xb(t,s);Gs(n,a)||(i.uniform1iv(this.addr,a),js(n,a));let c;this.type===i.SAMPLER_2D_SHADOW?c=xE:c=CI;for(let f=0;f!==s;++f)t.setTexture2D(e[f]||c,a[f])}function OV(i,e,t){const n=this.cache,s=e.length,a=Xb(t,s);Gs(n,a)||(i.uniform1iv(this.addr,a),js(n,a));for(let c=0;c!==s;++c)t.setTexture3D(e[c]||II,a[c])}function UV(i,e,t){const n=this.cache,s=e.length,a=Xb(t,s);Gs(n,a)||(i.uniform1iv(this.addr,a),js(n,a));for(let c=0;c!==s;++c)t.setTextureCube(e[c]||DI,a[c])}function zV(i,e,t){const n=this.cache,s=e.length,a=Xb(t,s);Gs(n,a)||(i.uniform1iv(this.addr,a),js(n,a));for(let c=0;c!==s;++c)t.setTexture2DArray(e[c]||RI,a[c])}function FV(i){switch(i){case 5126:return _V;case 35664:return xV;case 35665:return bV;case 35666:return SV;case 35674:return EV;case 35675:return MV;case 35676:return TV;case 5124:case 35670:return AV;case 35667:case 35671:return wV;case 35668:case 35672:return CV;case 35669:case 35673:return RV;case 5125:return IV;case 36294:return DV;case 36295:return NV;case 36296:return PV;case 35678:case 36198:case 36298:case 36306:case 35682:return LV;case 35679:case 36299:case 36307:return OV;case 35680:case 36300:case 36308:case 36293:return UV;case 36289:case 36303:case 36311:case 36292:return zV}}class BV{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=vV(t.type)}}class VV{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=FV(t.type)}}class kV{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const s=this.seq;for(let a=0,c=s.length;a!==c;++a){const f=s[a];f.setValue(e,t[f.id],n)}}}const N1=/(\w+)(\])?(\[|\.)?/g;function zw(i,e){i.seq.push(e),i.map[e.id]=e}function HV(i,e,t){const n=i.name,s=n.length;for(N1.lastIndex=0;;){const a=N1.exec(n),c=N1.lastIndex;let f=a[1];const d=a[2]==="]",m=a[3];if(d&&(f=f|0),m===void 0||m==="["&&c+2===s){zw(t,m===void 0?new BV(f,i,e):new VV(f,i,e));break}else{let v=t.map[f];v===void 0&&(v=new kV(f),zw(t,v)),t=v}}}class j_{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let c=0;c<n;++c){const f=e.getActiveUniform(t,c),d=e.getUniformLocation(t,f.name);HV(f,d,this)}const s=[],a=[];for(const c of this.seq)c.type===e.SAMPLER_2D_SHADOW||c.type===e.SAMPLER_CUBE_SHADOW||c.type===e.SAMPLER_2D_ARRAY_SHADOW?s.push(c):a.push(c);s.length>0&&(this.seq=s.concat(a))}setValue(e,t,n,s){const a=this.map[t];a!==void 0&&a.setValue(e,n,s)}setOptional(e,t,n){const s=t[n];s!==void 0&&this.setValue(e,n,s)}static upload(e,t,n,s){for(let a=0,c=t.length;a!==c;++a){const f=t[a],d=n[f.id];d.needsUpdate!==!1&&f.setValue(e,d.value,s)}}static seqWithValue(e,t){const n=[];for(let s=0,a=e.length;s!==a;++s){const c=e[s];c.id in t&&n.push(c)}return n}}function Fw(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const GV=37297;let jV=0;function WV(i,e){const t=i.split(`
`),n=[],s=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let c=s;c<a;c++){const f=c+1;n.push(`${f===e?">":" "} ${f}: ${t[c]}`)}return n.join(`
`)}const Bw=new xn;function qV(i){Gn._getMatrix(Bw,Gn.workingColorSpace,i);const e=`mat3( ${Bw.elements.map(t=>t.toFixed(4))} )`;switch(Gn.getTransfer(i)){case L0:return[e,"LinearTransferOETF"];case hi:return[e,"sRGBTransferOETF"];default:return St("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function Vw(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),a=(i.getShaderInfoLog(e)||"").trim();if(n&&a==="")return"";const c=/ERROR: 0:(\d+)/.exec(a);if(c){const f=parseInt(c[1]);return t.toUpperCase()+`

`+a+`

`+WV(i.getShaderSource(e),f)}else return a}function XV(i,e){const t=qV(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const YV={[iM]:"Linear",[sM]:"Reinhard",[rM]:"Cineon",[ny]:"ACESFilmic",[oM]:"AgX",[lM]:"Neutral",[aM]:"Custom"};function ZV(i,e){const t=YV[e];return t===void 0?(St("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const C_=new J;function KV(){Gn.getLuminanceCoefficients(C_);const i=C_.x.toFixed(4),e=C_.y.toFixed(4),t=C_.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function QV(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(l0).join(`
`)}function $V(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function JV(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const a=i.getActiveAttrib(e,s),c=a.name;let f=1;a.type===i.FLOAT_MAT2&&(f=2),a.type===i.FLOAT_MAT3&&(f=3),a.type===i.FLOAT_MAT4&&(f=4),t[c]={type:a.type,location:i.getAttribLocation(e,c),locationSize:f}}return t}function l0(i){return i!==""}function kw(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Hw(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const e5=/^[ \t]*#include +<([\w\d./]+)>/gm;function bE(i){return i.replace(e5,n5)}const t5=new Map;function n5(i,e){let t=wn[e];if(t===void 0){const n=t5.get(e);if(n!==void 0)t=wn[n],St('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return bE(t)}const i5=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Gw(i){return i.replace(i5,s5)}function s5(i,e,t,n){let s="";for(let a=parseInt(e);a<parseInt(t);a++)s+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return s}function jw(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const r5={[Xp]:"SHADOWMAP_TYPE_PCF",[Yf]:"SHADOWMAP_TYPE_VSM"};function a5(i){return r5[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const o5={[bc]:"ENVMAP_TYPE_CUBE",[Dh]:"ENVMAP_TYPE_CUBE",[Sm]:"ENVMAP_TYPE_CUBE_UV"};function l5(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":o5[i.envMapMode]||"ENVMAP_TYPE_CUBE"}const c5={[Dh]:"ENVMAP_MODE_REFRACTION"};function u5(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":c5[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}const h5={[ty]:"ENVMAP_BLENDING_MULTIPLY",[l3]:"ENVMAP_BLENDING_MIX",[c3]:"ENVMAP_BLENDING_ADD"};function f5(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":h5[i.combine]||"ENVMAP_BLENDING_NONE"}function d5(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function p5(i,e,t,n){const s=i.getContext(),a=t.defines;let c=t.vertexShader,f=t.fragmentShader;const d=a5(t),m=l5(t),y=u5(t),v=f5(t),x=d5(t),E=QV(t),T=$V(a),I=s.createProgram();let w,A,N=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T].filter(l0).join(`
`),w.length>0&&(w+=`
`),A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T].filter(l0).join(`
`),A.length>0&&(A+=`
`)):(w=[jw(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+y:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(l0).join(`
`),A=[jw(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.envMap?"#define "+y:"",t.envMap?"#define "+v:"",x?"#define CUBEUV_TEXEL_WIDTH "+x.texelWidth:"",x?"#define CUBEUV_TEXEL_HEIGHT "+x.texelHeight:"",x?"#define CUBEUV_MAX_MIP "+x.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas||t.batchingColor?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==jo?"#define TONE_MAPPING":"",t.toneMapping!==jo?wn.tonemapping_pars_fragment:"",t.toneMapping!==jo?ZV("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",wn.colorspace_pars_fragment,XV("linearToOutputTexel",t.outputColorSpace),KV(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(l0).join(`
`)),c=bE(c),c=kw(c,t),c=Hw(c,t),f=bE(f),f=kw(f,t),f=Hw(f,t),c=Gw(c),f=Gw(f),t.isRawShaderMaterial!==!0&&(N=`#version 300 es
`,w=[E,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,A=["#define varying in",t.glslVersion===hE?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===hE?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+A);const O=N+w+c,U=N+A+f,q=Fw(s,s.VERTEX_SHADER,O),j=Fw(s,s.FRAGMENT_SHADER,U);s.attachShader(I,q),s.attachShader(I,j),t.index0AttributeName!==void 0?s.bindAttribLocation(I,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(I,0,"position"),s.linkProgram(I);function F(B){if(i.debug.checkShaderErrors){const X=s.getProgramInfoLog(I)||"",k=s.getShaderInfoLog(q)||"",ue=s.getShaderInfoLog(j)||"",he=X.trim(),ee=k.trim(),ie=ue.trim();let ye=!0,be=!0;if(s.getProgramParameter(I,s.LINK_STATUS)===!1)if(ye=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(s,I,q,j);else{const Be=Vw(s,q,"vertex"),Oe=Vw(s,j,"fragment");Gt("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(I,s.VALIDATE_STATUS)+`

Material Name: `+B.name+`
Material Type: `+B.type+`

Program Info Log: `+he+`
`+Be+`
`+Oe)}else he!==""?St("WebGLProgram: Program Info Log:",he):(ee===""||ie==="")&&(be=!1);be&&(B.diagnostics={runnable:ye,programLog:he,vertexShader:{log:ee,prefix:w},fragmentShader:{log:ie,prefix:A}})}s.deleteShader(q),s.deleteShader(j),R=new j_(s,I),P=JV(s,I)}let R;this.getUniforms=function(){return R===void 0&&F(this),R};let P;this.getAttributes=function(){return P===void 0&&F(this),P};let H=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return H===!1&&(H=s.getProgramParameter(I,GV)),H},this.destroy=function(){n.releaseStatesOfProgram(this),s.deleteProgram(I),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=jV++,this.cacheKey=e,this.usedTimes=1,this.program=I,this.vertexShader=q,this.fragmentShader=j,this}let m5=0;class g5{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,s=this._getShaderStage(t),a=this._getShaderStage(n),c=this._getShaderCacheForMaterial(e);return c.has(s)===!1&&(c.add(s),s.usedTimes++),c.has(a)===!1&&(c.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new y5(e),t.set(e,n)),n}}class y5{constructor(e){this.id=m5++,this.code=e,this.usedTimes=0}}function v5(i,e,t,n,s,a){const c=new rm,f=new g5,d=new Set,m=[],y=new Map,v=n.logarithmicDepthBuffer;let x=n.precision;const E={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function T(R){return d.add(R),R===0?"uv":`uv${R}`}function I(R,P,H,B,X){const k=B.fog,ue=X.geometry,he=R.isMeshStandardMaterial||R.isMeshLambertMaterial||R.isMeshPhongMaterial?B.environment:null,ee=R.isMeshStandardMaterial||R.isMeshLambertMaterial&&!R.envMap||R.isMeshPhongMaterial&&!R.envMap,ie=e.get(R.envMap||he,ee),ye=ie&&ie.mapping===Sm?ie.image.height:null,be=E[R.type];R.precision!==null&&(x=n.getMaxPrecision(R.precision),x!==R.precision&&St("WebGLProgram.getParameters:",R.precision,"not supported, using",x,"instead."));const Be=ue.morphAttributes.position||ue.morphAttributes.normal||ue.morphAttributes.color,Oe=Be!==void 0?Be.length:0;let Pe=0;ue.morphAttributes.position!==void 0&&(Pe=1),ue.morphAttributes.normal!==void 0&&(Pe=2),ue.morphAttributes.color!==void 0&&(Pe=3);let $e,Mt,Yt,Ie;if(be){const nn=xl[be];$e=nn.vertexShader,Mt=nn.fragmentShader}else $e=R.vertexShader,Mt=R.fragmentShader,f.update(R),Yt=f.getVertexShaderID(R),Ie=f.getFragmentShaderID(R);const tt=i.getRenderTarget(),nt=i.state.buffers.depth.getReversed(),Tt=X.isInstancedMesh===!0,Lt=X.isBatchedMesh===!0,Ht=!!R.map,un=!!R.matcap,zt=!!ie,Ue=!!R.aoMap,Ye=!!R.lightMap,ze=!!R.bumpMap,ot=!!R.normalMap,te=!!R.displacementMap,yt=!!R.emissiveMap,it=!!R.metalnessMap,Rt=!!R.roughnessMap,st=R.anisotropy>0,Q=R.clearcoat>0,G=R.dispersion>0,oe=R.iridescence>0,Ae=R.sheen>0,Fe=R.transmission>0,we=st&&!!R.anisotropyMap,vt=Q&&!!R.clearcoatMap,rt=Q&&!!R.clearcoatNormalMap,It=Q&&!!R.clearcoatRoughnessMap,Ft=oe&&!!R.iridescenceMap,We=oe&&!!R.iridescenceThicknessMap,Xe=Ae&&!!R.sheenColorMap,_t=Ae&&!!R.sheenRoughnessMap,ne=!!R.specularMap,xe=!!R.specularColorMap,at=!!R.specularIntensityMap,se=Fe&&!!R.transmissionMap,je=Fe&&!!R.thicknessMap,Ze=!!R.gradientMap,Je=!!R.alphaMap,Qe=R.alphaTest>0,Ce=!!R.alphaHash,dt=!!R.extensions;let Bt=jo;R.toneMapped&&(tt===null||tt.isXRRenderTarget===!0)&&(Bt=i.toneMapping);const hn={shaderID:be,shaderType:R.type,shaderName:R.name,vertexShader:$e,fragmentShader:Mt,defines:R.defines,customVertexShaderID:Yt,customFragmentShaderID:Ie,isRawShaderMaterial:R.isRawShaderMaterial===!0,glslVersion:R.glslVersion,precision:x,batching:Lt,batchingColor:Lt&&X._colorsTexture!==null,instancing:Tt,instancingColor:Tt&&X.instanceColor!==null,instancingMorph:Tt&&X.morphTexture!==null,outputColorSpace:tt===null?i.outputColorSpace:tt.isXRRenderTarget===!0?tt.texture.colorSpace:Nh,alphaToCoverage:!!R.alphaToCoverage,map:Ht,matcap:un,envMap:zt,envMapMode:zt&&ie.mapping,envMapCubeUVHeight:ye,aoMap:Ue,lightMap:Ye,bumpMap:ze,normalMap:ot,displacementMap:te,emissiveMap:yt,normalMapObjectSpace:ot&&R.normalMapType===m3,normalMapTangentSpace:ot&&R.normalMapType===kh,metalnessMap:it,roughnessMap:Rt,anisotropy:st,anisotropyMap:we,clearcoat:Q,clearcoatMap:vt,clearcoatNormalMap:rt,clearcoatRoughnessMap:It,dispersion:G,iridescence:oe,iridescenceMap:Ft,iridescenceThicknessMap:We,sheen:Ae,sheenColorMap:Xe,sheenRoughnessMap:_t,specularMap:ne,specularColorMap:xe,specularIntensityMap:at,transmission:Fe,transmissionMap:se,thicknessMap:je,gradientMap:Ze,opaque:R.transparent===!1&&R.blending===Jf&&R.alphaToCoverage===!1,alphaMap:Je,alphaTest:Qe,alphaHash:Ce,combine:R.combine,mapUv:Ht&&T(R.map.channel),aoMapUv:Ue&&T(R.aoMap.channel),lightMapUv:Ye&&T(R.lightMap.channel),bumpMapUv:ze&&T(R.bumpMap.channel),normalMapUv:ot&&T(R.normalMap.channel),displacementMapUv:te&&T(R.displacementMap.channel),emissiveMapUv:yt&&T(R.emissiveMap.channel),metalnessMapUv:it&&T(R.metalnessMap.channel),roughnessMapUv:Rt&&T(R.roughnessMap.channel),anisotropyMapUv:we&&T(R.anisotropyMap.channel),clearcoatMapUv:vt&&T(R.clearcoatMap.channel),clearcoatNormalMapUv:rt&&T(R.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:It&&T(R.clearcoatRoughnessMap.channel),iridescenceMapUv:Ft&&T(R.iridescenceMap.channel),iridescenceThicknessMapUv:We&&T(R.iridescenceThicknessMap.channel),sheenColorMapUv:Xe&&T(R.sheenColorMap.channel),sheenRoughnessMapUv:_t&&T(R.sheenRoughnessMap.channel),specularMapUv:ne&&T(R.specularMap.channel),specularColorMapUv:xe&&T(R.specularColorMap.channel),specularIntensityMapUv:at&&T(R.specularIntensityMap.channel),transmissionMapUv:se&&T(R.transmissionMap.channel),thicknessMapUv:je&&T(R.thicknessMap.channel),alphaMapUv:Je&&T(R.alphaMap.channel),vertexTangents:!!ue.attributes.tangent&&(ot||st),vertexColors:R.vertexColors,vertexAlphas:R.vertexColors===!0&&!!ue.attributes.color&&ue.attributes.color.itemSize===4,pointsUvs:X.isPoints===!0&&!!ue.attributes.uv&&(Ht||Je),fog:!!k,useFog:R.fog===!0,fogExp2:!!k&&k.isFogExp2,flatShading:R.wireframe===!1&&(R.flatShading===!0||ue.attributes.normal===void 0&&ot===!1&&(R.isMeshLambertMaterial||R.isMeshPhongMaterial||R.isMeshStandardMaterial||R.isMeshPhysicalMaterial)),sizeAttenuation:R.sizeAttenuation===!0,logarithmicDepthBuffer:v,reversedDepthBuffer:nt,skinning:X.isSkinnedMesh===!0,morphTargets:ue.morphAttributes.position!==void 0,morphNormals:ue.morphAttributes.normal!==void 0,morphColors:ue.morphAttributes.color!==void 0,morphTargetsCount:Oe,morphTextureStride:Pe,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numLightProbes:P.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:R.dithering,shadowMapEnabled:i.shadowMap.enabled&&H.length>0,shadowMapType:i.shadowMap.type,toneMapping:Bt,decodeVideoTexture:Ht&&R.map.isVideoTexture===!0&&Gn.getTransfer(R.map.colorSpace)===hi,decodeVideoTextureEmissive:yt&&R.emissiveMap.isVideoTexture===!0&&Gn.getTransfer(R.emissiveMap.colorSpace)===hi,premultipliedAlpha:R.premultipliedAlpha,doubleSided:R.side===bl,flipSided:R.side===jr,useDepthPacking:R.depthPacking>=0,depthPacking:R.depthPacking||0,index0AttributeName:R.index0AttributeName,extensionClipCullDistance:dt&&R.extensions.clipCullDistance===!0&&t.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(dt&&R.extensions.multiDraw===!0||Lt)&&t.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:t.has("KHR_parallel_shader_compile"),customProgramCacheKey:R.customProgramCacheKey()};return hn.vertexUv1s=d.has(1),hn.vertexUv2s=d.has(2),hn.vertexUv3s=d.has(3),d.clear(),hn}function w(R){const P=[];if(R.shaderID?P.push(R.shaderID):(P.push(R.customVertexShaderID),P.push(R.customFragmentShaderID)),R.defines!==void 0)for(const H in R.defines)P.push(H),P.push(R.defines[H]);return R.isRawShaderMaterial===!1&&(A(P,R),N(P,R),P.push(i.outputColorSpace)),P.push(R.customProgramCacheKey),P.join()}function A(R,P){R.push(P.precision),R.push(P.outputColorSpace),R.push(P.envMapMode),R.push(P.envMapCubeUVHeight),R.push(P.mapUv),R.push(P.alphaMapUv),R.push(P.lightMapUv),R.push(P.aoMapUv),R.push(P.bumpMapUv),R.push(P.normalMapUv),R.push(P.displacementMapUv),R.push(P.emissiveMapUv),R.push(P.metalnessMapUv),R.push(P.roughnessMapUv),R.push(P.anisotropyMapUv),R.push(P.clearcoatMapUv),R.push(P.clearcoatNormalMapUv),R.push(P.clearcoatRoughnessMapUv),R.push(P.iridescenceMapUv),R.push(P.iridescenceThicknessMapUv),R.push(P.sheenColorMapUv),R.push(P.sheenRoughnessMapUv),R.push(P.specularMapUv),R.push(P.specularColorMapUv),R.push(P.specularIntensityMapUv),R.push(P.transmissionMapUv),R.push(P.thicknessMapUv),R.push(P.combine),R.push(P.fogExp2),R.push(P.sizeAttenuation),R.push(P.morphTargetsCount),R.push(P.morphAttributeCount),R.push(P.numDirLights),R.push(P.numPointLights),R.push(P.numSpotLights),R.push(P.numSpotLightMaps),R.push(P.numHemiLights),R.push(P.numRectAreaLights),R.push(P.numDirLightShadows),R.push(P.numPointLightShadows),R.push(P.numSpotLightShadows),R.push(P.numSpotLightShadowsWithMaps),R.push(P.numLightProbes),R.push(P.shadowMapType),R.push(P.toneMapping),R.push(P.numClippingPlanes),R.push(P.numClipIntersection),R.push(P.depthPacking)}function N(R,P){c.disableAll(),P.instancing&&c.enable(0),P.instancingColor&&c.enable(1),P.instancingMorph&&c.enable(2),P.matcap&&c.enable(3),P.envMap&&c.enable(4),P.normalMapObjectSpace&&c.enable(5),P.normalMapTangentSpace&&c.enable(6),P.clearcoat&&c.enable(7),P.iridescence&&c.enable(8),P.alphaTest&&c.enable(9),P.vertexColors&&c.enable(10),P.vertexAlphas&&c.enable(11),P.vertexUv1s&&c.enable(12),P.vertexUv2s&&c.enable(13),P.vertexUv3s&&c.enable(14),P.vertexTangents&&c.enable(15),P.anisotropy&&c.enable(16),P.alphaHash&&c.enable(17),P.batching&&c.enable(18),P.dispersion&&c.enable(19),P.batchingColor&&c.enable(20),P.gradientMap&&c.enable(21),R.push(c.mask),c.disableAll(),P.fog&&c.enable(0),P.useFog&&c.enable(1),P.flatShading&&c.enable(2),P.logarithmicDepthBuffer&&c.enable(3),P.reversedDepthBuffer&&c.enable(4),P.skinning&&c.enable(5),P.morphTargets&&c.enable(6),P.morphNormals&&c.enable(7),P.morphColors&&c.enable(8),P.premultipliedAlpha&&c.enable(9),P.shadowMapEnabled&&c.enable(10),P.doubleSided&&c.enable(11),P.flipSided&&c.enable(12),P.useDepthPacking&&c.enable(13),P.dithering&&c.enable(14),P.transmission&&c.enable(15),P.sheen&&c.enable(16),P.opaque&&c.enable(17),P.pointsUvs&&c.enable(18),P.decodeVideoTexture&&c.enable(19),P.decodeVideoTextureEmissive&&c.enable(20),P.alphaToCoverage&&c.enable(21),R.push(c.mask)}function O(R){const P=E[R.type];let H;if(P){const B=xl[P];H=Yx.clone(B.uniforms)}else H=R.uniforms;return H}function U(R,P){let H=y.get(P);return H!==void 0?++H.usedTimes:(H=new p5(i,P,R,s),m.push(H),y.set(P,H)),H}function q(R){if(--R.usedTimes===0){const P=m.indexOf(R);m[P]=m[m.length-1],m.pop(),y.delete(R.cacheKey),R.destroy()}}function j(R){f.remove(R)}function F(){f.dispose()}return{getParameters:I,getProgramCacheKey:w,getUniforms:O,acquireProgram:U,releaseProgram:q,releaseShaderCache:j,programs:m,dispose:F}}function _5(){let i=new WeakMap;function e(c){return i.has(c)}function t(c){let f=i.get(c);return f===void 0&&(f={},i.set(c,f)),f}function n(c){i.delete(c)}function s(c,f,d){i.get(c)[f]=d}function a(){i=new WeakMap}return{has:e,get:t,remove:n,update:s,dispose:a}}function x5(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.materialVariant!==e.materialVariant?i.materialVariant-e.materialVariant:i.z!==e.z?i.z-e.z:i.id-e.id}function Ww(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function qw(){const i=[];let e=0;const t=[],n=[],s=[];function a(){e=0,t.length=0,n.length=0,s.length=0}function c(x){let E=0;return x.isInstancedMesh&&(E+=2),x.isSkinnedMesh&&(E+=1),E}function f(x,E,T,I,w,A){let N=i[e];return N===void 0?(N={id:x.id,object:x,geometry:E,material:T,materialVariant:c(x),groupOrder:I,renderOrder:x.renderOrder,z:w,group:A},i[e]=N):(N.id=x.id,N.object=x,N.geometry=E,N.material=T,N.materialVariant=c(x),N.groupOrder=I,N.renderOrder=x.renderOrder,N.z=w,N.group=A),e++,N}function d(x,E,T,I,w,A){const N=f(x,E,T,I,w,A);T.transmission>0?n.push(N):T.transparent===!0?s.push(N):t.push(N)}function m(x,E,T,I,w,A){const N=f(x,E,T,I,w,A);T.transmission>0?n.unshift(N):T.transparent===!0?s.unshift(N):t.unshift(N)}function y(x,E){t.length>1&&t.sort(x||x5),n.length>1&&n.sort(E||Ww),s.length>1&&s.sort(E||Ww)}function v(){for(let x=e,E=i.length;x<E;x++){const T=i[x];if(T.id===null)break;T.id=null,T.object=null,T.geometry=null,T.material=null,T.group=null}}return{opaque:t,transmissive:n,transparent:s,init:a,push:d,unshift:m,finish:v,sort:y}}function b5(){let i=new WeakMap;function e(n,s){const a=i.get(n);let c;return a===void 0?(c=new qw,i.set(n,[c])):s>=a.length?(c=new qw,a.push(c)):c=a[s],c}function t(){i=new WeakMap}return{get:e,dispose:t}}function S5(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new J,color:new wt};break;case"SpotLight":t={position:new J,direction:new J,color:new wt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new J,color:new wt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new J,skyColor:new wt,groundColor:new wt};break;case"RectAreaLight":t={color:new wt,position:new J,halfWidth:new J,halfHeight:new J};break}return i[e.id]=t,t}}}function E5(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ke};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ke};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ke,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let M5=0;function T5(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function A5(i){const e=new S5,t=E5(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let m=0;m<9;m++)n.probe.push(new J);const s=new J,a=new on,c=new on;function f(m){let y=0,v=0,x=0;for(let P=0;P<9;P++)n.probe[P].set(0,0,0);let E=0,T=0,I=0,w=0,A=0,N=0,O=0,U=0,q=0,j=0,F=0;m.sort(T5);for(let P=0,H=m.length;P<H;P++){const B=m[P],X=B.color,k=B.intensity,ue=B.distance;let he=null;if(B.shadow&&B.shadow.map&&(B.shadow.map.texture.format===ad?he=B.shadow.map.texture:he=B.shadow.map.depthTexture||B.shadow.map.texture),B.isAmbientLight)y+=X.r*k,v+=X.g*k,x+=X.b*k;else if(B.isLightProbe){for(let ee=0;ee<9;ee++)n.probe[ee].addScaledVector(B.sh.coefficients[ee],k);F++}else if(B.isDirectionalLight){const ee=e.get(B);if(ee.color.copy(B.color).multiplyScalar(B.intensity),B.castShadow){const ie=B.shadow,ye=t.get(B);ye.shadowIntensity=ie.intensity,ye.shadowBias=ie.bias,ye.shadowNormalBias=ie.normalBias,ye.shadowRadius=ie.radius,ye.shadowMapSize=ie.mapSize,n.directionalShadow[E]=ye,n.directionalShadowMap[E]=he,n.directionalShadowMatrix[E]=B.shadow.matrix,N++}n.directional[E]=ee,E++}else if(B.isSpotLight){const ee=e.get(B);ee.position.setFromMatrixPosition(B.matrixWorld),ee.color.copy(X).multiplyScalar(k),ee.distance=ue,ee.coneCos=Math.cos(B.angle),ee.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),ee.decay=B.decay,n.spot[I]=ee;const ie=B.shadow;if(B.map&&(n.spotLightMap[q]=B.map,q++,ie.updateMatrices(B),B.castShadow&&j++),n.spotLightMatrix[I]=ie.matrix,B.castShadow){const ye=t.get(B);ye.shadowIntensity=ie.intensity,ye.shadowBias=ie.bias,ye.shadowNormalBias=ie.normalBias,ye.shadowRadius=ie.radius,ye.shadowMapSize=ie.mapSize,n.spotShadow[I]=ye,n.spotShadowMap[I]=he,U++}I++}else if(B.isRectAreaLight){const ee=e.get(B);ee.color.copy(X).multiplyScalar(k),ee.halfWidth.set(B.width*.5,0,0),ee.halfHeight.set(0,B.height*.5,0),n.rectArea[w]=ee,w++}else if(B.isPointLight){const ee=e.get(B);if(ee.color.copy(B.color).multiplyScalar(B.intensity),ee.distance=B.distance,ee.decay=B.decay,B.castShadow){const ie=B.shadow,ye=t.get(B);ye.shadowIntensity=ie.intensity,ye.shadowBias=ie.bias,ye.shadowNormalBias=ie.normalBias,ye.shadowRadius=ie.radius,ye.shadowMapSize=ie.mapSize,ye.shadowCameraNear=ie.camera.near,ye.shadowCameraFar=ie.camera.far,n.pointShadow[T]=ye,n.pointShadowMap[T]=he,n.pointShadowMatrix[T]=B.shadow.matrix,O++}n.point[T]=ee,T++}else if(B.isHemisphereLight){const ee=e.get(B);ee.skyColor.copy(B.color).multiplyScalar(k),ee.groundColor.copy(B.groundColor).multiplyScalar(k),n.hemi[A]=ee,A++}}w>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Et.LTC_FLOAT_1,n.rectAreaLTC2=Et.LTC_FLOAT_2):(n.rectAreaLTC1=Et.LTC_HALF_1,n.rectAreaLTC2=Et.LTC_HALF_2)),n.ambient[0]=y,n.ambient[1]=v,n.ambient[2]=x;const R=n.hash;(R.directionalLength!==E||R.pointLength!==T||R.spotLength!==I||R.rectAreaLength!==w||R.hemiLength!==A||R.numDirectionalShadows!==N||R.numPointShadows!==O||R.numSpotShadows!==U||R.numSpotMaps!==q||R.numLightProbes!==F)&&(n.directional.length=E,n.spot.length=I,n.rectArea.length=w,n.point.length=T,n.hemi.length=A,n.directionalShadow.length=N,n.directionalShadowMap.length=N,n.pointShadow.length=O,n.pointShadowMap.length=O,n.spotShadow.length=U,n.spotShadowMap.length=U,n.directionalShadowMatrix.length=N,n.pointShadowMatrix.length=O,n.spotLightMatrix.length=U+q-j,n.spotLightMap.length=q,n.numSpotLightShadowsWithMaps=j,n.numLightProbes=F,R.directionalLength=E,R.pointLength=T,R.spotLength=I,R.rectAreaLength=w,R.hemiLength=A,R.numDirectionalShadows=N,R.numPointShadows=O,R.numSpotShadows=U,R.numSpotMaps=q,R.numLightProbes=F,n.version=M5++)}function d(m,y){let v=0,x=0,E=0,T=0,I=0;const w=y.matrixWorldInverse;for(let A=0,N=m.length;A<N;A++){const O=m[A];if(O.isDirectionalLight){const U=n.directional[v];U.direction.setFromMatrixPosition(O.matrixWorld),s.setFromMatrixPosition(O.target.matrixWorld),U.direction.sub(s),U.direction.transformDirection(w),v++}else if(O.isSpotLight){const U=n.spot[E];U.position.setFromMatrixPosition(O.matrixWorld),U.position.applyMatrix4(w),U.direction.setFromMatrixPosition(O.matrixWorld),s.setFromMatrixPosition(O.target.matrixWorld),U.direction.sub(s),U.direction.transformDirection(w),E++}else if(O.isRectAreaLight){const U=n.rectArea[T];U.position.setFromMatrixPosition(O.matrixWorld),U.position.applyMatrix4(w),c.identity(),a.copy(O.matrixWorld),a.premultiply(w),c.extractRotation(a),U.halfWidth.set(O.width*.5,0,0),U.halfHeight.set(0,O.height*.5,0),U.halfWidth.applyMatrix4(c),U.halfHeight.applyMatrix4(c),T++}else if(O.isPointLight){const U=n.point[x];U.position.setFromMatrixPosition(O.matrixWorld),U.position.applyMatrix4(w),x++}else if(O.isHemisphereLight){const U=n.hemi[I];U.direction.setFromMatrixPosition(O.matrixWorld),U.direction.transformDirection(w),I++}}}return{setup:f,setupView:d,state:n}}function Xw(i){const e=new A5(i),t=[],n=[];function s(y){m.camera=y,t.length=0,n.length=0}function a(y){t.push(y)}function c(y){n.push(y)}function f(){e.setup(t)}function d(y){e.setupView(t,y)}const m={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:m,setupLights:f,setupLightsView:d,pushLight:a,pushShadow:c}}function w5(i){let e=new WeakMap;function t(s,a=0){const c=e.get(s);let f;return c===void 0?(f=new Xw(i),e.set(s,[f])):a>=c.length?(f=new Xw(i),c.push(f)):f=c[a],f}function n(){e=new WeakMap}return{get:t,dispose:n}}const C5=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,R5=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,I5=[new J(1,0,0),new J(-1,0,0),new J(0,1,0),new J(0,-1,0),new J(0,0,1),new J(0,0,-1)],D5=[new J(0,-1,0),new J(0,-1,0),new J(0,0,1),new J(0,0,-1),new J(0,-1,0),new J(0,-1,0)],Yw=new on,s0=new J,P1=new J;function N5(i,e,t){let n=new Em;const s=new ke,a=new ke,c=new Jn,f=new OM,d=new UM,m={},y=t.maxTextureSize,v={[vu]:jr,[jr]:vu,[bl]:bl},x=new Ga({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ke},radius:{value:4}},vertexShader:C5,fragmentShader:R5}),E=x.clone();E.defines.HORIZONTAL_PASS=1;const T=new vn;T.setAttribute("position",new vi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new _s(T,x),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Xp;let A=this.type;this.render=function(j,F,R){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||j.length===0)return;this.type===f0&&(St("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),this.type=Xp);const P=i.getRenderTarget(),H=i.getActiveCubeFace(),B=i.getActiveMipmapLevel(),X=i.state;X.setBlending(_c),X.buffers.depth.getReversed()===!0?X.buffers.color.setClear(0,0,0,0):X.buffers.color.setClear(1,1,1,1),X.buffers.depth.setTest(!0),X.setScissorTest(!1);const k=A!==this.type;k&&F.traverse(function(ue){ue.material&&(Array.isArray(ue.material)?ue.material.forEach(he=>he.needsUpdate=!0):ue.material.needsUpdate=!0)});for(let ue=0,he=j.length;ue<he;ue++){const ee=j[ue],ie=ee.shadow;if(ie===void 0){St("WebGLShadowMap:",ee,"has no shadow.");continue}if(ie.autoUpdate===!1&&ie.needsUpdate===!1)continue;s.copy(ie.mapSize);const ye=ie.getFrameExtents();s.multiply(ye),a.copy(ie.mapSize),(s.x>y||s.y>y)&&(s.x>y&&(a.x=Math.floor(y/ye.x),s.x=a.x*ye.x,ie.mapSize.x=a.x),s.y>y&&(a.y=Math.floor(y/ye.y),s.y=a.y*ye.y,ie.mapSize.y=a.y));const be=i.state.buffers.depth.getReversed();if(ie.camera._reversedDepth=be,ie.map===null||k===!0){if(ie.map!==null&&(ie.map.depthTexture!==null&&(ie.map.depthTexture.dispose(),ie.map.depthTexture=null),ie.map.dispose()),this.type===Yf){if(ee.isPointLight){St("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}ie.map=new co(s.x,s.y,{format:ad,type:Sc,minFilter:zi,magFilter:zi,generateMipmaps:!1}),ie.map.texture.name=ee.name+".shadowMap",ie.map.depthTexture=new om(s.x,s.y,fa),ie.map.depthTexture.name=ee.name+".shadowMapDepth",ie.map.depthTexture.format=Ec,ie.map.depthTexture.compareFunction=null,ie.map.depthTexture.minFilter=vs,ie.map.depthTexture.magFilter=vs}else ee.isPointLight?(ie.map=new ZM(s.x),ie.map.depthTexture=new z3(s.x,Wo)):(ie.map=new co(s.x,s.y),ie.map.depthTexture=new om(s.x,s.y,Wo)),ie.map.depthTexture.name=ee.name+".shadowMap",ie.map.depthTexture.format=Ec,this.type===Xp?(ie.map.depthTexture.compareFunction=be?Sb:bb,ie.map.depthTexture.minFilter=zi,ie.map.depthTexture.magFilter=zi):(ie.map.depthTexture.compareFunction=null,ie.map.depthTexture.minFilter=vs,ie.map.depthTexture.magFilter=vs);ie.camera.updateProjectionMatrix()}const Be=ie.map.isWebGLCubeRenderTarget?6:1;for(let Oe=0;Oe<Be;Oe++){if(ie.map.isWebGLCubeRenderTarget)i.setRenderTarget(ie.map,Oe),i.clear();else{Oe===0&&(i.setRenderTarget(ie.map),i.clear());const Pe=ie.getViewport(Oe);c.set(a.x*Pe.x,a.y*Pe.y,a.x*Pe.z,a.y*Pe.w),X.viewport(c)}if(ee.isPointLight){const Pe=ie.camera,$e=ie.matrix,Mt=ee.distance||Pe.far;Mt!==Pe.far&&(Pe.far=Mt,Pe.updateProjectionMatrix()),s0.setFromMatrixPosition(ee.matrixWorld),Pe.position.copy(s0),P1.copy(Pe.position),P1.add(I5[Oe]),Pe.up.copy(D5[Oe]),Pe.lookAt(P1),Pe.updateMatrixWorld(),$e.makeTranslation(-s0.x,-s0.y,-s0.z),Yw.multiplyMatrices(Pe.projectionMatrix,Pe.matrixWorldInverse),ie._frustum.setFromProjectionMatrix(Yw,Pe.coordinateSystem,Pe.reversedDepth)}else ie.updateMatrices(ee);n=ie.getFrustum(),U(F,R,ie.camera,ee,this.type)}ie.isPointLightShadow!==!0&&this.type===Yf&&N(ie,R),ie.needsUpdate=!1}A=this.type,w.needsUpdate=!1,i.setRenderTarget(P,H,B)};function N(j,F){const R=e.update(I);x.defines.VSM_SAMPLES!==j.blurSamples&&(x.defines.VSM_SAMPLES=j.blurSamples,E.defines.VSM_SAMPLES=j.blurSamples,x.needsUpdate=!0,E.needsUpdate=!0),j.mapPass===null&&(j.mapPass=new co(s.x,s.y,{format:ad,type:Sc})),x.uniforms.shadow_pass.value=j.map.depthTexture,x.uniforms.resolution.value=j.mapSize,x.uniforms.radius.value=j.radius,i.setRenderTarget(j.mapPass),i.clear(),i.renderBufferDirect(F,null,R,x,I,null),E.uniforms.shadow_pass.value=j.mapPass.texture,E.uniforms.resolution.value=j.mapSize,E.uniforms.radius.value=j.radius,i.setRenderTarget(j.map),i.clear(),i.renderBufferDirect(F,null,R,E,I,null)}function O(j,F,R,P){let H=null;const B=R.isPointLight===!0?j.customDistanceMaterial:j.customDepthMaterial;if(B!==void 0)H=B;else if(H=R.isPointLight===!0?d:f,i.localClippingEnabled&&F.clipShadows===!0&&Array.isArray(F.clippingPlanes)&&F.clippingPlanes.length!==0||F.displacementMap&&F.displacementScale!==0||F.alphaMap&&F.alphaTest>0||F.map&&F.alphaTest>0||F.alphaToCoverage===!0){const X=H.uuid,k=F.uuid;let ue=m[X];ue===void 0&&(ue={},m[X]=ue);let he=ue[k];he===void 0&&(he=H.clone(),ue[k]=he,F.addEventListener("dispose",q)),H=he}if(H.visible=F.visible,H.wireframe=F.wireframe,P===Yf?H.side=F.shadowSide!==null?F.shadowSide:F.side:H.side=F.shadowSide!==null?F.shadowSide:v[F.side],H.alphaMap=F.alphaMap,H.alphaTest=F.alphaToCoverage===!0?.5:F.alphaTest,H.map=F.map,H.clipShadows=F.clipShadows,H.clippingPlanes=F.clippingPlanes,H.clipIntersection=F.clipIntersection,H.displacementMap=F.displacementMap,H.displacementScale=F.displacementScale,H.displacementBias=F.displacementBias,H.wireframeLinewidth=F.wireframeLinewidth,H.linewidth=F.linewidth,R.isPointLight===!0&&H.isMeshDistanceMaterial===!0){const X=i.properties.get(H);X.light=R}return H}function U(j,F,R,P,H){if(j.visible===!1)return;if(j.layers.test(F.layers)&&(j.isMesh||j.isLine||j.isPoints)&&(j.castShadow||j.receiveShadow&&H===Yf)&&(!j.frustumCulled||n.intersectsObject(j))){j.modelViewMatrix.multiplyMatrices(R.matrixWorldInverse,j.matrixWorld);const k=e.update(j),ue=j.material;if(Array.isArray(ue)){const he=k.groups;for(let ee=0,ie=he.length;ee<ie;ee++){const ye=he[ee],be=ue[ye.materialIndex];if(be&&be.visible){const Be=O(j,be,P,H);j.onBeforeShadow(i,j,F,R,k,Be,ye),i.renderBufferDirect(R,null,k,Be,j,ye),j.onAfterShadow(i,j,F,R,k,Be,ye)}}}else if(ue.visible){const he=O(j,ue,P,H);j.onBeforeShadow(i,j,F,R,k,he,null),i.renderBufferDirect(R,null,k,he,j,null),j.onAfterShadow(i,j,F,R,k,he,null)}}const X=j.children;for(let k=0,ue=X.length;k<ue;k++)U(X[k],F,R,P,H)}function q(j){j.target.removeEventListener("dispose",q);for(const R in m){const P=m[R],H=j.target.uuid;H in P&&(P[H].dispose(),delete P[H])}}}function P5(i,e){function t(){let se=!1;const je=new Jn;let Ze=null;const Je=new Jn(0,0,0,0);return{setMask:function(Qe){Ze!==Qe&&!se&&(i.colorMask(Qe,Qe,Qe,Qe),Ze=Qe)},setLocked:function(Qe){se=Qe},setClear:function(Qe,Ce,dt,Bt,hn){hn===!0&&(Qe*=Bt,Ce*=Bt,dt*=Bt),je.set(Qe,Ce,dt,Bt),Je.equals(je)===!1&&(i.clearColor(Qe,Ce,dt,Bt),Je.copy(je))},reset:function(){se=!1,Ze=null,Je.set(-1,0,0,0)}}}function n(){let se=!1,je=!1,Ze=null,Je=null,Qe=null;return{setReversed:function(Ce){if(je!==Ce){const dt=e.get("EXT_clip_control");Ce?dt.clipControlEXT(dt.LOWER_LEFT_EXT,dt.ZERO_TO_ONE_EXT):dt.clipControlEXT(dt.LOWER_LEFT_EXT,dt.NEGATIVE_ONE_TO_ONE_EXT),je=Ce;const Bt=Qe;Qe=null,this.setClear(Bt)}},getReversed:function(){return je},setTest:function(Ce){Ce?tt(i.DEPTH_TEST):nt(i.DEPTH_TEST)},setMask:function(Ce){Ze!==Ce&&!se&&(i.depthMask(Ce),Ze=Ce)},setFunc:function(Ce){if(je&&(Ce=sO[Ce]),Je!==Ce){switch(Ce){case sx:i.depthFunc(i.NEVER);break;case rx:i.depthFunc(i.ALWAYS);break;case ax:i.depthFunc(i.LESS);break;case rd:i.depthFunc(i.LEQUAL);break;case ox:i.depthFunc(i.EQUAL);break;case lx:i.depthFunc(i.GEQUAL);break;case cx:i.depthFunc(i.GREATER);break;case ux:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Je=Ce}},setLocked:function(Ce){se=Ce},setClear:function(Ce){Qe!==Ce&&(Qe=Ce,je&&(Ce=1-Ce),i.clearDepth(Ce))},reset:function(){se=!1,Ze=null,Je=null,Qe=null,je=!1}}}function s(){let se=!1,je=null,Ze=null,Je=null,Qe=null,Ce=null,dt=null,Bt=null,hn=null;return{setTest:function(nn){se||(nn?tt(i.STENCIL_TEST):nt(i.STENCIL_TEST))},setMask:function(nn){je!==nn&&!se&&(i.stencilMask(nn),je=nn)},setFunc:function(nn,Si,Gi){(Ze!==nn||Je!==Si||Qe!==Gi)&&(i.stencilFunc(nn,Si,Gi),Ze=nn,Je=Si,Qe=Gi)},setOp:function(nn,Si,Gi){(Ce!==nn||dt!==Si||Bt!==Gi)&&(i.stencilOp(nn,Si,Gi),Ce=nn,dt=Si,Bt=Gi)},setLocked:function(nn){se=nn},setClear:function(nn){hn!==nn&&(i.clearStencil(nn),hn=nn)},reset:function(){se=!1,je=null,Ze=null,Je=null,Qe=null,Ce=null,dt=null,Bt=null,hn=null}}}const a=new t,c=new n,f=new s,d=new WeakMap,m=new WeakMap;let y={},v={},x=new WeakMap,E=[],T=null,I=!1,w=null,A=null,N=null,O=null,U=null,q=null,j=null,F=new wt(0,0,0),R=0,P=!1,H=null,B=null,X=null,k=null,ue=null;const he=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ee=!1,ie=0;const ye=i.getParameter(i.VERSION);ye.indexOf("WebGL")!==-1?(ie=parseFloat(/^WebGL (\d)/.exec(ye)[1]),ee=ie>=1):ye.indexOf("OpenGL ES")!==-1&&(ie=parseFloat(/^OpenGL ES (\d)/.exec(ye)[1]),ee=ie>=2);let be=null,Be={};const Oe=i.getParameter(i.SCISSOR_BOX),Pe=i.getParameter(i.VIEWPORT),$e=new Jn().fromArray(Oe),Mt=new Jn().fromArray(Pe);function Yt(se,je,Ze,Je){const Qe=new Uint8Array(4),Ce=i.createTexture();i.bindTexture(se,Ce),i.texParameteri(se,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(se,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let dt=0;dt<Ze;dt++)se===i.TEXTURE_3D||se===i.TEXTURE_2D_ARRAY?i.texImage3D(je,0,i.RGBA,1,1,Je,0,i.RGBA,i.UNSIGNED_BYTE,Qe):i.texImage2D(je+dt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Qe);return Ce}const Ie={};Ie[i.TEXTURE_2D]=Yt(i.TEXTURE_2D,i.TEXTURE_2D,1),Ie[i.TEXTURE_CUBE_MAP]=Yt(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ie[i.TEXTURE_2D_ARRAY]=Yt(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),Ie[i.TEXTURE_3D]=Yt(i.TEXTURE_3D,i.TEXTURE_3D,1,1),a.setClear(0,0,0,1),c.setClear(1),f.setClear(0),tt(i.DEPTH_TEST),c.setFunc(rd),ze(!1),ot(rE),tt(i.CULL_FACE),Ue(_c);function tt(se){y[se]!==!0&&(i.enable(se),y[se]=!0)}function nt(se){y[se]!==!1&&(i.disable(se),y[se]=!1)}function Tt(se,je){return v[se]!==je?(i.bindFramebuffer(se,je),v[se]=je,se===i.DRAW_FRAMEBUFFER&&(v[i.FRAMEBUFFER]=je),se===i.FRAMEBUFFER&&(v[i.DRAW_FRAMEBUFFER]=je),!0):!1}function Lt(se,je){let Ze=E,Je=!1;if(se){Ze=x.get(je),Ze===void 0&&(Ze=[],x.set(je,Ze));const Qe=se.textures;if(Ze.length!==Qe.length||Ze[0]!==i.COLOR_ATTACHMENT0){for(let Ce=0,dt=Qe.length;Ce<dt;Ce++)Ze[Ce]=i.COLOR_ATTACHMENT0+Ce;Ze.length=Qe.length,Je=!0}}else Ze[0]!==i.BACK&&(Ze[0]=i.BACK,Je=!0);Je&&i.drawBuffers(Ze)}function Ht(se){return T!==se?(i.useProgram(se),T=se,!0):!1}const un={[_h]:i.FUNC_ADD,[WR]:i.FUNC_SUBTRACT,[qR]:i.FUNC_REVERSE_SUBTRACT};un[XR]=i.MIN,un[YR]=i.MAX;const zt={[ZR]:i.ZERO,[KR]:i.ONE,[QR]:i.SRC_COLOR,[nx]:i.SRC_ALPHA,[i3]:i.SRC_ALPHA_SATURATE,[t3]:i.DST_COLOR,[JR]:i.DST_ALPHA,[$R]:i.ONE_MINUS_SRC_COLOR,[ix]:i.ONE_MINUS_SRC_ALPHA,[n3]:i.ONE_MINUS_DST_COLOR,[e3]:i.ONE_MINUS_DST_ALPHA,[s3]:i.CONSTANT_COLOR,[r3]:i.ONE_MINUS_CONSTANT_COLOR,[a3]:i.CONSTANT_ALPHA,[o3]:i.ONE_MINUS_CONSTANT_ALPHA};function Ue(se,je,Ze,Je,Qe,Ce,dt,Bt,hn,nn){if(se===_c){I===!0&&(nt(i.BLEND),I=!1);return}if(I===!1&&(tt(i.BLEND),I=!0),se!==jR){if(se!==w||nn!==P){if((A!==_h||U!==_h)&&(i.blendEquation(i.FUNC_ADD),A=_h,U=_h),nn)switch(se){case Jf:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case tx:i.blendFunc(i.ONE,i.ONE);break;case aE:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case oE:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:Gt("WebGLState: Invalid blending: ",se);break}else switch(se){case Jf:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case tx:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case aE:Gt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case oE:Gt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Gt("WebGLState: Invalid blending: ",se);break}N=null,O=null,q=null,j=null,F.set(0,0,0),R=0,w=se,P=nn}return}Qe=Qe||je,Ce=Ce||Ze,dt=dt||Je,(je!==A||Qe!==U)&&(i.blendEquationSeparate(un[je],un[Qe]),A=je,U=Qe),(Ze!==N||Je!==O||Ce!==q||dt!==j)&&(i.blendFuncSeparate(zt[Ze],zt[Je],zt[Ce],zt[dt]),N=Ze,O=Je,q=Ce,j=dt),(Bt.equals(F)===!1||hn!==R)&&(i.blendColor(Bt.r,Bt.g,Bt.b,hn),F.copy(Bt),R=hn),w=se,P=!1}function Ye(se,je){se.side===bl?nt(i.CULL_FACE):tt(i.CULL_FACE);let Ze=se.side===jr;je&&(Ze=!Ze),ze(Ze),se.blending===Jf&&se.transparent===!1?Ue(_c):Ue(se.blending,se.blendEquation,se.blendSrc,se.blendDst,se.blendEquationAlpha,se.blendSrcAlpha,se.blendDstAlpha,se.blendColor,se.blendAlpha,se.premultipliedAlpha),c.setFunc(se.depthFunc),c.setTest(se.depthTest),c.setMask(se.depthWrite),a.setMask(se.colorWrite);const Je=se.stencilWrite;f.setTest(Je),Je&&(f.setMask(se.stencilWriteMask),f.setFunc(se.stencilFunc,se.stencilRef,se.stencilFuncMask),f.setOp(se.stencilFail,se.stencilZFail,se.stencilZPass)),yt(se.polygonOffset,se.polygonOffsetFactor,se.polygonOffsetUnits),se.alphaToCoverage===!0?tt(i.SAMPLE_ALPHA_TO_COVERAGE):nt(i.SAMPLE_ALPHA_TO_COVERAGE)}function ze(se){H!==se&&(se?i.frontFace(i.CW):i.frontFace(i.CCW),H=se)}function ot(se){se!==kR?(tt(i.CULL_FACE),se!==B&&(se===rE?i.cullFace(i.BACK):se===HR?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):nt(i.CULL_FACE),B=se}function te(se){se!==X&&(ee&&i.lineWidth(se),X=se)}function yt(se,je,Ze){se?(tt(i.POLYGON_OFFSET_FILL),(k!==je||ue!==Ze)&&(k=je,ue=Ze,c.getReversed()&&(je=-je),i.polygonOffset(je,Ze))):nt(i.POLYGON_OFFSET_FILL)}function it(se){se?tt(i.SCISSOR_TEST):nt(i.SCISSOR_TEST)}function Rt(se){se===void 0&&(se=i.TEXTURE0+he-1),be!==se&&(i.activeTexture(se),be=se)}function st(se,je,Ze){Ze===void 0&&(be===null?Ze=i.TEXTURE0+he-1:Ze=be);let Je=Be[Ze];Je===void 0&&(Je={type:void 0,texture:void 0},Be[Ze]=Je),(Je.type!==se||Je.texture!==je)&&(be!==Ze&&(i.activeTexture(Ze),be=Ze),i.bindTexture(se,je||Ie[se]),Je.type=se,Je.texture=je)}function Q(){const se=Be[be];se!==void 0&&se.type!==void 0&&(i.bindTexture(se.type,null),se.type=void 0,se.texture=void 0)}function G(){try{i.compressedTexImage2D(...arguments)}catch(se){Gt("WebGLState:",se)}}function oe(){try{i.compressedTexImage3D(...arguments)}catch(se){Gt("WebGLState:",se)}}function Ae(){try{i.texSubImage2D(...arguments)}catch(se){Gt("WebGLState:",se)}}function Fe(){try{i.texSubImage3D(...arguments)}catch(se){Gt("WebGLState:",se)}}function we(){try{i.compressedTexSubImage2D(...arguments)}catch(se){Gt("WebGLState:",se)}}function vt(){try{i.compressedTexSubImage3D(...arguments)}catch(se){Gt("WebGLState:",se)}}function rt(){try{i.texStorage2D(...arguments)}catch(se){Gt("WebGLState:",se)}}function It(){try{i.texStorage3D(...arguments)}catch(se){Gt("WebGLState:",se)}}function Ft(){try{i.texImage2D(...arguments)}catch(se){Gt("WebGLState:",se)}}function We(){try{i.texImage3D(...arguments)}catch(se){Gt("WebGLState:",se)}}function Xe(se){$e.equals(se)===!1&&(i.scissor(se.x,se.y,se.z,se.w),$e.copy(se))}function _t(se){Mt.equals(se)===!1&&(i.viewport(se.x,se.y,se.z,se.w),Mt.copy(se))}function ne(se,je){let Ze=m.get(je);Ze===void 0&&(Ze=new WeakMap,m.set(je,Ze));let Je=Ze.get(se);Je===void 0&&(Je=i.getUniformBlockIndex(je,se.name),Ze.set(se,Je))}function xe(se,je){const Je=m.get(je).get(se);d.get(je)!==Je&&(i.uniformBlockBinding(je,Je,se.__bindingPointIndex),d.set(je,Je))}function at(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),c.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),y={},be=null,Be={},v={},x=new WeakMap,E=[],T=null,I=!1,w=null,A=null,N=null,O=null,U=null,q=null,j=null,F=new wt(0,0,0),R=0,P=!1,H=null,B=null,X=null,k=null,ue=null,$e.set(0,0,i.canvas.width,i.canvas.height),Mt.set(0,0,i.canvas.width,i.canvas.height),a.reset(),c.reset(),f.reset()}return{buffers:{color:a,depth:c,stencil:f},enable:tt,disable:nt,bindFramebuffer:Tt,drawBuffers:Lt,useProgram:Ht,setBlending:Ue,setMaterial:Ye,setFlipSided:ze,setCullFace:ot,setLineWidth:te,setPolygonOffset:yt,setScissorTest:it,activeTexture:Rt,bindTexture:st,unbindTexture:Q,compressedTexImage2D:G,compressedTexImage3D:oe,texImage2D:Ft,texImage3D:We,updateUBOMapping:ne,uniformBlockBinding:xe,texStorage2D:rt,texStorage3D:It,texSubImage2D:Ae,texSubImage3D:Fe,compressedTexSubImage2D:we,compressedTexSubImage3D:vt,scissor:Xe,viewport:_t,reset:at}}function L5(i,e,t,n,s,a,c){const f=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),m=new ke,y=new WeakMap;let v;const x=new WeakMap;let E=!1;try{E=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function T(Q,G){return E?new OffscreenCanvas(Q,G):U0("canvas")}function I(Q,G,oe){let Ae=1;const Fe=st(Q);if((Fe.width>oe||Fe.height>oe)&&(Ae=oe/Math.max(Fe.width,Fe.height)),Ae<1)if(typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Q instanceof ImageBitmap||typeof VideoFrame<"u"&&Q instanceof VideoFrame){const we=Math.floor(Ae*Fe.width),vt=Math.floor(Ae*Fe.height);v===void 0&&(v=T(we,vt));const rt=G?T(we,vt):v;return rt.width=we,rt.height=vt,rt.getContext("2d").drawImage(Q,0,0,we,vt),St("WebGLRenderer: Texture has been resized from ("+Fe.width+"x"+Fe.height+") to ("+we+"x"+vt+")."),rt}else return"data"in Q&&St("WebGLRenderer: Image in DataTexture is too big ("+Fe.width+"x"+Fe.height+")."),Q;return Q}function w(Q){return Q.generateMipmaps}function A(Q){i.generateMipmap(Q)}function N(Q){return Q.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:Q.isWebGL3DRenderTarget?i.TEXTURE_3D:Q.isWebGLArrayRenderTarget||Q.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function O(Q,G,oe,Ae,Fe=!1){if(Q!==null){if(i[Q]!==void 0)return i[Q];St("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Q+"'")}let we=G;if(G===i.RED&&(oe===i.FLOAT&&(we=i.R32F),oe===i.HALF_FLOAT&&(we=i.R16F),oe===i.UNSIGNED_BYTE&&(we=i.R8)),G===i.RED_INTEGER&&(oe===i.UNSIGNED_BYTE&&(we=i.R8UI),oe===i.UNSIGNED_SHORT&&(we=i.R16UI),oe===i.UNSIGNED_INT&&(we=i.R32UI),oe===i.BYTE&&(we=i.R8I),oe===i.SHORT&&(we=i.R16I),oe===i.INT&&(we=i.R32I)),G===i.RG&&(oe===i.FLOAT&&(we=i.RG32F),oe===i.HALF_FLOAT&&(we=i.RG16F),oe===i.UNSIGNED_BYTE&&(we=i.RG8)),G===i.RG_INTEGER&&(oe===i.UNSIGNED_BYTE&&(we=i.RG8UI),oe===i.UNSIGNED_SHORT&&(we=i.RG16UI),oe===i.UNSIGNED_INT&&(we=i.RG32UI),oe===i.BYTE&&(we=i.RG8I),oe===i.SHORT&&(we=i.RG16I),oe===i.INT&&(we=i.RG32I)),G===i.RGB_INTEGER&&(oe===i.UNSIGNED_BYTE&&(we=i.RGB8UI),oe===i.UNSIGNED_SHORT&&(we=i.RGB16UI),oe===i.UNSIGNED_INT&&(we=i.RGB32UI),oe===i.BYTE&&(we=i.RGB8I),oe===i.SHORT&&(we=i.RGB16I),oe===i.INT&&(we=i.RGB32I)),G===i.RGBA_INTEGER&&(oe===i.UNSIGNED_BYTE&&(we=i.RGBA8UI),oe===i.UNSIGNED_SHORT&&(we=i.RGBA16UI),oe===i.UNSIGNED_INT&&(we=i.RGBA32UI),oe===i.BYTE&&(we=i.RGBA8I),oe===i.SHORT&&(we=i.RGBA16I),oe===i.INT&&(we=i.RGBA32I)),G===i.RGB&&(oe===i.UNSIGNED_INT_5_9_9_9_REV&&(we=i.RGB9_E5),oe===i.UNSIGNED_INT_10F_11F_11F_REV&&(we=i.R11F_G11F_B10F)),G===i.RGBA){const vt=Fe?L0:Gn.getTransfer(Ae);oe===i.FLOAT&&(we=i.RGBA32F),oe===i.HALF_FLOAT&&(we=i.RGBA16F),oe===i.UNSIGNED_BYTE&&(we=vt===hi?i.SRGB8_ALPHA8:i.RGBA8),oe===i.UNSIGNED_SHORT_4_4_4_4&&(we=i.RGBA4),oe===i.UNSIGNED_SHORT_5_5_5_1&&(we=i.RGB5_A1)}return(we===i.R16F||we===i.R32F||we===i.RG16F||we===i.RG32F||we===i.RGBA16F||we===i.RGBA32F)&&e.get("EXT_color_buffer_float"),we}function U(Q,G){let oe;return Q?G===null||G===Wo||G===im?oe=i.DEPTH24_STENCIL8:G===fa?oe=i.DEPTH32F_STENCIL8:G===nm&&(oe=i.DEPTH24_STENCIL8,St("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):G===null||G===Wo||G===im?oe=i.DEPTH_COMPONENT24:G===fa?oe=i.DEPTH_COMPONENT32F:G===nm&&(oe=i.DEPTH_COMPONENT16),oe}function q(Q,G){return w(Q)===!0||Q.isFramebufferTexture&&Q.minFilter!==vs&&Q.minFilter!==zi?Math.log2(Math.max(G.width,G.height))+1:Q.mipmaps!==void 0&&Q.mipmaps.length>0?Q.mipmaps.length:Q.isCompressedTexture&&Array.isArray(Q.image)?G.mipmaps.length:1}function j(Q){const G=Q.target;G.removeEventListener("dispose",j),R(G),G.isVideoTexture&&y.delete(G)}function F(Q){const G=Q.target;G.removeEventListener("dispose",F),H(G)}function R(Q){const G=n.get(Q);if(G.__webglInit===void 0)return;const oe=Q.source,Ae=x.get(oe);if(Ae){const Fe=Ae[G.__cacheKey];Fe.usedTimes--,Fe.usedTimes===0&&P(Q),Object.keys(Ae).length===0&&x.delete(oe)}n.remove(Q)}function P(Q){const G=n.get(Q);i.deleteTexture(G.__webglTexture);const oe=Q.source,Ae=x.get(oe);delete Ae[G.__cacheKey],c.memory.textures--}function H(Q){const G=n.get(Q);if(Q.depthTexture&&(Q.depthTexture.dispose(),n.remove(Q.depthTexture)),Q.isWebGLCubeRenderTarget)for(let Ae=0;Ae<6;Ae++){if(Array.isArray(G.__webglFramebuffer[Ae]))for(let Fe=0;Fe<G.__webglFramebuffer[Ae].length;Fe++)i.deleteFramebuffer(G.__webglFramebuffer[Ae][Fe]);else i.deleteFramebuffer(G.__webglFramebuffer[Ae]);G.__webglDepthbuffer&&i.deleteRenderbuffer(G.__webglDepthbuffer[Ae])}else{if(Array.isArray(G.__webglFramebuffer))for(let Ae=0;Ae<G.__webglFramebuffer.length;Ae++)i.deleteFramebuffer(G.__webglFramebuffer[Ae]);else i.deleteFramebuffer(G.__webglFramebuffer);if(G.__webglDepthbuffer&&i.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&i.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer)for(let Ae=0;Ae<G.__webglColorRenderbuffer.length;Ae++)G.__webglColorRenderbuffer[Ae]&&i.deleteRenderbuffer(G.__webglColorRenderbuffer[Ae]);G.__webglDepthRenderbuffer&&i.deleteRenderbuffer(G.__webglDepthRenderbuffer)}const oe=Q.textures;for(let Ae=0,Fe=oe.length;Ae<Fe;Ae++){const we=n.get(oe[Ae]);we.__webglTexture&&(i.deleteTexture(we.__webglTexture),c.memory.textures--),n.remove(oe[Ae])}n.remove(Q)}let B=0;function X(){B=0}function k(){const Q=B;return Q>=s.maxTextures&&St("WebGLTextures: Trying to use "+Q+" texture units while this GPU supports only "+s.maxTextures),B+=1,Q}function ue(Q){const G=[];return G.push(Q.wrapS),G.push(Q.wrapT),G.push(Q.wrapR||0),G.push(Q.magFilter),G.push(Q.minFilter),G.push(Q.anisotropy),G.push(Q.internalFormat),G.push(Q.format),G.push(Q.type),G.push(Q.generateMipmaps),G.push(Q.premultiplyAlpha),G.push(Q.flipY),G.push(Q.unpackAlignment),G.push(Q.colorSpace),G.join()}function he(Q,G){const oe=n.get(Q);if(Q.isVideoTexture&&it(Q),Q.isRenderTargetTexture===!1&&Q.isExternalTexture!==!0&&Q.version>0&&oe.__version!==Q.version){const Ae=Q.image;if(Ae===null)St("WebGLRenderer: Texture marked for update but no image data found.");else if(Ae.complete===!1)St("WebGLRenderer: Texture marked for update but image is incomplete");else{Ie(oe,Q,G);return}}else Q.isExternalTexture&&(oe.__webglTexture=Q.sourceTexture?Q.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,oe.__webglTexture,i.TEXTURE0+G)}function ee(Q,G){const oe=n.get(Q);if(Q.isRenderTargetTexture===!1&&Q.version>0&&oe.__version!==Q.version){Ie(oe,Q,G);return}else Q.isExternalTexture&&(oe.__webglTexture=Q.sourceTexture?Q.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,oe.__webglTexture,i.TEXTURE0+G)}function ie(Q,G){const oe=n.get(Q);if(Q.isRenderTargetTexture===!1&&Q.version>0&&oe.__version!==Q.version){Ie(oe,Q,G);return}t.bindTexture(i.TEXTURE_3D,oe.__webglTexture,i.TEXTURE0+G)}function ye(Q,G){const oe=n.get(Q);if(Q.isCubeDepthTexture!==!0&&Q.version>0&&oe.__version!==Q.version){tt(oe,Q,G);return}t.bindTexture(i.TEXTURE_CUBE_MAP,oe.__webglTexture,i.TEXTURE0+G)}const be={[I0]:i.REPEAT,[Ha]:i.CLAMP_TO_EDGE,[D0]:i.MIRRORED_REPEAT},Be={[vs]:i.NEAREST,[cM]:i.NEAREST_MIPMAP_NEAREST,[jp]:i.NEAREST_MIPMAP_LINEAR,[zi]:i.LINEAR,[m0]:i.LINEAR_MIPMAP_NEAREST,[gc]:i.LINEAR_MIPMAP_LINEAR},Oe={[g3]:i.NEVER,[b3]:i.ALWAYS,[y3]:i.LESS,[bb]:i.LEQUAL,[v3]:i.EQUAL,[Sb]:i.GEQUAL,[_3]:i.GREATER,[x3]:i.NOTEQUAL};function Pe(Q,G){if(G.type===fa&&e.has("OES_texture_float_linear")===!1&&(G.magFilter===zi||G.magFilter===m0||G.magFilter===jp||G.magFilter===gc||G.minFilter===zi||G.minFilter===m0||G.minFilter===jp||G.minFilter===gc)&&St("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(Q,i.TEXTURE_WRAP_S,be[G.wrapS]),i.texParameteri(Q,i.TEXTURE_WRAP_T,be[G.wrapT]),(Q===i.TEXTURE_3D||Q===i.TEXTURE_2D_ARRAY)&&i.texParameteri(Q,i.TEXTURE_WRAP_R,be[G.wrapR]),i.texParameteri(Q,i.TEXTURE_MAG_FILTER,Be[G.magFilter]),i.texParameteri(Q,i.TEXTURE_MIN_FILTER,Be[G.minFilter]),G.compareFunction&&(i.texParameteri(Q,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(Q,i.TEXTURE_COMPARE_FUNC,Oe[G.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(G.magFilter===vs||G.minFilter!==jp&&G.minFilter!==gc||G.type===fa&&e.has("OES_texture_float_linear")===!1)return;if(G.anisotropy>1||n.get(G).__currentAnisotropy){const oe=e.get("EXT_texture_filter_anisotropic");i.texParameterf(Q,oe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(G.anisotropy,s.getMaxAnisotropy())),n.get(G).__currentAnisotropy=G.anisotropy}}}function $e(Q,G){let oe=!1;Q.__webglInit===void 0&&(Q.__webglInit=!0,G.addEventListener("dispose",j));const Ae=G.source;let Fe=x.get(Ae);Fe===void 0&&(Fe={},x.set(Ae,Fe));const we=ue(G);if(we!==Q.__cacheKey){Fe[we]===void 0&&(Fe[we]={texture:i.createTexture(),usedTimes:0},c.memory.textures++,oe=!0),Fe[we].usedTimes++;const vt=Fe[Q.__cacheKey];vt!==void 0&&(Fe[Q.__cacheKey].usedTimes--,vt.usedTimes===0&&P(G)),Q.__cacheKey=we,Q.__webglTexture=Fe[we].texture}return oe}function Mt(Q,G,oe){return Math.floor(Math.floor(Q/oe)/G)}function Yt(Q,G,oe,Ae){const we=Q.updateRanges;if(we.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,G.width,G.height,oe,Ae,G.data);else{we.sort((We,Xe)=>We.start-Xe.start);let vt=0;for(let We=1;We<we.length;We++){const Xe=we[vt],_t=we[We],ne=Xe.start+Xe.count,xe=Mt(_t.start,G.width,4),at=Mt(Xe.start,G.width,4);_t.start<=ne+1&&xe===at&&Mt(_t.start+_t.count-1,G.width,4)===xe?Xe.count=Math.max(Xe.count,_t.start+_t.count-Xe.start):(++vt,we[vt]=_t)}we.length=vt+1;const rt=i.getParameter(i.UNPACK_ROW_LENGTH),It=i.getParameter(i.UNPACK_SKIP_PIXELS),Ft=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,G.width);for(let We=0,Xe=we.length;We<Xe;We++){const _t=we[We],ne=Math.floor(_t.start/4),xe=Math.ceil(_t.count/4),at=ne%G.width,se=Math.floor(ne/G.width),je=xe,Ze=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,at),i.pixelStorei(i.UNPACK_SKIP_ROWS,se),t.texSubImage2D(i.TEXTURE_2D,0,at,se,je,Ze,oe,Ae,G.data)}Q.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,rt),i.pixelStorei(i.UNPACK_SKIP_PIXELS,It),i.pixelStorei(i.UNPACK_SKIP_ROWS,Ft)}}function Ie(Q,G,oe){let Ae=i.TEXTURE_2D;(G.isDataArrayTexture||G.isCompressedArrayTexture)&&(Ae=i.TEXTURE_2D_ARRAY),G.isData3DTexture&&(Ae=i.TEXTURE_3D);const Fe=$e(Q,G),we=G.source;t.bindTexture(Ae,Q.__webglTexture,i.TEXTURE0+oe);const vt=n.get(we);if(we.version!==vt.__version||Fe===!0){t.activeTexture(i.TEXTURE0+oe);const rt=Gn.getPrimaries(Gn.workingColorSpace),It=G.colorSpace===pu?null:Gn.getPrimaries(G.colorSpace),Ft=G.colorSpace===pu||rt===It?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,G.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,G.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ft);let We=I(G.image,!1,s.maxTextureSize);We=Rt(G,We);const Xe=a.convert(G.format,G.colorSpace),_t=a.convert(G.type);let ne=O(G.internalFormat,Xe,_t,G.colorSpace,G.isVideoTexture);Pe(Ae,G);let xe;const at=G.mipmaps,se=G.isVideoTexture!==!0,je=vt.__version===void 0||Fe===!0,Ze=we.dataReady,Je=q(G,We);if(G.isDepthTexture)ne=U(G.format===bh,G.type),je&&(se?t.texStorage2D(i.TEXTURE_2D,1,ne,We.width,We.height):t.texImage2D(i.TEXTURE_2D,0,ne,We.width,We.height,0,Xe,_t,null));else if(G.isDataTexture)if(at.length>0){se&&je&&t.texStorage2D(i.TEXTURE_2D,Je,ne,at[0].width,at[0].height);for(let Qe=0,Ce=at.length;Qe<Ce;Qe++)xe=at[Qe],se?Ze&&t.texSubImage2D(i.TEXTURE_2D,Qe,0,0,xe.width,xe.height,Xe,_t,xe.data):t.texImage2D(i.TEXTURE_2D,Qe,ne,xe.width,xe.height,0,Xe,_t,xe.data);G.generateMipmaps=!1}else se?(je&&t.texStorage2D(i.TEXTURE_2D,Je,ne,We.width,We.height),Ze&&Yt(G,We,Xe,_t)):t.texImage2D(i.TEXTURE_2D,0,ne,We.width,We.height,0,Xe,_t,We.data);else if(G.isCompressedTexture)if(G.isCompressedArrayTexture){se&&je&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Je,ne,at[0].width,at[0].height,We.depth);for(let Qe=0,Ce=at.length;Qe<Ce;Qe++)if(xe=at[Qe],G.format!==Gr)if(Xe!==null)if(se){if(Ze)if(G.layerUpdates.size>0){const dt=vE(xe.width,xe.height,G.format,G.type);for(const Bt of G.layerUpdates){const hn=xe.data.subarray(Bt*dt/xe.data.BYTES_PER_ELEMENT,(Bt+1)*dt/xe.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Qe,0,0,Bt,xe.width,xe.height,1,Xe,hn)}G.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Qe,0,0,0,xe.width,xe.height,We.depth,Xe,xe.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Qe,ne,xe.width,xe.height,We.depth,0,xe.data,0,0);else St("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else se?Ze&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,Qe,0,0,0,xe.width,xe.height,We.depth,Xe,_t,xe.data):t.texImage3D(i.TEXTURE_2D_ARRAY,Qe,ne,xe.width,xe.height,We.depth,0,Xe,_t,xe.data)}else{se&&je&&t.texStorage2D(i.TEXTURE_2D,Je,ne,at[0].width,at[0].height);for(let Qe=0,Ce=at.length;Qe<Ce;Qe++)xe=at[Qe],G.format!==Gr?Xe!==null?se?Ze&&t.compressedTexSubImage2D(i.TEXTURE_2D,Qe,0,0,xe.width,xe.height,Xe,xe.data):t.compressedTexImage2D(i.TEXTURE_2D,Qe,ne,xe.width,xe.height,0,xe.data):St("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):se?Ze&&t.texSubImage2D(i.TEXTURE_2D,Qe,0,0,xe.width,xe.height,Xe,_t,xe.data):t.texImage2D(i.TEXTURE_2D,Qe,ne,xe.width,xe.height,0,Xe,_t,xe.data)}else if(G.isDataArrayTexture)if(se){if(je&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Je,ne,We.width,We.height,We.depth),Ze)if(G.layerUpdates.size>0){const Qe=vE(We.width,We.height,G.format,G.type);for(const Ce of G.layerUpdates){const dt=We.data.subarray(Ce*Qe/We.data.BYTES_PER_ELEMENT,(Ce+1)*Qe/We.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,Ce,We.width,We.height,1,Xe,_t,dt)}G.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,We.width,We.height,We.depth,Xe,_t,We.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,ne,We.width,We.height,We.depth,0,Xe,_t,We.data);else if(G.isData3DTexture)se?(je&&t.texStorage3D(i.TEXTURE_3D,Je,ne,We.width,We.height,We.depth),Ze&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,We.width,We.height,We.depth,Xe,_t,We.data)):t.texImage3D(i.TEXTURE_3D,0,ne,We.width,We.height,We.depth,0,Xe,_t,We.data);else if(G.isFramebufferTexture){if(je)if(se)t.texStorage2D(i.TEXTURE_2D,Je,ne,We.width,We.height);else{let Qe=We.width,Ce=We.height;for(let dt=0;dt<Je;dt++)t.texImage2D(i.TEXTURE_2D,dt,ne,Qe,Ce,0,Xe,_t,null),Qe>>=1,Ce>>=1}}else if(at.length>0){if(se&&je){const Qe=st(at[0]);t.texStorage2D(i.TEXTURE_2D,Je,ne,Qe.width,Qe.height)}for(let Qe=0,Ce=at.length;Qe<Ce;Qe++)xe=at[Qe],se?Ze&&t.texSubImage2D(i.TEXTURE_2D,Qe,0,0,Xe,_t,xe):t.texImage2D(i.TEXTURE_2D,Qe,ne,Xe,_t,xe);G.generateMipmaps=!1}else if(se){if(je){const Qe=st(We);t.texStorage2D(i.TEXTURE_2D,Je,ne,Qe.width,Qe.height)}Ze&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Xe,_t,We)}else t.texImage2D(i.TEXTURE_2D,0,ne,Xe,_t,We);w(G)&&A(Ae),vt.__version=we.version,G.onUpdate&&G.onUpdate(G)}Q.__version=G.version}function tt(Q,G,oe){if(G.image.length!==6)return;const Ae=$e(Q,G),Fe=G.source;t.bindTexture(i.TEXTURE_CUBE_MAP,Q.__webglTexture,i.TEXTURE0+oe);const we=n.get(Fe);if(Fe.version!==we.__version||Ae===!0){t.activeTexture(i.TEXTURE0+oe);const vt=Gn.getPrimaries(Gn.workingColorSpace),rt=G.colorSpace===pu?null:Gn.getPrimaries(G.colorSpace),It=G.colorSpace===pu||vt===rt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,G.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,G.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,It);const Ft=G.isCompressedTexture||G.image[0].isCompressedTexture,We=G.image[0]&&G.image[0].isDataTexture,Xe=[];for(let Ce=0;Ce<6;Ce++)!Ft&&!We?Xe[Ce]=I(G.image[Ce],!0,s.maxCubemapSize):Xe[Ce]=We?G.image[Ce].image:G.image[Ce],Xe[Ce]=Rt(G,Xe[Ce]);const _t=Xe[0],ne=a.convert(G.format,G.colorSpace),xe=a.convert(G.type),at=O(G.internalFormat,ne,xe,G.colorSpace),se=G.isVideoTexture!==!0,je=we.__version===void 0||Ae===!0,Ze=Fe.dataReady;let Je=q(G,_t);Pe(i.TEXTURE_CUBE_MAP,G);let Qe;if(Ft){se&&je&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Je,at,_t.width,_t.height);for(let Ce=0;Ce<6;Ce++){Qe=Xe[Ce].mipmaps;for(let dt=0;dt<Qe.length;dt++){const Bt=Qe[dt];G.format!==Gr?ne!==null?se?Ze&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,dt,0,0,Bt.width,Bt.height,ne,Bt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,dt,at,Bt.width,Bt.height,0,Bt.data):St("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):se?Ze&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,dt,0,0,Bt.width,Bt.height,ne,xe,Bt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,dt,at,Bt.width,Bt.height,0,ne,xe,Bt.data)}}}else{if(Qe=G.mipmaps,se&&je){Qe.length>0&&Je++;const Ce=st(Xe[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Je,at,Ce.width,Ce.height)}for(let Ce=0;Ce<6;Ce++)if(We){se?Ze&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,Xe[Ce].width,Xe[Ce].height,ne,xe,Xe[Ce].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,at,Xe[Ce].width,Xe[Ce].height,0,ne,xe,Xe[Ce].data);for(let dt=0;dt<Qe.length;dt++){const hn=Qe[dt].image[Ce].image;se?Ze&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,dt+1,0,0,hn.width,hn.height,ne,xe,hn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,dt+1,at,hn.width,hn.height,0,ne,xe,hn.data)}}else{se?Ze&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,ne,xe,Xe[Ce]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,at,ne,xe,Xe[Ce]);for(let dt=0;dt<Qe.length;dt++){const Bt=Qe[dt];se?Ze&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,dt+1,0,0,ne,xe,Bt.image[Ce]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,dt+1,at,ne,xe,Bt.image[Ce])}}}w(G)&&A(i.TEXTURE_CUBE_MAP),we.__version=Fe.version,G.onUpdate&&G.onUpdate(G)}Q.__version=G.version}function nt(Q,G,oe,Ae,Fe,we){const vt=a.convert(oe.format,oe.colorSpace),rt=a.convert(oe.type),It=O(oe.internalFormat,vt,rt,oe.colorSpace),Ft=n.get(G),We=n.get(oe);if(We.__renderTarget=G,!Ft.__hasExternalTextures){const Xe=Math.max(1,G.width>>we),_t=Math.max(1,G.height>>we);Fe===i.TEXTURE_3D||Fe===i.TEXTURE_2D_ARRAY?t.texImage3D(Fe,we,It,Xe,_t,G.depth,0,vt,rt,null):t.texImage2D(Fe,we,It,Xe,_t,0,vt,rt,null)}t.bindFramebuffer(i.FRAMEBUFFER,Q),yt(G)?f.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Ae,Fe,We.__webglTexture,0,te(G)):(Fe===i.TEXTURE_2D||Fe>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Fe<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Ae,Fe,We.__webglTexture,we),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Tt(Q,G,oe){if(i.bindRenderbuffer(i.RENDERBUFFER,Q),G.depthBuffer){const Ae=G.depthTexture,Fe=Ae&&Ae.isDepthTexture?Ae.type:null,we=U(G.stencilBuffer,Fe),vt=G.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;yt(G)?f.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,te(G),we,G.width,G.height):oe?i.renderbufferStorageMultisample(i.RENDERBUFFER,te(G),we,G.width,G.height):i.renderbufferStorage(i.RENDERBUFFER,we,G.width,G.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,vt,i.RENDERBUFFER,Q)}else{const Ae=G.textures;for(let Fe=0;Fe<Ae.length;Fe++){const we=Ae[Fe],vt=a.convert(we.format,we.colorSpace),rt=a.convert(we.type),It=O(we.internalFormat,vt,rt,we.colorSpace);yt(G)?f.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,te(G),It,G.width,G.height):oe?i.renderbufferStorageMultisample(i.RENDERBUFFER,te(G),It,G.width,G.height):i.renderbufferStorage(i.RENDERBUFFER,It,G.width,G.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Lt(Q,G,oe){const Ae=G.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,Q),!(G.depthTexture&&G.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Fe=n.get(G.depthTexture);if(Fe.__renderTarget=G,(!Fe.__webglTexture||G.depthTexture.image.width!==G.width||G.depthTexture.image.height!==G.height)&&(G.depthTexture.image.width=G.width,G.depthTexture.image.height=G.height,G.depthTexture.needsUpdate=!0),Ae){if(Fe.__webglInit===void 0&&(Fe.__webglInit=!0,G.depthTexture.addEventListener("dispose",j)),Fe.__webglTexture===void 0){Fe.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,Fe.__webglTexture),Pe(i.TEXTURE_CUBE_MAP,G.depthTexture);const Ft=a.convert(G.depthTexture.format),We=a.convert(G.depthTexture.type);let Xe;G.depthTexture.format===Ec?Xe=i.DEPTH_COMPONENT24:G.depthTexture.format===bh&&(Xe=i.DEPTH24_STENCIL8);for(let _t=0;_t<6;_t++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+_t,0,Xe,G.width,G.height,0,Ft,We,null)}}else he(G.depthTexture,0);const we=Fe.__webglTexture,vt=te(G),rt=Ae?i.TEXTURE_CUBE_MAP_POSITIVE_X+oe:i.TEXTURE_2D,It=G.depthTexture.format===bh?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(G.depthTexture.format===Ec)yt(G)?f.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,It,rt,we,0,vt):i.framebufferTexture2D(i.FRAMEBUFFER,It,rt,we,0);else if(G.depthTexture.format===bh)yt(G)?f.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,It,rt,we,0,vt):i.framebufferTexture2D(i.FRAMEBUFFER,It,rt,we,0);else throw new Error("Unknown depthTexture format")}function Ht(Q){const G=n.get(Q),oe=Q.isWebGLCubeRenderTarget===!0;if(G.__boundDepthTexture!==Q.depthTexture){const Ae=Q.depthTexture;if(G.__depthDisposeCallback&&G.__depthDisposeCallback(),Ae){const Fe=()=>{delete G.__boundDepthTexture,delete G.__depthDisposeCallback,Ae.removeEventListener("dispose",Fe)};Ae.addEventListener("dispose",Fe),G.__depthDisposeCallback=Fe}G.__boundDepthTexture=Ae}if(Q.depthTexture&&!G.__autoAllocateDepthBuffer)if(oe)for(let Ae=0;Ae<6;Ae++)Lt(G.__webglFramebuffer[Ae],Q,Ae);else{const Ae=Q.texture.mipmaps;Ae&&Ae.length>0?Lt(G.__webglFramebuffer[0],Q,0):Lt(G.__webglFramebuffer,Q,0)}else if(oe){G.__webglDepthbuffer=[];for(let Ae=0;Ae<6;Ae++)if(t.bindFramebuffer(i.FRAMEBUFFER,G.__webglFramebuffer[Ae]),G.__webglDepthbuffer[Ae]===void 0)G.__webglDepthbuffer[Ae]=i.createRenderbuffer(),Tt(G.__webglDepthbuffer[Ae],Q,!1);else{const Fe=Q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,we=G.__webglDepthbuffer[Ae];i.bindRenderbuffer(i.RENDERBUFFER,we),i.framebufferRenderbuffer(i.FRAMEBUFFER,Fe,i.RENDERBUFFER,we)}}else{const Ae=Q.texture.mipmaps;if(Ae&&Ae.length>0?t.bindFramebuffer(i.FRAMEBUFFER,G.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,G.__webglFramebuffer),G.__webglDepthbuffer===void 0)G.__webglDepthbuffer=i.createRenderbuffer(),Tt(G.__webglDepthbuffer,Q,!1);else{const Fe=Q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,we=G.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,we),i.framebufferRenderbuffer(i.FRAMEBUFFER,Fe,i.RENDERBUFFER,we)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function un(Q,G,oe){const Ae=n.get(Q);G!==void 0&&nt(Ae.__webglFramebuffer,Q,Q.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),oe!==void 0&&Ht(Q)}function zt(Q){const G=Q.texture,oe=n.get(Q),Ae=n.get(G);Q.addEventListener("dispose",F);const Fe=Q.textures,we=Q.isWebGLCubeRenderTarget===!0,vt=Fe.length>1;if(vt||(Ae.__webglTexture===void 0&&(Ae.__webglTexture=i.createTexture()),Ae.__version=G.version,c.memory.textures++),we){oe.__webglFramebuffer=[];for(let rt=0;rt<6;rt++)if(G.mipmaps&&G.mipmaps.length>0){oe.__webglFramebuffer[rt]=[];for(let It=0;It<G.mipmaps.length;It++)oe.__webglFramebuffer[rt][It]=i.createFramebuffer()}else oe.__webglFramebuffer[rt]=i.createFramebuffer()}else{if(G.mipmaps&&G.mipmaps.length>0){oe.__webglFramebuffer=[];for(let rt=0;rt<G.mipmaps.length;rt++)oe.__webglFramebuffer[rt]=i.createFramebuffer()}else oe.__webglFramebuffer=i.createFramebuffer();if(vt)for(let rt=0,It=Fe.length;rt<It;rt++){const Ft=n.get(Fe[rt]);Ft.__webglTexture===void 0&&(Ft.__webglTexture=i.createTexture(),c.memory.textures++)}if(Q.samples>0&&yt(Q)===!1){oe.__webglMultisampledFramebuffer=i.createFramebuffer(),oe.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,oe.__webglMultisampledFramebuffer);for(let rt=0;rt<Fe.length;rt++){const It=Fe[rt];oe.__webglColorRenderbuffer[rt]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,oe.__webglColorRenderbuffer[rt]);const Ft=a.convert(It.format,It.colorSpace),We=a.convert(It.type),Xe=O(It.internalFormat,Ft,We,It.colorSpace,Q.isXRRenderTarget===!0),_t=te(Q);i.renderbufferStorageMultisample(i.RENDERBUFFER,_t,Xe,Q.width,Q.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+rt,i.RENDERBUFFER,oe.__webglColorRenderbuffer[rt])}i.bindRenderbuffer(i.RENDERBUFFER,null),Q.depthBuffer&&(oe.__webglDepthRenderbuffer=i.createRenderbuffer(),Tt(oe.__webglDepthRenderbuffer,Q,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(we){t.bindTexture(i.TEXTURE_CUBE_MAP,Ae.__webglTexture),Pe(i.TEXTURE_CUBE_MAP,G);for(let rt=0;rt<6;rt++)if(G.mipmaps&&G.mipmaps.length>0)for(let It=0;It<G.mipmaps.length;It++)nt(oe.__webglFramebuffer[rt][It],Q,G,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,It);else nt(oe.__webglFramebuffer[rt],Q,G,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+rt,0);w(G)&&A(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(vt){for(let rt=0,It=Fe.length;rt<It;rt++){const Ft=Fe[rt],We=n.get(Ft);let Xe=i.TEXTURE_2D;(Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(Xe=Q.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Xe,We.__webglTexture),Pe(Xe,Ft),nt(oe.__webglFramebuffer,Q,Ft,i.COLOR_ATTACHMENT0+rt,Xe,0),w(Ft)&&A(Xe)}t.unbindTexture()}else{let rt=i.TEXTURE_2D;if((Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(rt=Q.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(rt,Ae.__webglTexture),Pe(rt,G),G.mipmaps&&G.mipmaps.length>0)for(let It=0;It<G.mipmaps.length;It++)nt(oe.__webglFramebuffer[It],Q,G,i.COLOR_ATTACHMENT0,rt,It);else nt(oe.__webglFramebuffer,Q,G,i.COLOR_ATTACHMENT0,rt,0);w(G)&&A(rt),t.unbindTexture()}Q.depthBuffer&&Ht(Q)}function Ue(Q){const G=Q.textures;for(let oe=0,Ae=G.length;oe<Ae;oe++){const Fe=G[oe];if(w(Fe)){const we=N(Q),vt=n.get(Fe).__webglTexture;t.bindTexture(we,vt),A(we),t.unbindTexture()}}}const Ye=[],ze=[];function ot(Q){if(Q.samples>0){if(yt(Q)===!1){const G=Q.textures,oe=Q.width,Ae=Q.height;let Fe=i.COLOR_BUFFER_BIT;const we=Q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,vt=n.get(Q),rt=G.length>1;if(rt)for(let Ft=0;Ft<G.length;Ft++)t.bindFramebuffer(i.FRAMEBUFFER,vt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ft,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,vt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ft,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,vt.__webglMultisampledFramebuffer);const It=Q.texture.mipmaps;It&&It.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,vt.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,vt.__webglFramebuffer);for(let Ft=0;Ft<G.length;Ft++){if(Q.resolveDepthBuffer&&(Q.depthBuffer&&(Fe|=i.DEPTH_BUFFER_BIT),Q.stencilBuffer&&Q.resolveStencilBuffer&&(Fe|=i.STENCIL_BUFFER_BIT)),rt){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,vt.__webglColorRenderbuffer[Ft]);const We=n.get(G[Ft]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,We,0)}i.blitFramebuffer(0,0,oe,Ae,0,0,oe,Ae,Fe,i.NEAREST),d===!0&&(Ye.length=0,ze.length=0,Ye.push(i.COLOR_ATTACHMENT0+Ft),Q.depthBuffer&&Q.resolveDepthBuffer===!1&&(Ye.push(we),ze.push(we),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,ze)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Ye))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),rt)for(let Ft=0;Ft<G.length;Ft++){t.bindFramebuffer(i.FRAMEBUFFER,vt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ft,i.RENDERBUFFER,vt.__webglColorRenderbuffer[Ft]);const We=n.get(G[Ft]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,vt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ft,i.TEXTURE_2D,We,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,vt.__webglMultisampledFramebuffer)}else if(Q.depthBuffer&&Q.resolveDepthBuffer===!1&&d){const G=Q.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[G])}}}function te(Q){return Math.min(s.maxSamples,Q.samples)}function yt(Q){const G=n.get(Q);return Q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&G.__useRenderToTexture!==!1}function it(Q){const G=c.render.frame;y.get(Q)!==G&&(y.set(Q,G),Q.update())}function Rt(Q,G){const oe=Q.colorSpace,Ae=Q.format,Fe=Q.type;return Q.isCompressedTexture===!0||Q.isVideoTexture===!0||oe!==Nh&&oe!==pu&&(Gn.getTransfer(oe)===hi?(Ae!==Gr||Fe!==ca)&&St("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Gt("WebGLTextures: Unsupported texture color space:",oe)),G}function st(Q){return typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement?(m.width=Q.naturalWidth||Q.width,m.height=Q.naturalHeight||Q.height):typeof VideoFrame<"u"&&Q instanceof VideoFrame?(m.width=Q.displayWidth,m.height=Q.displayHeight):(m.width=Q.width,m.height=Q.height),m}this.allocateTextureUnit=k,this.resetTextureUnits=X,this.setTexture2D=he,this.setTexture2DArray=ee,this.setTexture3D=ie,this.setTextureCube=ye,this.rebindTextures=un,this.setupRenderTarget=zt,this.updateRenderTargetMipmap=Ue,this.updateMultisampleRenderTarget=ot,this.setupDepthRenderbuffer=Ht,this.setupFrameBufferTexture=nt,this.useMultisampledRTT=yt,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function NI(i,e){function t(n,s=pu){let a;const c=Gn.getTransfer(s);if(n===ca)return i.UNSIGNED_BYTE;if(n===mb)return i.UNSIGNED_SHORT_4_4_4_4;if(n===gb)return i.UNSIGNED_SHORT_5_5_5_1;if(n===fM)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===dM)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===uM)return i.BYTE;if(n===hM)return i.SHORT;if(n===nm)return i.UNSIGNED_SHORT;if(n===pb)return i.INT;if(n===Wo)return i.UNSIGNED_INT;if(n===fa)return i.FLOAT;if(n===Sc)return i.HALF_FLOAT;if(n===pM)return i.ALPHA;if(n===mM)return i.RGB;if(n===Gr)return i.RGBA;if(n===Ec)return i.DEPTH_COMPONENT;if(n===bh)return i.DEPTH_STENCIL;if(n===yb)return i.RED;if(n===iy)return i.RED_INTEGER;if(n===ad)return i.RG;if(n===vb)return i.RG_INTEGER;if(n===_b)return i.RGBA_INTEGER;if(n===g0||n===y0||n===v0||n===_0)if(c===hi)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(n===g0)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===y0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===v0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===_0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(n===g0)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===y0)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===v0)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===_0)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===hx||n===fx||n===dx||n===px)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(n===hx)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===fx)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===dx)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===px)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===mx||n===gx||n===yx||n===vx||n===_x||n===xx||n===bx)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(n===mx||n===gx)return c===hi?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===yx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC;if(n===vx)return a.COMPRESSED_R11_EAC;if(n===_x)return a.COMPRESSED_SIGNED_R11_EAC;if(n===xx)return a.COMPRESSED_RG11_EAC;if(n===bx)return a.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===Sx||n===Ex||n===Mx||n===Tx||n===Ax||n===wx||n===Cx||n===Rx||n===Ix||n===Dx||n===Nx||n===Px||n===Lx||n===Ox)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(n===Sx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Ex)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Mx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Tx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Ax)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===wx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Cx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Rx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Ix)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Dx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Nx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Px)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Lx)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Ox)return c===hi?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Ux||n===zx||n===Fx)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(n===Ux)return c===hi?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===zx)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Fx)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Bx||n===Vx||n===kx||n===Hx)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(n===Bx)return a.COMPRESSED_RED_RGTC1_EXT;if(n===Vx)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===kx)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Hx)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===im?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const O5=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,U5=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class z5{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new TM(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Ga({vertexShader:O5,fragmentShader:U5,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new _s(new Mm(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class F5 extends Ac{constructor(e,t){super();const n=this;let s=null,a=1,c=null,f="local-floor",d=1,m=null,y=null,v=null,x=null,E=null,T=null;const I=typeof XRWebGLBinding<"u",w=new z5,A={},N=t.getContextAttributes();let O=null,U=null;const q=[],j=[],F=new ke;let R=null;const P=new ys;P.viewport=new Jn;const H=new ys;H.viewport=new Jn;const B=[P,H],X=new vI;let k=null,ue=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ie){let tt=q[Ie];return tt===void 0&&(tt=new G_,q[Ie]=tt),tt.getTargetRaySpace()},this.getControllerGrip=function(Ie){let tt=q[Ie];return tt===void 0&&(tt=new G_,q[Ie]=tt),tt.getGripSpace()},this.getHand=function(Ie){let tt=q[Ie];return tt===void 0&&(tt=new G_,q[Ie]=tt),tt.getHandSpace()};function he(Ie){const tt=j.indexOf(Ie.inputSource);if(tt===-1)return;const nt=q[tt];nt!==void 0&&(nt.update(Ie.inputSource,Ie.frame,m||c),nt.dispatchEvent({type:Ie.type,data:Ie.inputSource}))}function ee(){s.removeEventListener("select",he),s.removeEventListener("selectstart",he),s.removeEventListener("selectend",he),s.removeEventListener("squeeze",he),s.removeEventListener("squeezestart",he),s.removeEventListener("squeezeend",he),s.removeEventListener("end",ee),s.removeEventListener("inputsourceschange",ie);for(let Ie=0;Ie<q.length;Ie++){const tt=j[Ie];tt!==null&&(j[Ie]=null,q[Ie].disconnect(tt))}k=null,ue=null,w.reset();for(const Ie in A)delete A[Ie];e.setRenderTarget(O),E=null,x=null,v=null,s=null,U=null,Yt.stop(),n.isPresenting=!1,e.setPixelRatio(R),e.setSize(F.width,F.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Ie){a=Ie,n.isPresenting===!0&&St("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ie){f=Ie,n.isPresenting===!0&&St("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m||c},this.setReferenceSpace=function(Ie){m=Ie},this.getBaseLayer=function(){return x!==null?x:E},this.getBinding=function(){return v===null&&I&&(v=new XRWebGLBinding(s,t)),v},this.getFrame=function(){return T},this.getSession=function(){return s},this.setSession=async function(Ie){if(s=Ie,s!==null){if(O=e.getRenderTarget(),s.addEventListener("select",he),s.addEventListener("selectstart",he),s.addEventListener("selectend",he),s.addEventListener("squeeze",he),s.addEventListener("squeezestart",he),s.addEventListener("squeezeend",he),s.addEventListener("end",ee),s.addEventListener("inputsourceschange",ie),N.xrCompatible!==!0&&await t.makeXRCompatible(),R=e.getPixelRatio(),e.getSize(F),I&&"createProjectionLayer"in XRWebGLBinding.prototype){let nt=null,Tt=null,Lt=null;N.depth&&(Lt=N.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,nt=N.stencil?bh:Ec,Tt=N.stencil?im:Wo);const Ht={colorFormat:t.RGBA8,depthFormat:Lt,scaleFactor:a};v=this.getBinding(),x=v.createProjectionLayer(Ht),s.updateRenderState({layers:[x]}),e.setPixelRatio(1),e.setSize(x.textureWidth,x.textureHeight,!1),U=new co(x.textureWidth,x.textureHeight,{format:Gr,type:ca,depthTexture:new om(x.textureWidth,x.textureHeight,Tt,void 0,void 0,void 0,void 0,void 0,void 0,nt),stencilBuffer:N.stencil,colorSpace:e.outputColorSpace,samples:N.antialias?4:0,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1})}else{const nt={antialias:N.antialias,alpha:!0,depth:N.depth,stencil:N.stencil,framebufferScaleFactor:a};E=new XRWebGLLayer(s,t,nt),s.updateRenderState({baseLayer:E}),e.setPixelRatio(1),e.setSize(E.framebufferWidth,E.framebufferHeight,!1),U=new co(E.framebufferWidth,E.framebufferHeight,{format:Gr,type:ca,colorSpace:e.outputColorSpace,stencilBuffer:N.stencil,resolveDepthBuffer:E.ignoreDepthValues===!1,resolveStencilBuffer:E.ignoreDepthValues===!1})}U.isXRRenderTarget=!0,this.setFoveation(d),m=null,c=await s.requestReferenceSpace(f),Yt.setContext(s),Yt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return w.getDepthTexture()};function ie(Ie){for(let tt=0;tt<Ie.removed.length;tt++){const nt=Ie.removed[tt],Tt=j.indexOf(nt);Tt>=0&&(j[Tt]=null,q[Tt].disconnect(nt))}for(let tt=0;tt<Ie.added.length;tt++){const nt=Ie.added[tt];let Tt=j.indexOf(nt);if(Tt===-1){for(let Ht=0;Ht<q.length;Ht++)if(Ht>=j.length){j.push(nt),Tt=Ht;break}else if(j[Ht]===null){j[Ht]=nt,Tt=Ht;break}if(Tt===-1)break}const Lt=q[Tt];Lt&&Lt.connect(nt)}}const ye=new J,be=new J;function Be(Ie,tt,nt){ye.setFromMatrixPosition(tt.matrixWorld),be.setFromMatrixPosition(nt.matrixWorld);const Tt=ye.distanceTo(be),Lt=tt.projectionMatrix.elements,Ht=nt.projectionMatrix.elements,un=Lt[14]/(Lt[10]-1),zt=Lt[14]/(Lt[10]+1),Ue=(Lt[9]+1)/Lt[5],Ye=(Lt[9]-1)/Lt[5],ze=(Lt[8]-1)/Lt[0],ot=(Ht[8]+1)/Ht[0],te=un*ze,yt=un*ot,it=Tt/(-ze+ot),Rt=it*-ze;if(tt.matrixWorld.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.translateX(Rt),Ie.translateZ(it),Ie.matrixWorld.compose(Ie.position,Ie.quaternion,Ie.scale),Ie.matrixWorldInverse.copy(Ie.matrixWorld).invert(),Lt[10]===-1)Ie.projectionMatrix.copy(tt.projectionMatrix),Ie.projectionMatrixInverse.copy(tt.projectionMatrixInverse);else{const st=un+it,Q=zt+it,G=te-Rt,oe=yt+(Tt-Rt),Ae=Ue*zt/Q*st,Fe=Ye*zt/Q*st;Ie.projectionMatrix.makePerspective(G,oe,Ae,Fe,st,Q),Ie.projectionMatrixInverse.copy(Ie.projectionMatrix).invert()}}function Oe(Ie,tt){tt===null?Ie.matrixWorld.copy(Ie.matrix):Ie.matrixWorld.multiplyMatrices(tt.matrixWorld,Ie.matrix),Ie.matrixWorldInverse.copy(Ie.matrixWorld).invert()}this.updateCamera=function(Ie){if(s===null)return;let tt=Ie.near,nt=Ie.far;w.texture!==null&&(w.depthNear>0&&(tt=w.depthNear),w.depthFar>0&&(nt=w.depthFar)),X.near=H.near=P.near=tt,X.far=H.far=P.far=nt,(k!==X.near||ue!==X.far)&&(s.updateRenderState({depthNear:X.near,depthFar:X.far}),k=X.near,ue=X.far),X.layers.mask=Ie.layers.mask|6,P.layers.mask=X.layers.mask&-5,H.layers.mask=X.layers.mask&-3;const Tt=Ie.parent,Lt=X.cameras;Oe(X,Tt);for(let Ht=0;Ht<Lt.length;Ht++)Oe(Lt[Ht],Tt);Lt.length===2?Be(X,P,H):X.projectionMatrix.copy(P.projectionMatrix),Pe(Ie,X,Tt)};function Pe(Ie,tt,nt){nt===null?Ie.matrix.copy(tt.matrixWorld):(Ie.matrix.copy(nt.matrixWorld),Ie.matrix.invert(),Ie.matrix.multiply(tt.matrixWorld)),Ie.matrix.decompose(Ie.position,Ie.quaternion,Ie.scale),Ie.updateMatrixWorld(!0),Ie.projectionMatrix.copy(tt.projectionMatrix),Ie.projectionMatrixInverse.copy(tt.projectionMatrixInverse),Ie.isPerspectiveCamera&&(Ie.fov=sm*2*Math.atan(1/Ie.projectionMatrix.elements[5]),Ie.zoom=1)}this.getCamera=function(){return X},this.getFoveation=function(){if(!(x===null&&E===null))return d},this.setFoveation=function(Ie){d=Ie,x!==null&&(x.fixedFoveation=Ie),E!==null&&E.fixedFoveation!==void 0&&(E.fixedFoveation=Ie)},this.hasDepthSensing=function(){return w.texture!==null},this.getDepthSensingMesh=function(){return w.getMesh(X)},this.getCameraTexture=function(Ie){return A[Ie]};let $e=null;function Mt(Ie,tt){if(y=tt.getViewerPose(m||c),T=tt,y!==null){const nt=y.views;E!==null&&(e.setRenderTargetFramebuffer(U,E.framebuffer),e.setRenderTarget(U));let Tt=!1;nt.length!==X.cameras.length&&(X.cameras.length=0,Tt=!0);for(let zt=0;zt<nt.length;zt++){const Ue=nt[zt];let Ye=null;if(E!==null)Ye=E.getViewport(Ue);else{const ot=v.getViewSubImage(x,Ue);Ye=ot.viewport,zt===0&&(e.setRenderTargetTextures(U,ot.colorTexture,ot.depthStencilTexture),e.setRenderTarget(U))}let ze=B[zt];ze===void 0&&(ze=new ys,ze.layers.enable(zt),ze.viewport=new Jn,B[zt]=ze),ze.matrix.fromArray(Ue.transform.matrix),ze.matrix.decompose(ze.position,ze.quaternion,ze.scale),ze.projectionMatrix.fromArray(Ue.projectionMatrix),ze.projectionMatrixInverse.copy(ze.projectionMatrix).invert(),ze.viewport.set(Ye.x,Ye.y,Ye.width,Ye.height),zt===0&&(X.matrix.copy(ze.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale)),Tt===!0&&X.cameras.push(ze)}const Lt=s.enabledFeatures;if(Lt&&Lt.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&I){v=n.getBinding();const zt=v.getDepthInformation(nt[0]);zt&&zt.isValid&&zt.texture&&w.init(zt,s.renderState)}if(Lt&&Lt.includes("camera-access")&&I){e.state.unbindTexture(),v=n.getBinding();for(let zt=0;zt<nt.length;zt++){const Ue=nt[zt].camera;if(Ue){let Ye=A[Ue];Ye||(Ye=new TM,A[Ue]=Ye);const ze=v.getCameraImage(Ue);Ye.sourceTexture=ze}}}}for(let nt=0;nt<q.length;nt++){const Tt=j[nt],Lt=q[nt];Tt!==null&&Lt!==void 0&&Lt.update(Tt,tt,m||c)}$e&&$e(Ie,tt),tt.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:tt}),T=null}const Yt=new wI;Yt.setAnimationLoop(Mt),this.setAnimationLoop=function(Ie){$e=Ie},this.dispose=function(){}}}const Hf=new uo,B5=new on;function V5(i,e){function t(w,A){w.matrixAutoUpdate===!0&&w.updateMatrix(),A.value.copy(w.matrix)}function n(w,A){A.color.getRGB(w.fogColor.value,Z3(i)),A.isFog?(w.fogNear.value=A.near,w.fogFar.value=A.far):A.isFogExp2&&(w.fogDensity.value=A.density)}function s(w,A,N,O,U){A.isMeshBasicMaterial?a(w,A):A.isMeshLambertMaterial?(a(w,A),A.envMap&&(w.envMapIntensity.value=A.envMapIntensity)):A.isMeshToonMaterial?(a(w,A),v(w,A)):A.isMeshPhongMaterial?(a(w,A),y(w,A),A.envMap&&(w.envMapIntensity.value=A.envMapIntensity)):A.isMeshStandardMaterial?(a(w,A),x(w,A),A.isMeshPhysicalMaterial&&E(w,A,U)):A.isMeshMatcapMaterial?(a(w,A),T(w,A)):A.isMeshDepthMaterial?a(w,A):A.isMeshDistanceMaterial?(a(w,A),I(w,A)):A.isMeshNormalMaterial?a(w,A):A.isLineBasicMaterial?(c(w,A),A.isLineDashedMaterial&&f(w,A)):A.isPointsMaterial?d(w,A,N,O):A.isSpriteMaterial?m(w,A):A.isShadowMaterial?(w.color.value.copy(A.color),w.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}function a(w,A){w.opacity.value=A.opacity,A.color&&w.diffuse.value.copy(A.color),A.emissive&&w.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(w.map.value=A.map,t(A.map,w.mapTransform)),A.alphaMap&&(w.alphaMap.value=A.alphaMap,t(A.alphaMap,w.alphaMapTransform)),A.bumpMap&&(w.bumpMap.value=A.bumpMap,t(A.bumpMap,w.bumpMapTransform),w.bumpScale.value=A.bumpScale,A.side===jr&&(w.bumpScale.value*=-1)),A.normalMap&&(w.normalMap.value=A.normalMap,t(A.normalMap,w.normalMapTransform),w.normalScale.value.copy(A.normalScale),A.side===jr&&w.normalScale.value.negate()),A.displacementMap&&(w.displacementMap.value=A.displacementMap,t(A.displacementMap,w.displacementMapTransform),w.displacementScale.value=A.displacementScale,w.displacementBias.value=A.displacementBias),A.emissiveMap&&(w.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,w.emissiveMapTransform)),A.specularMap&&(w.specularMap.value=A.specularMap,t(A.specularMap,w.specularMapTransform)),A.alphaTest>0&&(w.alphaTest.value=A.alphaTest);const N=e.get(A),O=N.envMap,U=N.envMapRotation;O&&(w.envMap.value=O,Hf.copy(U),Hf.x*=-1,Hf.y*=-1,Hf.z*=-1,O.isCubeTexture&&O.isRenderTargetTexture===!1&&(Hf.y*=-1,Hf.z*=-1),w.envMapRotation.value.setFromMatrix4(B5.makeRotationFromEuler(Hf)),w.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=A.reflectivity,w.ior.value=A.ior,w.refractionRatio.value=A.refractionRatio),A.lightMap&&(w.lightMap.value=A.lightMap,w.lightMapIntensity.value=A.lightMapIntensity,t(A.lightMap,w.lightMapTransform)),A.aoMap&&(w.aoMap.value=A.aoMap,w.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,w.aoMapTransform))}function c(w,A){w.diffuse.value.copy(A.color),w.opacity.value=A.opacity,A.map&&(w.map.value=A.map,t(A.map,w.mapTransform))}function f(w,A){w.dashSize.value=A.dashSize,w.totalSize.value=A.dashSize+A.gapSize,w.scale.value=A.scale}function d(w,A,N,O){w.diffuse.value.copy(A.color),w.opacity.value=A.opacity,w.size.value=A.size*N,w.scale.value=O*.5,A.map&&(w.map.value=A.map,t(A.map,w.uvTransform)),A.alphaMap&&(w.alphaMap.value=A.alphaMap,t(A.alphaMap,w.alphaMapTransform)),A.alphaTest>0&&(w.alphaTest.value=A.alphaTest)}function m(w,A){w.diffuse.value.copy(A.color),w.opacity.value=A.opacity,w.rotation.value=A.rotation,A.map&&(w.map.value=A.map,t(A.map,w.mapTransform)),A.alphaMap&&(w.alphaMap.value=A.alphaMap,t(A.alphaMap,w.alphaMapTransform)),A.alphaTest>0&&(w.alphaTest.value=A.alphaTest)}function y(w,A){w.specular.value.copy(A.specular),w.shininess.value=Math.max(A.shininess,1e-4)}function v(w,A){A.gradientMap&&(w.gradientMap.value=A.gradientMap)}function x(w,A){w.metalness.value=A.metalness,A.metalnessMap&&(w.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,w.metalnessMapTransform)),w.roughness.value=A.roughness,A.roughnessMap&&(w.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,w.roughnessMapTransform)),A.envMap&&(w.envMapIntensity.value=A.envMapIntensity)}function E(w,A,N){w.ior.value=A.ior,A.sheen>0&&(w.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),w.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(w.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,w.sheenColorMapTransform)),A.sheenRoughnessMap&&(w.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,w.sheenRoughnessMapTransform))),A.clearcoat>0&&(w.clearcoat.value=A.clearcoat,w.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(w.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,w.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(w.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),A.side===jr&&w.clearcoatNormalScale.value.negate())),A.dispersion>0&&(w.dispersion.value=A.dispersion),A.iridescence>0&&(w.iridescence.value=A.iridescence,w.iridescenceIOR.value=A.iridescenceIOR,w.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(w.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,w.iridescenceMapTransform)),A.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),A.transmission>0&&(w.transmission.value=A.transmission,w.transmissionSamplerMap.value=N.texture,w.transmissionSamplerSize.value.set(N.width,N.height),A.transmissionMap&&(w.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,w.transmissionMapTransform)),w.thickness.value=A.thickness,A.thicknessMap&&(w.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=A.attenuationDistance,w.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(w.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(w.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=A.specularIntensity,w.specularColor.value.copy(A.specularColor),A.specularColorMap&&(w.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,w.specularColorMapTransform)),A.specularIntensityMap&&(w.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,w.specularIntensityMapTransform))}function T(w,A){A.matcap&&(w.matcap.value=A.matcap)}function I(w,A){const N=e.get(A).light;w.referencePosition.value.setFromMatrixPosition(N.matrixWorld),w.nearDistance.value=N.shadow.camera.near,w.farDistance.value=N.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:s}}function k5(i,e,t,n){let s={},a={},c=[];const f=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function d(N,O){const U=O.program;n.uniformBlockBinding(N,U)}function m(N,O){let U=s[N.id];U===void 0&&(T(N),U=y(N),s[N.id]=U,N.addEventListener("dispose",w));const q=O.program;n.updateUBOMapping(N,q);const j=e.render.frame;a[N.id]!==j&&(x(N),a[N.id]=j)}function y(N){const O=v();N.__bindingPointIndex=O;const U=i.createBuffer(),q=N.__size,j=N.usage;return i.bindBuffer(i.UNIFORM_BUFFER,U),i.bufferData(i.UNIFORM_BUFFER,q,j),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,O,U),U}function v(){for(let N=0;N<f;N++)if(c.indexOf(N)===-1)return c.push(N),N;return Gt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function x(N){const O=s[N.id],U=N.uniforms,q=N.__cache;i.bindBuffer(i.UNIFORM_BUFFER,O);for(let j=0,F=U.length;j<F;j++){const R=Array.isArray(U[j])?U[j]:[U[j]];for(let P=0,H=R.length;P<H;P++){const B=R[P];if(E(B,j,P,q)===!0){const X=B.__offset,k=Array.isArray(B.value)?B.value:[B.value];let ue=0;for(let he=0;he<k.length;he++){const ee=k[he],ie=I(ee);typeof ee=="number"||typeof ee=="boolean"?(B.__data[0]=ee,i.bufferSubData(i.UNIFORM_BUFFER,X+ue,B.__data)):ee.isMatrix3?(B.__data[0]=ee.elements[0],B.__data[1]=ee.elements[1],B.__data[2]=ee.elements[2],B.__data[3]=0,B.__data[4]=ee.elements[3],B.__data[5]=ee.elements[4],B.__data[6]=ee.elements[5],B.__data[7]=0,B.__data[8]=ee.elements[6],B.__data[9]=ee.elements[7],B.__data[10]=ee.elements[8],B.__data[11]=0):(ee.toArray(B.__data,ue),ue+=ie.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,X,B.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function E(N,O,U,q){const j=N.value,F=O+"_"+U;if(q[F]===void 0)return typeof j=="number"||typeof j=="boolean"?q[F]=j:q[F]=j.clone(),!0;{const R=q[F];if(typeof j=="number"||typeof j=="boolean"){if(R!==j)return q[F]=j,!0}else if(R.equals(j)===!1)return R.copy(j),!0}return!1}function T(N){const O=N.uniforms;let U=0;const q=16;for(let F=0,R=O.length;F<R;F++){const P=Array.isArray(O[F])?O[F]:[O[F]];for(let H=0,B=P.length;H<B;H++){const X=P[H],k=Array.isArray(X.value)?X.value:[X.value];for(let ue=0,he=k.length;ue<he;ue++){const ee=k[ue],ie=I(ee),ye=U%q,be=ye%ie.boundary,Be=ye+be;U+=be,Be!==0&&q-Be<ie.storage&&(U+=q-Be),X.__data=new Float32Array(ie.storage/Float32Array.BYTES_PER_ELEMENT),X.__offset=U,U+=ie.storage}}}const j=U%q;return j>0&&(U+=q-j),N.__size=U,N.__cache={},this}function I(N){const O={boundary:0,storage:0};return typeof N=="number"||typeof N=="boolean"?(O.boundary=4,O.storage=4):N.isVector2?(O.boundary=8,O.storage=8):N.isVector3||N.isColor?(O.boundary=16,O.storage=12):N.isVector4?(O.boundary=16,O.storage=16):N.isMatrix3?(O.boundary=48,O.storage=48):N.isMatrix4?(O.boundary=64,O.storage=64):N.isTexture?St("WebGLRenderer: Texture samplers can not be part of an uniforms group."):St("WebGLRenderer: Unsupported uniform value type.",N),O}function w(N){const O=N.target;O.removeEventListener("dispose",w);const U=c.indexOf(O.__bindingPointIndex);c.splice(U,1),i.deleteBuffer(s[O.id]),delete s[O.id],delete a[O.id]}function A(){for(const N in s)i.deleteBuffer(s[N]);c=[],s={},a={}}return{bind:d,update:m,dispose:A}}const H5=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let cc=null;function G5(){return cc===null&&(cc=new El(H5,16,16,ad,Sc),cc.name="DFG_LUT",cc.minFilter=zi,cc.magFilter=zi,cc.wrapS=Ha,cc.wrapT=Ha,cc.generateMipmaps=!1,cc.needsUpdate=!0),cc}class PI{constructor(e={}){const{canvas:t=E3(),context:n=null,depth:s=!0,stencil:a=!1,alpha:c=!1,antialias:f=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:m=!1,powerPreference:y="default",failIfMajorPerformanceCaveat:v=!1,reversedDepthBuffer:x=!1,outputBufferType:E=ca}=e;this.isWebGLRenderer=!0;let T;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");T=n.getContextAttributes().alpha}else T=c;const I=E,w=new Set([_b,vb,iy]),A=new Set([ca,Wo,nm,im,mb,gb]),N=new Uint32Array(4),O=new Int32Array(4);let U=null,q=null;const j=[],F=[];let R=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=jo,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const P=this;let H=!1;this._outputColorSpace=kr;let B=0,X=0,k=null,ue=-1,he=null;const ee=new Jn,ie=new Jn;let ye=null;const be=new wt(0);let Be=0,Oe=t.width,Pe=t.height,$e=1,Mt=null,Yt=null;const Ie=new Jn(0,0,Oe,Pe),tt=new Jn(0,0,Oe,Pe);let nt=!1;const Tt=new Em;let Lt=!1,Ht=!1;const un=new on,zt=new J,Ue=new Jn,Ye={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ze=!1;function ot(){return k===null?$e:1}let te=n;function yt(Z,le){return t.getContext(Z,le)}try{const Z={alpha:!0,depth:s,stencil:a,antialias:f,premultipliedAlpha:d,preserveDrawingBuffer:m,powerPreference:y,failIfMajorPerformanceCaveat:v};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${bm}`),t.addEventListener("webglcontextlost",dt,!1),t.addEventListener("webglcontextrestored",Bt,!1),t.addEventListener("webglcontextcreationerror",hn,!1),te===null){const le="webgl2";if(te=yt(le,Z),te===null)throw yt(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Z){throw Gt("WebGLRenderer: "+Z.message),Z}let it,Rt,st,Q,G,oe,Ae,Fe,we,vt,rt,It,Ft,We,Xe,_t,ne,xe,at,se,je,Ze,Je;function Qe(){it=new WB(te),it.init(),je=new NI(te,it),Rt=new zB(te,it,e,je),st=new P5(te,it),Rt.reversedDepthBuffer&&x&&st.buffers.depth.setReversed(!0),Q=new YB(te),G=new _5,oe=new L5(te,it,st,G,Rt,je,Q),Ae=new jB(P),Fe=new J4(te),Ze=new OB(te,Fe),we=new qB(te,Fe,Q,Ze),vt=new KB(te,we,Fe,Ze,Q),xe=new ZB(te,Rt,oe),Xe=new FB(G),rt=new v5(P,Ae,it,Rt,Ze,Xe),It=new V5(P,G),Ft=new b5,We=new w5(it),ne=new LB(P,Ae,st,vt,T,d),_t=new N5(P,vt,Rt),Je=new k5(te,Q,Rt,st),at=new UB(te,it,Q),se=new XB(te,it,Q),Q.programs=rt.programs,P.capabilities=Rt,P.extensions=it,P.properties=G,P.renderLists=Ft,P.shadowMap=_t,P.state=st,P.info=Q}Qe(),I!==ca&&(R=new $B(I,t.width,t.height,s,a));const Ce=new F5(P,te);this.xr=Ce,this.getContext=function(){return te},this.getContextAttributes=function(){return te.getContextAttributes()},this.forceContextLoss=function(){const Z=it.get("WEBGL_lose_context");Z&&Z.loseContext()},this.forceContextRestore=function(){const Z=it.get("WEBGL_lose_context");Z&&Z.restoreContext()},this.getPixelRatio=function(){return $e},this.setPixelRatio=function(Z){Z!==void 0&&($e=Z,this.setSize(Oe,Pe,!1))},this.getSize=function(Z){return Z.set(Oe,Pe)},this.setSize=function(Z,le,Se=!0){if(Ce.isPresenting){St("WebGLRenderer: Can't change size while VR device is presenting.");return}Oe=Z,Pe=le,t.width=Math.floor(Z*$e),t.height=Math.floor(le*$e),Se===!0&&(t.style.width=Z+"px",t.style.height=le+"px"),R!==null&&R.setSize(t.width,t.height),this.setViewport(0,0,Z,le)},this.getDrawingBufferSize=function(Z){return Z.set(Oe*$e,Pe*$e).floor()},this.setDrawingBufferSize=function(Z,le,Se){Oe=Z,Pe=le,$e=Se,t.width=Math.floor(Z*Se),t.height=Math.floor(le*Se),this.setViewport(0,0,Z,le)},this.setEffects=function(Z){if(I===ca){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(Z){for(let le=0;le<Z.length;le++)if(Z[le].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}R.setEffects(Z||[])},this.getCurrentViewport=function(Z){return Z.copy(ee)},this.getViewport=function(Z){return Z.copy(Ie)},this.setViewport=function(Z,le,Se,ge){Z.isVector4?Ie.set(Z.x,Z.y,Z.z,Z.w):Ie.set(Z,le,Se,ge),st.viewport(ee.copy(Ie).multiplyScalar($e).round())},this.getScissor=function(Z){return Z.copy(tt)},this.setScissor=function(Z,le,Se,ge){Z.isVector4?tt.set(Z.x,Z.y,Z.z,Z.w):tt.set(Z,le,Se,ge),st.scissor(ie.copy(tt).multiplyScalar($e).round())},this.getScissorTest=function(){return nt},this.setScissorTest=function(Z){st.setScissorTest(nt=Z)},this.setOpaqueSort=function(Z){Mt=Z},this.setTransparentSort=function(Z){Yt=Z},this.getClearColor=function(Z){return Z.copy(ne.getClearColor())},this.setClearColor=function(){ne.setClearColor(...arguments)},this.getClearAlpha=function(){return ne.getClearAlpha()},this.setClearAlpha=function(){ne.setClearAlpha(...arguments)},this.clear=function(Z=!0,le=!0,Se=!0){let ge=0;if(Z){let me=!1;if(k!==null){const lt=k.texture.format;me=w.has(lt)}if(me){const lt=k.texture.type,pt=A.has(lt),gt=ne.getClearColor(),ht=ne.getClearAlpha(),Pt=gt.r,Kt=gt.g,jt=gt.b;pt?(N[0]=Pt,N[1]=Kt,N[2]=jt,N[3]=ht,te.clearBufferuiv(te.COLOR,0,N)):(O[0]=Pt,O[1]=Kt,O[2]=jt,O[3]=ht,te.clearBufferiv(te.COLOR,0,O))}else ge|=te.COLOR_BUFFER_BIT}le&&(ge|=te.DEPTH_BUFFER_BIT),Se&&(ge|=te.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ge!==0&&te.clear(ge)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",dt,!1),t.removeEventListener("webglcontextrestored",Bt,!1),t.removeEventListener("webglcontextcreationerror",hn,!1),ne.dispose(),Ft.dispose(),We.dispose(),G.dispose(),Ae.dispose(),vt.dispose(),Ze.dispose(),Je.dispose(),rt.dispose(),Ce.dispose(),Ce.removeEventListener("sessionstart",qr),Ce.removeEventListener("sessionend",er),Mr.stop()};function dt(Z){Z.preventDefault(),z0("WebGLRenderer: Context Lost."),H=!0}function Bt(){z0("WebGLRenderer: Context Restored."),H=!1;const Z=Q.autoReset,le=_t.enabled,Se=_t.autoUpdate,ge=_t.needsUpdate,me=_t.type;Qe(),Q.autoReset=Z,_t.enabled=le,_t.autoUpdate=Se,_t.needsUpdate=ge,_t.type=me}function hn(Z){Gt("WebGLRenderer: A WebGL context could not be created. Reason: ",Z.statusMessage)}function nn(Z){const le=Z.target;le.removeEventListener("dispose",nn),Si(le)}function Si(Z){Gi(Z),G.remove(Z)}function Gi(Z){const le=G.get(Z).programs;le!==void 0&&(le.forEach(function(Se){rt.releaseProgram(Se)}),Z.isShaderMaterial&&rt.releaseShaderCache(Z))}this.renderBufferDirect=function(Z,le,Se,ge,me,lt){le===null&&(le=Ye);const pt=me.isMesh&&me.matrixWorld.determinant()<0,gt=Al(Z,le,Se,ge,me);st.setMaterial(ge,pt);let ht=Se.index,Pt=1;if(ge.wireframe===!0){if(ht=we.getWireframeAttribute(Se),ht===void 0)return;Pt=2}const Kt=Se.drawRange,jt=Se.attributes.position;let bt=Kt.start*Pt,sn=(Kt.start+Kt.count)*Pt;lt!==null&&(bt=Math.max(bt,lt.start*Pt),sn=Math.min(sn,(lt.start+lt.count)*Pt)),ht!==null?(bt=Math.max(bt,0),sn=Math.min(sn,ht.count)):jt!=null&&(bt=Math.max(bt,0),sn=Math.min(sn,jt.count));const qn=sn-bt;if(qn<0||qn===1/0)return;Ze.setup(me,ge,gt,Se,ht);let ti,Ut=at;if(ht!==null&&(ti=Fe.get(ht),Ut=se,Ut.setIndex(ti)),me.isMesh)ge.wireframe===!0?(st.setLineWidth(ge.wireframeLinewidth*ot()),Ut.setMode(te.LINES)):Ut.setMode(te.TRIANGLES);else if(me.isLine){let Cn=ge.linewidth;Cn===void 0&&(Cn=1),st.setLineWidth(Cn*ot()),me.isLineSegments?Ut.setMode(te.LINES):me.isLineLoop?Ut.setMode(te.LINE_LOOP):Ut.setMode(te.LINE_STRIP)}else me.isPoints?Ut.setMode(te.POINTS):me.isSprite&&Ut.setMode(te.TRIANGLES);if(me.isBatchedMesh)if(me._multiDrawInstances!==null)F0("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Ut.renderMultiDrawInstances(me._multiDrawStarts,me._multiDrawCounts,me._multiDrawCount,me._multiDrawInstances);else if(it.get("WEBGL_multi_draw"))Ut.renderMultiDraw(me._multiDrawStarts,me._multiDrawCounts,me._multiDrawCount);else{const Cn=me._multiDrawStarts,ct=me._multiDrawCounts,Ei=me._multiDrawCount,Qt=ht?Fe.get(ht).bytesPerElement:1,Wi=G.get(ge).currentProgram.getUniforms();for(let Ls=0;Ls<Ei;Ls++)Wi.setValue(te,"_gl_DrawID",Ls),Ut.render(Cn[Ls]/Qt,ct[Ls])}else if(me.isInstancedMesh)Ut.renderInstances(bt,qn,me.count);else if(Se.isInstancedBufferGeometry){const Cn=Se._maxInstanceCount!==void 0?Se._maxInstanceCount:1/0,ct=Math.min(Se.instanceCount,Cn);Ut.renderInstances(bt,qn,ct)}else Ut.render(bt,qn)};function Er(Z,le,Se){Z.transparent===!0&&Z.side===bl&&Z.forceSinglePass===!1?(Z.side=jr,Z.needsUpdate=!0,bs(Z,le,Se),Z.side=vu,Z.needsUpdate=!0,bs(Z,le,Se),Z.side=bl):bs(Z,le,Se)}this.compile=function(Z,le,Se=null){Se===null&&(Se=Z),q=We.get(Se),q.init(le),F.push(q),Se.traverseVisible(function(me){me.isLight&&me.layers.test(le.layers)&&(q.pushLight(me),me.castShadow&&q.pushShadow(me))}),Z!==Se&&Z.traverseVisible(function(me){me.isLight&&me.layers.test(le.layers)&&(q.pushLight(me),me.castShadow&&q.pushShadow(me))}),q.setupLights();const ge=new Set;return Z.traverse(function(me){if(!(me.isMesh||me.isPoints||me.isLine||me.isSprite))return;const lt=me.material;if(lt)if(Array.isArray(lt))for(let pt=0;pt<lt.length;pt++){const gt=lt[pt];Er(gt,Se,me),ge.add(gt)}else Er(lt,Se,me),ge.add(lt)}),q=F.pop(),ge},this.compileAsync=function(Z,le,Se=null){const ge=this.compile(Z,le,Se);return new Promise(me=>{function lt(){if(ge.forEach(function(pt){G.get(pt).currentProgram.isReady()&&ge.delete(pt)}),ge.size===0){me(Z);return}setTimeout(lt,10)}it.get("KHR_parallel_shader_compile")!==null?lt():setTimeout(lt,10)})};let pa=null;function Tl(Z){pa&&pa(Z)}function qr(){Mr.stop()}function er(){Mr.start()}const Mr=new wI;Mr.setAnimationLoop(Tl),typeof self<"u"&&Mr.setContext(self),this.setAnimationLoop=function(Z){pa=Z,Ce.setAnimationLoop(Z),Z===null?Mr.stop():Mr.start()},Ce.addEventListener("sessionstart",qr),Ce.addEventListener("sessionend",er),this.render=function(Z,le){if(le!==void 0&&le.isCamera!==!0){Gt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H===!0)return;const Se=Ce.enabled===!0&&Ce.isPresenting===!0,ge=R!==null&&(k===null||Se)&&R.begin(P,k);if(Z.matrixWorldAutoUpdate===!0&&Z.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),Ce.enabled===!0&&Ce.isPresenting===!0&&(R===null||R.isCompositing()===!1)&&(Ce.cameraAutoUpdate===!0&&Ce.updateCamera(le),le=Ce.getCamera()),Z.isScene===!0&&Z.onBeforeRender(P,Z,le,k),q=We.get(Z,F.length),q.init(le),F.push(q),un.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),Tt.setFromProjectionMatrix(un,ao,le.reversedDepth),Ht=this.localClippingEnabled,Lt=Xe.init(this.clippingPlanes,Ht),U=Ft.get(Z,j.length),U.init(),j.push(U),Ce.enabled===!0&&Ce.isPresenting===!0){const pt=P.xr.getDepthSensingMesh();pt!==null&&ji(pt,le,-1/0,P.sortObjects)}ji(Z,le,0,P.sortObjects),U.finish(),P.sortObjects===!0&&U.sort(Mt,Yt),ze=Ce.enabled===!1||Ce.isPresenting===!1||Ce.hasDepthSensing()===!1,ze&&ne.addToRenderList(U,Z),this.info.render.frame++,Lt===!0&&Xe.beginShadows();const me=q.state.shadowsArray;if(_t.render(me,Z,le),Lt===!0&&Xe.endShadows(),this.info.autoReset===!0&&this.info.reset(),(ge&&R.hasRenderPass())===!1){const pt=U.opaque,gt=U.transmissive;if(q.setupLights(),le.isArrayCamera){const ht=le.cameras;if(gt.length>0)for(let Pt=0,Kt=ht.length;Pt<Kt;Pt++){const jt=ht[Pt];fi(pt,gt,Z,jt)}ze&&ne.render(Z);for(let Pt=0,Kt=ht.length;Pt<Kt;Pt++){const jt=ht[Pt];tr(U,Z,jt,jt.viewport)}}else gt.length>0&&fi(pt,gt,Z,le),ze&&ne.render(Z),tr(U,Z,le)}k!==null&&X===0&&(oe.updateMultisampleRenderTarget(k),oe.updateRenderTargetMipmap(k)),ge&&R.end(P),Z.isScene===!0&&Z.onAfterRender(P,Z,le),Ze.resetDefaultState(),ue=-1,he=null,F.pop(),F.length>0?(q=F[F.length-1],Lt===!0&&Xe.setGlobalState(P.clippingPlanes,q.state.camera)):q=null,j.pop(),j.length>0?U=j[j.length-1]:U=null};function ji(Z,le,Se,ge){if(Z.visible===!1)return;if(Z.layers.test(le.layers)){if(Z.isGroup)Se=Z.renderOrder;else if(Z.isLOD)Z.autoUpdate===!0&&Z.update(le);else if(Z.isLight)q.pushLight(Z),Z.castShadow&&q.pushShadow(Z);else if(Z.isSprite){if(!Z.frustumCulled||Tt.intersectsSprite(Z)){ge&&Ue.setFromMatrixPosition(Z.matrixWorld).applyMatrix4(un);const pt=vt.update(Z),gt=Z.material;gt.visible&&U.push(Z,pt,gt,Se,Ue.z,null)}}else if((Z.isMesh||Z.isLine||Z.isPoints)&&(!Z.frustumCulled||Tt.intersectsObject(Z))){const pt=vt.update(Z),gt=Z.material;if(ge&&(Z.boundingSphere!==void 0?(Z.boundingSphere===null&&Z.computeBoundingSphere(),Ue.copy(Z.boundingSphere.center)):(pt.boundingSphere===null&&pt.computeBoundingSphere(),Ue.copy(pt.boundingSphere.center)),Ue.applyMatrix4(Z.matrixWorld).applyMatrix4(un)),Array.isArray(gt)){const ht=pt.groups;for(let Pt=0,Kt=ht.length;Pt<Kt;Pt++){const jt=ht[Pt],bt=gt[jt.materialIndex];bt&&bt.visible&&U.push(Z,pt,bt,Se,Ue.z,jt)}}else gt.visible&&U.push(Z,pt,gt,Se,Ue.z,null)}}const lt=Z.children;for(let pt=0,gt=lt.length;pt<gt;pt++)ji(lt[pt],le,Se,ge)}function tr(Z,le,Se,ge){const{opaque:me,transmissive:lt,transparent:pt}=Z;q.setupLightsView(Se),Lt===!0&&Xe.setGlobalState(P.clippingPlanes,Se),ge&&st.viewport(ee.copy(ge)),me.length>0&&_i(me,le,Se),lt.length>0&&_i(lt,le,Se),pt.length>0&&_i(pt,le,Se),st.buffers.depth.setTest(!0),st.buffers.depth.setMask(!0),st.buffers.color.setMask(!0),st.setPolygonOffset(!1)}function fi(Z,le,Se,ge){if((Se.isScene===!0?Se.overrideMaterial:null)!==null)return;if(q.state.transmissionRenderTarget[ge.id]===void 0){const bt=it.has("EXT_color_buffer_half_float")||it.has("EXT_color_buffer_float");q.state.transmissionRenderTarget[ge.id]=new co(1,1,{generateMipmaps:!0,type:bt?Sc:ca,minFilter:gc,samples:Rt.samples,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Gn.workingColorSpace})}const lt=q.state.transmissionRenderTarget[ge.id],pt=ge.viewport||ee;lt.setSize(pt.z*P.transmissionResolutionScale,pt.w*P.transmissionResolutionScale);const gt=P.getRenderTarget(),ht=P.getActiveCubeFace(),Pt=P.getActiveMipmapLevel();P.setRenderTarget(lt),P.getClearColor(be),Be=P.getClearAlpha(),Be<1&&P.setClearColor(16777215,.5),P.clear(),ze&&ne.render(Se);const Kt=P.toneMapping;P.toneMapping=jo;const jt=ge.viewport;if(ge.viewport!==void 0&&(ge.viewport=void 0),q.setupLightsView(ge),Lt===!0&&Xe.setGlobalState(P.clippingPlanes,ge),_i(Z,Se,ge),oe.updateMultisampleRenderTarget(lt),oe.updateRenderTargetMipmap(lt),it.has("WEBGL_multisampled_render_to_texture")===!1){let bt=!1;for(let sn=0,qn=le.length;sn<qn;sn++){const ti=le[sn],{object:Ut,geometry:Cn,material:ct,group:Ei}=ti;if(ct.side===bl&&Ut.layers.test(ge.layers)){const Qt=ct.side;ct.side=jr,ct.needsUpdate=!0,nr(Ut,Se,ge,Cn,ct,Ei),ct.side=Qt,ct.needsUpdate=!0,bt=!0}}bt===!0&&(oe.updateMultisampleRenderTarget(lt),oe.updateRenderTargetMipmap(lt))}P.setRenderTarget(gt,ht,Pt),P.setClearColor(be,Be),jt!==void 0&&(ge.viewport=jt),P.toneMapping=Kt}function _i(Z,le,Se){const ge=le.isScene===!0?le.overrideMaterial:null;for(let me=0,lt=Z.length;me<lt;me++){const pt=Z[me],{object:gt,geometry:ht,group:Pt}=pt;let Kt=pt.material;Kt.allowOverride===!0&&ge!==null&&(Kt=ge),gt.layers.test(Se.layers)&&nr(gt,le,Se,ht,Kt,Pt)}}function nr(Z,le,Se,ge,me,lt){Z.onBeforeRender(P,le,Se,ge,me,lt),Z.modelViewMatrix.multiplyMatrices(Se.matrixWorldInverse,Z.matrixWorld),Z.normalMatrix.getNormalMatrix(Z.modelViewMatrix),me.onBeforeRender(P,le,Se,ge,Z,lt),me.transparent===!0&&me.side===bl&&me.forceSinglePass===!1?(me.side=jr,me.needsUpdate=!0,P.renderBufferDirect(Se,le,ge,me,Z,lt),me.side=vu,me.needsUpdate=!0,P.renderBufferDirect(Se,le,ge,me,Z,lt),me.side=bl):P.renderBufferDirect(Se,le,ge,me,Z,lt),Z.onAfterRender(P,le,Se,ge,me,lt)}function bs(Z,le,Se){le.isScene!==!0&&(le=Ye);const ge=G.get(Z),me=q.state.lights,lt=q.state.shadowsArray,pt=me.state.version,gt=rt.getParameters(Z,me.state,lt,le,Se),ht=rt.getProgramCacheKey(gt);let Pt=ge.programs;ge.environment=Z.isMeshStandardMaterial||Z.isMeshLambertMaterial||Z.isMeshPhongMaterial?le.environment:null,ge.fog=le.fog;const Kt=Z.isMeshStandardMaterial||Z.isMeshLambertMaterial&&!Z.envMap||Z.isMeshPhongMaterial&&!Z.envMap;ge.envMap=Ae.get(Z.envMap||ge.environment,Kt),ge.envMapRotation=ge.environment!==null&&Z.envMap===null?le.environmentRotation:Z.envMapRotation,Pt===void 0&&(Z.addEventListener("dispose",nn),Pt=new Map,ge.programs=Pt);let jt=Pt.get(ht);if(jt!==void 0){if(ge.currentProgram===jt&&ge.lightsStateVersion===pt)return Wa(Z,gt),jt}else gt.uniforms=rt.getUniforms(Z),Z.onBeforeCompile(gt,P),jt=rt.acquireProgram(gt,ht),Pt.set(ht,jt),ge.uniforms=gt.uniforms;const bt=ge.uniforms;return(!Z.isShaderMaterial&&!Z.isRawShaderMaterial||Z.clipping===!0)&&(bt.clippingPlanes=Xe.uniform),Wa(Z,gt),ge.needsLights=ma(Z),ge.lightsStateVersion=pt,ge.needsLights&&(bt.ambientLightColor.value=me.state.ambient,bt.lightProbe.value=me.state.probe,bt.directionalLights.value=me.state.directional,bt.directionalLightShadows.value=me.state.directionalShadow,bt.spotLights.value=me.state.spot,bt.spotLightShadows.value=me.state.spotShadow,bt.rectAreaLights.value=me.state.rectArea,bt.ltc_1.value=me.state.rectAreaLTC1,bt.ltc_2.value=me.state.rectAreaLTC2,bt.pointLights.value=me.state.point,bt.pointLightShadows.value=me.state.pointShadow,bt.hemisphereLights.value=me.state.hemi,bt.directionalShadowMatrix.value=me.state.directionalShadowMatrix,bt.spotLightMatrix.value=me.state.spotLightMatrix,bt.spotLightMap.value=me.state.spotLightMap,bt.pointShadowMatrix.value=me.state.pointShadowMatrix),ge.currentProgram=jt,ge.uniformsList=null,jt}function Xr(Z){if(Z.uniformsList===null){const le=Z.currentProgram.getUniforms();Z.uniformsList=j_.seqWithValue(le.seq,Z.uniforms)}return Z.uniformsList}function Wa(Z,le){const Se=G.get(Z);Se.outputColorSpace=le.outputColorSpace,Se.batching=le.batching,Se.batchingColor=le.batchingColor,Se.instancing=le.instancing,Se.instancingColor=le.instancingColor,Se.instancingMorph=le.instancingMorph,Se.skinning=le.skinning,Se.morphTargets=le.morphTargets,Se.morphNormals=le.morphNormals,Se.morphColors=le.morphColors,Se.morphTargetsCount=le.morphTargetsCount,Se.numClippingPlanes=le.numClippingPlanes,Se.numIntersection=le.numClipIntersection,Se.vertexAlphas=le.vertexAlphas,Se.vertexTangents=le.vertexTangents,Se.toneMapping=le.toneMapping}function Al(Z,le,Se,ge,me){le.isScene!==!0&&(le=Ye),oe.resetTextureUnits();const lt=le.fog,pt=ge.isMeshStandardMaterial||ge.isMeshLambertMaterial||ge.isMeshPhongMaterial?le.environment:null,gt=k===null?P.outputColorSpace:k.isXRRenderTarget===!0?k.texture.colorSpace:Nh,ht=ge.isMeshStandardMaterial||ge.isMeshLambertMaterial&&!ge.envMap||ge.isMeshPhongMaterial&&!ge.envMap,Pt=Ae.get(ge.envMap||pt,ht),Kt=ge.vertexColors===!0&&!!Se.attributes.color&&Se.attributes.color.itemSize===4,jt=!!Se.attributes.tangent&&(!!ge.normalMap||ge.anisotropy>0),bt=!!Se.morphAttributes.position,sn=!!Se.morphAttributes.normal,qn=!!Se.morphAttributes.color;let ti=jo;ge.toneMapped&&(k===null||k.isXRRenderTarget===!0)&&(ti=P.toneMapping);const Ut=Se.morphAttributes.position||Se.morphAttributes.normal||Se.morphAttributes.color,Cn=Ut!==void 0?Ut.length:0,ct=G.get(ge),Ei=q.state.lights;if(Lt===!0&&(Ht===!0||Z!==he)){const Ti=Z===he&&ge.id===ue;Xe.setState(ge,Z,Ti)}let Qt=!1;ge.version===ct.__version?(ct.needsLights&&ct.lightsStateVersion!==Ei.state.version||ct.outputColorSpace!==gt||me.isBatchedMesh&&ct.batching===!1||!me.isBatchedMesh&&ct.batching===!0||me.isBatchedMesh&&ct.batchingColor===!0&&me.colorTexture===null||me.isBatchedMesh&&ct.batchingColor===!1&&me.colorTexture!==null||me.isInstancedMesh&&ct.instancing===!1||!me.isInstancedMesh&&ct.instancing===!0||me.isSkinnedMesh&&ct.skinning===!1||!me.isSkinnedMesh&&ct.skinning===!0||me.isInstancedMesh&&ct.instancingColor===!0&&me.instanceColor===null||me.isInstancedMesh&&ct.instancingColor===!1&&me.instanceColor!==null||me.isInstancedMesh&&ct.instancingMorph===!0&&me.morphTexture===null||me.isInstancedMesh&&ct.instancingMorph===!1&&me.morphTexture!==null||ct.envMap!==Pt||ge.fog===!0&&ct.fog!==lt||ct.numClippingPlanes!==void 0&&(ct.numClippingPlanes!==Xe.numPlanes||ct.numIntersection!==Xe.numIntersection)||ct.vertexAlphas!==Kt||ct.vertexTangents!==jt||ct.morphTargets!==bt||ct.morphNormals!==sn||ct.morphColors!==qn||ct.toneMapping!==ti||ct.morphTargetsCount!==Cn)&&(Qt=!0):(Qt=!0,ct.__version=ge.version);let Wi=ct.currentProgram;Qt===!0&&(Wi=bs(ge,le,me));let Ls=!1,qi=!1,Ss=!1;const Vn=Wi.getUniforms(),li=ct.uniforms;if(st.useProgram(Wi.program)&&(Ls=!0,qi=!0,Ss=!0),ge.id!==ue&&(ue=ge.id,qi=!0),Ls||he!==Z){st.buffers.depth.getReversed()&&Z.reversedDepth!==!0&&(Z._reversedDepth=!0,Z.updateProjectionMatrix()),Vn.setValue(te,"projectionMatrix",Z.projectionMatrix),Vn.setValue(te,"viewMatrix",Z.matrixWorldInverse);const sr=Vn.map.cameraPosition;sr!==void 0&&sr.setValue(te,zt.setFromMatrixPosition(Z.matrixWorld)),Rt.logarithmicDepthBuffer&&Vn.setValue(te,"logDepthBufFC",2/(Math.log(Z.far+1)/Math.LN2)),(ge.isMeshPhongMaterial||ge.isMeshToonMaterial||ge.isMeshLambertMaterial||ge.isMeshBasicMaterial||ge.isMeshStandardMaterial||ge.isShaderMaterial)&&Vn.setValue(te,"isOrthographic",Z.isOrthographicCamera===!0),he!==Z&&(he=Z,qi=!0,Ss=!0)}if(ct.needsLights&&(Ei.state.directionalShadowMap.length>0&&Vn.setValue(te,"directionalShadowMap",Ei.state.directionalShadowMap,oe),Ei.state.spotShadowMap.length>0&&Vn.setValue(te,"spotShadowMap",Ei.state.spotShadowMap,oe),Ei.state.pointShadowMap.length>0&&Vn.setValue(te,"pointShadowMap",Ei.state.pointShadowMap,oe)),me.isSkinnedMesh){Vn.setOptional(te,me,"bindMatrix"),Vn.setOptional(te,me,"bindMatrixInverse");const Ti=me.skeleton;Ti&&(Ti.boneTexture===null&&Ti.computeBoneTexture(),Vn.setValue(te,"boneTexture",Ti.boneTexture,oe))}me.isBatchedMesh&&(Vn.setOptional(te,me,"batchingTexture"),Vn.setValue(te,"batchingTexture",me._matricesTexture,oe),Vn.setOptional(te,me,"batchingIdTexture"),Vn.setValue(te,"batchingIdTexture",me._indirectTexture,oe),Vn.setOptional(te,me,"batchingColorTexture"),me._colorsTexture!==null&&Vn.setValue(te,"batchingColorTexture",me._colorsTexture,oe));const Mi=Se.morphAttributes;if((Mi.position!==void 0||Mi.normal!==void 0||Mi.color!==void 0)&&xe.update(me,Se,Wi),(qi||ct.receiveShadow!==me.receiveShadow)&&(ct.receiveShadow=me.receiveShadow,Vn.setValue(te,"receiveShadow",me.receiveShadow)),(ge.isMeshStandardMaterial||ge.isMeshLambertMaterial||ge.isMeshPhongMaterial)&&ge.envMap===null&&le.environment!==null&&(li.envMapIntensity.value=le.environmentIntensity),li.dfgLUT!==void 0&&(li.dfgLUT.value=G5()),qi&&(Vn.setValue(te,"toneMappingExposure",P.toneMappingExposure),ct.needsLights&&Ws(li,Ss),lt&&ge.fog===!0&&It.refreshFogUniforms(li,lt),It.refreshMaterialUniforms(li,ge,$e,Pe,q.state.transmissionRenderTarget[Z.id]),j_.upload(te,Xr(ct),li,oe)),ge.isShaderMaterial&&ge.uniformsNeedUpdate===!0&&(j_.upload(te,Xr(ct),li,oe),ge.uniformsNeedUpdate=!1),ge.isSpriteMaterial&&Vn.setValue(te,"center",me.center),Vn.setValue(te,"modelViewMatrix",me.modelViewMatrix),Vn.setValue(te,"normalMatrix",me.normalMatrix),Vn.setValue(te,"modelMatrix",me.matrixWorld),ge.isShaderMaterial||ge.isRawShaderMaterial){const Ti=ge.uniformsGroups;for(let sr=0,Zr=Ti.length;sr<Zr;sr++){const ho=Ti[sr];Je.update(ho,Wi),Je.bind(ho,Wi)}}return Wi}function Ws(Z,le){Z.ambientLightColor.needsUpdate=le,Z.lightProbe.needsUpdate=le,Z.directionalLights.needsUpdate=le,Z.directionalLightShadows.needsUpdate=le,Z.pointLights.needsUpdate=le,Z.pointLightShadows.needsUpdate=le,Z.spotLights.needsUpdate=le,Z.spotLightShadows.needsUpdate=le,Z.rectAreaLights.needsUpdate=le,Z.hemisphereLights.needsUpdate=le}function ma(Z){return Z.isMeshLambertMaterial||Z.isMeshToonMaterial||Z.isMeshPhongMaterial||Z.isMeshStandardMaterial||Z.isShadowMaterial||Z.isShaderMaterial&&Z.lights===!0}this.getActiveCubeFace=function(){return B},this.getActiveMipmapLevel=function(){return X},this.getRenderTarget=function(){return k},this.setRenderTargetTextures=function(Z,le,Se){const ge=G.get(Z);ge.__autoAllocateDepthBuffer=Z.resolveDepthBuffer===!1,ge.__autoAllocateDepthBuffer===!1&&(ge.__useRenderToTexture=!1),G.get(Z.texture).__webglTexture=le,G.get(Z.depthTexture).__webglTexture=ge.__autoAllocateDepthBuffer?void 0:Se,ge.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(Z,le){const Se=G.get(Z);Se.__webglFramebuffer=le,Se.__useDefaultFramebuffer=le===void 0};const Yr=te.createFramebuffer();this.setRenderTarget=function(Z,le=0,Se=0){k=Z,B=le,X=Se;let ge=null,me=!1,lt=!1;if(Z){const gt=G.get(Z);if(gt.__useDefaultFramebuffer!==void 0){st.bindFramebuffer(te.FRAMEBUFFER,gt.__webglFramebuffer),ee.copy(Z.viewport),ie.copy(Z.scissor),ye=Z.scissorTest,st.viewport(ee),st.scissor(ie),st.setScissorTest(ye),ue=-1;return}else if(gt.__webglFramebuffer===void 0)oe.setupRenderTarget(Z);else if(gt.__hasExternalTextures)oe.rebindTextures(Z,G.get(Z.texture).__webglTexture,G.get(Z.depthTexture).__webglTexture);else if(Z.depthBuffer){const Kt=Z.depthTexture;if(gt.__boundDepthTexture!==Kt){if(Kt!==null&&G.has(Kt)&&(Z.width!==Kt.image.width||Z.height!==Kt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");oe.setupDepthRenderbuffer(Z)}}const ht=Z.texture;(ht.isData3DTexture||ht.isDataArrayTexture||ht.isCompressedArrayTexture)&&(lt=!0);const Pt=G.get(Z).__webglFramebuffer;Z.isWebGLCubeRenderTarget?(Array.isArray(Pt[le])?ge=Pt[le][Se]:ge=Pt[le],me=!0):Z.samples>0&&oe.useMultisampledRTT(Z)===!1?ge=G.get(Z).__webglMultisampledFramebuffer:Array.isArray(Pt)?ge=Pt[Se]:ge=Pt,ee.copy(Z.viewport),ie.copy(Z.scissor),ye=Z.scissorTest}else ee.copy(Ie).multiplyScalar($e).floor(),ie.copy(tt).multiplyScalar($e).floor(),ye=nt;if(Se!==0&&(ge=Yr),st.bindFramebuffer(te.FRAMEBUFFER,ge)&&st.drawBuffers(Z,ge),st.viewport(ee),st.scissor(ie),st.setScissorTest(ye),me){const gt=G.get(Z.texture);te.framebufferTexture2D(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_CUBE_MAP_POSITIVE_X+le,gt.__webglTexture,Se)}else if(lt){const gt=le;for(let ht=0;ht<Z.textures.length;ht++){const Pt=G.get(Z.textures[ht]);te.framebufferTextureLayer(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0+ht,Pt.__webglTexture,Se,gt)}}else if(Z!==null&&Se!==0){const gt=G.get(Z.texture);te.framebufferTexture2D(te.FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,gt.__webglTexture,Se)}ue=-1},this.readRenderTargetPixels=function(Z,le,Se,ge,me,lt,pt,gt=0){if(!(Z&&Z.isWebGLRenderTarget)){Gt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ht=G.get(Z).__webglFramebuffer;if(Z.isWebGLCubeRenderTarget&&pt!==void 0&&(ht=ht[pt]),ht){st.bindFramebuffer(te.FRAMEBUFFER,ht);try{const Pt=Z.textures[gt],Kt=Pt.format,jt=Pt.type;if(Z.textures.length>1&&te.readBuffer(te.COLOR_ATTACHMENT0+gt),!Rt.textureFormatReadable(Kt)){Gt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Rt.textureTypeReadable(jt)){Gt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=Z.width-ge&&Se>=0&&Se<=Z.height-me&&te.readPixels(le,Se,ge,me,je.convert(Kt),je.convert(jt),lt)}finally{const Pt=k!==null?G.get(k).__webglFramebuffer:null;st.bindFramebuffer(te.FRAMEBUFFER,Pt)}}},this.readRenderTargetPixelsAsync=async function(Z,le,Se,ge,me,lt,pt,gt=0){if(!(Z&&Z.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ht=G.get(Z).__webglFramebuffer;if(Z.isWebGLCubeRenderTarget&&pt!==void 0&&(ht=ht[pt]),ht)if(le>=0&&le<=Z.width-ge&&Se>=0&&Se<=Z.height-me){st.bindFramebuffer(te.FRAMEBUFFER,ht);const Pt=Z.textures[gt],Kt=Pt.format,jt=Pt.type;if(Z.textures.length>1&&te.readBuffer(te.COLOR_ATTACHMENT0+gt),!Rt.textureFormatReadable(Kt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Rt.textureTypeReadable(jt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const bt=te.createBuffer();te.bindBuffer(te.PIXEL_PACK_BUFFER,bt),te.bufferData(te.PIXEL_PACK_BUFFER,lt.byteLength,te.STREAM_READ),te.readPixels(le,Se,ge,me,je.convert(Kt),je.convert(jt),0);const sn=k!==null?G.get(k).__webglFramebuffer:null;st.bindFramebuffer(te.FRAMEBUFFER,sn);const qn=te.fenceSync(te.SYNC_GPU_COMMANDS_COMPLETE,0);return te.flush(),await iO(te,qn,4),te.bindBuffer(te.PIXEL_PACK_BUFFER,bt),te.getBufferSubData(te.PIXEL_PACK_BUFFER,0,lt),te.deleteBuffer(bt),te.deleteSync(qn),lt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(Z,le=null,Se=0){const ge=Math.pow(2,-Se),me=Math.floor(Z.image.width*ge),lt=Math.floor(Z.image.height*ge),pt=le!==null?le.x:0,gt=le!==null?le.y:0;oe.setTexture2D(Z,0),te.copyTexSubImage2D(te.TEXTURE_2D,Se,0,0,pt,gt,me,lt),st.unbindTexture()};const ir=te.createFramebuffer(),qs=te.createFramebuffer();this.copyTextureToTexture=function(Z,le,Se=null,ge=null,me=0,lt=0){let pt,gt,ht,Pt,Kt,jt,bt,sn,qn;const ti=Z.isCompressedTexture?Z.mipmaps[lt]:Z.image;if(Se!==null)pt=Se.max.x-Se.min.x,gt=Se.max.y-Se.min.y,ht=Se.isBox3?Se.max.z-Se.min.z:1,Pt=Se.min.x,Kt=Se.min.y,jt=Se.isBox3?Se.min.z:0;else{const li=Math.pow(2,-me);pt=Math.floor(ti.width*li),gt=Math.floor(ti.height*li),Z.isDataArrayTexture?ht=ti.depth:Z.isData3DTexture?ht=Math.floor(ti.depth*li):ht=1,Pt=0,Kt=0,jt=0}ge!==null?(bt=ge.x,sn=ge.y,qn=ge.z):(bt=0,sn=0,qn=0);const Ut=je.convert(le.format),Cn=je.convert(le.type);let ct;le.isData3DTexture?(oe.setTexture3D(le,0),ct=te.TEXTURE_3D):le.isDataArrayTexture||le.isCompressedArrayTexture?(oe.setTexture2DArray(le,0),ct=te.TEXTURE_2D_ARRAY):(oe.setTexture2D(le,0),ct=te.TEXTURE_2D),te.pixelStorei(te.UNPACK_FLIP_Y_WEBGL,le.flipY),te.pixelStorei(te.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),te.pixelStorei(te.UNPACK_ALIGNMENT,le.unpackAlignment);const Ei=te.getParameter(te.UNPACK_ROW_LENGTH),Qt=te.getParameter(te.UNPACK_IMAGE_HEIGHT),Wi=te.getParameter(te.UNPACK_SKIP_PIXELS),Ls=te.getParameter(te.UNPACK_SKIP_ROWS),qi=te.getParameter(te.UNPACK_SKIP_IMAGES);te.pixelStorei(te.UNPACK_ROW_LENGTH,ti.width),te.pixelStorei(te.UNPACK_IMAGE_HEIGHT,ti.height),te.pixelStorei(te.UNPACK_SKIP_PIXELS,Pt),te.pixelStorei(te.UNPACK_SKIP_ROWS,Kt),te.pixelStorei(te.UNPACK_SKIP_IMAGES,jt);const Ss=Z.isDataArrayTexture||Z.isData3DTexture,Vn=le.isDataArrayTexture||le.isData3DTexture;if(Z.isDepthTexture){const li=G.get(Z),Mi=G.get(le),Ti=G.get(li.__renderTarget),sr=G.get(Mi.__renderTarget);st.bindFramebuffer(te.READ_FRAMEBUFFER,Ti.__webglFramebuffer),st.bindFramebuffer(te.DRAW_FRAMEBUFFER,sr.__webglFramebuffer);for(let Zr=0;Zr<ht;Zr++)Ss&&(te.framebufferTextureLayer(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,G.get(Z).__webglTexture,me,jt+Zr),te.framebufferTextureLayer(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,G.get(le).__webglTexture,lt,qn+Zr)),te.blitFramebuffer(Pt,Kt,pt,gt,bt,sn,pt,gt,te.DEPTH_BUFFER_BIT,te.NEAREST);st.bindFramebuffer(te.READ_FRAMEBUFFER,null),st.bindFramebuffer(te.DRAW_FRAMEBUFFER,null)}else if(me!==0||Z.isRenderTargetTexture||G.has(Z)){const li=G.get(Z),Mi=G.get(le);st.bindFramebuffer(te.READ_FRAMEBUFFER,ir),st.bindFramebuffer(te.DRAW_FRAMEBUFFER,qs);for(let Ti=0;Ti<ht;Ti++)Ss?te.framebufferTextureLayer(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,li.__webglTexture,me,jt+Ti):te.framebufferTexture2D(te.READ_FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,li.__webglTexture,me),Vn?te.framebufferTextureLayer(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,Mi.__webglTexture,lt,qn+Ti):te.framebufferTexture2D(te.DRAW_FRAMEBUFFER,te.COLOR_ATTACHMENT0,te.TEXTURE_2D,Mi.__webglTexture,lt),me!==0?te.blitFramebuffer(Pt,Kt,pt,gt,bt,sn,pt,gt,te.COLOR_BUFFER_BIT,te.NEAREST):Vn?te.copyTexSubImage3D(ct,lt,bt,sn,qn+Ti,Pt,Kt,pt,gt):te.copyTexSubImage2D(ct,lt,bt,sn,Pt,Kt,pt,gt);st.bindFramebuffer(te.READ_FRAMEBUFFER,null),st.bindFramebuffer(te.DRAW_FRAMEBUFFER,null)}else Vn?Z.isDataTexture||Z.isData3DTexture?te.texSubImage3D(ct,lt,bt,sn,qn,pt,gt,ht,Ut,Cn,ti.data):le.isCompressedArrayTexture?te.compressedTexSubImage3D(ct,lt,bt,sn,qn,pt,gt,ht,Ut,ti.data):te.texSubImage3D(ct,lt,bt,sn,qn,pt,gt,ht,Ut,Cn,ti):Z.isDataTexture?te.texSubImage2D(te.TEXTURE_2D,lt,bt,sn,pt,gt,Ut,Cn,ti.data):Z.isCompressedTexture?te.compressedTexSubImage2D(te.TEXTURE_2D,lt,bt,sn,ti.width,ti.height,Ut,ti.data):te.texSubImage2D(te.TEXTURE_2D,lt,bt,sn,pt,gt,Ut,Cn,ti);te.pixelStorei(te.UNPACK_ROW_LENGTH,Ei),te.pixelStorei(te.UNPACK_IMAGE_HEIGHT,Qt),te.pixelStorei(te.UNPACK_SKIP_PIXELS,Wi),te.pixelStorei(te.UNPACK_SKIP_ROWS,Ls),te.pixelStorei(te.UNPACK_SKIP_IMAGES,qi),lt===0&&le.generateMipmaps&&te.generateMipmap(ct),st.unbindTexture()},this.initRenderTarget=function(Z){G.get(Z).__webglFramebuffer===void 0&&oe.setupRenderTarget(Z)},this.initTexture=function(Z){Z.isCubeTexture?oe.setTextureCube(Z,0):Z.isData3DTexture?oe.setTexture3D(Z,0):Z.isDataArrayTexture||Z.isCompressedArrayTexture?oe.setTexture2DArray(Z,0):oe.setTexture2D(Z,0),st.unbindTexture()},this.resetState=function(){B=0,X=0,k=null,st.reset(),Ze.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ao}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Gn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Gn._getUnpackColorSpace()}}const j5=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:ny,AddEquation:_h,AddOperation:c3,AdditiveAnimationBlendMode:gM,AdditiveBlending:tx,AgXToneMapping:oM,AlphaFormat:pM,AlwaysCompare:b3,AlwaysDepth:rx,AlwaysStencilFunc:uE,AmbientLight:dI,AnimationAction:SI,AnimationClip:j0,AnimationLoader:XU,AnimationMixer:E4,AnimationObjectGroup:b4,AnimationUtils:GU,ArcCurve:B3,ArrayCamera:vI,ArrowHelper:j4,AttachedBindMode:lE,Audio:xI,AudioAnalyser:h4,AudioContext:jM,AudioListener:l4,AudioLoader:s4,AxesHelper:W4,BackSide:jr,BasicDepthPacking:p3,BasicShadowMap:GR,BatchedMesh:P3,BezierInterpolant:aI,Bone:EM,BooleanKeyframeTrack:md,Box2:R4,Box3:Vs,Box3Helper:H4,BoxGeometry:pd,BoxHelper:k4,BufferAttribute:vi,BufferGeometry:vn,BufferGeometryLoader:gI,ByteType:uM,Cache:yc,Camera:jb,CameraHelper:V4,CanvasTexture:cU,CapsuleGeometry:Db,CatmullRomCurve3:V3,CineonToneMapping:rM,CircleGeometry:Nb,ClampToEdgeWrapping:Ha,Clock:MI,Color:wt,ColorKeyframeTrack:BM,ColorManagement:Gn,Compatibility:$L,CompressedArrayTexture:oU,CompressedCubeTexture:lU,CompressedTexture:Ib,CompressedTextureLoader:YU,ConeGeometry:ay,ConstantAlphaFactor:a3,ConstantColorFactor:s3,Controls:X4,CubeCamera:yI,CubeDepthTexture:z3,CubeReflectionMapping:bc,CubeRefractionMapping:Dh,CubeTexture:sy,CubeTextureLoader:ZU,CubeUVReflectionMapping:Sm,CubicBezierCurve:wM,CubicBezierCurve3:k3,CubicInterpolant:sI,CullFaceBack:rE,CullFaceFront:HR,CullFaceFrontBack:uL,CullFaceNone:kR,Curve:Ml,CurvePath:G3,CustomBlending:jR,CustomToneMapping:aM,CylinderGeometry:ry,Cylindrical:C4,Data3DTexture:Mb,DataArrayTexture:Eb,DataTexture:El,DataTextureLoader:KU,DataUtils:LO,DecrementStencilOp:RL,DecrementWrapStencilOp:DL,DefaultLoadingManager:lI,DepthFormat:Ec,DepthStencilFormat:bh,DepthTexture:om,DetachedBindMode:u3,DirectionalLight:fI,DirectionalLightHelper:B4,DiscreteInterpolant:rI,DodecahedronGeometry:Pb,DoubleSide:bl,DstAlphaFactor:JR,DstColorFactor:t3,DynamicCopyUsage:qL,DynamicDrawUsage:VL,DynamicReadUsage:GL,EdgesGeometry:F3,EllipseCurve:Lb,EqualCompare:v3,EqualDepth:ox,EqualStencilFunc:OL,EquirectangularReflectionMapping:d0,EquirectangularRefractionMapping:p0,Euler:uo,EventDispatcher:Ac,ExternalTexture:TM,ExtrudeGeometry:Ob,FileLoader:_u,Float16BufferAttribute:kO,Float32BufferAttribute:Ct,FloatType:fa,Fog:Ab,FogExp2:Tb,FramebufferTexture:aU,FrontSide:vu,Frustum:Em,FrustumArray:Rb,GLBufferAttribute:w4,GLSL1:YL,GLSL3:hE,GreaterCompare:_3,GreaterDepth:cx,GreaterEqualCompare:Sb,GreaterEqualDepth:lx,GreaterEqualStencilFunc:BL,GreaterStencilFunc:zL,GridHelper:z4,Group:qp,HalfFloatType:Sc,HemisphereLight:cI,HemisphereLightHelper:U4,IcosahedronGeometry:Ub,ImageBitmapLoader:i4,ImageLoader:W0,ImageUtils:A3,IncrementStencilOp:CL,IncrementWrapStencilOp:IL,InstancedBufferAttribute:am,InstancedBufferGeometry:GM,InstancedInterleavedBuffer:Zx,InstancedMesh:N3,Int16BufferAttribute:BO,Int32BufferAttribute:VO,Int8BufferAttribute:UO,IntType:pb,InterleavedBuffer:wb,InterleavedBufferAttribute:oo,Interpolant:Tm,InterpolateBezier:cE,InterpolateDiscrete:N0,InterpolateLinear:Gx,InterpolateSmooth:H_,InterpolationSamplingMode:QL,InterpolationSamplingType:KL,InvertStencilOp:NL,KeepStencilOp:Wf,KeyframeTrack:qo,LOD:I3,LatheGeometry:zb,Layers:rm,LessCompare:y3,LessDepth:ax,LessEqualCompare:bb,LessEqualDepth:rd,LessEqualStencilFunc:UL,LessStencilFunc:LL,Light:jh,LightProbe:mI,Line:Lh,Line3:TI,LineBasicMaterial:da,LineCurve:CM,LineCurve3:H3,LineDashedMaterial:nI,LineLoop:L3,LineSegments:wc,LinearFilter:zi,LinearInterpolant:FM,LinearMipMapLinearFilter:mL,LinearMipMapNearestFilter:pL,LinearMipmapLinearFilter:gc,LinearMipmapNearestFilter:m0,LinearSRGBColorSpace:Nh,LinearToneMapping:iM,LinearTransfer:L0,Loader:ja,LoaderUtils:gE,LoadingManager:VM,LoopOnce:h3,LoopPingPong:d3,LoopRepeat:f3,MOUSE:Gf,Material:Wr,MaterialBlending:hL,MaterialLoader:Wb,MathUtils:T3,Matrix2:YM,Matrix3:xn,Matrix4:on,MaxEquation:YR,Mesh:_s,MeshBasicMaterial:Hh,MeshDepthMaterial:OM,MeshDistanceMaterial:UM,MeshLambertMaterial:eI,MeshMatcapMaterial:tI,MeshNormalMaterial:J3,MeshPhongMaterial:Q3,MeshPhysicalMaterial:K3,MeshStandardMaterial:LM,MeshToonMaterial:$3,MinEquation:XR,MirroredRepeatWrapping:D0,MixOperation:l3,MultiplyBlending:oE,MultiplyOperation:ty,NearestFilter:vs,NearestMipMapLinearFilter:dL,NearestMipMapNearestFilter:fL,NearestMipmapLinearFilter:jp,NearestMipmapNearestFilter:cM,NeutralToneMapping:lM,NeverCompare:g3,NeverDepth:sx,NeverStencilFunc:PL,NoBlending:_c,NoColorSpace:pu,NoNormalPacking:EL,NoToneMapping:jo,NormalAnimationBlendMode:xb,NormalBlending:Jf,NormalGAPacking:TL,NormalRGPacking:ML,NotEqualCompare:x3,NotEqualDepth:ux,NotEqualStencilFunc:FL,NumberKeyframeTrack:H0,Object3D:ei,ObjectLoader:t4,ObjectSpaceNormalMap:m3,OctahedronGeometry:oy,OneFactor:KR,OneMinusConstantAlphaFactor:o3,OneMinusConstantColorFactor:r3,OneMinusDstAlphaFactor:e3,OneMinusDstColorFactor:n3,OneMinusSrcAlphaFactor:ix,OneMinusSrcColorFactor:$R,OrthographicCamera:yu,PCFShadowMap:Xp,PCFSoftShadowMap:f0,PMREMGenerator:_E,Path:Xx,PerspectiveCamera:ys,Plane:du,PlaneGeometry:Mm,PlaneHelper:G4,PointLight:hI,PointLightHelper:L4,Points:O3,PointsMaterial:MM,PolarGridHelper:F4,PolyhedronGeometry:Gh,PositionalAudio:u4,PropertyBinding:Qn,PropertyMixer:bI,QuadraticBezierCurve:RM,QuadraticBezierCurve3:IM,Quaternion:br,QuaternionKeyframeTrack:cy,QuaternionLinearInterpolant:oI,R11_EAC_Format:vx,RED_GREEN_RGTC2_Format:kx,RED_RGTC1_Format:Bx,REVISION:bm,RG11_EAC_Format:xx,RGBADepthPacking:xL,RGBAFormat:Gr,RGBAIntegerFormat:_b,RGBA_ASTC_10x10_Format:Px,RGBA_ASTC_10x5_Format:Ix,RGBA_ASTC_10x6_Format:Dx,RGBA_ASTC_10x8_Format:Nx,RGBA_ASTC_12x10_Format:Lx,RGBA_ASTC_12x12_Format:Ox,RGBA_ASTC_4x4_Format:Sx,RGBA_ASTC_5x4_Format:Ex,RGBA_ASTC_5x5_Format:Mx,RGBA_ASTC_6x5_Format:Tx,RGBA_ASTC_6x6_Format:Ax,RGBA_ASTC_8x5_Format:wx,RGBA_ASTC_8x6_Format:Cx,RGBA_ASTC_8x8_Format:Rx,RGBA_BPTC_Format:Ux,RGBA_ETC2_EAC_Format:yx,RGBA_PVRTC_2BPPV1_Format:px,RGBA_PVRTC_4BPPV1_Format:dx,RGBA_S3TC_DXT1_Format:y0,RGBA_S3TC_DXT3_Format:v0,RGBA_S3TC_DXT5_Format:_0,RGBDepthPacking:bL,RGBFormat:mM,RGBIntegerFormat:gL,RGB_BPTC_SIGNED_Format:zx,RGB_BPTC_UNSIGNED_Format:Fx,RGB_ETC1_Format:mx,RGB_ETC2_Format:gx,RGB_PVRTC_2BPPV1_Format:fx,RGB_PVRTC_4BPPV1_Format:hx,RGB_S3TC_DXT1_Format:g0,RGDepthPacking:SL,RGFormat:ad,RGIntegerFormat:vb,RawShaderMaterial:PM,Ray:dd,Raycaster:EI,RectAreaLight:pI,RedFormat:yb,RedIntegerFormat:iy,ReinhardToneMapping:sM,RenderTarget:vM,RenderTarget3D:M4,RepeatWrapping:I0,ReplaceStencilOp:wL,ReverseSubtractEquation:qR,RingGeometry:Fb,SIGNED_R11_EAC_Format:_x,SIGNED_RED_GREEN_RGTC2_Format:Hx,SIGNED_RED_RGTC1_Format:Vx,SIGNED_RG11_EAC_Format:bx,SRGBColorSpace:kr,SRGBTransfer:hi,Scene:_M,ShaderChunk:wn,ShaderLib:xl,ShaderMaterial:Ga,ShadowMaterial:Y3,Shape:td,ShapeGeometry:Bb,ShapePath:q4,ShapeUtils:Sl,ShortType:hM,Skeleton:Cb,SkeletonHelper:P4,SkinnedMesh:D3,Source:Sh,Sphere:ks,SphereGeometry:ly,Spherical:Kx,SphericalHarmonics3:HM,SplineCurve:DM,SpotLight:uI,SpotLightHelper:N4,Sprite:R3,SpriteMaterial:SM,SrcAlphaFactor:nx,SrcAlphaSaturateFactor:i3,SrcColorFactor:QR,StaticCopyUsage:WL,StaticDrawUsage:O0,StaticReadUsage:HL,StereoCamera:r4,StreamCopyUsage:XL,StreamDrawUsage:kL,StreamReadUsage:jL,StringKeyframeTrack:gd,SubtractEquation:WR,SubtractiveBlending:aE,TOUCH:jf,TangentSpaceNormalMap:kh,TetrahedronGeometry:Vb,Texture:ls,TextureLoader:QU,TextureUtils:$4,Timer:_I,TimestampQuery:ZL,TorusGeometry:kb,TorusKnotGeometry:Hb,Triangle:ka,TriangleFanDrawMode:_L,TriangleStripDrawMode:vL,TrianglesDrawMode:yL,TubeGeometry:Gb,UVMapping:db,Uint16BufferAttribute:xM,Uint32BufferAttribute:bM,Uint8BufferAttribute:zO,Uint8ClampedBufferAttribute:FO,Uniform:XM,UniformsGroup:A4,UniformsLib:Et,UniformsUtils:Yx,UnsignedByteType:ca,UnsignedInt101111Type:dM,UnsignedInt248Type:im,UnsignedInt5999Type:fM,UnsignedIntType:Wo,UnsignedShort4444Type:mb,UnsignedShort5551Type:gb,UnsignedShortType:nm,VSMShadowMap:Yf,Vector2:ke,Vector3:J,Vector4:Jn,VectorKeyframeTrack:G0,VideoFrameTexture:rU,VideoTexture:U3,WebGL3DRenderTarget:TO,WebGLArrayRenderTarget:MO,WebGLCoordinateSystem:ao,WebGLCubeRenderTarget:ZM,WebGLRenderTarget:co,WebGLRenderer:PI,WebGLUtils:NI,WebGPUCoordinateSystem:od,WebXRController:G_,WireframeGeometry:NM,WrapAroundEnding:P0,ZeroCurvatureEnding:Zf,ZeroFactor:ZR,ZeroSlopeEnding:Kf,ZeroStencilOp:AL,createCanvasElement:E3,error:Gt,getConsoleFunction:nO,log:z0,setConsoleFunction:tO,warn:St,warnOnce:F0},Symbol.toStringTag,{value:"Module"}));var L1={exports:{}},O1={},U1={exports:{}},z1={};var Zw;function W5(){if(Zw)return z1;Zw=1;var i=eM();function e(v,x){return v===x&&(v!==0||1/v===1/x)||v!==v&&x!==x}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,s=i.useEffect,a=i.useLayoutEffect,c=i.useDebugValue;function f(v,x){var E=x(),T=n({inst:{value:E,getSnapshot:x}}),I=T[0].inst,w=T[1];return a(function(){I.value=E,I.getSnapshot=x,d(I)&&w({inst:I})},[v,E,x]),s(function(){return d(I)&&w({inst:I}),v(function(){d(I)&&w({inst:I})})},[v]),c(E),E}function d(v){var x=v.getSnapshot;v=v.value;try{var E=x();return!t(v,E)}catch{return!0}}function m(v,x){return x()}var y=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?m:f;return z1.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:y,z1}var Kw;function q5(){return Kw||(Kw=1,U1.exports=W5()),U1.exports}var Qw;function X5(){if(Qw)return O1;Qw=1;var i=eM(),e=q5();function t(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var n=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,a=i.useRef,c=i.useEffect,f=i.useMemo,d=i.useDebugValue;return O1.useSyncExternalStoreWithSelector=function(m,y,v,x,E){var T=a(null);if(T.current===null){var I={hasValue:!1,value:null};T.current=I}else I=T.current;T=f(function(){function A(j){if(!N){if(N=!0,O=j,j=x(j),E!==void 0&&I.hasValue){var F=I.value;if(E(F,j))return U=F}return U=j}if(F=U,n(O,j))return F;var R=x(j);return E!==void 0&&E(F,R)?(O=j,F):(O=j,U=R)}var N=!1,O,U,q=v===void 0?null:v;return[function(){return A(y())},q===null?void 0:function(){return A(q())}]},[y,v,x,E]);var w=s(m,T[0],T[1]);return c(function(){I.hasValue=!0,I.value=w},[w]),d(w),w},O1}var $w;function Y5(){return $w||($w=1,L1.exports=X5()),L1.exports}var Z5=Y5();const K5=OR(Z5),Jw=i=>{let e;const t=new Set,n=(m,y)=>{const v=typeof m=="function"?m(e):m;if(!Object.is(v,e)){const x=e;e=y??(typeof v!="object"||v===null)?v:Object.assign({},e,v),t.forEach(E=>E(e,x))}},s=()=>e,f={setState:n,getState:s,getInitialState:()=>d,subscribe:m=>(t.add(m),()=>t.delete(m))},d=e=i(n,s,f);return f},Q5=(i=>i?Jw(i):Jw),{useSyncExternalStoreWithSelector:$5}=K5,J5=i=>i;function e6(i,e=J5,t){const n=$5(i.subscribe,i.getState,i.getInitialState,e,t);return UR.useDebugValue(n),n}const eC=(i,e)=>{const t=Q5(i),n=(s,a=e)=>e6(t,s,a);return Object.assign(n,t),n},t6=((i,e)=>i?eC(i,e):eC);var SE=FR();const n6=OR(SE);function KM(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const s=KM(n,e,t);if(s)return s;n=e?null:n.sibling}}function LI(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const QM=LI(Ve.createContext(null));class OI extends Ve.Component{render(){return Ve.createElement(QM.Provider,{value:this._reactInternals},this.props.children)}}function UI(){const i=Ve.useContext(QM);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Ve.useId();return Ve.useMemo(()=>{for(const t of[i,i?.alternate]){if(!t)continue;const n=KM(t,!1,s=>{let a=s.memoizedState;for(;a;){if(a.memoizedState===e)return!0;a=a.next}});if(n)return n}},[i,e])}const i6=Symbol.for("react.context"),s6=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===i6;function r6(){const i=UI(),[e]=Ve.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;s6(n)&&n!==QM&&!e.has(n)&&e.set(n,Ve.use(LI(n))),t=t.return}return e}function a6(){const i=r6();return Ve.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>Ve.createElement(e,null,Ve.createElement(t.Provider,{...n,value:i.get(t)})),e=>Ve.createElement(OI,{...e})),[i])}function zI(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const FI=i=>i&&i.isOrthographicCamera,o6=i=>i&&i.hasOwnProperty("current"),l6=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),uy=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?Ve.useLayoutEffect:Ve.useEffect;function BI(i){const e=Ve.useRef(i);return uy(()=>{e.current=i},[i]),e}function c6(){const i=UI(),e=a6();return Ve.useMemo(()=>({children:t})=>{const s=!!KM(i,!0,a=>a.type===Ve.StrictMode)?Ve.StrictMode:Ve.Fragment;return W.jsx(s,{children:W.jsx(e,{children:t})})},[i,e])}function u6({set:i}){return uy(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const h6=(i=>(i=class extends Ve.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function VI(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function Lp(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const Ji={obj:i=>i===Object(i)&&!Ji.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:s=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(Ji.str(i)||Ji.num(i)||Ji.boo(i))return i===e;const a=Ji.obj(i);if(a&&n==="reference")return i===e;const c=Ji.arr(i);if(c&&t==="reference")return i===e;if((c||a)&&i===e)return!0;let f;for(f in i)if(!(f in e))return!1;if(a&&t==="shallow"&&n==="shallow"){for(f in s?e:i)if(!Ji.equ(i[f],e[f],{strict:s,objects:"reference"}))return!1}else for(f in s?e:i)if(i[f]!==e[f])return!1;if(Ji.und(f)){if(c&&i.length===0&&e.length===0||a&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function f6(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const kI=["children","key","ref"];function d6(i){const e={};for(const t in i)kI.includes(t)||(e[t]=i[t]);return e}function Qx(i,e,t,n){const s=i;let a=s?.__r3f;return a||(a={root:e,type:t,parent:null,children:[],props:d6(n),object:s,eventCount:0,handlers:{},isHidden:!1},s&&(s.__r3f=a)),a}function q0(i,e){if(!e.includes("-"))return{root:i,key:e,target:i[e]};if(e in i)return{root:i,key:e,target:i[e]};let t=i;const n=e.split("-");for(const s of n){if(typeof t!="object"||t===null){if(t!==void 0){const a=n.slice(n.indexOf(s)).join("-");return{root:t,key:a,target:void 0}}return{root:i,key:e,target:void 0}}e=s,i=t,t=t[e]}return{root:i,key:e,target:t}}const tC=/-\d+$/;function $x(i,e){if(Ji.str(e.props.attach)){if(tC.test(e.props.attach)){const s=e.props.attach.replace(tC,""),{root:a,key:c}=q0(i.object,s);Array.isArray(a[c])||(a[c]=[])}const{root:t,key:n}=q0(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Ji.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function Jx(i,e){if(Ji.str(e.props.attach)){const{root:t,key:n}=q0(i.object,e.props.attach),s=e.previousAttach;s===void 0?delete t[n]:t[n]=s}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const EE=[...kI,"args","dispose","attach","object","onUpdate","dispose"],nC=new Map;function p6(i){let e=nC.get(i.constructor);try{e||(e=new i.constructor,nC.set(i.constructor,e))}catch{}return e}function m6(i,e){const t={};for(const n in e)if(!EE.includes(n)&&!Ji.equ(e[n],i.props[n])){t[n]=e[n];for(const s in e)s.startsWith(`${n}-`)&&(t[s]=e[s])}for(const n in i.props){if(EE.includes(n)||e.hasOwnProperty(n))continue;const{root:s,key:a}=q0(i.object,n);if(s.constructor&&s.constructor.length===0){const c=p6(s);Ji.und(c)||(t[a]=c[a])}else t[a]=0}return t}const g6=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],y6=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function xh(i,e){var t;const n=i.__r3f,s=n&&zI(n).getState(),a=n?.eventCount;for(const f in e){let d=e[f];if(EE.includes(f))continue;if(n&&y6.test(f)){typeof d=="function"?n.handlers[f]=d:delete n.handlers[f],n.eventCount=Object.keys(n.handlers).length;continue}if(d===void 0)continue;let{root:m,key:y,target:v}=q0(i,f);if(v===void 0&&(typeof m!="object"||m===null))throw Error(`R3F: Cannot set "${f}". Ensure it is an object before setting "${y}".`);if(v instanceof rm&&d instanceof rm)v.mask=d.mask;else if(v instanceof wt&&l6(d))v.set(d);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof v.copy=="function"&&d!=null&&d.constructor&&v.constructor===d.constructor)v.copy(d);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&Array.isArray(d))typeof v.fromArray=="function"?v.fromArray(d):v.set(...d);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof d=="number")typeof v.setScalar=="function"?v.setScalar(d):v.set(d);else{var c;m[y]=d,s&&!s.linear&&g6.includes(y)&&(c=m[y])!=null&&c.isTexture&&m[y].format===Gr&&m[y].type===ca&&(m[y].colorSpace=kr)}}if(n!=null&&n.parent&&s!=null&&s.internal&&(t=n.object)!=null&&t.isObject3D&&a!==n.eventCount){const f=n.object,d=s.internal.interaction.indexOf(f);d>-1&&s.internal.interaction.splice(d,1),n.eventCount&&f.raycast!==null&&s.internal.interaction.push(f)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&wm(n),i}function wm(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function v6(i,e){i.manual||(FI(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const Ba=i=>i?.isObject3D;function R_(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function HI(i,e,t,n){const s=t.get(e);s&&(t.delete(e),t.size===0&&(i.delete(n),s.target.releasePointerCapture(n)))}function _6(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,s)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((n,s)=>{HI(t.capturedMap,e,n,s)})}function x6(i){function e(d){const{internal:m}=i.getState(),y=d.offsetX-m.initialClick[0],v=d.offsetY-m.initialClick[1];return Math.round(Math.sqrt(y*y+v*v))}function t(d){return d.filter(m=>["Move","Over","Enter","Out","Leave"].some(y=>{var v;return(v=m.__r3f)==null?void 0:v.handlers["onPointer"+y]}))}function n(d,m){const y=i.getState(),v=new Set,x=[],E=m?m(y.internal.interaction):y.internal.interaction;for(let A=0;A<E.length;A++){const N=Lp(E[A]);N&&(N.raycaster.camera=void 0)}y.previousRoot||y.events.compute==null||y.events.compute(d,y);function T(A){const N=Lp(A);if(!N||!N.events.enabled||N.raycaster.camera===null)return[];if(N.raycaster.camera===void 0){var O;N.events.compute==null||N.events.compute(d,N,(O=N.previousRoot)==null?void 0:O.getState()),N.raycaster.camera===void 0&&(N.raycaster.camera=null)}return N.raycaster.camera?N.raycaster.intersectObject(A,!0):[]}let I=E.flatMap(T).sort((A,N)=>{const O=Lp(A.object),U=Lp(N.object);return!O||!U?A.distance-N.distance:U.events.priority-O.events.priority||A.distance-N.distance}).filter(A=>{const N=R_(A);return v.has(N)?!1:(v.add(N),!0)});y.events.filter&&(I=y.events.filter(I,y));for(const A of I){let N=A.object;for(;N;){var w;(w=N.__r3f)!=null&&w.eventCount&&x.push({...A,eventObject:N}),N=N.parent}}if("pointerId"in d&&y.internal.capturedMap.has(d.pointerId))for(let A of y.internal.capturedMap.get(d.pointerId).values())v.has(R_(A.intersection))||x.push(A.intersection);return x}function s(d,m,y,v){if(d.length){const x={stopped:!1};for(const E of d){let T=Lp(E.object);if(T||E.object.traverseAncestors(I=>{const w=Lp(I);if(w)return T=w,!1}),T){const{raycaster:I,pointer:w,camera:A,internal:N}=T,O=new J(w.x,w.y,0).unproject(A),U=P=>{var H,B;return(H=(B=N.capturedMap.get(P))==null?void 0:B.has(E.eventObject))!=null?H:!1},q=P=>{const H={intersection:E,target:m.target};N.capturedMap.has(P)?N.capturedMap.get(P).set(E.eventObject,H):N.capturedMap.set(P,new Map([[E.eventObject,H]])),m.target.setPointerCapture(P)},j=P=>{const H=N.capturedMap.get(P);H&&HI(N.capturedMap,E.eventObject,H,P)};let F={};for(let P in m){let H=m[P];typeof H!="function"&&(F[P]=H)}let R={...E,...F,pointer:w,intersections:d,stopped:x.stopped,delta:y,unprojectedPoint:O,ray:I.ray,camera:A,stopPropagation(){const P="pointerId"in m&&N.capturedMap.get(m.pointerId);if((!P||P.has(E.eventObject))&&(R.stopped=x.stopped=!0,N.hovered.size&&Array.from(N.hovered.values()).find(H=>H.eventObject===E.eventObject))){const H=d.slice(0,d.indexOf(E));a([...H,E])}},target:{hasPointerCapture:U,setPointerCapture:q,releasePointerCapture:j},currentTarget:{hasPointerCapture:U,setPointerCapture:q,releasePointerCapture:j},nativeEvent:m};if(v(R),x.stopped===!0)break}}}return d}function a(d){const{internal:m}=i.getState();for(const y of m.hovered.values())if(!d.length||!d.find(v=>v.object===y.object&&v.index===y.index&&v.instanceId===y.instanceId)){const x=y.eventObject.__r3f;if(m.hovered.delete(R_(y)),x!=null&&x.eventCount){const E=x.handlers,T={...y,intersections:d};E.onPointerOut==null||E.onPointerOut(T),E.onPointerLeave==null||E.onPointerLeave(T)}}}function c(d,m){for(let y=0;y<m.length;y++){const v=m[y].__r3f;v==null||v.handlers.onPointerMissed==null||v.handlers.onPointerMissed(d)}}function f(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>a([]);case"onLostPointerCapture":return m=>{const{internal:y}=i.getState();"pointerId"in m&&y.capturedMap.has(m.pointerId)&&requestAnimationFrame(()=>{y.capturedMap.has(m.pointerId)&&(y.capturedMap.delete(m.pointerId),a([]))})}}return function(y){const{onPointerMissed:v,internal:x}=i.getState();x.lastEvent.current=y;const E=d==="onPointerMove",T=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",w=n(y,E?t:void 0),A=T?e(y):0;d==="onPointerDown"&&(x.initialClick=[y.offsetX,y.offsetY],x.initialHits=w.map(O=>O.eventObject)),T&&!w.length&&A<=2&&(c(y,x.interaction),v&&v(y)),E&&a(w);function N(O){const U=O.eventObject,q=U.__r3f;if(!(q!=null&&q.eventCount))return;const j=q.handlers;if(E){if(j.onPointerOver||j.onPointerEnter||j.onPointerOut||j.onPointerLeave){const F=R_(O),R=x.hovered.get(F);R?R.stopped&&O.stopPropagation():(x.hovered.set(F,O),j.onPointerOver==null||j.onPointerOver(O),j.onPointerEnter==null||j.onPointerEnter(O))}j.onPointerMove==null||j.onPointerMove(O)}else{const F=j[d];F?(!T||x.initialHits.includes(U))&&(c(y,x.interaction.filter(R=>!x.initialHits.includes(R))),F(O)):T&&x.initialHits.includes(U)&&c(y,x.interaction.filter(R=>!x.initialHits.includes(R)))}}s(w,y,A,N)}}return{handlePointer:f}}const iC=i=>!!(i!=null&&i.render),GI=Ve.createContext(null),b6=(i,e)=>{const t=t6((f,d)=>{const m=new J,y=new J,v=new J;function x(A=d().camera,N=y,O=d().size){const{width:U,height:q,top:j,left:F}=O,R=U/q;N.isVector3?v.copy(N):v.set(...N);const P=A.getWorldPosition(m).distanceTo(v);if(FI(A))return{width:U/A.zoom,height:q/A.zoom,top:j,left:F,factor:1,distance:P,aspect:R};{const H=A.fov*Math.PI/180,B=2*Math.tan(H/2)*P,X=B*(U/q);return{width:X,height:B,top:j,left:F,factor:U/X,distance:P,aspect:R}}}let E;const T=A=>f(N=>({performance:{...N.performance,current:A}})),I=new ke;return{set:f,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(A=1)=>i(d(),A),advance:(A,N)=>e(A,N,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new MI,pointer:I,mouse:I,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const A=d();E&&clearTimeout(E),A.performance.current!==A.performance.min&&T(A.performance.min),E=setTimeout(()=>T(d().performance.max),A.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:x},setEvents:A=>f(N=>({...N,events:{...N.events,...A}})),setSize:(A,N,O=0,U=0)=>{const q=d().camera,j={width:A,height:N,top:O,left:U};f(F=>({size:j,viewport:{...F.viewport,...x(q,y,j)}}))},setDpr:A=>f(N=>{const O=VI(A);return{viewport:{...N.viewport,dpr:O,initialDpr:N.viewport.initialDpr||O}}}),setFrameloop:(A="always")=>{const N=d().clock;N.stop(),N.elapsedTime=0,A!=="never"&&(N.start(),N.elapsedTime=0),f(()=>({frameloop:A}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:Ve.createRef(),active:!1,frames:0,priority:0,subscribe:(A,N,O)=>{const U=d().internal;return U.priority=U.priority+(N>0?1:0),U.subscribers.push({ref:A,priority:N,store:O}),U.subscribers=U.subscribers.sort((q,j)=>q.priority-j.priority),()=>{const q=d().internal;q!=null&&q.subscribers&&(q.priority=q.priority-(N>0?1:0),q.subscribers=q.subscribers.filter(j=>j.ref!==A))}}}}}),n=t.getState();let s=n.size,a=n.viewport.dpr,c=n.camera;return t.subscribe(()=>{const{camera:f,size:d,viewport:m,gl:y,set:v}=t.getState();if(d.width!==s.width||d.height!==s.height||m.dpr!==a){s=d,a=m.dpr,v6(f,d),m.dpr>0&&y.setPixelRatio(m.dpr);const x=typeof HTMLCanvasElement<"u"&&y.domElement instanceof HTMLCanvasElement;y.setSize(d.width,d.height,x)}f!==c&&(c=f,v(x=>({viewport:{...x.viewport,...x.viewport.getCurrentViewport(f)}})))}),t.subscribe(f=>i(f)),t};function jI(){const i=Ve.useContext(GI);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function vl(i=t=>t,e){return jI()(i,e)}function hy(i,e=0){const t=jI(),n=t.getState().internal.subscribe,s=BI(i);return uy(()=>n(s,e,t),[e,n,t]),null}const S6=1,E6=8,M6=32,T6=2;var A6={version:"9.5.0"};function w6(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var sC={exports:{}},rC={exports:{}},aC;function C6(){return aC||(aC=1,(function(i){i.exports=function(e){function t(l,u,g,b){return new Wm(l,u,g,b)}function n(){}function s(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)u+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(l){var u=l,g=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(g=u.return),l=u.return;while(l)}return u.tag===3?g:null}function c(l){if(a(l)!==l)throw Error(s(188))}function f(l){var u=l.alternate;if(!u){if(u=a(l),u===null)throw Error(s(188));return u!==l?null:l}for(var g=l,b=u;;){var C=g.return;if(C===null)break;var D=C.alternate;if(D===null){if(b=C.return,b!==null){g=b;continue}break}if(C.child===D.child){for(D=C.child;D;){if(D===g)return c(C),l;if(D===b)return c(C),u;D=D.sibling}throw Error(s(188))}if(g.return!==b.return)g=C,b=D;else{for(var Y=!1,ae=C.child;ae;){if(ae===g){Y=!0,g=C,b=D;break}if(ae===b){Y=!0,b=C,g=D;break}ae=ae.sibling}if(!Y){for(ae=D.child;ae;){if(ae===g){Y=!0,g=D,b=C;break}if(ae===b){Y=!0,b=D,g=C;break}ae=ae.sibling}if(!Y)throw Error(s(189))}}if(g.alternate!==b)throw Error(s(190))}if(g.tag!==3)throw Error(s(188));return g.stateNode.current===g?l:u}function d(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(u=d(l),u!==null)return u;l=l.sibling}return null}function m(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(l.tag!==4&&(u=m(l),u!==null))return u;l=l.sibling}return null}function y(l){return l===null||typeof l!="object"?null:(l=rl&&l[rl]||l["@@iterator"],typeof l=="function"?l:null)}function v(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===jl?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case Hc:return"Fragment";case jc:return"Profiler";case Gc:return"StrictMode";case Od:return"Suspense";case sl:return"SuspenseList";case uf:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case kc:return"Portal";case Ta:return l.displayName||"Context";case cf:return(l._context.displayName||"Context")+".Consumer";case Gu:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case Ud:return u=l.displayName||null,u!==null?u:v(l.type)||"Memo";case cr:u=l._payload,l=l._init;try{return v(l(u))}catch{}}return null}function x(l){return{current:l}}function E(l){0>Zc||(l.current=Zd[Zc],Zd[Zc]=null,Zc--)}function T(l,u){Zc++,Zd[Zc]=l.current,l.current=u}function I(l){return l>>>=0,l===0?32:31-(Kd(l)/gv|0)|0}function w(l){var u=l&42;if(u!==0)return u;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function A(l,u,g){var b=l.pendingLanes;if(b===0)return 0;var C=0,D=l.suspendedLanes,Y=l.pingedLanes;l=l.warmLanes;var ae=b&134217727;return ae!==0?(b=ae&~D,b!==0?C=w(b):(Y&=ae,Y!==0?C=w(Y):g||(g=ae&~l,g!==0&&(C=w(g))))):(ae=b&~D,ae!==0?C=w(ae):Y!==0?C=w(Y):g||(g=b&~l,g!==0&&(C=w(g)))),C===0?0:u!==0&&u!==C&&(u&D)===0&&(D=C&-C,g=u&-u,D>=g||D===32&&(g&4194048)!==0)?u:C}function N(l,u){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&u)===0}function O(l,u){switch(l){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U(){var l=Ku;return Ku<<=1,(Ku&62914560)===0&&(Ku=4194304),l}function q(l){for(var u=[],g=0;31>g;g++)u.push(l);return u}function j(l,u){l.pendingLanes|=u,u!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function F(l,u,g,b,C,D){var Y=l.pendingLanes;l.pendingLanes=g,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=g,l.entangledLanes&=g,l.errorRecoveryDisabledLanes&=g,l.shellSuspendCounter=0;var ae=l.entanglements,De=l.expirationTimes,Ke=l.hiddenUpdates;for(g=Y&~g;0<g;){var ft=31-Dr(g),et=1<<ft;ae[ft]=0,De[ft]=-1;var At=Ke[ft];if(At!==null)for(Ke[ft]=null,ft=0;ft<At.length;ft++){var dn=At[ft];dn!==null&&(dn.lane&=-536870913)}g&=~et}b!==0&&R(l,b,0),D!==0&&C===0&&l.tag!==0&&(l.suspendedLanes|=D&~(Y&~u))}function R(l,u,g){l.pendingLanes|=u,l.suspendedLanes&=~u;var b=31-Dr(u);l.entangledLanes|=u,l.entanglements[b]=l.entanglements[b]|1073741824|g&261930}function P(l,u){var g=l.entangledLanes|=u;for(l=l.entanglements;g;){var b=31-Dr(g),C=1<<b;C&u|l[b]&u&&(l[b]|=u),g&=~C}}function H(l,u){var g=u&-u;return g=(g&42)!==0?1:B(g),(g&(l.suspendedLanes|u))!==0?0:g}function B(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function X(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function k(l){if(typeof Ig=="function"&&_v(l),Nr&&typeof Nr.setStrictMode=="function")try{Nr.setStrictMode(Qc,l)}catch{}}function ue(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}function he(l){if(np===void 0)try{throw Error()}catch(g){var u=g.stack.trim().match(/\n( *(at )?)/);np=u&&u[1]||"",No=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+np+l+No}function ee(l,u){if(!l||_f)return"";_f=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(u){var et=function(){throw Error()};if(Object.defineProperty(et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(et,[])}catch(dn){var At=dn}Reflect.construct(l,[],et)}else{try{et.call()}catch(dn){At=dn}l.call(et.prototype)}}else{try{throw Error()}catch(dn){At=dn}(et=l())&&typeof et.catch=="function"&&et.catch(function(){})}}catch(dn){if(dn&&At&&typeof dn.stack=="string")return[dn.stack,At.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=b.DetermineComponentFrameRoot(),Y=D[0],ae=D[1];if(Y&&ae){var De=Y.split(`
`),Ke=ae.split(`
`);for(C=b=0;b<De.length&&!De[b].includes("DetermineComponentFrameRoot");)b++;for(;C<Ke.length&&!Ke[C].includes("DetermineComponentFrameRoot");)C++;if(b===De.length||C===Ke.length)for(b=De.length-1,C=Ke.length-1;1<=b&&0<=C&&De[b]!==Ke[C];)C--;for(;1<=b&&0<=C;b--,C--)if(De[b]!==Ke[C]){if(b!==1||C!==1)do if(b--,C--,0>C||De[b]!==Ke[C]){var ft=`
`+De[b].replace(" at new "," at ");return l.displayName&&ft.includes("<anonymous>")&&(ft=ft.replace("<anonymous>",l.displayName)),ft}while(1<=b&&0<=C);break}}}finally{_f=!1,Error.prepareStackTrace=g}return(g=l?l.displayName||l.name:"")?he(g):""}function ie(l,u){switch(l.tag){case 26:case 27:case 5:return he(l.type);case 16:return he("Lazy");case 13:return l.child!==u&&u!==null?he("Suspense Fallback"):he("Suspense");case 19:return he("SuspenseList");case 0:case 15:return ee(l.type,!1);case 11:return ee(l.type.render,!1);case 1:return ee(l.type,!0);case 31:return he("Activity");default:return""}}function ye(l){try{var u="",g=null;do u+=ie(l,g),g=l,l=l.return;while(l);return u}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}function be(l,u){if(typeof l=="object"&&l!==null){var g=Dg.get(l);return g!==void 0?g:(u={value:l,source:u,stack:ye(u)},Dg.set(l,u),u)}return{value:l,source:u,stack:ye(u)}}function Be(l,u){ll[Po++]=xf,ll[Po++]=ui,ui=l,xf=u}function Oe(l,u,g){Ca[na++]=Os,Ca[na++]=eo,Ca[na++]=Ra,Ra=l;var b=Os;l=eo;var C=32-Dr(b)-1;b&=~(1<<C),g+=1;var D=32-Dr(u)+C;if(30<D){var Y=C-C%5;D=(b&(1<<Y)-1).toString(32),b>>=Y,C-=Y,Os=1<<32-Dr(u)+C|g<<C|b,eo=D+l}else Os=1<<D|g<<C|b,eo=l}function Pe(l){l.return!==null&&(Be(l,1),Oe(l,1,0))}function $e(l){for(;l===ui;)ui=ll[--Po],ll[Po]=null,xf=ll[--Po],ll[Po]=null;for(;l===Ra;)Ra=Ca[--na],Ca[na]=null,eo=Ca[--na],Ca[na]=null,Os=Ca[--na],Ca[na]=null}function Mt(l,u){Ca[na++]=Os,Ca[na++]=eo,Ca[na++]=Ra,Os=u.id,eo=u.overflow,Ra=l}function Yt(l,u){T(Us,u),T(cl,l),T(ws,null),l=Ny(u),E(ws),T(ws,l)}function Ie(){E(ws),E(cl),E(Us)}function tt(l){l.memoizedState!==null&&T(bf,l);var u=ws.current,g=qu(u,l.type);u!==g&&(T(cl,l),T(ws,g))}function nt(l){cl.current===l&&(E(ws),E(cl)),bf.current===l&&(E(bf),Xi?Xc._currentValue=qc:Xc._currentValue2=qc)}function Tt(l){var u=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ye(be(u,l)),ip}function Lt(l,u){if(!wi)throw Error(s(175));sv(l.stateNode,l.type,l.memoizedProps,u,l)||Tt(l,!0)}function Ht(l){for(hs=l.return;hs;)switch(hs.tag){case 5:case 31:case 13:hr=!1;return;case 27:case 3:hr=!0;return;default:hs=hs.return}}function un(l){if(!wi||l!==hs)return!1;if(!Nn)return Ht(l),Nn=!0,!1;var u=l.tag;if(us?u!==3&&u!==27&&(u!==5||Zu(l.type)&&!ur(l.type,l.memoizedProps))&&Ci&&Tt(l):u!==3&&(u!==5||Zu(l.type)&&!ur(l.type,l.memoizedProps))&&Ci&&Tt(l),Ht(l),u===13){if(!wi)throw Error(s(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));Ci=_g(l)}else if(u===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(317));Ci=av(l)}else Ci=us&&u===27?Ky(l.type,Ci):hs?Zy(l.stateNode):null;return!0}function zt(){wi&&(Ci=hs=null,Nn=!1)}function Ue(){var l=Lo;return l!==null&&(Or===null?Or=l:Or.push.apply(Or,l),Lo=null),l}function Ye(l){Lo===null?Lo=[l]:Lo.push(l)}function ze(l,u,g){Xi?(T(Ia,u._currentValue),u._currentValue=g):(T(Ia,u._currentValue2),u._currentValue2=g)}function ot(l){var u=Ia.current;Xi?l._currentValue=u:l._currentValue2=u,E(Ia)}function te(l,u,g){for(;l!==null;){var b=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,b!==null&&(b.childLanes|=u)):b!==null&&(b.childLanes&u)!==u&&(b.childLanes|=u),l===g)break;l=l.return}}function yt(l,u,g,b){var C=l.child;for(C!==null&&(C.return=l);C!==null;){var D=C.dependencies;if(D!==null){var Y=C.child;D=D.firstContext;e:for(;D!==null;){var ae=D;D=C;for(var De=0;De<u.length;De++)if(ae.context===u[De]){D.lanes|=g,ae=D.alternate,ae!==null&&(ae.lanes|=g),te(D.return,g,l),b||(Y=null);break e}D=ae.next}}else if(C.tag===18){if(Y=C.return,Y===null)throw Error(s(341));Y.lanes|=g,D=Y.alternate,D!==null&&(D.lanes|=g),te(Y,g,l),Y=null}else Y=C.child;if(Y!==null)Y.return=C;else for(Y=C;Y!==null;){if(Y===l){Y=null;break}if(C=Y.sibling,C!==null){C.return=Y.return,Y=C;break}Y=Y.return}C=Y}}function it(l,u,g,b){l=null;for(var C=u,D=!1;C!==null;){if(!D){if((C.flags&524288)!==0)D=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var Y=C.alternate;if(Y===null)throw Error(s(387));if(Y=Y.memoizedProps,Y!==null){var ae=C.type;Zi(C.pendingProps.value,Y.value)||(l!==null?l.push(ae):l=[ae])}}else if(C===bf.current){if(Y=C.alternate,Y===null)throw Error(s(387));Y.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(l!==null?l.push(Xc):l=[Xc])}C=C.return}l!==null&&yt(u,l,g,b),u.flags|=262144}function Rt(l){for(l=l.firstContext;l!==null;){var u=l.context;if(!Zi(Xi?u._currentValue:u._currentValue2,l.memoizedValue))return!0;l=l.next}return!1}function st(l){mi=l,to=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Q(l){return oe(mi,l)}function G(l,u){return mi===null&&st(l),oe(l,u)}function oe(l,u){var g=Xi?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:g,next:null},to===null){if(l===null)throw Error(s(308));to=u,l.dependencies={lanes:0,firstContext:u},l.flags|=524288}else to=to.next=u;return g}function Ae(){return{controller:new xv,data:new Map,refCount:0}}function Fe(l){l.refCount--,l.refCount===0&&Cs(mS,function(){l.controller.abort()})}function we(){}function vt(l){l!==ri&&l.next===null&&(ri===null?Sf=ri=l:ri=ri.next=l),Da=!0,Ks||(Ks=!0,ne())}function rt(l,u){if(!sp&&Da){sp=!0;do for(var g=!1,b=Sf;b!==null;){if(l!==0){var C=b.pendingLanes;if(C===0)var D=0;else{var Y=b.suspendedLanes,ae=b.pingedLanes;D=(1<<31-Dr(42|l)+1)-1,D&=C&~(Y&~ae),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(g=!0,_t(b,D))}else D=Pn,D=A(b,b===Mn?D:0,b.cancelPendingCommit!==null||b.timeoutHandle!==Ir),(D&3)===0||N(b,D)||(g=!0,_t(b,D));b=b.next}while(g);sp=!1}}function It(){Ft()}function Ft(){Da=Ks=!1;var l=0;Zl!==0&&Wc()&&(l=Zl);for(var u=Zs(),g=null,b=Sf;b!==null;){var C=b.next,D=We(b,u);D===0?(b.next=null,g===null?Sf=C:g.next=C,C===null&&(ri=g)):(g=b,(l!==0||(D&3)!==0)&&(Da=!0)),b=C}as!==0&&as!==5||rt(l),Zl!==0&&(Zl=0)}function We(l,u){for(var g=l.suspendedLanes,b=l.pingedLanes,C=l.expirationTimes,D=l.pendingLanes&-62914561;0<D;){var Y=31-Dr(D),ae=1<<Y,De=C[Y];De===-1?((ae&g)===0||(ae&b)!==0)&&(C[Y]=O(ae,u)):De<=u&&(l.expiredLanes|=ae),D&=~ae}if(u=Mn,g=Pn,g=A(l,l===u?g:0,l.cancelPendingCommit!==null||l.timeoutHandle!==Ir),b=l.callbackNode,g===0||l===u&&(oi===2||oi===9)||l.cancelPendingCommit!==null)return b!==null&&b!==null&&$d(b),l.callbackNode=null,l.callbackPriority=0;if((g&3)===0||N(l,g)){if(u=g&-g,u===l.callbackPriority)return u;switch(b!==null&&$d(b),X(g)){case 2:case 8:g=vv;break;case 32:g=vf;break;case 268435456:g=ep;break;default:g=vf}return b=Xe.bind(null,l),g=yf(g,b),l.callbackPriority=u,l.callbackNode=g,u}return b!==null&&b!==null&&$d(b),l.callbackPriority=2,l.callbackNode=null,2}function Xe(l,u){if(as!==0&&as!==5)return l.callbackNode=null,l.callbackPriority=0,null;var g=l.callbackNode;if(Ro()&&l.callbackNode!==g)return null;var b=Pn;return b=A(l,l===Mn?b:0,l.cancelPendingCommit!==null||l.timeoutHandle!==Ir),b===0?null:(Ja(l,b,u),We(l,Zs()),l.callbackNode!=null&&l.callbackNode===g?Xe.bind(null,l):null)}function _t(l,u){if(Ro())return null;Ja(l,u,!0)}function ne(){ig?sg(function(){(Rn&6)!==0?yf(Jd,It):Ft()}):yf(Jd,It)}function xe(){if(Zl===0){var l=ul;l===0&&(l=Qd,Qd<<=1,(Qd&261888)===0&&(Qd=256)),Zl=l}return Zl}function at(l,u){if(Qu===null){var g=Qu=[];Ng=0,ul=xe(),fs={status:"pending",value:void 0,then:function(b){g.push(b)}}}return Ng++,u.then(se,se),u}function se(){if(--Ng===0&&Qu!==null){fs!==null&&(fs.status="fulfilled");var l=Qu;Qu=null,ul=0,fs=null;for(var u=0;u<l.length;u++)(0,l[u])()}}function je(l,u){var g=[],b={status:"pending",value:null,reason:null,then:function(C){g.push(C)}};return l.then(function(){b.status="fulfilled",b.value=u;for(var C=0;C<g.length;C++)(0,g[C])(u)},function(C){for(b.status="rejected",b.reason=C,C=0;C<g.length;C++)(0,g[C])(void 0)}),b}function Ze(){var l=Kl.current;return l!==null?l:Mn.pooledCache}function Je(l,u){u===null?T(Kl,Kl.current):T(Kl,u.pool)}function Qe(){var l=Ze();return l===null?null:{parent:Xi?Ri._currentValue:Ri._currentValue2,pool:l}}function Ce(l,u){if(Zi(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var g=Object.keys(l),b=Object.keys(u);if(g.length!==b.length)return!1;for(b=0;b<g.length;b++){var C=g[b];if(!pS.call(u,C)||!Zi(l[C],u[C]))return!1}return!0}function dt(l){return l=l.status,l==="fulfilled"||l==="rejected"}function Bt(l,u,g){switch(g=l[g],g===void 0?l.push(u):g!==u&&(u.then(we,we),u=g),u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,Si(l),l;default:if(typeof u.status=="string")u.then(we,we);else{if(l=Mn,l!==null&&100<l.shellSuspendCounter)throw Error(s(482));l=u,l.status="pending",l.then(function(b){if(u.status==="pending"){var C=u;C.status="fulfilled",C.value=b}},function(b){if(u.status==="pending"){var C=u;C.status="rejected",C.reason=b}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,Si(l),l}throw fr=u,ds}}function hn(l){try{var u=l._init;return u(l._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(fr=g,ds):g}}function nn(){if(fr===null)throw Error(s(459));var l=fr;return fr=null,l}function Si(l){if(l===ds||l===Pa)throw Error(s(483))}function Gi(l){var u=$c;return $c+=1,Ql===null&&(Ql=[]),Bt(Ql,l,u)}function Er(l,u){u=u.props.ref,l.ref=u!==void 0?u:null}function pa(l,u){throw u.$$typeof===Vc?Error(s(525)):(l=Object.prototype.toString.call(u),Error(s(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l)))}function Tl(l){function u(Ee,pe){if(l){var Re=Ee.deletions;Re===null?(Ee.deletions=[pe],Ee.flags|=16):Re.push(pe)}}function g(Ee,pe){if(!l)return null;for(;pe!==null;)u(Ee,pe),pe=pe.sibling;return null}function b(Ee){for(var pe=new Map;Ee!==null;)Ee.key!==null?pe.set(Ee.key,Ee):pe.set(Ee.index,Ee),Ee=Ee.sibling;return pe}function C(Ee,pe){return Ee=ea(Ee,pe),Ee.index=0,Ee.sibling=null,Ee}function D(Ee,pe,Re){return Ee.index=Re,l?(Re=Ee.alternate,Re!==null?(Re=Re.index,Re<pe?(Ee.flags|=67108866,pe):Re):(Ee.flags|=67108866,pe)):(Ee.flags|=1048576,pe)}function Y(Ee){return l&&Ee.alternate===null&&(Ee.flags|=67108866),Ee}function ae(Ee,pe,Re,ut){return pe===null||pe.tag!==6?(pe=qm(Re,Ee.mode,ut),pe.return=Ee,pe):(pe=C(pe,Re),pe.return=Ee,pe)}function De(Ee,pe,Re,ut){var Zt=Re.type;return Zt===Hc?ft(Ee,pe,Re.props.children,ut,Re.key):pe!==null&&(pe.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===cr&&hn(Zt)===pe.type)?(pe=C(pe,Re.props),Er(pe,Re),pe.return=Ee,pe):(pe=il(Re.type,Re.key,Re.props,null,Ee.mode,ut),Er(pe,Re),pe.return=Ee,pe)}function Ke(Ee,pe,Re,ut){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==Re.containerInfo||pe.stateNode.implementation!==Re.implementation?(pe=Ym(Re,Ee.mode,ut),pe.return=Ee,pe):(pe=C(pe,Re.children||[]),pe.return=Ee,pe)}function ft(Ee,pe,Re,ut,Zt){return pe===null||pe.tag!==7?(pe=Ma(Re,Ee.mode,ut,Zt),pe.return=Ee,pe):(pe=C(pe,Re),pe.return=Ee,pe)}function et(Ee,pe,Re){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return pe=qm(""+pe,Ee.mode,Re),pe.return=Ee,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case Io:return Re=il(pe.type,pe.key,pe.props,null,Ee.mode,Re),Er(Re,pe),Re.return=Ee,Re;case kc:return pe=Ym(pe,Ee.mode,Re),pe.return=Ee,pe;case cr:return pe=hn(pe),et(Ee,pe,Re)}if(Wl(pe)||y(pe))return pe=Ma(pe,Ee.mode,Re,null),pe.return=Ee,pe;if(typeof pe.then=="function")return et(Ee,Gi(pe),Re);if(pe.$$typeof===Ta)return et(Ee,G(Ee,pe),Re);pa(Ee,pe)}return null}function At(Ee,pe,Re,ut){var Zt=pe!==null?pe.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Zt!==null?null:ae(Ee,pe,""+Re,ut);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case Io:return Re.key===Zt?De(Ee,pe,Re,ut):null;case kc:return Re.key===Zt?Ke(Ee,pe,Re,ut):null;case cr:return Re=hn(Re),At(Ee,pe,Re,ut)}if(Wl(Re)||y(Re))return Zt!==null?null:ft(Ee,pe,Re,ut,null);if(typeof Re.then=="function")return At(Ee,pe,Gi(Re),ut);if(Re.$$typeof===Ta)return At(Ee,pe,G(Ee,Re),ut);pa(Ee,Re)}return null}function dn(Ee,pe,Re,ut,Zt){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Ee=Ee.get(Re)||null,ae(pe,Ee,""+ut,Zt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case Io:return Ee=Ee.get(ut.key===null?Re:ut.key)||null,De(pe,Ee,ut,Zt);case kc:return Ee=Ee.get(ut.key===null?Re:ut.key)||null,Ke(pe,Ee,ut,Zt);case cr:return ut=hn(ut),dn(Ee,pe,Re,ut,Zt)}if(Wl(ut)||y(ut))return Ee=Ee.get(Re)||null,ft(pe,Ee,ut,Zt,null);if(typeof ut.then=="function")return dn(Ee,pe,Re,Gi(ut),Zt);if(ut.$$typeof===Ta)return dn(Ee,pe,Re,G(pe,ut),Zt);pa(pe,ut)}return null}function $i(Ee,pe,Re,ut){for(var Zt=null,Ui=null,$t=pe,kn=pe=0,Rs=null;$t!==null&&kn<Re.length;kn++){$t.index>kn?(Rs=$t,$t=null):Rs=$t.sibling;var Xn=At(Ee,$t,Re[kn],ut);if(Xn===null){$t===null&&($t=Rs);break}l&&$t&&Xn.alternate===null&&u(Ee,$t),pe=D(Xn,pe,kn),Ui===null?Zt=Xn:Ui.sibling=Xn,Ui=Xn,$t=Rs}if(kn===Re.length)return g(Ee,$t),Nn&&Be(Ee,kn),Zt;if($t===null){for(;kn<Re.length;kn++)$t=et(Ee,Re[kn],ut),$t!==null&&(pe=D($t,pe,kn),Ui===null?Zt=$t:Ui.sibling=$t,Ui=$t);return Nn&&Be(Ee,kn),Zt}for($t=b($t);kn<Re.length;kn++)Rs=dn($t,Ee,kn,Re[kn],ut),Rs!==null&&(l&&Rs.alternate!==null&&$t.delete(Rs.key===null?kn:Rs.key),pe=D(Rs,pe,kn),Ui===null?Zt=Rs:Ui.sibling=Rs,Ui=Rs);return l&&$t.forEach(function(Ua){return u(Ee,Ua)}),Nn&&Be(Ee,kn),Zt}function rh(Ee,pe,Re,ut){if(Re==null)throw Error(s(151));for(var Zt=null,Ui=null,$t=pe,kn=pe=0,Rs=null,Xn=Re.next();$t!==null&&!Xn.done;kn++,Xn=Re.next()){$t.index>kn?(Rs=$t,$t=null):Rs=$t.sibling;var Ua=At(Ee,$t,Xn.value,ut);if(Ua===null){$t===null&&($t=Rs);break}l&&$t&&Ua.alternate===null&&u(Ee,$t),pe=D(Ua,pe,kn),Ui===null?Zt=Ua:Ui.sibling=Ua,Ui=Ua,$t=Rs}if(Xn.done)return g(Ee,$t),Nn&&Be(Ee,kn),Zt;if($t===null){for(;!Xn.done;kn++,Xn=Re.next())Xn=et(Ee,Xn.value,ut),Xn!==null&&(pe=D(Xn,pe,kn),Ui===null?Zt=Xn:Ui.sibling=Xn,Ui=Xn);return Nn&&Be(Ee,kn),Zt}for($t=b($t);!Xn.done;kn++,Xn=Re.next())Xn=dn($t,Ee,kn,Xn.value,ut),Xn!==null&&(l&&Xn.alternate!==null&&$t.delete(Xn.key===null?kn:Xn.key),pe=D(Xn,pe,kn),Ui===null?Zt=Xn:Ui.sibling=Xn,Ui=Xn);return l&&$t.forEach(function(gS){return u(Ee,gS)}),Nn&&Be(Ee,kn),Zt}function rc(Ee,pe,Re,ut){if(typeof Re=="object"&&Re!==null&&Re.type===Hc&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case Io:e:{for(var Zt=Re.key;pe!==null;){if(pe.key===Zt){if(Zt=Re.type,Zt===Hc){if(pe.tag===7){g(Ee,pe.sibling),ut=C(pe,Re.props.children),ut.return=Ee,Ee=ut;break e}}else if(pe.elementType===Zt||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===cr&&hn(Zt)===pe.type){g(Ee,pe.sibling),ut=C(pe,Re.props),Er(ut,Re),ut.return=Ee,Ee=ut;break e}g(Ee,pe);break}else u(Ee,pe);pe=pe.sibling}Re.type===Hc?(ut=Ma(Re.props.children,Ee.mode,ut,Re.key),ut.return=Ee,Ee=ut):(ut=il(Re.type,Re.key,Re.props,null,Ee.mode,ut),Er(ut,Re),ut.return=Ee,Ee=ut)}return Y(Ee);case kc:e:{for(Zt=Re.key;pe!==null;){if(pe.key===Zt)if(pe.tag===4&&pe.stateNode.containerInfo===Re.containerInfo&&pe.stateNode.implementation===Re.implementation){g(Ee,pe.sibling),ut=C(pe,Re.children||[]),ut.return=Ee,Ee=ut;break e}else{g(Ee,pe);break}else u(Ee,pe);pe=pe.sibling}ut=Ym(Re,Ee.mode,ut),ut.return=Ee,Ee=ut}return Y(Ee);case cr:return Re=hn(Re),rc(Ee,pe,Re,ut)}if(Wl(Re))return $i(Ee,pe,Re,ut);if(y(Re)){if(Zt=y(Re),typeof Zt!="function")throw Error(s(150));return Re=Zt.call(Re),rh(Ee,pe,Re,ut)}if(typeof Re.then=="function")return rc(Ee,pe,Gi(Re),ut);if(Re.$$typeof===Ta)return rc(Ee,pe,G(Ee,Re),ut);pa(Ee,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint"?(Re=""+Re,pe!==null&&pe.tag===6?(g(Ee,pe.sibling),ut=C(pe,Re),ut.return=Ee,Ee=ut):(g(Ee,pe),ut=qm(Re,Ee.mode,ut),ut.return=Ee,Ee=ut),Y(Ee)):g(Ee,pe)}return function(Ee,pe,Re,ut){try{$c=0;var Zt=rc(Ee,pe,Re,ut);return Ql=null,Zt}catch($t){if($t===ds||$t===Pa)throw $t;var Ui=t(29,$t,null,Ee.mode);return Ui.lanes=ut,Ui.return=Ee,Ui}}}function qr(){for(var l=Uo,u=Jc=Uo=0;u<l;){var g=Fs[u];Fs[u++]=null;var b=Fs[u];Fs[u++]=null;var C=Fs[u];Fs[u++]=null;var D=Fs[u];if(Fs[u++]=null,b!==null&&C!==null){var Y=b.pending;Y===null?C.next=C:(C.next=Y.next,Y.next=C),b.pending=C}D!==0&&tr(g,C,D)}}function er(l,u,g,b){Fs[Uo++]=l,Fs[Uo++]=u,Fs[Uo++]=g,Fs[Uo++]=b,Jc|=b,l.lanes|=b,l=l.alternate,l!==null&&(l.lanes|=b)}function Mr(l,u,g,b){return er(l,u,g,b),fi(l)}function ji(l,u){return er(l,null,null,u),fi(l)}function tr(l,u,g){l.lanes|=g;var b=l.alternate;b!==null&&(b.lanes|=g);for(var C=!1,D=l.return;D!==null;)D.childLanes|=g,b=D.alternate,b!==null&&(b.childLanes|=g),D.tag===22&&(l=D.stateNode,l===null||l._visibility&1||(C=!0)),l=D,D=D.return;return l.tag===3?(D=l.stateNode,C&&u!==null&&(C=31-Dr(g),l=D.hiddenUpdates,b=l[C],b===null?l[C]=[u]:b.push(u),u.lane=g|536870912),D):null}function fi(l){if(50<jn)throw jn=0,Cf=null,Error(s(185));for(var u=l.return;u!==null;)l=u,u=l.return;return l.tag===3?l.stateNode:null}function _i(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nr(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function bs(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function Xr(l,u,g){var b=l.updateQueue;if(b===null)return null;if(b=b.shared,(Rn&2)!==0){var C=b.pending;return C===null?u.next=u:(u.next=C.next,C.next=u),b.pending=u,u=fi(l),tr(l,null,g),u}return er(l,b,u,g),fi(l)}function Wa(l,u,g){if(u=u.updateQueue,u!==null&&(u=u.shared,(g&4194048)!==0)){var b=u.lanes;b&=l.pendingLanes,g|=b,u.lanes=g,P(l,g)}}function Al(l,u){var g=l.updateQueue,b=l.alternate;if(b!==null&&(b=b.updateQueue,g===b)){var C=null,D=null;if(g=g.firstBaseUpdate,g!==null){do{var Y={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};D===null?C=D=Y:D=D.next=Y,g=g.next}while(g!==null);D===null?C=D=u:D=D.next=u}else C=D=u;g={baseState:b.baseState,firstBaseUpdate:C,lastBaseUpdate:D,shared:b.shared,callbacks:b.callbacks},l.updateQueue=g;return}l=g.lastBaseUpdate,l===null?g.firstBaseUpdate=u:l.next=u,g.lastBaseUpdate=u}function Ws(){if(ap){var l=fs;if(l!==null)throw l}}function ma(l,u,g,b){ap=!1;var C=l.updateQueue;ia=!1;var D=C.firstBaseUpdate,Y=C.lastBaseUpdate,ae=C.shared.pending;if(ae!==null){C.shared.pending=null;var De=ae,Ke=De.next;De.next=null,Y===null?D=Ke:Y.next=Ke,Y=De;var ft=l.alternate;ft!==null&&(ft=ft.updateQueue,ae=ft.lastBaseUpdate,ae!==Y&&(ae===null?ft.firstBaseUpdate=Ke:ae.next=Ke,ft.lastBaseUpdate=De))}if(D!==null){var et=C.baseState;Y=0,ft=Ke=De=null,ae=D;do{var At=ae.lane&-536870913,dn=At!==ae.lane;if(dn?(Pn&At)===At:(b&At)===At){At!==0&&At===ul&&(ap=!0),ft!==null&&(ft=ft.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var $i=l,rh=ae;At=u;var rc=g;switch(rh.tag){case 1:if($i=rh.payload,typeof $i=="function"){et=$i.call(rc,et,At);break e}et=$i;break e;case 3:$i.flags=$i.flags&-65537|128;case 0:if($i=rh.payload,At=typeof $i=="function"?$i.call(rc,et,At):$i,At==null)break e;et=Ld({},et,At);break e;case 2:ia=!0}}At=ae.callback,At!==null&&(l.flags|=64,dn&&(l.flags|=8192),dn=C.callbacks,dn===null?C.callbacks=[At]:dn.push(At))}else dn={lane:At,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},ft===null?(Ke=ft=dn,De=et):ft=ft.next=dn,Y|=At;if(ae=ae.next,ae===null){if(ae=C.shared.pending,ae===null)break;dn=ae,ae=dn.next,dn.next=null,C.lastBaseUpdate=dn,C.shared.pending=null}}while(!0);ft===null&&(De=et),C.baseState=De,C.firstBaseUpdate=Ke,C.lastBaseUpdate=ft,D===null&&(C.shared.lanes=0),fl|=Y,l.lanes=Y,l.memoizedState=et}}function Yr(l,u){if(typeof l!="function")throw Error(s(191,l));l.call(u)}function ir(l,u){var g=l.callbacks;if(g!==null)for(l.callbacks=null,l=0;l<g.length;l++)Yr(g[l],u)}function qs(l,u){l=Fo,T($l,l),T(eu,u),Fo=l|u.baseLanes}function Z(){T($l,Fo),T(eu,eu.current)}function le(){Fo=$l.current,E(eu),E($l)}function Se(l){var u=l.alternate;T(Vi,Vi.current&1),T(Pr,l),Lr===null&&(u===null||eu.current!==null||u.memoizedState!==null)&&(Lr=l)}function ge(l){T(Vi,Vi.current),T(Pr,l),Lr===null&&(Lr=l)}function me(l){l.tag===22?(T(Vi,Vi.current),T(Pr,l),Lr===null&&(Lr=l)):lt()}function lt(){T(Vi,Vi.current),T(Pr,Pr.current)}function pt(l){E(Pr),Lr===l&&(Lr=null),E(Vi)}function gt(l){for(var u=l;u!==null;){if(u.tag===13){var g=u.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||Xl(g)||Hd(g)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function ht(){throw Error(s(321))}function Pt(l,u){if(u===null)return!1;for(var g=0;g<u.length&&g<l.length;g++)if(!Zi(l[g],u[g]))return!1;return!0}function Kt(l,u,g,b,C,D){return hl=D,mn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Wt.H=l===null||l.memoizedState===null?Pi:zo,Fn=!1,D=g(b,C),Fn=!1,_n&&(D=bt(u,g,b,C)),jt(l),D}function jt(l){Wt.H=sa;var u=kt!==null&&kt.next!==null;if(hl=0,ln=kt=mn=null,En=!1,La=0,no=null,u)throw Error(s(300));l===null||bi||(l=l.dependencies,l!==null&&Rt(l)&&(bi=!0))}function bt(l,u,g,b){mn=l;var C=0;do{if(_n&&(no=null),La=0,_n=!1,25<=C)throw Error(s(301));if(C+=1,ln=kt=null,l.updateQueue!=null){var D=l.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Wt.H=Jl,D=u(g,b)}while(_n);return D}function sn(){var l=Wt.H,u=l.useState()[0];return u=typeof u.then=="function"?Qt(u):u,l=l.useState()[0],(kt!==null?kt.memoizedState:null)!==l&&(mn.flags|=1024),u}function qn(){var l=Qs!==0;return Qs=0,l}function ti(l,u,g){u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~g}function Ut(l){if(En){for(l=l.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}En=!1}hl=0,ln=kt=mn=null,_n=!1,La=Qs=0,no=null}function Cn(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?mn.memoizedState=ln=l:ln=ln.next=l,ln}function ct(){if(kt===null){var l=mn.alternate;l=l!==null?l.memoizedState:null}else l=kt.next;var u=ln===null?mn.memoizedState:ln.next;if(u!==null)ln=u,kt=l;else{if(l===null)throw mn.alternate===null?Error(s(467)):Error(s(310));kt=l,l={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},ln===null?mn.memoizedState=ln=l:ln=ln.next=l}return ln}function Ei(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qt(l){var u=La;return La+=1,no===null&&(no=[]),l=Bt(no,l,u),u=mn,(ln===null?u.memoizedState:ln.next)===null&&(u=u.alternate,Wt.H=u===null||u.memoizedState===null?Pi:zo),l}function Wi(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Qt(l);if(l.$$typeof===Ta)return Q(l)}throw Error(s(438,String(l)))}function Ls(l){var u=null,g=mn.updateQueue;if(g!==null&&(u=g.memoCache),u==null){var b=mn.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(u={data:b.data.map(function(C){return C.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),g===null&&(g=Ei(),mn.updateQueue=g),g.memoCache=u,g=u.data[u.index],g===void 0)for(g=u.data[u.index]=Array(l),b=0;b<l;b++)g[b]=Km;return u.index++,g}function qi(l,u){return typeof u=="function"?u(l):u}function Ss(l){var u=ct();return Vn(u,kt,l)}function Vn(l,u,g){var b=l.queue;if(b===null)throw Error(s(311));b.lastRenderedReducer=g;var C=l.baseQueue,D=b.pending;if(D!==null){if(C!==null){var Y=C.next;C.next=D.next,D.next=Y}u.baseQueue=C=D,b.pending=null}if(D=l.baseState,C===null)l.memoizedState=D;else{u=C.next;var ae=Y=null,De=null,Ke=u,ft=!1;do{var et=Ke.lane&-536870913;if(et!==Ke.lane?(Pn&et)===et:(hl&et)===et){var At=Ke.revertLane;if(At===0)De!==null&&(De=De.next={lane:0,revertLane:0,gesture:null,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null}),et===ul&&(ft=!0);else if((hl&At)===At){Ke=Ke.next,At===ul&&(ft=!0);continue}else et={lane:0,revertLane:Ke.revertLane,gesture:null,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null},De===null?(ae=De=et,Y=D):De=De.next=et,mn.lanes|=At,fl|=At;et=Ke.action,Fn&&g(D,et),D=Ke.hasEagerState?Ke.eagerState:g(D,et)}else At={lane:et,revertLane:Ke.revertLane,gesture:Ke.gesture,action:Ke.action,hasEagerState:Ke.hasEagerState,eagerState:Ke.eagerState,next:null},De===null?(ae=De=At,Y=D):De=De.next=At,mn.lanes|=et,fl|=et;Ke=Ke.next}while(Ke!==null&&Ke!==u);if(De===null?Y=D:De.next=ae,!Zi(D,l.memoizedState)&&(bi=!0,ft&&(g=fs,g!==null)))throw g;l.memoizedState=D,l.baseState=Y,l.baseQueue=De,b.lastRenderedState=D}return C===null&&(b.lanes=0),[l.memoizedState,b.dispatch]}function li(l){var u=ct(),g=u.queue;if(g===null)throw Error(s(311));g.lastRenderedReducer=l;var b=g.dispatch,C=g.pending,D=u.memoizedState;if(C!==null){g.pending=null;var Y=C=C.next;do D=l(D,Y.action),Y=Y.next;while(Y!==C);Zi(D,u.memoizedState)||(bi=!0),u.memoizedState=D,u.baseQueue===null&&(u.baseState=D),g.lastRenderedState=D}return[D,b]}function Mi(l,u,g){var b=mn,C=ct(),D=Nn;if(D){if(g===void 0)throw Error(s(407));g=g()}else g=u();var Y=!Zi((kt||C).memoizedState,g);if(Y&&(C.memoizedState=g,bi=!0),C=C.queue,Xa(Zr.bind(null,b,C,l),[l]),C.getSnapshot!==u||Y||ln!==null&&ln.memoizedState.tag&1){if(b.flags|=2048,rr(9,{destroy:void 0},sr.bind(null,b,C,g,u),null),Mn===null)throw Error(s(349));D||(hl&127)!==0||Ti(b,u,g)}return g}function Ti(l,u,g){l.flags|=16384,l={getSnapshot:u,value:g},u=mn.updateQueue,u===null?(u=Ei(),mn.updateQueue=u,u.stores=[l]):(g=u.stores,g===null?u.stores=[l]:g.push(l))}function sr(l,u,g,b){u.value=g,u.getSnapshot=b,ho(u)&&Wh(l)}function Zr(l,u,g){return g(function(){ho(u)&&Wh(l)})}function ho(l){var u=l.getSnapshot;l=l.value;try{var g=u();return!Zi(l,g)}catch{return!0}}function Wh(l){var u=ji(l,2);u!==null&&Di(u,l,2)}function fo(l){var u=Cn();if(typeof l=="function"){var g=l;if(l=g(),Fn){k(!0);try{g()}finally{k(!1)}}}return u.memoizedState=u.baseState=l,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:l},u}function Cc(l,u,g,b){return l.baseState=g,Vn(l,kt,typeof b=="function"?b:qi)}function qa(l,u,g,b,C){if(Nc(l))throw Error(s(485));if(l=u.action,l!==null){var D={payload:C,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Y){D.listeners.push(Y)}};Wt.T!==null?g(!0):D.isTransition=!1,b(D),g=u.pending,g===null?(D.next=u.pending=D,Su(u,D)):(D.next=g.next,u.pending=g.next=D)}}function Su(l,u){var g=u.action,b=u.payload,C=l.state;if(u.isTransition){var D=Wt.T,Y={};Wt.T=Y;try{var ae=g(C,b),De=Wt.S;De!==null&&De(Y,ae),Kr(l,u,ae)}catch(Ke){ga(l,u,Ke)}finally{D!==null&&Y.types!==null&&(D.types=Y.types),Wt.T=D}}else try{D=g(C,b),Kr(l,u,D)}catch(Ke){ga(l,u,Ke)}}function Kr(l,u,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(b){Xo(l,u,b)},function(b){return ga(l,u,b)}):Xo(l,u,g)}function Xo(l,u,g){u.status="fulfilled",u.value=g,wl(u),l.state=g,u=l.pending,u!==null&&(g=u.next,g===u?l.pending=null:(g=g.next,u.next=g,Su(l,g)))}function ga(l,u,g){var b=l.pending;if(l.pending=null,b!==null){b=b.next;do u.status="rejected",u.reason=g,wl(u),u=u.next;while(u!==b)}l.action=null}function wl(l){l=l.listeners;for(var u=0;u<l.length;u++)(0,l[u])()}function Rc(l,u){return u}function Yo(l,u){if(Nn){var g=Mn.formState;if(g!==null){e:{var b=mn;if(Nn){if(Ci){var C=Yy(Ci,hr);if(C){Ci=Zy(C),b=mg(C);break e}}Tt(b)}b=!1}b&&(u=g[0])}}g=Cn(),g.memoizedState=g.baseState=u,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rc,lastRenderedState:u},g.queue=b,g=Xh.bind(null,mn,b),b.dispatch=g,b=fo(!1);var D=va.bind(null,mn,!1,b.queue);return b=Cn(),C={state:u,dispatch:null,action:l,pending:null},b.queue=C,g=qa.bind(null,mn,C,D,g),C.dispatch=g,b.memoizedState=l,[u,g,!1]}function ya(l){var u=ct();return Qr(u,kt,l)}function Qr(l,u,g){if(u=Vn(l,u,Rc)[0],l=Ss(qi)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var b=Qt(u)}catch(Y){throw Y===ds?Pa:Y}else b=u;u=ct();var C=u.queue,D=C.dispatch;return g!==u.memoizedState&&(mn.flags|=2048,rr(9,{destroy:void 0},Ic.bind(null,C,g),null)),[b,D,l]}function Ic(l,u){l.action=u}function si(l){var u=ct(),g=kt;if(g!==null)return Qr(u,g,l);ct(),u=u.memoizedState,g=ct();var b=g.queue.dispatch;return g.memoizedState=l,[u,b,!1]}function rr(l,u,g,b){return l={tag:l,create:g,deps:b,inst:u,next:null},u=mn.updateQueue,u===null&&(u=Ei(),mn.updateQueue=u),g=u.lastEffect,g===null?u.lastEffect=l.next=l:(b=g.next,g.next=l,l.next=b,u.lastEffect=l),l}function Eu(){return ct().memoizedState}function po(l,u,g,b){var C=Cn();mn.flags|=l,C.memoizedState=rr(1|u,{destroy:void 0},g,b===void 0?null:b)}function Cl(l,u,g,b){var C=ct();b=b===void 0?null:b;var D=C.memoizedState.inst;kt!==null&&b!==null&&Pt(b,kt.memoizedState.deps)?C.memoizedState=rr(u,D,g,b):(mn.flags|=l,C.memoizedState=rr(1|u,D,g,b))}function Rl(l,u){po(8390656,8,l,u)}function Xa(l,u){Cl(2048,8,l,u)}function Ya(l){mn.flags|=4;var u=mn.updateQueue;if(u===null)u=Ei(),mn.updateQueue=u,u.events=[l];else{var g=u.events;g===null?u.events=[l]:g.push(l)}}function Es(l){var u=ct().memoizedState;return Ya({ref:u,nextImpl:l}),function(){if((Rn&2)!==0)throw Error(s(440));return u.impl.apply(void 0,arguments)}}function mo(l,u){return Cl(4,2,l,u)}function Za(l,u){return Cl(4,4,l,u)}function Zo(l,u){if(typeof u=="function"){l=l();var g=u(l);return function(){typeof g=="function"?g():u(null)}}if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function Mu(l,u,g){g=g!=null?g.concat([l]):null,Cl(4,4,Zo.bind(null,u,l),g)}function go(){}function Dc(l,u){var g=ct();u=u===void 0?null:u;var b=g.memoizedState;return u!==null&&Pt(u,b[1])?b[0]:(g.memoizedState=[l,u],l)}function Ka(l,u){var g=ct();u=u===void 0?null:u;var b=g.memoizedState;if(u!==null&&Pt(u,b[1]))return b[0];if(b=l(),Fn){k(!0);try{l()}finally{k(!1)}}return g.memoizedState=[b,u],b}function Il(l,u,g){return g===void 0||(hl&1073741824)!==0&&(Pn&261930)===0?l.memoizedState=u:(l.memoizedState=g,l=el(),mn.lanes|=l,fl|=l,g)}function Tu(l,u,g,b){return Zi(g,u)?g:eu.current!==null?(l=Il(l,g,b),Zi(l,u)||(bi=!0),l):(hl&42)===0||(hl&1073741824)!==0&&(Pn&261930)===0?(bi=!0,l.memoizedState=g):(l=el(),mn.lanes|=l,fl|=l,u)}function Dl(l,u,g,b,C){var D=Aa();Dn(D!==0&&8>D?D:8);var Y=Wt.T,ae={};Wt.T=ae,va(l,!1,u,g);try{var De=C(),Ke=Wt.S;if(Ke!==null&&Ke(ae,De),De!==null&&typeof De=="object"&&typeof De.then=="function"){var ft=je(De,b);Pl(l,u,ft,Ai(l))}else Pl(l,u,b,Ai(l))}catch(et){Pl(l,u,{then:function(){},status:"rejected",reason:et},Ai())}finally{Dn(D),Y!==null&&ae.types!==null&&(Y.types=ae.types),Wt.T=Y}}function qh(l){var u=l.memoizedState;if(u!==null)return u;u={memoizedState:qc,baseState:qc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:qc},next:null};var g={};return u.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qi,lastRenderedState:g},next:null},l.memoizedState=u,l=l.alternate,l!==null&&(l.memoizedState=u),u}function Au(){return Q(Xc)}function Nl(){return ct().memoizedState}function wu(){return ct().memoizedState}function vd(l){for(var u=l.return;u!==null;){switch(u.tag){case 24:case 3:var g=Ai();l=bs(g);var b=Xr(u,l,g);b!==null&&(Di(b,u,g),Wa(b,u,g)),u={cache:Ae()},l.payload=u;return}u=u.return}}function Cu(l,u,g){var b=Ai();g={lane:b,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Nc(l)?Yh(u,g):(g=Mr(l,u,g,b),g!==null&&(Di(g,l,b),Zh(g,u,b)))}function Xh(l,u,g){var b=Ai();Pl(l,u,g,b)}function Pl(l,u,g,b){var C={lane:b,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(Nc(l))Yh(u,C);else{var D=l.alternate;if(l.lanes===0&&(D===null||D.lanes===0)&&(D=u.lastRenderedReducer,D!==null))try{var Y=u.lastRenderedState,ae=D(Y,g);if(C.hasEagerState=!0,C.eagerState=ae,Zi(ae,Y))return er(l,u,C,0),Mn===null&&qr(),!1}catch{}if(g=Mr(l,u,C,b),g!==null)return Di(g,l,b),Zh(g,u,b),!0}return!1}function va(l,u,g,b){if(b={lane:2,revertLane:xe(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Nc(l)){if(u)throw Error(s(479))}else u=Mr(l,g,b,2),u!==null&&Di(u,l,2)}function Nc(l){var u=l.alternate;return l===mn||u!==null&&u===mn}function Yh(l,u){_n=En=!0;var g=l.pending;g===null?u.next=u:(u.next=g.next,g.next=u),l.pending=u}function Zh(l,u,g){if((g&4194048)!==0){var b=u.lanes;b&=l.pendingLanes,g|=b,u.lanes=g,P(l,g)}}function Ru(l,u,g,b){u=l.memoizedState,g=g(b,u),g=g==null?u:Ld({},u,g),l.memoizedState=g,l.lanes===0&&(l.updateQueue.baseState=g)}function Ko(l,u,g,b,C,D,Y){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(b,D,Y):u.prototype&&u.prototype.isPureReactComponent?!Ce(g,b)||!Ce(C,D):!0}function Xs(l,u,g,b){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(g,b),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(g,b),u.state!==l&&Ef.enqueueReplaceState(u,u.state,null)}function yo(l,u){var g=u;if("ref"in u){g={};for(var b in u)b!=="ref"&&(g[b]=u[b])}if(l=l.defaultProps){g===u&&(g=Ld({},g));for(var C in l)g[C]===void 0&&(g[C]=l[C])}return g}function Pc(l,u){try{var g=l.onUncaughtError;g(u.value,{componentStack:u.stack})}catch(b){setTimeout(function(){throw b})}}function vo(l,u,g){try{var b=l.onCaughtError;b(g.value,{componentStack:g.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function _(l,u,g){return g=bs(g),g.tag=3,g.payload={element:null},g.callback=function(){Pc(l,u)},g}function L(l){return l=bs(l),l.tag=3,l}function V(l,u,g,b){var C=g.type.getDerivedStateFromError;if(typeof C=="function"){var D=b.value;l.payload=function(){return C(D)},l.callback=function(){vo(u,g,b)}}var Y=g.stateNode;Y!==null&&typeof Y.componentDidCatch=="function"&&(l.callback=function(){vo(u,g,b),typeof C!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var ae=b.stack;this.componentDidCatch(b.value,{componentStack:ae!==null?ae:""})})}function $(l,u,g,b,C){if(g.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(u=g.alternate,u!==null&&it(u,g,C,!0),g=Pr.current,g!==null){switch(g.tag){case 31:case 13:return Lr===null?Bu():g.alternate===null&&Oi===0&&(Oi=3),g.flags&=-257,g.flags|=65536,g.lanes=C,b===Oo?g.flags|=16384:(u=g.updateQueue,u===null?g.updateQueue=new Set([b]):u.add(b),Hu(l,b,C)),!1;case 22:return g.flags|=65536,b===Oo?g.flags|=16384:(u=g.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([b])},g.updateQueue=u):(g=u.retryQueue,g===null?u.retryQueue=new Set([b]):g.add(b)),Hu(l,b,C)),!1}throw Error(s(435,g.tag))}return Hu(l,b,C),Bu(),!1}if(Nn)return u=Pr.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=C,b!==ip&&(l=Error(s(422),{cause:b}),Ye(be(l,g)))):(b!==ip&&(u=Error(s(423),{cause:b}),Ye(be(u,g))),l=l.current.alternate,l.flags|=65536,C&=-C,l.lanes|=C,b=be(b,g),C=_(l.stateNode,b,C),Al(l,C),Oi!==4&&(Oi=2)),!1;var D=Error(s(520),{cause:b});if(D=be(D,g),Tf===null?Tf=[D]:Tf.push(D),Oi!==4&&(Oi=2),u===null)return!0;b=be(b,g),g=u;do{switch(g.tag){case 3:return g.flags|=65536,l=C&-C,g.lanes|=l,l=_(g.stateNode,b,l),Al(g,l),!1;case 1:if(u=g.type,D=g.stateNode,(g.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(dl===null||!dl.has(D))))return g.flags|=65536,C&=-C,g.lanes|=C,C=L(C),V(C,l,g,b),Al(g,C),!1}g=g.return}while(g!==null);return!1}function fe(l,u,g,b){u.child=l===null?Pg(u,null,g,b):zs(u,l.child,g,b)}function Te(l,u,g,b,C){g=g.render;var D=u.ref;if("ref"in b){var Y={};for(var ae in b)ae!=="ref"&&(Y[ae]=b[ae])}else Y=b;return st(u),b=Kt(l,u,g,Y,D,C),ae=qn(),l!==null&&!bi?(ti(l,u,C),_o(l,u,C)):(Nn&&ae&&Pe(u),u.flags|=1,fe(l,u,b,C),u.child)}function mt(l,u,g,b,C){if(l===null){var D=g.type;return typeof D=="function"&&!Fc(D)&&D.defaultProps===void 0&&g.compare===null?(u.tag=15,u.type=D,fn(l,u,D,b,C)):(l=il(g.type,null,b,u,u.mode,C),l.ref=u.ref,l.return=u,u.child=l)}if(D=l.child,!Kh(l,C)){var Y=D.memoizedProps;if(g=g.compare,g=g!==null?g:Ce,g(Y,b)&&l.ref===u.ref)return _o(l,u,C)}return u.flags|=1,l=ea(D,b),l.ref=u.ref,l.return=u,u.child=l}function fn(l,u,g,b,C){if(l!==null){var D=l.memoizedProps;if(Ce(D,b)&&l.ref===u.ref)if(bi=!1,u.pendingProps=b=D,Kh(l,C))(l.flags&131072)!==0&&(bi=!0);else return u.lanes=l.lanes,_o(l,u,C)}return Qo(l,u,g,b,C)}function Fi(l,u,g,b){var C=b.children,D=l!==null?l.memoizedState:null;if(l===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((u.flags&128)!==0){if(D=D!==null?D.baseLanes|g:g,l!==null){for(b=u.child=l.child,C=0;b!==null;)C=C|b.lanes|b.childLanes,b=b.sibling;b=C&~D}else b=0,u.child=null;return xi(l,u,D,g,b)}if((g&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},l!==null&&Je(u,D!==null?D.cachePool:null),D!==null?qs(u,D):Z(),me(u);else return b=u.lanes=536870912,xi(l,u,D!==null?D.baseLanes|g:g,g,b)}else D!==null?(Je(u,D.cachePool),qs(u,D),lt(),u.memoizedState=null):(l!==null&&Je(u,null),Z(),lt());return fe(l,u,C,g),u.child}function zn(l,u){return l!==null&&l.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function xi(l,u,g,b,C){var D=Ze();return D=D===null?null:{parent:Xi?Ri._currentValue:Ri._currentValue2,pool:D},u.memoizedState={baseLanes:g,cachePool:D},l!==null&&Je(u,null),Z(),me(u),l!==null&&it(l,u,b,!0),u.childLanes=C,null}function ar(l,u){return u=Ll({mode:u.mode,children:u.children},l.mode),u.ref=l.ref,l.child=u,u.return=l,u}function Qa(l,u,g){return zs(u,l.child,null,g),l=ar(u,u.pendingProps),l.flags|=2,pt(u),u.memoizedState=null,l}function $a(l,u,g){var b=u.pendingProps,C=(u.flags&128)!==0;if(u.flags&=-129,l===null){if(Nn){if(b.mode==="hidden")return l=ar(u,b),u.lanes=536870912,zn(null,l);if(ge(u),(l=Ci)?(l=yg(l,hr),l!==null&&(u.memoizedState={dehydrated:l,treeContext:Ra!==null?{id:Os,overflow:eo}:null,retryLane:536870912,hydrationErrors:null},g=Xm(l),g.return=u,u.child=g,hs=u,Ci=null)):l=null,l===null)throw Tt(u);return u.lanes=536870912,null}return ar(u,b)}var D=l.memoizedState;if(D!==null){var Y=D.dehydrated;if(ge(u),C)if(u.flags&256)u.flags&=-257,u=Qa(l,u,g);else if(u.memoizedState!==null)u.child=l.child,u.flags|=128,u=null;else throw Error(s(558));else if(bi||it(l,u,g,!1),C=(g&l.childLanes)!==0,bi||C){if(b=Mn,b!==null&&(Y=H(b,g),Y!==0&&Y!==D.retryLane))throw D.retryLane=Y,ji(l,Y),Di(b,l,Y),dr;Bu(),u=Qa(l,u,g)}else l=D.treeContext,wi&&(Ci=Jy(Y),hs=u,Nn=!0,Lo=null,hr=!1,l!==null&&Mt(u,l)),u=ar(u,b),u.flags|=4096;return u}return l=ea(l.child,{mode:b.mode,children:b.children}),l.ref=u.ref,u.child=l,l.return=u,l}function Tr(l,u){var g=u.ref;if(g===null)l!==null&&l.ref!==null&&(u.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(s(284));(l===null||l.ref!==g)&&(u.flags|=4194816)}}function Qo(l,u,g,b,C){return st(u),g=Kt(l,u,g,b,void 0,C),b=qn(),l!==null&&!bi?(ti(l,u,C),_o(l,u,C)):(Nn&&b&&Pe(u),u.flags|=1,fe(l,u,g,C),u.child)}function Lc(l,u,g,b,C,D){return st(u),u.updateQueue=null,g=bt(u,b,g,C),jt(l),b=qn(),l!==null&&!bi?(ti(l,u,D),_o(l,u,D)):(Nn&&b&&Pe(u),u.flags|=1,fe(l,u,g,D),u.child)}function Oc(l,u,g,b,C){if(st(u),u.stateNode===null){var D=Do,Y=g.contextType;typeof Y=="object"&&Y!==null&&(D=Q(Y)),D=new g(b,D),u.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Ef,u.stateNode=D,D._reactInternals=u,D=u.stateNode,D.props=b,D.state=u.memoizedState,D.refs={},_i(u),Y=g.contextType,D.context=typeof Y=="object"&&Y!==null?Q(Y):Do,D.state=u.memoizedState,Y=g.getDerivedStateFromProps,typeof Y=="function"&&(Ru(u,g,Y,b),D.state=u.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(Y=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),Y!==D.state&&Ef.enqueueReplaceState(D,D.state,null),ma(u,b,D,C),Ws(),D.state=u.memoizedState),typeof D.componentDidMount=="function"&&(u.flags|=4194308),b=!0}else if(l===null){D=u.stateNode;var ae=u.memoizedProps,De=yo(g,ae);D.props=De;var Ke=D.context,ft=g.contextType;Y=Do,typeof ft=="object"&&ft!==null&&(Y=Q(ft));var et=g.getDerivedStateFromProps;ft=typeof et=="function"||typeof D.getSnapshotBeforeUpdate=="function",ae=u.pendingProps!==ae,ft||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(ae||Ke!==Y)&&Xs(u,D,b,Y),ia=!1;var At=u.memoizedState;D.state=At,ma(u,b,D,C),Ws(),Ke=u.memoizedState,ae||At!==Ke||ia?(typeof et=="function"&&(Ru(u,g,et,b),Ke=u.memoizedState),(De=ia||Ko(u,g,De,b,At,Ke,Y))?(ft||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(u.flags|=4194308)):(typeof D.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=b,u.memoizedState=Ke),D.props=b,D.state=Ke,D.context=Y,b=De):(typeof D.componentDidMount=="function"&&(u.flags|=4194308),b=!1)}else{D=u.stateNode,nr(l,u),Y=u.memoizedProps,ft=yo(g,Y),D.props=ft,et=u.pendingProps,At=D.context,Ke=g.contextType,De=Do,typeof Ke=="object"&&Ke!==null&&(De=Q(Ke)),ae=g.getDerivedStateFromProps,(Ke=typeof ae=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(Y!==et||At!==De)&&Xs(u,D,b,De),ia=!1,At=u.memoizedState,D.state=At,ma(u,b,D,C),Ws();var dn=u.memoizedState;Y!==et||At!==dn||ia||l!==null&&l.dependencies!==null&&Rt(l.dependencies)?(typeof ae=="function"&&(Ru(u,g,ae,b),dn=u.memoizedState),(ft=ia||Ko(u,g,ft,b,At,dn,De)||l!==null&&l.dependencies!==null&&Rt(l.dependencies))?(Ke||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(b,dn,De),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(b,dn,De)),typeof D.componentDidUpdate=="function"&&(u.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof D.componentDidUpdate!="function"||Y===l.memoizedProps&&At===l.memoizedState||(u.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Y===l.memoizedProps&&At===l.memoizedState||(u.flags|=1024),u.memoizedProps=b,u.memoizedState=dn),D.props=b,D.state=dn,D.context=De,b=ft):(typeof D.componentDidUpdate!="function"||Y===l.memoizedProps&&At===l.memoizedState||(u.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||Y===l.memoizedProps&&At===l.memoizedState||(u.flags|=1024),b=!1)}return D=b,Tr(l,u),b=(u.flags&128)!==0,D||b?(D=u.stateNode,g=b&&typeof g.getDerivedStateFromError!="function"?null:D.render(),u.flags|=1,l!==null&&b?(u.child=zs(u,l.child,null,C),u.child=zs(u,null,g,C)):fe(l,u,g,C),u.memoizedState=D.state,l=u.child):l=_o(l,u,C),l}function yy(l,u,g,b){return zt(),u.flags|=256,fe(l,u,g,b),u.child}function Nm(l){return{baseLanes:l,cachePool:Qe()}}function Pm(l,u,g){return l=l!==null?l.childLanes&~g:0,u&&(l|=pr),l}function Lm(l,u,g){var b=u.pendingProps,C=!1,D=(u.flags&128)!==0,Y;if((Y=D)||(Y=l!==null&&l.memoizedState===null?!1:(Vi.current&2)!==0),Y&&(C=!0,u.flags&=-129),Y=(u.flags&32)!==0,u.flags&=-33,l===null){if(Nn){if(C?Se(u):lt(),(l=Ci)?(l=iv(l,hr),l!==null&&(u.memoizedState={dehydrated:l,treeContext:Ra!==null?{id:Os,overflow:eo}:null,retryLane:536870912,hydrationErrors:null},g=Xm(l),g.return=u,u.child=g,hs=u,Ci=null)):l=null,l===null)throw Tt(u);return Hd(l)?u.lanes=32:u.lanes=536870912,null}var ae=b.children;return b=b.fallback,C?(lt(),C=u.mode,ae=Ll({mode:"hidden",children:ae},C),b=Ma(b,C,g,null),ae.return=u,b.return=u,ae.sibling=b,u.child=ae,b=u.child,b.memoizedState=Nm(g),b.childLanes=Pm(l,Y,g),u.memoizedState=tu,zn(null,b)):(Se(u),_d(u,ae))}var De=l.memoizedState;if(De!==null&&(ae=De.dehydrated,ae!==null)){if(D)u.flags&256?(Se(u),u.flags&=-257,u=Uc(l,u,g)):u.memoizedState!==null?(lt(),u.child=l.child,u.flags|=128,u=null):(lt(),ae=b.fallback,C=u.mode,b=Ll({mode:"visible",children:b.children},C),ae=Ma(ae,C,g,null),ae.flags|=2,b.return=u,ae.return=u,b.sibling=ae,u.child=b,zs(u,l.child,null,g),b=u.child,b.memoizedState=Nm(g),b.childLanes=Pm(l,Y,g),u.memoizedState=tu,u=zn(null,b));else if(Se(u),Hd(ae))Y=Gd(ae).digest,b=Error(s(419)),b.stack="",b.digest=Y,Ye({value:b,source:null,stack:null}),u=Uc(l,u,g);else if(bi||it(l,u,g,!1),Y=(g&l.childLanes)!==0,bi||Y){if(Y=Mn,Y!==null&&(b=H(Y,g),b!==0&&b!==De.retryLane))throw De.retryLane=b,ji(l,b),Di(Y,l,b),dr;Xl(ae)||Bu(),u=Uc(l,u,g)}else Xl(ae)?(u.flags|=192,u.child=l.child,u=null):(l=De.treeContext,wi&&(Ci=ev(ae),hs=u,Nn=!0,Lo=null,hr=!1,l!==null&&Mt(u,l)),u=_d(u,b.children),u.flags|=4096);return u}return C?(lt(),ae=b.fallback,C=u.mode,De=l.child,D=De.sibling,b=ea(De,{mode:"hidden",children:b.children}),b.subtreeFlags=De.subtreeFlags&65011712,D!==null?ae=ea(D,ae):(ae=Ma(ae,C,g,null),ae.flags|=2),ae.return=u,b.return=u,b.sibling=ae,u.child=b,zn(null,b),b=u.child,ae=l.child.memoizedState,ae===null?ae=Nm(g):(C=ae.cachePool,C!==null?(De=Xi?Ri._currentValue:Ri._currentValue2,C=C.parent!==De?{parent:De,pool:De}:C):C=Qe(),ae={baseLanes:ae.baseLanes|g,cachePool:C}),b.memoizedState=ae,b.childLanes=Pm(l,Y,g),u.memoizedState=tu,zn(l.child,b)):(Se(u),g=l.child,l=g.sibling,g=ea(g,{mode:"visible",children:b.children}),g.return=u,g.sibling=null,l!==null&&(Y=u.deletions,Y===null?(u.deletions=[l],u.flags|=16):Y.push(l)),u.child=g,u.memoizedState=null,g)}function _d(l,u){return u=Ll({mode:"visible",children:u},l.mode),u.return=l,l.child=u}function Ll(l,u){return l=t(22,l,null,u),l.lanes=0,l}function Uc(l,u,g){return zs(u,l.child,null,g),l=_d(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function vy(l,u,g){l.lanes|=u;var b=l.alternate;b!==null&&(b.lanes|=u),te(l.return,u,g)}function Iu(l,u,g,b,C,D){var Y=l.memoizedState;Y===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:b,tail:g,tailMode:C,treeForkCount:D}:(Y.isBackwards=u,Y.rendering=null,Y.renderingStartTime=0,Y.last=b,Y.tail=g,Y.tailMode=C,Y.treeForkCount=D)}function Om(l,u,g){var b=u.pendingProps,C=b.revealOrder,D=b.tail;b=b.children;var Y=Vi.current,ae=(Y&2)!==0;if(ae?(Y=Y&1|2,u.flags|=128):Y&=1,T(Vi,Y),fe(l,u,b,g),b=Nn?xf:0,!ae&&l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&vy(l,g,u);else if(l.tag===19)vy(l,g,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(C){case"forwards":for(g=u.child,C=null;g!==null;)l=g.alternate,l!==null&&gt(l)===null&&(C=g),g=g.sibling;g=C,g===null?(C=u.child,u.child=null):(C=g.sibling,g.sibling=null),Iu(u,!1,C,g,D,b);break;case"backwards":case"unstable_legacy-backwards":for(g=null,C=u.child,u.child=null;C!==null;){if(l=C.alternate,l!==null&&gt(l)===null){u.child=C;break}l=C.sibling,C.sibling=g,g=C,C=l}Iu(u,!0,g,null,D,b);break;case"together":Iu(u,!1,null,null,void 0,b);break;default:u.memoizedState=null}return u.child}function _o(l,u,g){if(l!==null&&(u.dependencies=l.dependencies),fl|=u.lanes,(g&u.childLanes)===0)if(l!==null){if(it(l,u,g,!1),(g&u.childLanes)===0)return null}else return null;if(l!==null&&u.child!==l.child)throw Error(s(153));if(u.child!==null){for(l=u.child,g=ea(l,l.pendingProps),u.child=g,g.return=u;l.sibling!==null;)l=l.sibling,g=g.sibling=ea(l,l.pendingProps),g.return=u;g.sibling=null}return u.child}function Kh(l,u){return(l.lanes&u)!==0?!0:(l=l.dependencies,!!(l!==null&&Rt(l)))}function Um(l,u,g){switch(u.tag){case 3:Yt(u,u.stateNode.containerInfo),ze(u,Ri,l.memoizedState.cache),zt();break;case 27:case 5:tt(u);break;case 4:Yt(u,u.stateNode.containerInfo);break;case 10:ze(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,ge(u),null;break;case 13:var b=u.memoizedState;if(b!==null)return b.dehydrated!==null?(Se(u),u.flags|=128,null):(g&u.child.childLanes)!==0?Lm(l,u,g):(Se(u),l=_o(l,u,g),l!==null?l.sibling:null);Se(u);break;case 19:var C=(l.flags&128)!==0;if(b=(g&u.childLanes)!==0,b||(it(l,u,g,!1),b=(g&u.childLanes)!==0),C){if(b)return Om(l,u,g);u.flags|=128}if(C=u.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),T(Vi,Vi.current),b)break;return null;case 22:return u.lanes=0,Fi(l,u,g,u.pendingProps);case 24:ze(u,Ri,l.memoizedState.cache)}return _o(l,u,g)}function zm(l,u,g){if(l!==null)if(l.memoizedProps!==u.pendingProps)bi=!0;else{if(!Kh(l,g)&&(u.flags&128)===0)return bi=!1,Um(l,u,g);bi=(l.flags&131072)!==0}else bi=!1,Nn&&(u.flags&1048576)!==0&&Oe(u,xf,u.index);switch(u.lanes=0,u.tag){case 16:e:{var b=u.pendingProps;if(l=hn(u.elementType),u.type=l,typeof l=="function")Fc(l)?(b=yo(l,b),u.tag=1,u=Oc(null,u,l,b,g)):(u.tag=0,u=Qo(null,u,l,b,g));else{if(l!=null){var C=l.$$typeof;if(C===Gu){u.tag=11,u=Te(null,u,l,b,g);break e}else if(C===Ud){u.tag=14,u=mt(null,u,l,b,g);break e}}throw u=v(l)||l,Error(s(306,u,""))}}return u;case 0:return Qo(l,u,u.type,u.pendingProps,g);case 1:return b=u.type,C=yo(b,u.pendingProps),Oc(l,u,b,C,g);case 3:e:{if(Yt(u,u.stateNode.containerInfo),l===null)throw Error(s(387));var D=u.pendingProps;C=u.memoizedState,b=C.element,nr(l,u),ma(u,D,null,g);var Y=u.memoizedState;if(D=Y.cache,ze(u,Ri,D),D!==C.cache&&yt(u,[Ri],g,!0),Ws(),D=Y.element,wi&&C.isDehydrated)if(C={element:D,isDehydrated:!1,cache:Y.cache},u.updateQueue.baseState=C,u.memoizedState=C,u.flags&256){u=yy(l,u,D,g);break e}else if(D!==b){b=be(Error(s(424)),u),Ye(b),u=yy(l,u,D,g);break e}else for(wi&&(Ci=$y(u.stateNode.containerInfo),hs=u,Nn=!0,Lo=null,hr=!0),g=Pg(u,null,D,g),u.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(zt(),D===b){u=_o(l,u,g);break e}fe(l,u,D,g)}u=u.child}return u;case 26:if(wa)return Tr(l,u),l===null?(g=Sg(u.type,null,u.pendingProps,null))?u.memoizedState=g:Nn||(u.stateNode=Xd(u.type,u.pendingProps,Us.current,u)):u.memoizedState=Sg(u.type,l.memoizedProps,u.pendingProps,l.memoizedState),null;case 27:if(us)return tt(u),l===null&&us&&Nn&&(b=u.stateNode=Yd(u.type,u.pendingProps,Us.current,ws.current,!1),hs=u,hr=!0,Ci=gg(u.type,b,Ci)),fe(l,u,u.pendingProps.children,g),Tr(l,u),l===null&&(u.flags|=4194304),u.child;case 5:return l===null&&Nn&&(fv(u.type,u.pendingProps,ws.current),(C=b=Ci)&&(b=tv(b,u.type,u.pendingProps,hr),b!==null?(u.stateNode=b,hs=u,Ci=Qy(b),hr=!1,C=!0):C=!1),C||Tt(u)),tt(u),C=u.type,D=u.pendingProps,Y=l!==null?l.memoizedProps:null,b=D.children,ur(C,D)?b=null:Y!==null&&ur(C,Y)&&(u.flags|=32),u.memoizedState!==null&&(C=Kt(l,u,sn,null,null,g),Xi?Xc._currentValue=C:Xc._currentValue2=C),Tr(l,u),fe(l,u,b,g),u.child;case 6:return l===null&&Nn&&(bg(u.pendingProps,ws.current),(l=g=Ci)&&(g=nv(g,u.pendingProps,hr),g!==null?(u.stateNode=g,hs=u,Ci=null,l=!0):l=!1),l||Tt(u)),null;case 13:return Lm(l,u,g);case 4:return Yt(u,u.stateNode.containerInfo),b=u.pendingProps,l===null?u.child=zs(u,null,b,g):fe(l,u,b,g),u.child;case 11:return Te(l,u,u.type,u.pendingProps,g);case 7:return fe(l,u,u.pendingProps,g),u.child;case 8:return fe(l,u,u.pendingProps.children,g),u.child;case 12:return fe(l,u,u.pendingProps.children,g),u.child;case 10:return b=u.pendingProps,ze(u,u.type,b.value),fe(l,u,b.children,g),u.child;case 9:return C=u.type._context,b=u.pendingProps.children,st(u),C=Q(C),b=b(C),u.flags|=1,fe(l,u,b,g),u.child;case 14:return mt(l,u,u.type,u.pendingProps,g);case 15:return fn(l,u,u.type,u.pendingProps,g);case 19:return Om(l,u,g);case 31:return $a(l,u,g);case 22:return Fi(l,u,g,u.pendingProps);case 24:return st(u),b=Q(Ri),l===null?(C=Ze(),C===null&&(C=Mn,D=Ae(),C.pooledCache=D,D.refCount++,D!==null&&(C.pooledCacheLanes|=g),C=D),u.memoizedState={parent:b,cache:C},_i(u),ze(u,Ri,C)):((l.lanes&g)!==0&&(nr(l,u),ma(u,null,null,g),Ws()),C=l.memoizedState,D=u.memoizedState,C.parent!==b?(C={parent:b,cache:b},u.memoizedState=C,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=C),ze(u,Ri,b)):(b=D.cache,ze(u,Ri,b),b!==C.cache&&yt(u,[Ri],g,!0))),fe(l,u,u.pendingProps.children,g),u.child;case 29:throw u.pendingProps}throw Error(s(156,u.tag))}function _a(l){l.flags|=4}function Qh(l){ta&&(l.flags|=8)}function _y(l,u){if(l!==null&&l.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(l=u.child;l!==null;){if((l.flags&8218)!==0||(l.subtreeFlags&8218)!==0)return!0;l=l.sibling}return!1}function Fm(l,u,g,b){if(On)for(g=u.child;g!==null;){if(g.tag===5||g.tag===6)ff(l,g.stateNode);else if(!(g.tag===4||us&&g.tag===27)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===u)break;for(;g.sibling===null;){if(g.return===null||g.return===u)return;g=g.return}g.sibling.return=g.return,g=g.sibling}else if(ta)for(var C=u.child;C!==null;){if(C.tag===5){var D=C.stateNode;g&&b&&(D=Xy(D,C.type,C.memoizedProps)),ff(l,D)}else if(C.tag===6)D=C.stateNode,g&&b&&(D=pg(D,C.memoizedProps)),ff(l,D);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)D=C.child,D!==null&&(D.return=C),Fm(l,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===u)break;for(;C.sibling===null;){if(C.return===null||C.return===u)return;C=C.return}C.sibling.return=C.return,C=C.sibling}}function xy(l,u,g,b){var C=!1;if(ta)for(var D=u.child;D!==null;){if(D.tag===5){var Y=D.stateNode;g&&b&&(Y=Xy(Y,D.type,D.memoizedProps)),fg(l,Y)}else if(D.tag===6)Y=D.stateNode,g&&b&&(Y=pg(Y,D.memoizedProps)),fg(l,Y);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)C=D.child,C!==null&&(C.return=D),xy(l,D,!0,!0),C=!0;else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===u)break;for(;D.sibling===null;){if(D.return===null||D.return===u)return C;D=D.return}D.sibling.return=D.return,D=D.sibling}return C}function by(l,u){if(ta&&_y(l,u)){l=u.stateNode;var g=l.containerInfo,b=hg();xy(b,u,!1,!1),l.pendingChildren=b,_a(u),qy(g,b)}}function Bm(l,u,g,b){if(On)l.memoizedProps!==b&&_a(u);else if(ta){var C=l.stateNode,D=l.memoizedProps;if((l=_y(l,u))||D!==b){var Y=ws.current;D=Wy(C,g,D,b,!l,null),D===C?u.stateNode=C:(Qh(u),Rr(D,g,b,Y)&&_a(u),u.stateNode=D,l&&Fm(D,u,!1,!1))}else u.stateNode=C}}function or(l,u,g,b,C){if((l.mode&32)!==0&&(g===null?df(u,b):Yu(u,g,b))){if(l.flags|=16777216,(C&335544128)===C||eg(u,b))if(Ni(l.stateNode,u,b))l.flags|=8192;else if(Ln())l.flags|=8192;else throw fr=Oo,rp}else l.flags&=-16777217}function Du(l,u){if(Ag(u)){if(l.flags|=16777216,!wg(u))if(Ln())l.flags|=8192;else throw fr=Oo,rp}else l.flags&=-16777217}function $h(l,u){u!==null&&(l.flags|=4),l.flags&16384&&(u=l.tag!==22?U():536870912,l.lanes|=u,ih|=u)}function Nu(l,u){if(!Nn)switch(l.tailMode){case"hidden":u=l.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?l.tail=null:g.sibling=null;break;case"collapsed":g=l.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:b.sibling=null}}function di(l){var u=l.alternate!==null&&l.alternate.child===l.child,g=0,b=0;if(u)for(var C=l.child;C!==null;)g|=C.lanes|C.childLanes,b|=C.subtreeFlags&65011712,b|=C.flags&65011712,C.return=l,C=C.sibling;else for(C=l.child;C!==null;)g|=C.lanes|C.childLanes,b|=C.subtreeFlags,b|=C.flags,C.return=l,C=C.sibling;return l.subtreeFlags|=b,l.childLanes=g,u}function Sy(l,u,g){var b=u.pendingProps;switch($e(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return di(u),null;case 1:return di(u),null;case 3:return g=u.stateNode,b=null,l!==null&&(b=l.memoizedState.cache),u.memoizedState.cache!==b&&(u.flags|=2048),ot(Ri),Ie(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(l===null||l.child===null)&&(un(u)?_a(u):l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ue())),by(l,u),di(u),null;case 26:if(wa){var C=u.type,D=u.memoizedState;return l===null?(_a(u),D!==null?(di(u),Du(u,D)):(di(u),or(u,C,null,b,g))):D?D!==l.memoizedState?(_a(u),di(u),Du(u,D)):(di(u),u.flags&=-16777217):(D=l.memoizedProps,On?D!==b&&_a(u):Bm(l,u,C,b),di(u),or(u,C,D,b,g)),null}case 27:if(us){if(nt(u),g=Us.current,C=u.type,l!==null&&u.stateNode!=null)On?l.memoizedProps!==b&&_a(u):Bm(l,u,C,b);else{if(!b){if(u.stateNode===null)throw Error(s(166));return di(u),null}l=ws.current,un(u)?Lt(u,l):(l=Yd(C,b,g,l,!0),u.stateNode=l,_a(u))}return di(u),null}case 5:if(nt(u),C=u.type,l!==null&&u.stateNode!=null)Bm(l,u,C,b);else{if(!b){if(u.stateNode===null)throw Error(s(166));return di(u),null}if(D=ws.current,un(u))Lt(u,D),cv(u.stateNode,C,b,D)&&(u.flags|=64);else{var Y=$m(C,b,Us.current,D,u);Qh(u),Fm(Y,u,!1,!1),u.stateNode=Y,Rr(Y,C,b,D)&&_a(u)}}return di(u),or(u,u.type,l===null?null:l.memoizedProps,u.pendingProps,g),null;case 6:if(l&&u.stateNode!=null)g=l.memoizedProps,On?g!==b&&_a(u):ta&&(g!==b?(l=Us.current,g=ws.current,Qh(u),u.stateNode=al(b,l,g,u)):u.stateNode=l.stateNode);else{if(typeof b!="string"&&u.stateNode===null)throw Error(s(166));if(l=Us.current,g=ws.current,un(u)){if(!wi)throw Error(s(176));if(l=u.stateNode,g=u.memoizedProps,b=null,C=hs,C!==null)switch(C.tag){case 27:case 5:b=C.memoizedProps}hS(l,g,u,b)||Tt(u,!0)}else Qh(u),u.stateNode=al(b,l,g,u)}return di(u),null;case 31:if(g=u.memoizedState,l===null||l.memoizedState!==null){if(b=un(u),g!==null){if(l===null){if(!b)throw Error(s(318));if(!wi)throw Error(s(556));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(s(557));vg(l,u)}else zt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;di(u),l=!1}else g=Ue(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=g),l=!0;if(!l)return u.flags&256?(pt(u),u):(pt(u),null);if((u.flags&128)!==0)throw Error(s(558))}return di(u),null;case 13:if(b=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(C=un(u),b!==null&&b.dehydrated!==null){if(l===null){if(!C)throw Error(s(318));if(!wi)throw Error(s(344));if(C=u.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(s(317));rv(C,u)}else zt(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;di(u),C=!1}else C=Ue(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=C),C=!0;if(!C)return u.flags&256?(pt(u),u):(pt(u),null)}return pt(u),(u.flags&128)!==0?(u.lanes=g,u):(g=b!==null,l=l!==null&&l.memoizedState!==null,g&&(b=u.child,C=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(C=b.alternate.memoizedState.cachePool.pool),D=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(D=b.memoizedState.cachePool.pool),D!==C&&(b.flags|=2048)),g!==l&&g&&(u.child.flags|=8192),$h(u,u.updateQueue),di(u),null);case 4:return Ie(),by(l,u),l===null&&ci(u.stateNode.containerInfo),di(u),null;case 10:return ot(u.type),di(u),null;case 19:if(E(Vi),b=u.memoizedState,b===null)return di(u),null;if(C=(u.flags&128)!==0,D=b.rendering,D===null)if(C)Nu(b,!1);else{if(Oi!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(D=gt(l),D!==null){for(u.flags|=128,Nu(b,!1),l=D.updateQueue,u.updateQueue=l,$h(u,l),u.subtreeFlags=0,l=g,g=u.child;g!==null;)Dd(g,l),g=g.sibling;return T(Vi,Vi.current&1|2),Nn&&Be(u,b.treeForkCount),u.child}l=l.sibling}b.tail!==null&&Zs()>sc&&(u.flags|=128,C=!0,Nu(b,!1),u.lanes=4194304)}else{if(!C)if(l=gt(D),l!==null){if(u.flags|=128,C=!0,l=l.updateQueue,u.updateQueue=l,$h(u,l),Nu(b,!0),b.tail===null&&b.tailMode==="hidden"&&!D.alternate&&!Nn)return di(u),null}else 2*Zs()-b.renderingStartTime>sc&&g!==536870912&&(u.flags|=128,C=!0,Nu(b,!1),u.lanes=4194304);b.isBackwards?(D.sibling=u.child,u.child=D):(l=b.last,l!==null?l.sibling=D:u.child=D,b.last=D)}return b.tail!==null?(l=b.tail,b.rendering=l,b.tail=l.sibling,b.renderingStartTime=Zs(),l.sibling=null,g=Vi.current,T(Vi,C?g&1|2:g&1),Nn&&Be(u,b.treeForkCount),l):(di(u),null);case 22:case 23:return pt(u),le(),b=u.memoizedState!==null,l!==null?l.memoizedState!==null!==b&&(u.flags|=8192):b&&(u.flags|=8192),b?(g&536870912)!==0&&(u.flags&128)===0&&(di(u),u.subtreeFlags&6&&(u.flags|=8192)):di(u),g=u.updateQueue,g!==null&&$h(u,g.retryQueue),g=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),b=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==g&&(u.flags|=2048),l!==null&&E(Kl),null;case 24:return g=null,l!==null&&(g=l.memoizedState.cache),u.memoizedState.cache!==g&&(u.flags|=2048),ot(Ri),di(u),null;case 25:return null;case 30:return null}throw Error(s(156,u.tag))}function Vm(l,u){switch($e(u),u.tag){case 1:return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return ot(Ri),Ie(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 26:case 27:case 5:return nt(u),null;case 31:if(u.memoizedState!==null){if(pt(u),u.alternate===null)throw Error(s(340));zt()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 13:if(pt(u),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(s(340));zt()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return E(Vi),null;case 4:return Ie(),null;case 10:return ot(u.type),null;case 22:case 23:return pt(u),le(),l!==null&&E(Kl),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 24:return ot(Ri),null;case 25:return null;default:return null}}function Ey(l,u){switch($e(u),u.tag){case 3:ot(Ri),Ie();break;case 26:case 27:case 5:nt(u);break;case 4:Ie();break;case 31:u.memoizedState!==null&&pt(u);break;case 13:pt(u);break;case 19:E(Vi);break;case 10:ot(u.type);break;case 22:case 23:pt(u),le(),l!==null&&E(Kl);break;case 24:ot(Ri)}}function xo(l,u){try{var g=u.updateQueue,b=g!==null?g.lastEffect:null;if(b!==null){var C=b.next;g=C;do{if((g.tag&l)===l){b=void 0;var D=g.create,Y=g.inst;b=D(),Y.destroy=b}g=g.next}while(g!==C)}}catch(ae){tn(u,u.return,ae)}}function bo(l,u,g){try{var b=u.updateQueue,C=b!==null?b.lastEffect:null;if(C!==null){var D=C.next;b=D;do{if((b.tag&l)===l){var Y=b.inst,ae=Y.destroy;if(ae!==void 0){Y.destroy=void 0,C=u;var De=g,Ke=ae;try{Ke()}catch(ft){tn(C,De,ft)}}}b=b.next}while(b!==D)}}catch(ft){tn(u,u.return,ft)}}function Pu(l){var u=l.updateQueue;if(u!==null){var g=l.stateNode;try{ir(u,g)}catch(b){tn(l,l.return,b)}}}function xd(l,u,g){g.props=yo(l.type,l.memoizedProps),g.state=l.memoizedState;try{g.componentWillUnmount()}catch(b){tn(l,u,b)}}function Lu(l,u){try{var g=l.ref;if(g!==null){switch(l.tag){case 26:case 27:case 5:var b=Wu(l.stateNode);break;case 30:b=l.stateNode;break;default:b=l.stateNode}typeof g=="function"?l.refCleanup=g(b):g.current=b}}catch(C){tn(l,u,C)}}function Ys(l,u){var g=l.ref,b=l.refCleanup;if(g!==null)if(typeof b=="function")try{b()}catch(C){tn(l,u,C)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(C){tn(l,u,C)}else g.current=null}function zc(l){var u=l.type,g=l.memoizedProps,b=l.stateNode;try{zy(b,u,g,l)}catch(C){tn(l,l.return,C)}}function Jh(l,u,g){try{Fy(l.stateNode,l.type,g,u,l)}catch(b){tn(l,l.return,b)}}function km(l){return l.tag===5||l.tag===3||(wa?l.tag===26:!1)||(us?l.tag===27&&Yc(l.type):!1)||l.tag===4}function $o(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||km(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(us&&l.tag===27&&Yc(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function bd(l,u,g){var b=l.tag;if(b===5||b===6)l=l.stateNode,u?Vy(g,l,u):og(g,l);else if(b!==4&&(us&&b===27&&Yc(l.type)&&(g=l.stateNode,u=null),l=l.child,l!==null))for(bd(l,u,g),l=l.sibling;l!==null;)bd(l,u,g),l=l.sibling}function ef(l,u,g){var b=l.tag;if(b===5||b===6)l=l.stateNode,u?By(g,l,u):ag(g,l);else if(b!==4&&(us&&b===27&&Yc(l.type)&&(g=l.stateNode),l=l.child,l!==null))for(ef(l,u,g),l=l.sibling;l!==null;)ef(l,u,g),l=l.sibling}function Hm(l,u,g){l=l.containerInfo;try{dg(l,g)}catch(b){tn(u,u.return,b)}}function My(l){var u=l.stateNode,g=l.memoizedProps;try{ss(l.type,g,u,l)}catch(b){tn(l,l.return,b)}}function oS(l,u){for(zd(l.containerInfo),Ki=u;Ki!==null;)if(l=Ki,u=l.child,(l.subtreeFlags&1028)!==0&&u!==null)u.return=l,Ki=u;else for(;Ki!==null;){l=Ki;var g=l.alternate;switch(u=l.flags,l.tag){case 0:if((u&4)!==0&&(u=l.updateQueue,u=u!==null?u.events:null,u!==null))for(var b=0;b<u.length;b++){var C=u[b];C.ref.impl=C.nextImpl}break;case 11:case 15:break;case 1:if((u&1024)!==0&&g!==null){u=void 0,b=l,C=g.memoizedProps,g=g.memoizedState;var D=b.stateNode;try{var Y=yo(b.type,C);u=D.getSnapshotBeforeUpdate(Y,g),D.__reactInternalSnapshotBeforeUpdate=u}catch(ae){tn(b,b.return,ae)}}break;case 3:(u&1024)!==0&&On&&ug(l.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(s(163))}if(u=l.sibling,u!==null){u.return=l.return,Ki=u;break}Ki=l.return}}function Ty(l,u,g){var b=g.flags;switch(g.tag){case 0:case 11:case 15:lr(l,g),b&4&&xo(5,g);break;case 1:if(lr(l,g),b&4)if(l=g.stateNode,u===null)try{l.componentDidMount()}catch(Y){tn(g,g.return,Y)}else{var C=yo(g.type,u.memoizedProps);u=u.memoizedState;try{l.componentDidUpdate(C,u,l.__reactInternalSnapshotBeforeUpdate)}catch(Y){tn(g,g.return,Y)}}b&64&&Pu(g),b&512&&Lu(g,g.return);break;case 3:if(lr(l,g),b&64&&(b=g.updateQueue,b!==null)){if(l=null,g.child!==null)switch(g.child.tag){case 27:case 5:l=Wu(g.child.stateNode);break;case 1:l=g.child.stateNode}try{ir(b,l)}catch(Y){tn(g,g.return,Y)}}break;case 27:us&&u===null&&b&4&&My(g);case 26:case 5:if(lr(l,g),u===null){if(b&4)zc(g);else if(b&64){l=g.type,u=g.memoizedProps,C=g.stateNode;try{ov(C,l,u,g)}catch(Y){tn(g,g.return,Y)}}}b&512&&Lu(g,g.return);break;case 12:lr(l,g);break;case 31:lr(l,g),b&4&&ba(l,g);break;case 13:lr(l,g),b&4&&nf(l,g),b&64&&(b=g.memoizedState,b!==null&&(b=b.dehydrated,b!==null&&(g=lS.bind(null,g),jd(b,g))));break;case 22:if(b=g.memoizedState!==null||ki,!b){u=u!==null&&u.memoizedState!==null||Hi,C=ki;var D=Hi;ki=b,(Hi=u)&&!D?Ea(l,g,(g.subtreeFlags&8772)!==0):lr(l,g),ki=C,Hi=D}break;case 30:break;default:lr(l,g)}}function Gm(l){var u=l.alternate;u!==null&&(l.alternate=null,Gm(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&Fd(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function xa(l,u,g){for(g=g.child;g!==null;)tf(l,u,g),g=g.sibling}function tf(l,u,g){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Qc,g)}catch{}switch(g.tag){case 26:if(wa){Hi||Ys(g,u),xa(l,u,g),g.memoizedState?Yl(g.memoizedState):g.stateNode&&Tg(g.stateNode);break}case 27:if(us){Hi||Ys(g,u);var b=Li,C=Qi;Yc(g.type)&&(Li=g.stateNode,Qi=!1),xa(l,u,g),As(g.stateNode),Li=b,Qi=C;break}case 5:Hi||Ys(g,u);case 6:if(On){if(b=Li,C=Qi,Li=null,xa(l,u,g),Li=b,Qi=C,Li!==null)if(Qi)try{lg(Li,g.stateNode)}catch(D){tn(g,u,D)}else try{ky(Li,g.stateNode)}catch(D){tn(g,u,D)}}else xa(l,u,g);break;case 18:On&&Li!==null&&(Qi?Wd(Li,g.stateNode):xg(Li,g.stateNode));break;case 4:On?(b=Li,C=Qi,Li=g.stateNode.containerInfo,Qi=!0,xa(l,u,g),Li=b,Qi=C):(ta&&Hm(g.stateNode,g,hg()),xa(l,u,g));break;case 0:case 11:case 14:case 15:bo(2,g,u),Hi||bo(4,g,u),xa(l,u,g);break;case 1:Hi||(Ys(g,u),b=g.stateNode,typeof b.componentWillUnmount=="function"&&xd(g,u,b)),xa(l,u,g);break;case 21:xa(l,u,g);break;case 22:Hi=(b=Hi)||g.memoizedState!==null,xa(l,u,g),Hi=b;break;default:xa(l,u,g)}}function ba(l,u){if(wi&&u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{fS(l)}catch(g){tn(u,u.return,g)}}}function nf(l,u){if(wi&&u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{dS(l)}catch(g){tn(u,u.return,g)}}function Sa(l){switch(l.tag){case 31:case 13:case 19:var u=l.stateNode;return u===null&&(u=l.stateNode=new Og),u;case 22:return l=l.stateNode,u=l._retryCache,u===null&&(u=l._retryCache=new Og),u;default:throw Error(s(435,l.tag))}}function Jo(l,u){var g=Sa(l);u.forEach(function(b){if(!g.has(b)){g.add(b);var C=cS.bind(null,l,b);b.then(C,C)}})}function Ms(l,u){var g=u.deletions;if(g!==null)for(var b=0;b<g.length;b++){var C=g[b],D=l,Y=u;if(On){var ae=Y;e:for(;ae!==null;){switch(ae.tag){case 27:if(us){if(Yc(ae.type)){Li=ae.stateNode,Qi=!1;break e}break}case 5:Li=ae.stateNode,Qi=!1;break e;case 3:case 4:Li=ae.stateNode.containerInfo,Qi=!0;break e}ae=ae.return}if(Li===null)throw Error(s(160));tf(D,Y,C),Li=null,Qi=!1}else tf(D,Y,C);D=C.alternate,D!==null&&(D.return=null),C.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)sf(u,l),u=u.sibling}function sf(l,u){var g=l.alternate,b=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:Ms(u,l),Ts(l),b&4&&(bo(3,l,l.return),xo(3,l),bo(5,l,l.return));break;case 1:Ms(u,l),Ts(l),b&512&&(Hi||g===null||Ys(g,g.return)),b&64&&ki&&(l=l.updateQueue,l!==null&&(b=l.callbacks,b!==null&&(g=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=g===null?b:g.concat(b))));break;case 26:if(wa){var C=ai;if(Ms(u,l),Ts(l),b&512&&(Hi||g===null||Ys(g,g.return)),b&4){b=g!==null?g.memoizedState:null;var D=l.memoizedState;g===null?D===null?l.stateNode===null?l.stateNode=dv(C,l.type,l.memoizedProps,l):Mg(C,l.type,l.stateNode):l.stateNode=Eg(C,D,l.memoizedProps):b!==D?(b===null?g.stateNode!==null&&Tg(g.stateNode):Yl(b),D===null?Mg(C,l.type,l.stateNode):Eg(C,D,l.memoizedProps)):D===null&&l.stateNode!==null&&Jh(l,l.memoizedProps,g.memoizedProps)}break}case 27:if(us){Ms(u,l),Ts(l),b&512&&(Hi||g===null||Ys(g,g.return)),g!==null&&b&4&&Jh(l,l.memoizedProps,g.memoizedProps);break}case 5:if(Ms(u,l),Ts(l),b&512&&(Hi||g===null||Ys(g,g.return)),On){if(l.flags&32){C=l.stateNode;try{cg(C)}catch(et){tn(l,l.return,et)}}b&4&&l.stateNode!=null&&(C=l.memoizedProps,Jh(l,C,g!==null?g.memoizedProps:C)),b&1024&&($u=!0)}else ta&&l.alternate!==null&&(l.alternate.stateNode=l.stateNode);break;case 6:if(Ms(u,l),Ts(l),b&4&&On){if(l.stateNode===null)throw Error(s(162));b=l.memoizedProps,g=g!==null?g.memoizedProps:b,C=l.stateNode;try{Uy(C,g,b)}catch(et){tn(l,l.return,et)}}break;case 3:if(wa?(pv(),C=ai,ai=gf(u.containerInfo),Ms(u,l),ai=C):Ms(u,l),Ts(l),b&4){if(On&&wi&&g!==null&&g.memoizedState.isDehydrated)try{lv(u.containerInfo)}catch(et){tn(l,l.return,et)}if(ta){b=u.containerInfo,g=u.pendingChildren;try{dg(b,g)}catch(et){tn(l,l.return,et)}}}$u&&($u=!1,Sd(l));break;case 4:wa?(g=ai,ai=gf(l.stateNode.containerInfo),Ms(u,l),Ts(l),ai=g):(Ms(u,l),Ts(l)),b&4&&ta&&Hm(l.stateNode,l,l.stateNode.pendingChildren);break;case 12:Ms(u,l),Ts(l);break;case 31:Ms(u,l),Ts(l),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,Jo(l,b)));break;case 13:Ms(u,l),Ts(l),l.child.flags&8192&&l.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Af=Zs()),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,Jo(l,b)));break;case 22:C=l.memoizedState!==null;var Y=g!==null&&g.memoizedState!==null,ae=ki,De=Hi;if(ki=ae||C,Hi=De||Y,Ms(u,l),Hi=De,ki=ae,Ts(l),b&8192&&(u=l.stateNode,u._visibility=C?u._visibility&-2:u._visibility|1,C&&(g===null||Y||ki||Hi||Ol(l)),On)){e:if(g=null,On)for(u=l;;){if(u.tag===5||wa&&u.tag===26){if(g===null){Y=g=u;try{D=Y.stateNode,C?uS(D):Gy(Y.stateNode,Y.memoizedProps)}catch(et){tn(Y,Y.return,et)}}}else if(u.tag===6){if(g===null){Y=u;try{var Ke=Y.stateNode;C?Hy(Ke):jy(Ke,Y.memoizedProps)}catch(et){tn(Y,Y.return,et)}}}else if(u.tag===18){if(g===null){Y=u;try{var ft=Y.stateNode;C?uv(ft):hv(Y.stateNode)}catch(et){tn(Y,Y.return,et)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;g===u&&(g=null),u=u.return}g===u&&(g=null),u.sibling.return=u.return,u=u.sibling}}b&4&&(b=l.updateQueue,b!==null&&(g=b.retryQueue,g!==null&&(b.retryQueue=null,Jo(l,g))));break;case 19:Ms(u,l),Ts(l),b&4&&(b=l.updateQueue,b!==null&&(l.updateQueue=null,Jo(l,b)));break;case 30:break;case 21:break;default:Ms(u,l),Ts(l)}}function Ts(l){var u=l.flags;if(u&2){try{for(var g,b=l.return;b!==null;){if(km(b)){g=b;break}b=b.return}if(On){if(g==null)throw Error(s(160));switch(g.tag){case 27:if(us){var C=g.stateNode,D=$o(l);ef(l,D,C);break}case 5:var Y=g.stateNode;g.flags&32&&(cg(Y),g.flags&=-33);var ae=$o(l);ef(l,ae,Y);break;case 3:case 4:var De=g.stateNode.containerInfo,Ke=$o(l);bd(l,Ke,De);break;default:throw Error(s(161))}}}catch(ft){tn(l,l.return,ft)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function Sd(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var u=l;Sd(u),u.tag===5&&u.flags&1024&&ng(u.stateNode),l=l.sibling}}function lr(l,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Ty(l,u.alternate,u),u=u.sibling}function Ol(l){for(l=l.child;l!==null;){var u=l;switch(u.tag){case 0:case 11:case 14:case 15:bo(4,u,u.return),Ol(u);break;case 1:Ys(u,u.return);var g=u.stateNode;typeof g.componentWillUnmount=="function"&&xd(u,u.return,g),Ol(u);break;case 27:us&&As(u.stateNode);case 26:case 5:Ys(u,u.return),Ol(u);break;case 22:u.memoizedState===null&&Ol(u);break;case 30:Ol(u);break;default:Ol(u)}l=l.sibling}}function Ea(l,u,g){for(g=g&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var b=u.alternate,C=l,D=u,Y=D.flags;switch(D.tag){case 0:case 11:case 15:Ea(C,D,g),xo(4,D);break;case 1:if(Ea(C,D,g),b=D,C=b.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(Ke){tn(b,b.return,Ke)}if(b=D,C=b.updateQueue,C!==null){var ae=b.stateNode;try{var De=C.shared.hiddenCallbacks;if(De!==null)for(C.shared.hiddenCallbacks=null,C=0;C<De.length;C++)Yr(De[C],ae)}catch(Ke){tn(b,b.return,Ke)}}g&&Y&64&&Pu(D),Lu(D,D.return);break;case 27:us&&My(D);case 26:case 5:Ea(C,D,g),g&&b===null&&Y&4&&zc(D),Lu(D,D.return);break;case 12:Ea(C,D,g);break;case 31:Ea(C,D,g),g&&Y&4&&ba(C,D);break;case 13:Ea(C,D,g),g&&Y&4&&nf(C,D);break;case 22:D.memoizedState===null&&Ea(C,D,g),Lu(D,D.return);break;case 30:break;default:Ea(C,D,g)}u=u.sibling}}function Ul(l,u){var g=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),l=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(l=u.memoizedState.cachePool.pool),l!==g&&(l!=null&&l.refCount++,g!=null&&Fe(g))}function jm(l,u){l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&Fe(l))}function Ii(l,u,g,b){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)Ed(l,u,g,b),u=u.sibling}function Ed(l,u,g,b){var C=u.flags;switch(u.tag){case 0:case 11:case 15:Ii(l,u,g,b),C&2048&&xo(9,u);break;case 1:Ii(l,u,g,b);break;case 3:Ii(l,u,g,b),C&2048&&(l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&Fe(l)));break;case 12:if(C&2048){Ii(l,u,g,b),l=u.stateNode;try{var D=u.memoizedProps,Y=D.id,ae=D.onPostCommit;typeof ae=="function"&&ae(Y,u.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(De){tn(u,u.return,De)}}else Ii(l,u,g,b);break;case 31:Ii(l,u,g,b);break;case 13:Ii(l,u,g,b);break;case 23:break;case 22:D=u.stateNode,Y=u.alternate,u.memoizedState!==null?D._visibility&2?Ii(l,u,g,b):Ou(l,u):D._visibility&2?Ii(l,u,g,b):(D._visibility|=2,Ar(l,u,g,b,(u.subtreeFlags&10256)!==0||!1)),C&2048&&Ul(Y,u);break;case 24:Ii(l,u,g,b),C&2048&&jm(u.alternate,u);break;default:Ii(l,u,g,b)}}function Ar(l,u,g,b,C){for(C=C&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var D=l,Y=u,ae=g,De=b,Ke=Y.flags;switch(Y.tag){case 0:case 11:case 15:Ar(D,Y,ae,De,C),xo(8,Y);break;case 23:break;case 22:var ft=Y.stateNode;Y.memoizedState!==null?ft._visibility&2?Ar(D,Y,ae,De,C):Ou(D,Y):(ft._visibility|=2,Ar(D,Y,ae,De,C)),C&&Ke&2048&&Ul(Y.alternate,Y);break;case 24:Ar(D,Y,ae,De,C),C&&Ke&2048&&jm(Y.alternate,Y);break;default:Ar(D,Y,ae,De,C)}u=u.sibling}}function Ou(l,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var g=l,b=u,C=b.flags;switch(b.tag){case 22:Ou(g,b),C&2048&&Ul(b.alternate,b);break;case 24:Ou(g,b),C&2048&&jm(b.alternate,b);break;default:Ou(g,b)}u=u.sibling}}function So(l,u,g){if(l.subtreeFlags&ra)for(l=l.child;l!==null;)zl(l,u,g),l=l.sibling}function zl(l,u,g){switch(l.tag){case 26:if(So(l,u,g),l.flags&ra)if(l.memoizedState!==null)mv(g,ai,l.memoizedState,l.memoizedProps);else{var b=l.stateNode,C=l.type;l=l.memoizedProps,((u&335544128)===u||eg(C,l))&&Bd(g,b,C,l)}break;case 5:So(l,u,g),l.flags&ra&&(b=l.stateNode,C=l.type,l=l.memoizedProps,((u&335544128)===u||eg(C,l))&&Bd(g,b,C,l));break;case 3:case 4:wa?(b=ai,ai=gf(l.stateNode.containerInfo),So(l,u,g),ai=b):So(l,u,g);break;case 22:l.memoizedState===null&&(b=l.alternate,b!==null&&b.memoizedState!==null?(b=ra,ra=16777216,So(l,u,g),ra=b):So(l,u,g));break;default:So(l,u,g)}}function Md(l){var u=l.alternate;if(u!==null&&(l=u.child,l!==null)){u.child=null;do u=l.sibling,l.sibling=null,l=u;while(l!==null)}}function Uu(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var b=u[g];Ki=b,$r(b,l)}Md(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Td(l),l=l.sibling}function Td(l){switch(l.tag){case 0:case 11:case 15:Uu(l),l.flags&2048&&bo(9,l,l.return);break;case 3:Uu(l);break;case 12:Uu(l);break;case 22:var u=l.stateNode;l.memoizedState!==null&&u._visibility&2&&(l.return===null||l.return.tag!==13)?(u._visibility&=-3,rf(l)):Uu(l);break;default:Uu(l)}}function rf(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var g=0;g<u.length;g++){var b=u[g];Ki=b,$r(b,l)}Md(l)}for(l=l.child;l!==null;){switch(u=l,u.tag){case 0:case 11:case 15:bo(8,u,u.return),rf(u);break;case 22:g=u.stateNode,g._visibility&2&&(g._visibility&=-3,rf(u));break;default:rf(u)}l=l.sibling}}function $r(l,u){for(;Ki!==null;){var g=Ki;switch(g.tag){case 0:case 11:case 15:bo(8,g,u);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var b=g.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:Fe(g.memoizedState.cache)}if(b=g.child,b!==null)b.return=g,Ki=b;else e:for(g=l;Ki!==null;){b=Ki;var C=b.sibling,D=b.return;if(Gm(b),b===g){Ki=null;break e}if(C!==null){C.return=D,Ki=C;break e}Ki=D}}}function Fl(l){var u=pn(l);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(s(364));return u}if(l=Yi(l),l===null)throw Error(s(362));return l.stateNode.current}function Bl(l,u){var g=l.tag;switch(u.$$typeof){case Oa:if(l.type===u.value)return!0;break;case eh:e:{for(u=u.value,l=[l,0],g=0;g<l.length;){var b=l[g++],C=b.tag,D=l[g++],Y=u[D];if(C!==5&&C!==26&&C!==27||!ql(b)){for(;Y!=null&&Bl(b,Y);)D++,Y=u[D];if(D===u.length){u=!0;break e}else for(b=b.child;b!==null;)l.push(b,D),b=b.sibling}}u=!1}return u;case th:if((g===5||g===26||g===27)&&rg(l.stateNode,u.value))return!0;break;case ec:if((g===5||g===6||g===26||g===27)&&(l=pf(l),l!==null&&0<=l.indexOf(u.value)))return!0;break;case Mf:if((g===5||g===26||g===27)&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function zu(l){switch(l.$$typeof){case Oa:return"<"+(v(l.value)||"Unknown")+">";case eh:return":has("+(zu(l)||"")+")";case th:return'[role="'+l.value+'"]';case ec:return'"'+l.value+'"';case Mf:return'[data-testname="'+l.value+'"]';default:throw Error(s(365))}}function Fu(l,u){var g=[];l=[l,0];for(var b=0;b<l.length;){var C=l[b++],D=C.tag,Y=l[b++],ae=u[Y];if(D!==5&&D!==26&&D!==27||!ql(C)){for(;ae!=null&&Bl(C,ae);)Y++,ae=u[Y];if(Y===u.length)g.push(C);else for(C=C.child;C!==null;)l.push(C,Y),C=C.sibling}}return g}function wr(l,u){if(!cs)throw Error(s(363));l=Fl(l),l=Fu(l,u),u=[],l=Array.from(l);for(var g=0;g<l.length;){var b=l[g++],C=b.tag;if(C===5||C===26||C===27)ql(b)||u.push(b.stateNode);else for(b=b.child;b!==null;)l.push(b),b=b.sibling}return u}function Ai(){return(Rn&2)!==0&&Pn!==0?Pn&-Pn:Wt.T!==null?xe():Xu()}function el(){if(pr===0)if((Pn&536870912)===0||Nn){var l=Kc;Kc<<=1,(Kc&3932160)===0&&(Kc=262144),pr=l}else pr=536870912;return l=Pr.current,l!==null&&(l.flags|=32),pr}function Di(l,u,g){(l===Mn&&(oi===2||oi===9)||l.cancelPendingCommit!==null)&&(Bi(l,0),Mo(l,Pn,pr,!1)),j(l,g),((Rn&2)===0||l!==Mn)&&(l===Mn&&((Rn&2)===0&&(ic|=g),Oi===4&&Mo(l,Pn,pr,!1)),vt(l))}function Ja(l,u,g){if((Rn&6)!==0)throw Error(s(327));var b=!g&&(u&127)===0&&(u&l.expiredLanes)===0||N(l,u),C=b?Cy(l,u):To(l,u,!0),D=b;do{if(C===0){tc&&!b&&Mo(l,u,0,!1);break}else{if(g=l.current.alternate,D&&!Ay(g)){C=To(l,u,!1),D=!1;continue}if(C===2){if(D=u,l.errorRecoveryDisabledLanes&D)var Y=0;else Y=l.pendingLanes&-536870913,Y=Y!==0?Y:Y&536870912?536870912:0;if(Y!==0){u=Y;e:{var ae=l;C=Tf;var De=wi&&ae.current.memoizedState.isDehydrated;if(De&&(Bi(ae,Y).flags|=256),Y=To(ae,Y,!1),Y!==2){if(nc&&!De){ae.errorRecoveryDisabledLanes|=D,ic|=D,C=4;break e}D=Or,Or=C,D!==null&&(Or===null?Or=D:Or.push.apply(Or,D))}C=Y}if(D=!1,C!==2)continue}}if(C===1){Bi(l,0),Mo(l,u,0,!0);break}e:{switch(b=l,D=C,D){case 0:case 1:throw Error(s(345));case 4:if((u&4194048)!==u)break;case 6:Mo(b,u,pr,!io);break e;case 2:Or=null;break;case 3:case 5:break;default:throw Error(s(329))}if((u&62914560)===u&&(C=Af+300-Zs(),10<C)){if(Mo(b,u,pr,!io),A(b,0,!0)!==0)break e;Bo=u,b.timeoutHandle=Jm(Eo.bind(null,b,g,Or,wf,op,u,pr,ic,ih,io,D,"Throttled",-0,0),C);break e}Eo(b,g,Or,wf,op,u,pr,ic,ih,io,D,null,-0,0)}}break}while(!0);vt(l)}function Eo(l,u,g,b,C,D,Y,ae,De,Ke,ft,et,At,dn){if(l.timeoutHandle=Ir,et=u.subtreeFlags,et&8192||(et&16785408)===16785408){et=tg(),zl(u,D,et);var $i=(D&62914560)===D?Af-Zs():(D&4194048)===D?iu-Zs():0;if($i=Oy(et,$i),$i!==null){Bo=D,l.cancelPendingCommit=$i(wo.bind(null,l,u,D,g,b,C,Y,ae,De,ft,et,null,At,dn)),Mo(l,D,Y,!Ke);return}}wo(l,u,D,g,b,C,Y,ae,De)}function Ay(l){for(var u=l;;){var g=u.tag;if((g===0||g===11||g===15)&&u.flags&16384&&(g=u.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var b=0;b<g.length;b++){var C=g[b],D=C.getSnapshot;C=C.value;try{if(!Zi(D(),C))return!1}catch{return!1}}if(g=u.child,u.subtreeFlags&16384&&g!==null)g.return=u,u=g;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Mo(l,u,g,b){u&=~nh,u&=~ic,l.suspendedLanes|=u,l.pingedLanes&=~u,b&&(l.warmLanes|=u),b=l.expirationTimes;for(var C=u;0<C;){var D=31-Dr(C),Y=1<<D;b[D]=-1,C&=~Y}g!==0&&R(l,g,u)}function Ad(){return(Rn&6)===0?(rt(0),!1):!0}function wd(){if(In!==null){if(oi===0)var l=In.return;else l=In,to=mi=null,Ut(l),Ql=null,$c=0,l=In;for(;l!==null;)Ey(l.alternate,l),l=l.return;In=null}}function Bi(l,u){var g=l.timeoutHandle;g!==Ir&&(l.timeoutHandle=Ir,Ly(g)),g=l.cancelPendingCommit,g!==null&&(l.cancelPendingCommit=null,g()),Bo=0,wd(),Mn=l,In=g=ea(l.current,null),Pn=u,oi=0,rs=null,io=!1,tc=N(l,u),nc=!1,ih=pr=nh=ic=fl=Oi=0,Or=Tf=null,op=!1,(u&8)!==0&&(u|=u&32);var b=l.entangledLanes;if(b!==0)for(l=l.entanglements,b&=u;0<b;){var C=31-Dr(b),D=1<<C;u|=l[C],b&=~D}return Fo=u,qr(),g}function pi(l,u){mn=null,Wt.H=sa,u===ds||u===Pa?(u=nn(),oi=3):u===rp?(u=nn(),oi=4):oi=u===dr?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,rs=u,In===null&&(Oi=1,Pc(l,be(u,l.current)))}function Ln(){var l=Pr.current;return l===null?!0:(Pn&4194048)===Pn?Lr===null:(Pn&62914560)===Pn||(Pn&536870912)!==0?l===Lr:!1}function tl(){var l=Wt.H;return Wt.H=sa,l===null?sa:l}function Jr(){var l=Wt.A;return Wt.A=Ju,l}function Bu(){Oi=4,io||(Pn&4194048)!==Pn&&Pr.current!==null||(tc=!0),(fl&134217727)===0&&(ic&134217727)===0||Mn===null||Mo(Mn,Pn,pr,!1)}function To(l,u,g){var b=Rn;Rn|=2;var C=tl(),D=Jr();(Mn!==l||Pn!==u)&&(wf=null,Bi(l,u)),u=!1;var Y=Oi;e:do try{if(oi!==0&&In!==null){var ae=In,De=rs;switch(oi){case 8:wd(),Y=6;break e;case 3:case 2:case 9:case 6:Pr.current===null&&(u=!0);var Ke=oi;if(oi=0,rs=null,Ao(l,ae,De,Ke),g&&tc){Y=0;break e}break;default:Ke=oi,oi=0,rs=null,Ao(l,ae,De,Ke)}}wy(),Y=Oi;break}catch(ft){pi(l,ft)}while(!0);return u&&l.shellSuspendCounter++,to=mi=null,Rn=b,Wt.H=C,Wt.A=D,In===null&&(Mn=null,Pn=0,qr()),Y}function wy(){for(;In!==null;)Vl(In)}function Cy(l,u){var g=Rn;Rn|=2;var b=tl(),C=Jr();Mn!==l||Pn!==u?(wf=null,sc=Zs()+500,Bi(l,u)):tc=N(l,u);e:do try{if(oi!==0&&In!==null){u=In;var D=rs;t:switch(oi){case 1:oi=0,rs=null,Ao(l,u,D,1);break;case 2:case 9:if(dt(D)){oi=0,rs=null,Cd(u);break}u=function(){oi!==2&&oi!==9||Mn!==l||(oi=7),vt(l)},D.then(u,u);break e;case 3:oi=7;break e;case 4:oi=5;break e;case 7:dt(D)?(oi=0,rs=null,Cd(u)):(oi=0,rs=null,Ao(l,u,D,7));break;case 5:var Y=null;switch(In.tag){case 26:Y=In.memoizedState;case 5:case 27:var ae=In,De=ae.type,Ke=ae.pendingProps;if(Y?wg(Y):Ni(ae.stateNode,De,Ke)){oi=0,rs=null;var ft=ae.sibling;if(ft!==null)In=ft;else{var et=ae.return;et!==null?(In=et,ku(et)):In=null}break t}}oi=0,rs=null,Ao(l,u,D,5);break;case 6:oi=0,rs=null,Ao(l,u,D,6);break;case 8:wd(),Oi=6;break e;default:throw Error(s(462))}}Vu();break}catch(At){pi(l,At)}while(!0);return to=mi=null,Wt.H=b,Wt.A=C,Rn=g,In!==null?0:(Mn=null,Pn=0,qr(),Oi)}function Vu(){for(;In!==null&&!yv();)Vl(In)}function Vl(l){var u=zm(l.alternate,l,Fo);l.memoizedProps=l.pendingProps,u===null?ku(l):In=u}function Cd(l){var u=l,g=u.alternate;switch(u.tag){case 15:case 0:u=Lc(g,u,u.pendingProps,u.type,void 0,Pn);break;case 11:u=Lc(g,u,u.pendingProps,u.type.render,u.ref,Pn);break;case 5:Ut(u);default:Ey(g,u),u=In=Dd(u,Fo),u=zm(g,u,Fo)}l.memoizedProps=l.pendingProps,u===null?ku(l):In=u}function Ao(l,u,g,b){to=mi=null,Ut(u),Ql=null,$c=0;var C=u.return;try{if($(l,C,u,g,Pn)){Oi=1,Pc(l,be(g,l.current)),In=null;return}}catch(D){if(C!==null)throw In=C,D;Oi=1,Pc(l,be(g,l.current)),In=null;return}u.flags&32768?(Nn||b===1?l=!0:tc||(Pn&536870912)!==0?l=!1:(io=l=!0,(b===2||b===9||b===3||b===6)&&(b=Pr.current,b!==null&&b.tag===13&&(b.flags|=16384))),kl(u,l)):ku(u)}function ku(l){var u=l;do{if((u.flags&32768)!==0){kl(u,io);return}l=u.return;var g=Sy(u.alternate,u,Fo);if(g!==null){In=g;return}if(u=u.sibling,u!==null){In=u;return}In=u=l}while(u!==null);Oi===0&&(Oi=5)}function kl(l,u){do{var g=Vm(l.alternate,l);if(g!==null){g.flags&=32767,In=g;return}if(g=l.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!u&&(l=l.sibling,l!==null)){In=l;return}In=l=g}while(l!==null);Oi=6,In=null}function wo(l,u,g,b,C,D,Y,ae,De){l.cancelPendingCommit=null;do Ro();while(as!==0);if((Rn&6)!==0)throw Error(s(327));if(u!==null){if(u===l.current)throw Error(s(177));if(D=u.lanes|u.childLanes,D|=Jc,F(l,g,D,Y,ae,De),l===Mn&&(In=Mn=null,Pn=0),su=u,pl=l,Bo=g,sh=D,lp=C,Ug=b,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,is(vf,function(){return af(),null})):(l.callbackNode=null,l.callbackPriority=0),b=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||b){b=Wt.T,Wt.T=null,C=Aa(),Dn(2),Y=Rn,Rn|=4;try{oS(l,u,g)}finally{Rn=Y,Dn(C),Wt.T=b}}as=1,nl(),Co(),Rd()}}function nl(){if(as===1){as=0;var l=pl,u=su,g=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||g){g=Wt.T,Wt.T=null;var b=Aa();Dn(2);var C=Rn;Rn|=4;try{sf(u,l),Py(l.containerInfo)}finally{Rn=C,Dn(b),Wt.T=g}}l.current=u,as=2}}function Co(){if(as===2){as=0;var l=pl,u=su,g=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||g){g=Wt.T,Wt.T=null;var b=Aa();Dn(2);var C=Rn;Rn|=4;try{Ty(l,u.alternate,u)}finally{Rn=C,Dn(b),Wt.T=g}}as=3}}function Rd(){if(as===4||as===3){as=0,Rg();var l=pl,u=su,g=Bo,b=Ug;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?as=5:(as=0,su=pl=null,Id(l,l.pendingLanes));var C=l.pendingLanes;if(C===0&&(dl=null),X(g),u=u.stateNode,Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Qc,u,void 0,(u.current.flags&128)===128)}catch{}if(b!==null){u=Wt.T,C=Aa(),Dn(2),Wt.T=null;try{for(var D=l.onRecoverableError,Y=0;Y<b.length;Y++){var ae=b[Y];D(ae.value,{componentStack:ae.stack})}}finally{Wt.T=u,Dn(C)}}(Bo&3)!==0&&Ro(),vt(l),C=l.pendingLanes,(g&261930)!==0&&(C&42)!==0?l===Cf?jn++:(jn=0,Cf=l):jn=0,wi&&mf(),rt(0)}}function Id(l,u){(l.pooledCacheLanes&=u)===0&&(u=l.pooledCache,u!=null&&(l.pooledCache=null,Fe(u)))}function Ro(){return nl(),Co(),Rd(),af()}function af(){if(as!==5)return!1;var l=pl,u=sh;sh=0;var g=X(Bo),b=32>g?32:g;g=Wt.T;var C=Aa();try{Dn(b),Wt.T=null,b=lp,lp=null;var D=pl,Y=Bo;if(as=0,su=pl=null,Bo=0,(Rn&6)!==0)throw Error(s(331));var ae=Rn;if(Rn|=4,Td(D.current),Ed(D,D.current,Y,b),Rn=ae,rt(0,!1),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Qc,D)}catch{}return!0}finally{Dn(C),Wt.T=g,Id(l,u)}}function Hl(l,u,g){u=be(g,u),u=_(l.stateNode,u,2),l=Xr(l,u,2),l!==null&&(j(l,2),vt(l))}function tn(l,u,g){if(l.tag===3)Hl(l,l,g);else for(;u!==null;){if(u.tag===3){Hl(u,l,g);break}else if(u.tag===1){var b=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(dl===null||!dl.has(b))){l=be(g,l),g=L(2),b=Xr(u,g,2),b!==null&&(V(g,b,u,l),j(b,2),vt(b));break}}u=u.return}}function Hu(l,u,g){var b=l.pingCache;if(b===null){b=l.pingCache=new aa;var C=new Set;b.set(u,C)}else C=b.get(u),C===void 0&&(C=new Set,b.set(u,C));C.has(g)||(nc=!0,C.add(g),l=Ry.bind(null,l,u,g),u.then(l,l))}function Ry(l,u,g){var b=l.pingCache;b!==null&&b.delete(u),l.pingedLanes|=l.suspendedLanes&g,l.warmLanes&=~g,Mn===l&&(Pn&g)===g&&(Oi===4||Oi===3&&(Pn&62914560)===Pn&&300>Zs()-Af?(Rn&2)===0&&Bi(l,0):nh|=g,ih===Pn&&(ih=0)),vt(l)}function Iy(l,u){u===0&&(u=U()),l=ji(l,u),l!==null&&(j(l,u),vt(l))}function lS(l){var u=l.memoizedState,g=0;u!==null&&(g=u.retryLane),Iy(l,g)}function cS(l,u){var g=0;switch(l.tag){case 31:case 13:var b=l.stateNode,C=l.memoizedState;C!==null&&(g=C.retryLane);break;case 19:b=l.stateNode;break;case 22:b=l.stateNode._retryCache;break;default:throw Error(s(314))}b!==null&&b.delete(u),Iy(l,g)}function is(l,u){return yf(l,u)}function Wm(l,u,g,b){this.tag=l,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fc(l){return l=l.prototype,!(!l||!l.isReactComponent)}function ea(l,u){var g=l.alternate;return g===null?(g=t(l.tag,u,l.key,l.mode),g.elementType=l.elementType,g.type=l.type,g.stateNode=l.stateNode,g.alternate=l,l.alternate=g):(g.pendingProps=u,g.type=l.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=l.flags&65011712,g.childLanes=l.childLanes,g.lanes=l.lanes,g.child=l.child,g.memoizedProps=l.memoizedProps,g.memoizedState=l.memoizedState,g.updateQueue=l.updateQueue,u=l.dependencies,g.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},g.sibling=l.sibling,g.index=l.index,g.ref=l.ref,g.refCleanup=l.refCleanup,g}function Dd(l,u){l.flags&=65011714;var g=l.alternate;return g===null?(l.childLanes=0,l.lanes=u,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=g.childLanes,l.lanes=g.lanes,l.child=g.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=g.memoizedProps,l.memoizedState=g.memoizedState,l.updateQueue=g.updateQueue,l.type=g.type,u=g.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l}function il(l,u,g,b,C,D){var Y=0;if(b=l,typeof l=="function")Fc(l)&&(Y=1);else if(typeof l=="string")Y=wa&&us?qd(l,g,ws.current)?26:Cg(l)?27:5:wa?qd(l,g,ws.current)?26:5:us&&Cg(l)?27:5;else e:switch(l){case uf:return l=t(31,g,u,C),l.elementType=uf,l.lanes=D,l;case Hc:return Ma(g.children,C,D,u);case Gc:Y=8,C|=24;break;case jc:return l=t(12,g,u,C|2),l.elementType=jc,l.lanes=D,l;case Od:return l=t(13,g,u,C),l.elementType=Od,l.lanes=D,l;case sl:return l=t(19,g,u,C),l.elementType=sl,l.lanes=D,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case Ta:Y=10;break e;case cf:Y=9;break e;case Gu:Y=11;break e;case Ud:Y=14;break e;case cr:Y=16,b=null;break e}Y=29,g=Error(s(130,l===null?"null":typeof l,"")),b=null}return u=t(Y,g,u,C),u.elementType=l,u.type=b,u.lanes=D,u}function Ma(l,u,g,b){return l=t(7,l,b,u),l.lanes=g,l}function qm(l,u,g){return l=t(6,l,null,u),l.lanes=g,l}function Xm(l){var u=t(18,null,null,0);return u.stateNode=l,u}function Ym(l,u,g){return u=t(4,l.children!==null?l.children:[],l.key,u),u.lanes=g,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function Dy(l,u,g,b,C,D,Y,ae,De){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ir,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=q(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=q(0),this.hiddenUpdates=q(null),this.identifierPrefix=b,this.onUncaughtError=C,this.onCaughtError=D,this.onRecoverableError=Y,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function Gl(l,u,g,b,C,D,Y,ae,De,Ke,ft,et){return l=new Dy(l,u,g,Y,De,Ke,ft,et,ae),u=1,D===!0&&(u|=24),D=t(3,null,null,u),l.current=D,D.stateNode=l,u=Ae(),u.refCount++,l.pooledCache=u,u.refCount++,D.memoizedState={element:b,isDehydrated:g,cache:u},_i(D),l}function Nd(l){return l?(l=Do,l):Do}function of(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(s(188)):(l=Object.keys(l).join(","),Error(s(268,l)));return l=f(u),l=l!==null?d(l):null,l===null?null:Wu(l.stateNode)}function Zm(l,u,g,b,C,D){C=Nd(C),b.context===null?b.context=C:b.pendingContext=C,b=bs(u),b.payload={element:g},D=D===void 0?null:D,D!==null&&(b.callback=D),g=Xr(l,b,u),g!==null&&(Di(g,l,u),Wa(g,l,u))}function Bc(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var g=l.retryLane;l.retryLane=g!==0&&g<u?g:u}}function lf(l,u){Bc(l,u),(l=l.alternate)&&Bc(l,u)}var Sn={},Pd=UR,Cr=n6,Ld=Object.assign,Vc=Symbol.for("react.element"),Io=Symbol.for("react.transitional.element"),kc=Symbol.for("react.portal"),Hc=Symbol.for("react.fragment"),Gc=Symbol.for("react.strict_mode"),jc=Symbol.for("react.profiler"),cf=Symbol.for("react.consumer"),Ta=Symbol.for("react.context"),Gu=Symbol.for("react.forward_ref"),Od=Symbol.for("react.suspense"),sl=Symbol.for("react.suspense_list"),Ud=Symbol.for("react.memo"),cr=Symbol.for("react.lazy"),uf=Symbol.for("react.activity"),Km=Symbol.for("react.memo_cache_sentinel"),rl=Symbol.iterator,jl=Symbol.for("react.client.reference"),Wl=Array.isArray,Wt=Pd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Qm=e.rendererVersion,hf=e.rendererPackageName,ju=e.extraDevToolsConfig,Wu=e.getPublicInstance,Ny=e.getRootHostContext,qu=e.getChildHostContext,zd=e.prepareForCommit,Py=e.resetAfterCommit,$m=e.createInstance;e.cloneMutableInstance;var ff=e.appendInitialChild,Rr=e.finalizeInitialChildren,ur=e.shouldSetTextContent,al=e.createTextInstance;e.cloneMutableTextInstance;var Jm=e.scheduleTimeout,Ly=e.cancelTimeout,Ir=e.noTimeout,Xi=e.isPrimaryRenderer;e.warnsIfNotActing;var On=e.supportsMutation,ta=e.supportsPersistence,wi=e.supportsHydration,pn=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var ci=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Dn=e.setCurrentUpdatePriority,Aa=e.getCurrentUpdatePriority,Xu=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var Wc=e.shouldAttemptEagerTransition,Fd=e.detachDeletedInstance;e.requestPostPaintCallback;var df=e.maySuspendCommit,Yu=e.maySuspendCommitOnUpdate,eg=e.maySuspendCommitInSyncRender,Ni=e.preloadInstance,tg=e.startSuspendingCommit,Bd=e.suspendInstance;e.suspendOnActiveViewTransition;var Oy=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var qc=e.NotPendingTransition,Xc=e.HostTransitionContext,ng=e.resetFormInstance;e.bindToConsole;var ig=e.supportsMicrotasks,sg=e.scheduleMicrotask,cs=e.supportsTestSelectors,Yi=e.findFiberRoot,Vd=e.getBoundingRect,pf=e.getTextContent,ql=e.isHiddenSubtree,rg=e.matchAccessibilityRole,ol=e.setFocusIfFocusable,kd=e.setupIntersectionObserver,ag=e.appendChild,og=e.appendChildToContainer,Uy=e.commitTextUpdate,zy=e.commitMount,Fy=e.commitUpdate,By=e.insertBefore,Vy=e.insertInContainerBefore,ky=e.removeChild,lg=e.removeChildFromContainer,cg=e.resetTextContent,uS=e.hideInstance,Hy=e.hideTextInstance,Gy=e.unhideInstance,jy=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var ug=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var Wy=e.cloneInstance,hg=e.createContainerChildSet,fg=e.appendChildToContainerChildSet,qy=e.finalizeContainerChildren,dg=e.replaceContainerChildren,Xy=e.cloneHiddenInstance,pg=e.cloneHiddenTextInstance,Xl=e.isSuspenseInstancePending,Hd=e.isSuspenseInstanceFallback,Gd=e.getSuspenseInstanceFallbackErrorDetails,jd=e.registerSuspenseInstanceRetry,Yy=e.canHydrateFormStateMarker,mg=e.isFormStateMarkerMatching,Zy=e.getNextHydratableSibling,Ky=e.getNextHydratableSiblingAfterSingleton,Qy=e.getFirstHydratableChild,$y=e.getFirstHydratableChildWithinContainer,Jy=e.getFirstHydratableChildWithinActivityInstance,ev=e.getFirstHydratableChildWithinSuspenseInstance,gg=e.getFirstHydratableChildWithinSingleton,tv=e.canHydrateInstance,nv=e.canHydrateTextInstance,yg=e.canHydrateActivityInstance,iv=e.canHydrateSuspenseInstance,sv=e.hydrateInstance,hS=e.hydrateTextInstance,vg=e.hydrateActivityInstance,rv=e.hydrateSuspenseInstance,av=e.getNextHydratableInstanceAfterActivityInstance,_g=e.getNextHydratableInstanceAfterSuspenseInstance,ov=e.commitHydratedInstance,lv=e.commitHydratedContainer,fS=e.commitHydratedActivityInstance,dS=e.commitHydratedSuspenseInstance,cv=e.finalizeHydratedChildren,mf=e.flushHydrationEvents;e.clearActivityBoundary;var xg=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var Wd=e.clearSuspenseBoundaryFromContainer,uv=e.hideDehydratedBoundary,hv=e.unhideDehydratedBoundary,Zu=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var fv=e.validateHydratableInstance,bg=e.validateHydratableTextInstance,wa=e.supportsResources,qd=e.isHostHoistableType,gf=e.getHoistableRoot,Sg=e.getResource,Eg=e.acquireResource,Yl=e.releaseResource,dv=e.hydrateHoistable,Mg=e.mountHoistable,Tg=e.unmountHoistable,Xd=e.createHoistableInstance,pv=e.prepareToCommitHoistables,Ag=e.mayResourceSuspendCommit,wg=e.preloadResource,mv=e.suspendResource,us=e.supportsSingletons,Yd=e.resolveSingletonInstance,ss=e.acquireSingletonInstance,As=e.releaseSingletonInstance,Cg=e.isHostSingletonType,Yc=e.isSingletonScope,Zd=[],Zc=-1,Do={},Dr=Math.clz32?Math.clz32:I,Kd=Math.log,gv=Math.LN2,Qd=256,Kc=262144,Ku=4194304,yf=Cr.unstable_scheduleCallback,$d=Cr.unstable_cancelCallback,yv=Cr.unstable_shouldYield,Rg=Cr.unstable_requestPaint,Zs=Cr.unstable_now,Jd=Cr.unstable_ImmediatePriority,vv=Cr.unstable_UserBlockingPriority,vf=Cr.unstable_NormalPriority,ep=Cr.unstable_IdlePriority,Ig=Cr.log,_v=Cr.unstable_setDisableYieldValue,Qc=null,Nr=null,Zi=typeof Object.is=="function"?Object.is:ue,tp=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},pS=Object.prototype.hasOwnProperty,np,No,_f=!1,Dg=new WeakMap,ll=[],Po=0,ui=null,xf=0,Ca=[],na=0,Ra=null,Os=1,eo="",ws=x(null),cl=x(null),Us=x(null),bf=x(null),hs=null,Ci=null,Nn=!1,Lo=null,hr=!1,ip=Error(s(519)),Ia=x(null),mi=null,to=null,xv=typeof AbortController<"u"?AbortController:function(){var l=[],u=this.signal={aborted:!1,addEventListener:function(g,b){l.push(b)}};this.abort=function(){u.aborted=!0,l.forEach(function(g){return g()})}},Cs=Cr.unstable_scheduleCallback,mS=Cr.unstable_NormalPriority,Ri={$$typeof:Ta,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Sf=null,ri=null,Ks=!1,Da=!1,sp=!1,Zl=0,Qu=null,Ng=0,ul=0,fs=null,Na=Wt.S;Wt.S=function(l,u){iu=Zs(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&at(l,u),Na!==null&&Na(l,u)};var Kl=x(null),ds=Error(s(460)),rp=Error(s(474)),Pa=Error(s(542)),Oo={then:function(){}},fr=null,Ql=null,$c=0,zs=Tl(!0),Pg=Tl(!1),Fs=[],Uo=0,Jc=0,ia=!1,ap=!1,eu=x(null),$l=x(0),Pr=x(null),Lr=null,Vi=x(0),hl=0,mn=null,kt=null,ln=null,En=!1,_n=!1,Fn=!1,Qs=0,La=0,no=null,Lg=0,sa={readContext:Q,use:Wi,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useLayoutEffect:ht,useInsertionEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useSyncExternalStore:ht,useId:ht,useHostTransitionStatus:ht,useFormState:ht,useActionState:ht,useOptimistic:ht,useMemoCache:ht,useCacheRefresh:ht};sa.useEffectEvent=ht;var Pi={readContext:Q,use:Wi,useCallback:function(l,u){return Cn().memoizedState=[l,u===void 0?null:u],l},useContext:Q,useEffect:Rl,useImperativeHandle:function(l,u,g){g=g!=null?g.concat([l]):null,po(4194308,4,Zo.bind(null,u,l),g)},useLayoutEffect:function(l,u){return po(4194308,4,l,u)},useInsertionEffect:function(l,u){po(4,2,l,u)},useMemo:function(l,u){var g=Cn();u=u===void 0?null:u;var b=l();if(Fn){k(!0);try{l()}finally{k(!1)}}return g.memoizedState=[b,u],b},useReducer:function(l,u,g){var b=Cn();if(g!==void 0){var C=g(u);if(Fn){k(!0);try{g(u)}finally{k(!1)}}}else C=u;return b.memoizedState=b.baseState=C,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:C},b.queue=l,l=l.dispatch=Cu.bind(null,mn,l),[b.memoizedState,l]},useRef:function(l){var u=Cn();return l={current:l},u.memoizedState=l},useState:function(l){l=fo(l);var u=l.queue,g=Xh.bind(null,mn,u);return u.dispatch=g,[l.memoizedState,g]},useDebugValue:go,useDeferredValue:function(l,u){var g=Cn();return Il(g,l,u)},useTransition:function(){var l=fo(!1);return l=Dl.bind(null,mn,l.queue,!0,!1),Cn().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,u,g){var b=mn,C=Cn();if(Nn){if(g===void 0)throw Error(s(407));g=g()}else{if(g=u(),Mn===null)throw Error(s(349));(Pn&127)!==0||Ti(b,u,g)}C.memoizedState=g;var D={value:g,getSnapshot:u};return C.queue=D,Rl(Zr.bind(null,b,D,l),[l]),b.flags|=2048,rr(9,{destroy:void 0},sr.bind(null,b,D,g,u),null),g},useId:function(){var l=Cn(),u=Mn.identifierPrefix;if(Nn){var g=eo,b=Os;g=(b&~(1<<32-Dr(b)-1)).toString(32)+g,u="_"+u+"R_"+g,g=Qs++,0<g&&(u+="H"+g.toString(32)),u+="_"}else g=Lg++,u="_"+u+"r_"+g.toString(32)+"_";return l.memoizedState=u},useHostTransitionStatus:Au,useFormState:Yo,useActionState:Yo,useOptimistic:function(l){var u=Cn();u.memoizedState=u.baseState=l;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=g,u=va.bind(null,mn,!0,g),g.dispatch=u,[l,u]},useMemoCache:Ls,useCacheRefresh:function(){return Cn().memoizedState=vd.bind(null,mn)},useEffectEvent:function(l){var u=Cn(),g={impl:l};return u.memoizedState=g,function(){if((Rn&2)!==0)throw Error(s(440));return g.impl.apply(void 0,arguments)}}},zo={readContext:Q,use:Wi,useCallback:Dc,useContext:Q,useEffect:Xa,useImperativeHandle:Mu,useInsertionEffect:mo,useLayoutEffect:Za,useMemo:Ka,useReducer:Ss,useRef:Eu,useState:function(){return Ss(qi)},useDebugValue:go,useDeferredValue:function(l,u){var g=ct();return Tu(g,kt.memoizedState,l,u)},useTransition:function(){var l=Ss(qi)[0],u=ct().memoizedState;return[typeof l=="boolean"?l:Qt(l),u]},useSyncExternalStore:Mi,useId:Nl,useHostTransitionStatus:Au,useFormState:ya,useActionState:ya,useOptimistic:function(l,u){var g=ct();return Cc(g,kt,l,u)},useMemoCache:Ls,useCacheRefresh:wu};zo.useEffectEvent=Es;var Jl={readContext:Q,use:Wi,useCallback:Dc,useContext:Q,useEffect:Xa,useImperativeHandle:Mu,useInsertionEffect:mo,useLayoutEffect:Za,useMemo:Ka,useReducer:li,useRef:Eu,useState:function(){return li(qi)},useDebugValue:go,useDeferredValue:function(l,u){var g=ct();return kt===null?Il(g,l,u):Tu(g,kt.memoizedState,l,u)},useTransition:function(){var l=li(qi)[0],u=ct().memoizedState;return[typeof l=="boolean"?l:Qt(l),u]},useSyncExternalStore:Mi,useId:Nl,useHostTransitionStatus:Au,useFormState:si,useActionState:si,useOptimistic:function(l,u){var g=ct();return kt!==null?Cc(g,kt,l,u):(g.baseState=l,[l,g.queue.dispatch])},useMemoCache:Ls,useCacheRefresh:wu};Jl.useEffectEvent=Es;var Ef={enqueueSetState:function(l,u,g){l=l._reactInternals;var b=Ai(),C=bs(b);C.payload=u,g!=null&&(C.callback=g),u=Xr(l,C,b),u!==null&&(Di(u,l,b),Wa(u,l,b))},enqueueReplaceState:function(l,u,g){l=l._reactInternals;var b=Ai(),C=bs(b);C.tag=1,C.payload=u,g!=null&&(C.callback=g),u=Xr(l,C,b),u!==null&&(Di(u,l,b),Wa(u,l,b))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var g=Ai(),b=bs(g);b.tag=2,u!=null&&(b.callback=u),u=Xr(l,b,g),u!==null&&(Di(u,l,g),Wa(u,l,g))}},dr=Error(s(461)),bi=!1,tu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},ki=!1,Hi=!1,$u=!1,Og=typeof WeakSet=="function"?WeakSet:Set,Ki=null,Li=null,Qi=!1,ai=null,ra=8192,Ju={getCacheForType:function(l){var u=Q(Ri),g=u.data.get(l);return g===void 0&&(g=l(),u.data.set(l,g)),g},cacheSignal:function(){return Q(Ri).controller.signal}},Oa=0,eh=1,th=2,Mf=3,ec=4;if(typeof Symbol=="function"&&Symbol.for){var nu=Symbol.for;Oa=nu("selector.component"),eh=nu("selector.has_pseudo_class"),th=nu("selector.role"),Mf=nu("selector.test_id"),ec=nu("selector.text")}var aa=typeof WeakMap=="function"?WeakMap:Map,Rn=0,Mn=null,In=null,Pn=0,oi=0,rs=null,io=!1,tc=!1,nc=!1,Fo=0,Oi=0,fl=0,ic=0,nh=0,pr=0,ih=0,Tf=null,Or=null,op=!1,Af=0,iu=0,sc=1/0,wf=null,dl=null,as=0,pl=null,su=null,Bo=0,sh=0,lp=null,Ug=null,jn=0,Cf=null;return Sn.attemptContinuousHydration=function(l){if(l.tag===13||l.tag===31){var u=ji(l,67108864);u!==null&&Di(u,l,67108864),lf(l,67108864)}},Sn.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13||l.tag===31){var u=Ai();u=B(u);var g=ji(l,u);g!==null&&Di(g,l,u),lf(l,u)}},Sn.attemptSynchronousHydration=function(l){switch(l.tag){case 3:if(l=l.stateNode,l.current.memoizedState.isDehydrated){var u=w(l.pendingLanes);if(u!==0){for(l.pendingLanes|=2,l.entangledLanes|=2;u;){var g=1<<31-Dr(u);l.entanglements[1]|=g,u&=~g}vt(l),(Rn&6)===0&&(sc=Zs()+500,rt(0))}}break;case 31:case 13:u=ji(l,2),u!==null&&Di(u,l,2),Ad(),lf(l,2)}},Sn.batchedUpdates=function(l,u){return l(u)},Sn.createComponentSelector=function(l){return{$$typeof:Oa,value:l}},Sn.createContainer=function(l,u,g,b,C,D,Y,ae,De,Ke){return Gl(l,u,!1,null,g,b,D,null,Y,ae,De,Ke)},Sn.createHasPseudoClassSelector=function(l){return{$$typeof:eh,value:l}},Sn.createHydrationContainer=function(l,u,g,b,C,D,Y,ae,De,Ke,ft,et,At,dn){var $i;return l=Gl(g,b,!0,l,C,D,ae,dn,De,Ke,ft,et),l.context=Nd(null),g=l.current,b=Ai(),b=B(b),C=bs(b),C.callback=($i=u)!=null?$i:null,Xr(g,C,b),u=b,l.current.lanes=u,j(l,u),vt(l),l},Sn.createPortal=function(l,u,g){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kc,key:b==null?null:""+b,children:l,containerInfo:u,implementation:g}},Sn.createRoleSelector=function(l){return{$$typeof:th,value:l}},Sn.createTestNameSelector=function(l){return{$$typeof:Mf,value:l}},Sn.createTextSelector=function(l){return{$$typeof:ec,value:l}},Sn.defaultOnCaughtError=function(l){console.error(l)},Sn.defaultOnRecoverableError=function(l){tp(l)},Sn.defaultOnUncaughtError=function(l){tp(l)},Sn.deferredUpdates=function(l){var u=Wt.T,g=Aa();try{return Dn(32),Wt.T=null,l()}finally{Dn(g),Wt.T=u}},Sn.discreteUpdates=function(l,u,g,b,C){var D=Wt.T,Y=Aa();try{return Dn(2),Wt.T=null,l(u,g,b,C)}finally{Dn(Y),Wt.T=D,Rn===0&&(sc=Zs()+500)}},Sn.findAllNodes=wr,Sn.findBoundingRects=function(l,u){if(!cs)throw Error(s(363));u=wr(l,u),l=[];for(var g=0;g<u.length;g++)l.push(Vd(u[g]));for(u=l.length-1;0<u;u--){g=l[u];for(var b=g.x,C=b+g.width,D=g.y,Y=D+g.height,ae=u-1;0<=ae;ae--)if(u!==ae){var De=l[ae],Ke=De.x,ft=Ke+De.width,et=De.y,At=et+De.height;if(b>=Ke&&D>=et&&C<=ft&&Y<=At){l.splice(u,1);break}else if(b!==Ke||g.width!==De.width||At<D||et>Y){if(!(D!==et||g.height!==De.height||ft<b||Ke>C)){Ke>b&&(De.width+=Ke-b,De.x=b),ft<C&&(De.width=C-Ke),l.splice(u,1);break}}else{et>D&&(De.height+=et-D,De.y=D),At<Y&&(De.height=Y-et),l.splice(u,1);break}}}return l},Sn.findHostInstance=of,Sn.findHostInstanceWithNoPortals=function(l){return l=f(l),l=l!==null?m(l):null,l===null?null:Wu(l.stateNode)},Sn.findHostInstanceWithWarning=function(l){return of(l)},Sn.flushPassiveEffects=Ro,Sn.flushSyncFromReconciler=function(l){var u=Rn;Rn|=1;var g=Wt.T,b=Aa();try{if(Dn(2),Wt.T=null,l)return l()}finally{Dn(b),Wt.T=g,Rn=u,(Rn&6)===0&&rt(0)}},Sn.flushSyncWork=Ad,Sn.focusWithin=function(l,u){if(!cs)throw Error(s(363));for(l=Fl(l),u=Fu(l,u),u=Array.from(u),l=0;l<u.length;){var g=u[l++],b=g.tag;if(!ql(g)){if((b===5||b===26||b===27)&&ol(g.stateNode))return!0;for(g=g.child;g!==null;)u.push(g),g=g.sibling}}return!1},Sn.getFindAllNodesFailureDescription=function(l,u){if(!cs)throw Error(s(363));var g=0,b=[];l=[Fl(l),0];for(var C=0;C<l.length;){var D=l[C++],Y=D.tag,ae=l[C++],De=u[ae];if((Y!==5&&Y!==26&&Y!==27||!ql(D))&&(Bl(D,De)&&(b.push(zu(De)),ae++,ae>g&&(g=ae)),ae<u.length))for(D=D.child;D!==null;)l.push(D,ae),D=D.sibling}if(g<u.length){for(l=[];g<u.length;g++)l.push(zu(u[g]));return`findAllNodes was able to match part of the selector:
  `+(b.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},Sn.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 27:case 5:return Wu(l.child.stateNode);default:return l.child.stateNode}},Sn.injectIntoDevTools=function(){var l={bundleType:0,version:Qm,rendererPackageName:hf,currentDispatcherRef:Wt,reconcilerVersion:"19.2.0"};if(ju!==null&&(l.rendererConfig=ju),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)l=!0;else{try{Qc=u.inject(l),Nr=u}catch{}l=!!u.checkDCE}}return l},Sn.isAlreadyRendering=function(){return(Rn&6)!==0},Sn.observeVisibleRects=function(l,u,g,b){if(!cs)throw Error(s(363));l=wr(l,u);var C=kd(l,g,b).disconnect;return{disconnect:function(){C()}}},Sn.shouldError=function(){return null},Sn.shouldSuspend=function(){return!1},Sn.startHostTransition=function(l,u,g,b){if(l.tag!==5)throw Error(s(476));var C=qh(l).queue;Dl(l,C,u,qc,g===null?n:function(){var D=qh(l);return D.next===null&&(D=l.alternate.memoizedState),Pl(l,D.next.queue,{},Ai()),g(b)})},Sn.updateContainer=function(l,u,g,b){var C=u.current,D=Ai();return Zm(C,D,l,u,g,b),D},Sn.updateContainerSync=function(l,u,g,b){return Zm(u.current,2,l,u,g,b),2},Sn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(rC)),rC.exports}var oC;function R6(){return oC||(oC=1,sC.exports=C6()),sC.exports}var I6=R6();const D6=w6(I6);function N6(i){const e=D6(i);return e.injectIntoDevTools(),e}const WI=0,um={},P6=/^three(?=[A-Z])/,Yb=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let L6=0;const O6=i=>typeof i=="function";function U6(i){if(O6(i)){const e=`${L6++}`;return um[e]=i,e}else Object.assign(um,i)}function qI(i,e){const t=Yb(i),n=um[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function z6(i,e,t){var n;return i=Yb(i)in um?i:i.replace(P6,""),qI(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,Qx(e.object,t,i,e)}function F6(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?Jx(i.parent,i):Ba(i.object)&&(i.object.visible=!1),i.isHidden=!0,wm(i)}}function XI(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?$x(i.parent,i):Ba(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,wm(i)}}function $M(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var s,a;const c=um[Yb(e.type)];e.object=(s=e.props.object)!=null?s:new c(...(a=e.props.args)!=null?a:[]),e.object.__r3f=e}if(xh(e.object,e.props),e.props.attach)$x(i,e);else if(Ba(e.object)&&Ba(i.object)){const c=i.object.children.indexOf(t?.object);if(t&&c!==-1){const f=i.object.children.indexOf(e.object);if(f!==-1){i.object.children.splice(f,1);const d=f<c?c-1:c;i.object.children.splice(d,0,e.object)}else e.object.parent=i.object,i.object.children.splice(c,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const c of e.children)$M(e,c);wm(e)}}function F1(i,e){e&&(e.parent=i,i.children.push(e),$M(i,e))}function lC(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),$M(i,e,t)}function YI(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():SE.unstable_scheduleCallback(SE.unstable_IdlePriority,e)}}function ME(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?Jx(i,e):Ba(e.object)&&Ba(i.object)&&(i.object.remove(e.object),_6(zI(e),e.object));const s=e.props.dispose!==null&&t!==!1;for(let a=e.children.length-1;a>=0;a--){const c=e.children[a];ME(e,c,s)}e.children.length=0,delete e.object.__r3f,s&&e.type!=="primitive"&&e.object.type!=="Scene"&&YI(e.object),t===void 0&&wm(e)}function B6(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const W_=[];function V6(){for(const[t]of W_){const n=t.parent;if(n){t.props.attach?Jx(n,t):Ba(t.object)&&Ba(n.object)&&n.object.remove(t.object);for(const s of t.children)s.props.attach?Jx(t,s):Ba(s.object)&&Ba(t.object)&&t.object.remove(s.object)}t.isHidden&&XI(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&YI(t.object)}for(const[t,n,s]of W_){t.props=n;const a=t.parent;if(a){var i,e;const c=um[Yb(t.type)];t.object=(i=t.props.object)!=null?i:new c(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,B6(s,t.object),xh(t.object,t.props),t.props.attach?$x(a,t):Ba(t.object)&&Ba(a.object)&&a.object.add(t.object);for(const f of t.children)f.props.attach?$x(t,f):Ba(f.object)&&Ba(t.object)&&t.object.add(f.object);wm(t)}}W_.length=0}const B1=()=>{},cC={};let I_=WI;const k6=0,H6=4,TE=N6({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:z6,removeChild:ME,appendChild:F1,appendInitialChild:F1,insertBefore:lC,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||F1(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||ME(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||lC(n,e,t)},getRootHostContext:()=>cC,getChildHostContext:()=>cC,commitUpdate(i,e,t,n,s){var a,c,f;qI(e,n);let d=!1;if((i.type==="primitive"&&t.object!==n.object||((a=n.args)==null?void 0:a.length)!==((c=t.args)==null?void 0:c.length)||(f=n.args)!=null&&f.some((y,v)=>{var x;return y!==((x=t.args)==null?void 0:x[v])}))&&(d=!0),d)W_.push([i,{...n},s]);else{const y=m6(i,n);Object.keys(y).length&&(Object.assign(i.props,y),xh(i.object,y))}(s.sibling===null||(s.flags&H6)===k6)&&V6()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i?.object,prepareForCommit:()=>null,preparePortalMount:i=>Qx(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:F6,unhideInstance:XI,createTextInstance:B1,hideTextInstance:B1,unhideTextInstance:B1,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:Ve.createContext(null),setCurrentUpdatePriority(i){I_=i},getCurrentUpdatePriority(){return I_},resolveUpdatePriority(){var i;if(I_!==WI)return I_;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return T6;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return E6;default:return M6}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:A6.version,applyViewTransitionName(i,e,t){},restoreViewTransitionName(i,e){},cancelViewTransitionName(i,e,t){},cancelRootViewTransitionName(i){},restoreRootViewTransitionName(i){},InstanceMeasurement:null,measureInstance:i=>null,wasInstanceInViewport:i=>!0,hasInstanceChanged:(i,e)=>!1,hasInstanceAffectedParent:(i,e)=>!1,suspendOnActiveViewTransition(i,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(i){},createViewTransitionInstance:i=>null,getCurrentGestureOffset(i){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(i,e){return i},cloneMutableTextInstance(i){return i},cloneRootViewTransitionContainer(i){throw new Error("Not implemented.")},removeRootViewTransitionClone(i,e){throw new Error("Not implemented.")},createFragmentInstance:i=>null,updateFragmentInstanceFiber(i,e){},commitNewChildToFragmentInstance(i,e){},deleteChildFromFragmentInstance(i,e){},measureClonedInstance:i=>null,maySuspendCommitOnUpdate:(i,e,t)=>!1,maySuspendCommitInSyncRender:(i,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(i,e)=>null}),cd=new Map,Op={objects:"shallow",strict:!1};function G6(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:s,left:a}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:s,left:a}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function j6(i){const e=cd.get(i),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,a=n||b6(CE,hC),c=t||TE.createContainer(a,S6,null,!1,null,"",s,s,s,null);e||cd.set(i,{fiber:c,store:a});let f,d,m=!1,y=null;return{async configure(v={}){let x;y=new Promise(Oe=>x=Oe);let{gl:E,size:T,scene:I,events:w,onCreated:A,shadows:N=!1,linear:O=!1,flat:U=!1,legacy:q=!1,orthographic:j=!1,frameloop:F="always",dpr:R=[1,2],performance:P,raycaster:H,camera:B,onPointerMissed:X}=v,k=a.getState(),ue=k.gl;if(!k.gl){const Oe={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},Pe=typeof E=="function"?await E(Oe):E;iC(Pe)?ue=Pe:ue=new PI({...Oe,...E}),k.set({gl:ue})}let he=k.raycaster;he||k.set({raycaster:he=new EI});const{params:ee,...ie}=H||{};if(Ji.equ(ie,he,Op)||xh(he,{...ie}),Ji.equ(ee,he.params,Op)||xh(he,{params:{...he.params,...ee}}),!k.camera||k.camera===d&&!Ji.equ(d,B,Op)){d=B;const Oe=B?.isCamera,Pe=Oe?B:j?new yu(0,0,0,0,.1,1e3):new ys(75,0,.1,1e3);Oe||(Pe.position.z=5,B&&(xh(Pe,B),Pe.manual||("aspect"in B||"left"in B||"right"in B||"bottom"in B||"top"in B)&&(Pe.manual=!0,Pe.updateProjectionMatrix())),!k.camera&&!(B!=null&&B.rotation)&&Pe.lookAt(0,0,0)),k.set({camera:Pe}),he.camera=Pe}if(!k.scene){let Oe;I!=null&&I.isScene?(Oe=I,Qx(Oe,a,"",{})):(Oe=new _M,Qx(Oe,a,"",{}),I&&xh(Oe,I)),k.set({scene:Oe})}w&&!k.events.handlers&&k.set({events:w(a)});const ye=G6(i,T);if(Ji.equ(ye,k.size,Op)||k.setSize(ye.width,ye.height,ye.top,ye.left),R&&k.viewport.dpr!==VI(R)&&k.setDpr(R),k.frameloop!==F&&k.setFrameloop(F),k.onPointerMissed||k.set({onPointerMissed:X}),P&&!Ji.equ(P,k.performance,Op)&&k.set(Oe=>({performance:{...Oe.performance,...P}})),!k.xr){var be;const Oe=(Mt,Yt)=>{const Ie=a.getState();Ie.frameloop!=="never"&&hC(Mt,!0,Ie,Yt)},Pe=()=>{const Mt=a.getState();Mt.gl.xr.enabled=Mt.gl.xr.isPresenting,Mt.gl.xr.setAnimationLoop(Mt.gl.xr.isPresenting?Oe:null),Mt.gl.xr.isPresenting||CE(Mt)},$e={connect(){const Mt=a.getState().gl;Mt.xr.addEventListener("sessionstart",Pe),Mt.xr.addEventListener("sessionend",Pe)},disconnect(){const Mt=a.getState().gl;Mt.xr.removeEventListener("sessionstart",Pe),Mt.xr.removeEventListener("sessionend",Pe)}};typeof((be=ue.xr)==null?void 0:be.addEventListener)=="function"&&$e.connect(),k.set({xr:$e})}if(ue.shadowMap){const Oe=ue.shadowMap.enabled,Pe=ue.shadowMap.type;if(ue.shadowMap.enabled=!!N,Ji.boo(N))ue.shadowMap.type=f0;else if(Ji.str(N)){var Be;const $e={basic:GR,percentage:Xp,soft:f0,variance:Yf};ue.shadowMap.type=(Be=$e[N])!=null?Be:f0}else Ji.obj(N)&&Object.assign(ue.shadowMap,N);(Oe!==ue.shadowMap.enabled||Pe!==ue.shadowMap.type)&&(ue.shadowMap.needsUpdate=!0)}return Gn.enabled=!q,m||(ue.outputColorSpace=O?Nh:kr,ue.toneMapping=U?jo:ny),k.legacy!==q&&k.set(()=>({legacy:q})),k.linear!==O&&k.set(()=>({linear:O})),k.flat!==U&&k.set(()=>({flat:U})),E&&!Ji.fun(E)&&!iC(E)&&!Ji.equ(E,ue,Op)&&xh(ue,E),f=A,m=!0,x(),this},render(v){return!m&&!y&&this.configure(),y.then(()=>{TE.updateContainer(W.jsx(W6,{store:a,children:v,onCreated:f,rootElement:i}),c,null,()=>{})}),a},unmount(){ZI(i)}}}function W6({store:i,children:e,onCreated:t,rootElement:n}){return uy(()=>{const s=i.getState();s.set(a=>({internal:{...a.internal,active:!0}})),t&&t(s),i.getState().events.connected||s.events.connect==null||s.events.connect(n)},[]),W.jsx(GI.Provider,{value:i,children:e})}function ZI(i,e){const t=cd.get(i),n=t?.fiber;if(n){const s=t?.store.getState();s&&(s.internal.active=!1),TE.updateContainer(null,n,null,()=>{s&&setTimeout(()=>{try{var a,c,f,d;s.events.disconnect==null||s.events.disconnect(),(a=s.gl)==null||(c=a.renderLists)==null||c.dispose==null||c.dispose(),(f=s.gl)==null||f.forceContextLoss==null||f.forceContextLoss(),(d=s.gl)!=null&&d.xr&&s.xr.disconnect(),f6(s.scene),cd.delete(i)}catch{}},500)})}}const q6=new Set,X6=new Set,Y6=new Set;function V1(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function E0(i,e){switch(i){case"before":return V1(q6,e);case"after":return V1(X6,e);case"tail":return V1(Y6,e)}}let k1,H1;function AE(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),k1=e.internal.subscribers;for(let s=0;s<k1.length;s++)H1=k1[s],H1.ref.current(H1.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let eb=!1,wE=!1,G1,uC,Up;function KI(i){uC=requestAnimationFrame(KI),eb=!0,G1=0,E0("before",i),wE=!0;for(const t of cd.values()){var e;Up=t.store.getState(),Up.internal.active&&(Up.frameloop==="always"||Up.internal.frames>0)&&!((e=Up.gl.xr)!=null&&e.isPresenting)&&(G1+=AE(i,Up))}if(wE=!1,E0("after",i),G1===0)return E0("tail",i),eb=!1,cancelAnimationFrame(uC)}function CE(i,e=1){var t;if(!i)return cd.forEach(n=>CE(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):wE?i.internal.frames=2:i.internal.frames=1,eb||(eb=!0,requestAnimationFrame(KI)))}function hC(i,e=!0,t,n){if(e&&E0("before",i),t)AE(i,t,n);else for(const s of cd.values())AE(i,s.store.getState());e&&E0("after",i)}const j1={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Z6(i){const{handlePointer:e}=x6(i);return{priority:1,enabled:!0,compute(t,n,s){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(j1).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:s}=i.getState();(t=s.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{const{set:n,events:s}=i.getState();if(s.disconnect==null||s.disconnect(),n(a=>({events:{...a.events,connected:t}})),s.handlers)for(const a in s.handlers){const c=s.handlers[a],[f,d]=j1[a];t.addEventListener(f,c,{passive:d})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const s in n.handlers){const a=n.handlers[s],[c]=j1[s];n.connected.removeEventListener(c,a)}t(s=>({events:{...s.events,connected:void 0}}))}}}}function fC(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function K6({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const s=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,c]=Ve.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),f=Ve.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),d=i?typeof i=="number"?i:i.scroll:null,m=i?typeof i=="number"?i:i.resize:null,y=Ve.useRef(!1);Ve.useEffect(()=>(y.current=!0,()=>{y.current=!1}));const[v,x,E]=Ve.useMemo(()=>{const A=()=>{if(!f.current.element)return;const{left:N,top:O,width:U,height:q,bottom:j,right:F,x:R,y:P}=f.current.element.getBoundingClientRect(),H={left:N,top:O,width:U,height:q,bottom:j,right:F,x:R,y:P};f.current.element instanceof HTMLElement&&n&&(H.height=f.current.element.offsetHeight,H.width=f.current.element.offsetWidth),Object.freeze(H),y.current&&!ek(f.current.lastBounds,H)&&c(f.current.lastBounds=H)};return[A,m?fC(A,m):A,d?fC(A,d):A]},[c,n,d,m]);function T(){f.current.scrollContainers&&(f.current.scrollContainers.forEach(A=>A.removeEventListener("scroll",E,!0)),f.current.scrollContainers=null),f.current.resizeObserver&&(f.current.resizeObserver.disconnect(),f.current.resizeObserver=null),f.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",f.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",f.current.orientationHandler))}function I(){f.current.element&&(f.current.resizeObserver=new s(E),f.current.resizeObserver.observe(f.current.element),e&&f.current.scrollContainers&&f.current.scrollContainers.forEach(A=>A.addEventListener("scroll",E,{capture:!0,passive:!0})),f.current.orientationHandler=()=>{E()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",f.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",f.current.orientationHandler))}const w=A=>{!A||A===f.current.element||(T(),f.current.element=A,f.current.scrollContainers=QI(A),I())};return $6(E,!!e),Q6(x),Ve.useEffect(()=>{T(),I()},[e,E,x]),Ve.useEffect(()=>T,[]),[w,a,v]}function Q6(i){Ve.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[i])}function $6(i,e){Ve.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[i,e])}function QI(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:s}=window.getComputedStyle(i);return[t,n,s].some(a=>a==="auto"||a==="scroll")&&e.push(i),[...e,...QI(i.parentElement)]}const J6=["x","y","top","bottom","left","right","width","height"],ek=(i,e)=>J6.every(t=>i[t]===e[t]);function tk({ref:i,children:e,fallback:t,resize:n,style:s,gl:a,events:c=Z6,eventSource:f,eventPrefix:d,shadows:m,linear:y,flat:v,legacy:x,orthographic:E,frameloop:T,dpr:I,performance:w,raycaster:A,camera:N,scene:O,onPointerMissed:U,onCreated:q,...j}){Ve.useMemo(()=>U6(j5),[]);const F=c6(),[R,P]=K6({scroll:!0,debounce:{scroll:50,resize:0},...n}),H=Ve.useRef(null),B=Ve.useRef(null);Ve.useImperativeHandle(i,()=>H.current);const X=BI(U),[k,ue]=Ve.useState(!1),[he,ee]=Ve.useState(!1);if(k)throw k;if(he)throw he;const ie=Ve.useRef(null);uy(()=>{const be=H.current;if(P.width>0&&P.height>0&&be){ie.current||(ie.current=j6(be));async function Be(){await ie.current.configure({gl:a,scene:O,events:c,shadows:m,linear:y,flat:v,legacy:x,orthographic:E,frameloop:T,dpr:I,performance:w,raycaster:A,camera:N,size:P,onPointerMissed:(...Oe)=>X.current==null?void 0:X.current(...Oe),onCreated:Oe=>{Oe.events.connect==null||Oe.events.connect(f?o6(f)?f.current:f:B.current),d&&Oe.setEvents({compute:(Pe,$e)=>{const Mt=Pe[d+"X"],Yt=Pe[d+"Y"];$e.pointer.set(Mt/$e.size.width*2-1,-(Yt/$e.size.height)*2+1),$e.raycaster.setFromCamera($e.pointer,$e.camera)}}),q?.(Oe)}}),ie.current.render(W.jsx(F,{children:W.jsx(h6,{set:ee,children:W.jsx(Ve.Suspense,{fallback:W.jsx(u6,{set:ue}),children:e??null})})}))}Be()}}),Ve.useEffect(()=>{const be=H.current;if(be)return()=>ZI(be)},[]);const ye=f?"none":"auto";return W.jsx("div",{ref:B,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ye,...s},...j,children:W.jsx("div",{ref:R,style:{width:"100%",height:"100%"},children:W.jsx("canvas",{ref:H,style:{display:"block"},children:t})})})}function nk(i){return W.jsx(OI,{children:W.jsx(tk,{...i})})}const $I=parseInt(bm.replace(/\D+/g,"")),JI=$I>=125?"uv1":"uv2";var ik=Object.defineProperty,sk=(i,e,t)=>e in i?ik(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,rk=(i,e,t)=>(sk(i,e+"",t),t);class ak{constructor(){rk(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const a=s.indexOf(t);a!==-1&&s.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let a=0,c=s.length;a<c;a++)s[a].call(this,e);e.target=null}}}var ok=Object.defineProperty,lk=(i,e,t)=>e in i?ok(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Jt=(i,e,t)=>(lk(i,typeof e!="symbol"?e+"":e,t),t);const D_=new dd,dC=new du,ck=Math.cos(70*(Math.PI/180)),pC=(i,e)=>(i%e+e)%e;let uk=class extends ak{constructor(e,t){super(),Jt(this,"object"),Jt(this,"domElement"),Jt(this,"enabled",!0),Jt(this,"target",new J),Jt(this,"minDistance",0),Jt(this,"maxDistance",1/0),Jt(this,"minZoom",0),Jt(this,"maxZoom",1/0),Jt(this,"minPolarAngle",0),Jt(this,"maxPolarAngle",Math.PI),Jt(this,"minAzimuthAngle",-1/0),Jt(this,"maxAzimuthAngle",1/0),Jt(this,"enableDamping",!1),Jt(this,"dampingFactor",.05),Jt(this,"enableZoom",!0),Jt(this,"zoomSpeed",1),Jt(this,"enableRotate",!0),Jt(this,"rotateSpeed",1),Jt(this,"enablePan",!0),Jt(this,"panSpeed",1),Jt(this,"screenSpacePanning",!0),Jt(this,"keyPanSpeed",7),Jt(this,"zoomToCursor",!1),Jt(this,"autoRotate",!1),Jt(this,"autoRotateSpeed",2),Jt(this,"reverseOrbit",!1),Jt(this,"reverseHorizontalOrbit",!1),Jt(this,"reverseVerticalOrbit",!1),Jt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Jt(this,"mouseButtons",{LEFT:Gf.ROTATE,MIDDLE:Gf.DOLLY,RIGHT:Gf.PAN}),Jt(this,"touches",{ONE:jf.ROTATE,TWO:jf.DOLLY_PAN}),Jt(this,"target0"),Jt(this,"position0"),Jt(this,"zoom0"),Jt(this,"_domElementKeyEvents",null),Jt(this,"getPolarAngle"),Jt(this,"getAzimuthalAngle"),Jt(this,"setPolarAngle"),Jt(this,"setAzimuthalAngle"),Jt(this,"getDistance"),Jt(this,"getZoomScale"),Jt(this,"listenToKeyEvents"),Jt(this,"stopListenToKeyEvents"),Jt(this,"saveState"),Jt(this,"reset"),Jt(this,"update"),Jt(this,"connect"),Jt(this,"dispose"),Jt(this,"dollyIn"),Jt(this,"dollyOut"),Jt(this,"getScale"),Jt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>y.phi,this.getAzimuthalAngle=()=>y.theta,this.setPolarAngle=ne=>{let xe=pC(ne,2*Math.PI),at=y.phi;at<0&&(at+=2*Math.PI),xe<0&&(xe+=2*Math.PI);let se=Math.abs(xe-at);2*Math.PI-se<se&&(xe<at?xe+=2*Math.PI:at+=2*Math.PI),v.phi=xe-at,n.update()},this.setAzimuthalAngle=ne=>{let xe=pC(ne,2*Math.PI),at=y.theta;at<0&&(at+=2*Math.PI),xe<0&&(xe+=2*Math.PI);let se=Math.abs(xe-at);2*Math.PI-se<se&&(xe<at?xe+=2*Math.PI:at+=2*Math.PI),v.theta=xe-at,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ne=>{ne.addEventListener("keydown",we),this._domElementKeyEvents=ne},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",we),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(s),n.update(),d=f.NONE},this.update=(()=>{const ne=new J,xe=new J(0,1,0),at=new br().setFromUnitVectors(e.up,xe),se=at.clone().invert(),je=new J,Ze=new br,Je=2*Math.PI;return function(){const Ce=n.object.position;at.setFromUnitVectors(e.up,xe),se.copy(at).invert(),ne.copy(Ce).sub(n.target),ne.applyQuaternion(at),y.setFromVector3(ne),n.autoRotate&&d===f.NONE&&ue(X()),n.enableDamping?(y.theta+=v.theta*n.dampingFactor,y.phi+=v.phi*n.dampingFactor):(y.theta+=v.theta,y.phi+=v.phi);let dt=n.minAzimuthAngle,Bt=n.maxAzimuthAngle;isFinite(dt)&&isFinite(Bt)&&(dt<-Math.PI?dt+=Je:dt>Math.PI&&(dt-=Je),Bt<-Math.PI?Bt+=Je:Bt>Math.PI&&(Bt-=Je),dt<=Bt?y.theta=Math.max(dt,Math.min(Bt,y.theta)):y.theta=y.theta>(dt+Bt)/2?Math.max(dt,y.theta):Math.min(Bt,y.theta)),y.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,y.phi)),y.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(E,n.dampingFactor):n.target.add(E),n.zoomToCursor&&P||n.object.isOrthographicCamera?y.radius=$e(y.radius):y.radius=$e(y.radius*x),ne.setFromSpherical(y),ne.applyQuaternion(se),Ce.copy(n.target).add(ne),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(v.theta*=1-n.dampingFactor,v.phi*=1-n.dampingFactor,E.multiplyScalar(1-n.dampingFactor)):(v.set(0,0,0),E.set(0,0,0));let hn=!1;if(n.zoomToCursor&&P){let nn=null;if(n.object instanceof ys&&n.object.isPerspectiveCamera){const Si=ne.length();nn=$e(Si*x);const Gi=Si-nn;n.object.position.addScaledVector(F,Gi),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Si=new J(R.x,R.y,0);Si.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/x)),n.object.updateProjectionMatrix(),hn=!0;const Gi=new J(R.x,R.y,0);Gi.unproject(n.object),n.object.position.sub(Gi).add(Si),n.object.updateMatrixWorld(),nn=ne.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;nn!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(nn).add(n.object.position):(D_.origin.copy(n.object.position),D_.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(D_.direction))<ck?e.lookAt(n.target):(dC.setFromNormalAndCoplanarPoint(n.object.up,n.target),D_.intersectPlane(dC,n.target))))}else n.object instanceof yu&&n.object.isOrthographicCamera&&(hn=x!==1,hn&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/x)),n.object.updateProjectionMatrix()));return x=1,P=!1,hn||je.distanceToSquared(n.object.position)>m||8*(1-Ze.dot(n.object.quaternion))>m?(n.dispatchEvent(s),je.copy(n.object.position),Ze.copy(n.object.quaternion),hn=!1,!0):!1}})(),this.connect=ne=>{n.domElement=ne,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",It),n.domElement.addEventListener("pointerdown",st),n.domElement.addEventListener("pointercancel",G),n.domElement.addEventListener("wheel",Fe)},this.dispose=()=>{var ne,xe,at,se,je,Ze;n.domElement&&(n.domElement.style.touchAction="auto"),(ne=n.domElement)==null||ne.removeEventListener("contextmenu",It),(xe=n.domElement)==null||xe.removeEventListener("pointerdown",st),(at=n.domElement)==null||at.removeEventListener("pointercancel",G),(se=n.domElement)==null||se.removeEventListener("wheel",Fe),(je=n.domElement)==null||je.ownerDocument.removeEventListener("pointermove",Q),(Ze=n.domElement)==null||Ze.ownerDocument.removeEventListener("pointerup",G),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",we)};const n=this,s={type:"change"},a={type:"start"},c={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=f.NONE;const m=1e-6,y=new Kx,v=new Kx;let x=1;const E=new J,T=new ke,I=new ke,w=new ke,A=new ke,N=new ke,O=new ke,U=new ke,q=new ke,j=new ke,F=new J,R=new ke;let P=!1;const H=[],B={};function X(){return 2*Math.PI/60/60*n.autoRotateSpeed}function k(){return Math.pow(.95,n.zoomSpeed)}function ue(ne){n.reverseOrbit||n.reverseHorizontalOrbit?v.theta+=ne:v.theta-=ne}function he(ne){n.reverseOrbit||n.reverseVerticalOrbit?v.phi+=ne:v.phi-=ne}const ee=(()=>{const ne=new J;return function(at,se){ne.setFromMatrixColumn(se,0),ne.multiplyScalar(-at),E.add(ne)}})(),ie=(()=>{const ne=new J;return function(at,se){n.screenSpacePanning===!0?ne.setFromMatrixColumn(se,1):(ne.setFromMatrixColumn(se,0),ne.crossVectors(n.object.up,ne)),ne.multiplyScalar(at),E.add(ne)}})(),ye=(()=>{const ne=new J;return function(at,se){const je=n.domElement;if(je&&n.object instanceof ys&&n.object.isPerspectiveCamera){const Ze=n.object.position;ne.copy(Ze).sub(n.target);let Je=ne.length();Je*=Math.tan(n.object.fov/2*Math.PI/180),ee(2*at*Je/je.clientHeight,n.object.matrix),ie(2*se*Je/je.clientHeight,n.object.matrix)}else je&&n.object instanceof yu&&n.object.isOrthographicCamera?(ee(at*(n.object.right-n.object.left)/n.object.zoom/je.clientWidth,n.object.matrix),ie(se*(n.object.top-n.object.bottom)/n.object.zoom/je.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function be(ne){n.object instanceof ys&&n.object.isPerspectiveCamera||n.object instanceof yu&&n.object.isOrthographicCamera?x=ne:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Be(ne){be(x/ne)}function Oe(ne){be(x*ne)}function Pe(ne){if(!n.zoomToCursor||!n.domElement)return;P=!0;const xe=n.domElement.getBoundingClientRect(),at=ne.clientX-xe.left,se=ne.clientY-xe.top,je=xe.width,Ze=xe.height;R.x=at/je*2-1,R.y=-(se/Ze)*2+1,F.set(R.x,R.y,1).unproject(n.object).sub(n.object.position).normalize()}function $e(ne){return Math.max(n.minDistance,Math.min(n.maxDistance,ne))}function Mt(ne){T.set(ne.clientX,ne.clientY)}function Yt(ne){Pe(ne),U.set(ne.clientX,ne.clientY)}function Ie(ne){A.set(ne.clientX,ne.clientY)}function tt(ne){I.set(ne.clientX,ne.clientY),w.subVectors(I,T).multiplyScalar(n.rotateSpeed);const xe=n.domElement;xe&&(ue(2*Math.PI*w.x/xe.clientHeight),he(2*Math.PI*w.y/xe.clientHeight)),T.copy(I),n.update()}function nt(ne){q.set(ne.clientX,ne.clientY),j.subVectors(q,U),j.y>0?Be(k()):j.y<0&&Oe(k()),U.copy(q),n.update()}function Tt(ne){N.set(ne.clientX,ne.clientY),O.subVectors(N,A).multiplyScalar(n.panSpeed),ye(O.x,O.y),A.copy(N),n.update()}function Lt(ne){Pe(ne),ne.deltaY<0?Oe(k()):ne.deltaY>0&&Be(k()),n.update()}function Ht(ne){let xe=!1;switch(ne.code){case n.keys.UP:ye(0,n.keyPanSpeed),xe=!0;break;case n.keys.BOTTOM:ye(0,-n.keyPanSpeed),xe=!0;break;case n.keys.LEFT:ye(n.keyPanSpeed,0),xe=!0;break;case n.keys.RIGHT:ye(-n.keyPanSpeed,0),xe=!0;break}xe&&(ne.preventDefault(),n.update())}function un(){if(H.length==1)T.set(H[0].pageX,H[0].pageY);else{const ne=.5*(H[0].pageX+H[1].pageX),xe=.5*(H[0].pageY+H[1].pageY);T.set(ne,xe)}}function zt(){if(H.length==1)A.set(H[0].pageX,H[0].pageY);else{const ne=.5*(H[0].pageX+H[1].pageX),xe=.5*(H[0].pageY+H[1].pageY);A.set(ne,xe)}}function Ue(){const ne=H[0].pageX-H[1].pageX,xe=H[0].pageY-H[1].pageY,at=Math.sqrt(ne*ne+xe*xe);U.set(0,at)}function Ye(){n.enableZoom&&Ue(),n.enablePan&&zt()}function ze(){n.enableZoom&&Ue(),n.enableRotate&&un()}function ot(ne){if(H.length==1)I.set(ne.pageX,ne.pageY);else{const at=_t(ne),se=.5*(ne.pageX+at.x),je=.5*(ne.pageY+at.y);I.set(se,je)}w.subVectors(I,T).multiplyScalar(n.rotateSpeed);const xe=n.domElement;xe&&(ue(2*Math.PI*w.x/xe.clientHeight),he(2*Math.PI*w.y/xe.clientHeight)),T.copy(I)}function te(ne){if(H.length==1)N.set(ne.pageX,ne.pageY);else{const xe=_t(ne),at=.5*(ne.pageX+xe.x),se=.5*(ne.pageY+xe.y);N.set(at,se)}O.subVectors(N,A).multiplyScalar(n.panSpeed),ye(O.x,O.y),A.copy(N)}function yt(ne){const xe=_t(ne),at=ne.pageX-xe.x,se=ne.pageY-xe.y,je=Math.sqrt(at*at+se*se);q.set(0,je),j.set(0,Math.pow(q.y/U.y,n.zoomSpeed)),Be(j.y),U.copy(q)}function it(ne){n.enableZoom&&yt(ne),n.enablePan&&te(ne)}function Rt(ne){n.enableZoom&&yt(ne),n.enableRotate&&ot(ne)}function st(ne){var xe,at;n.enabled!==!1&&(H.length===0&&((xe=n.domElement)==null||xe.ownerDocument.addEventListener("pointermove",Q),(at=n.domElement)==null||at.ownerDocument.addEventListener("pointerup",G)),Ft(ne),ne.pointerType==="touch"?vt(ne):oe(ne))}function Q(ne){n.enabled!==!1&&(ne.pointerType==="touch"?rt(ne):Ae(ne))}function G(ne){var xe,at,se;We(ne),H.length===0&&((xe=n.domElement)==null||xe.releasePointerCapture(ne.pointerId),(at=n.domElement)==null||at.ownerDocument.removeEventListener("pointermove",Q),(se=n.domElement)==null||se.ownerDocument.removeEventListener("pointerup",G)),n.dispatchEvent(c),d=f.NONE}function oe(ne){let xe;switch(ne.button){case 0:xe=n.mouseButtons.LEFT;break;case 1:xe=n.mouseButtons.MIDDLE;break;case 2:xe=n.mouseButtons.RIGHT;break;default:xe=-1}switch(xe){case Gf.DOLLY:if(n.enableZoom===!1)return;Yt(ne),d=f.DOLLY;break;case Gf.ROTATE:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(n.enablePan===!1)return;Ie(ne),d=f.PAN}else{if(n.enableRotate===!1)return;Mt(ne),d=f.ROTATE}break;case Gf.PAN:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(n.enableRotate===!1)return;Mt(ne),d=f.ROTATE}else{if(n.enablePan===!1)return;Ie(ne),d=f.PAN}break;default:d=f.NONE}d!==f.NONE&&n.dispatchEvent(a)}function Ae(ne){if(n.enabled!==!1)switch(d){case f.ROTATE:if(n.enableRotate===!1)return;tt(ne);break;case f.DOLLY:if(n.enableZoom===!1)return;nt(ne);break;case f.PAN:if(n.enablePan===!1)return;Tt(ne);break}}function Fe(ne){n.enabled===!1||n.enableZoom===!1||d!==f.NONE&&d!==f.ROTATE||(ne.preventDefault(),n.dispatchEvent(a),Lt(ne),n.dispatchEvent(c))}function we(ne){n.enabled===!1||n.enablePan===!1||Ht(ne)}function vt(ne){switch(Xe(ne),H.length){case 1:switch(n.touches.ONE){case jf.ROTATE:if(n.enableRotate===!1)return;un(),d=f.TOUCH_ROTATE;break;case jf.PAN:if(n.enablePan===!1)return;zt(),d=f.TOUCH_PAN;break;default:d=f.NONE}break;case 2:switch(n.touches.TWO){case jf.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Ye(),d=f.TOUCH_DOLLY_PAN;break;case jf.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;ze(),d=f.TOUCH_DOLLY_ROTATE;break;default:d=f.NONE}break;default:d=f.NONE}d!==f.NONE&&n.dispatchEvent(a)}function rt(ne){switch(Xe(ne),d){case f.TOUCH_ROTATE:if(n.enableRotate===!1)return;ot(ne),n.update();break;case f.TOUCH_PAN:if(n.enablePan===!1)return;te(ne),n.update();break;case f.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;it(ne),n.update();break;case f.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Rt(ne),n.update();break;default:d=f.NONE}}function It(ne){n.enabled!==!1&&ne.preventDefault()}function Ft(ne){H.push(ne)}function We(ne){delete B[ne.pointerId];for(let xe=0;xe<H.length;xe++)if(H[xe].pointerId==ne.pointerId){H.splice(xe,1);return}}function Xe(ne){let xe=B[ne.pointerId];xe===void 0&&(xe=new ke,B[ne.pointerId]=xe),xe.set(ne.pageX,ne.pageY)}function _t(ne){const xe=ne.pointerId===H[0].pointerId?H[1]:H[0];return B[xe.pointerId]}this.dollyIn=(ne=k())=>{Oe(ne),n.update()},this.dollyOut=(ne=k())=>{Be(ne),n.update()},this.getScale=()=>x,this.setScale=ne=>{be(ne),n.update()},this.getZoomScale=()=>k(),t!==void 0&&this.connect(t),this.update()}};const mC=new Vs,N_=new J;class JM extends GM{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new Ct(e,3)),this.setAttribute("uv",new Ct(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new Zx(t,6,1);return this.setAttribute("instanceStart",new oo(n,3,0)),this.setAttribute("instanceEnd",new oo(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const s=new Zx(n,t*2,1);return this.setAttribute("instanceColorStart",new oo(s,t,0)),this.setAttribute("instanceColorEnd",new oo(s,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new NM(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vs);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),mC.setFromBufferAttribute(t),this.boundingBox.union(mC))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ks),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let s=0;for(let a=0,c=e.count;a<c;a++)N_.fromBufferAttribute(e,a),s=Math.max(s,n.distanceToSquared(N_)),N_.fromBufferAttribute(t,a),s=Math.max(s,n.distanceToSquared(N_));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class eD extends JM{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let s=0;s<t;s+=3)n[2*s]=e[s],n[2*s+1]=e[s+1],n[2*s+2]=e[s+2],n[2*s+3]=e[s+3],n[2*s+4]=e[s+4],n[2*s+5]=e[s+5];return super.setPositions(n),this}setColors(e,t=3){const n=e.length-t,s=new Float32Array(2*n);if(t===3)for(let a=0;a<n;a+=t)s[2*a]=e[a],s[2*a+1]=e[a+1],s[2*a+2]=e[a+2],s[2*a+3]=e[a+3],s[2*a+4]=e[a+4],s[2*a+5]=e[a+5];else for(let a=0;a<n;a+=t)s[2*a]=e[a],s[2*a+1]=e[a+1],s[2*a+2]=e[a+2],s[2*a+3]=e[a+3],s[2*a+4]=e[a+4],s[2*a+5]=e[a+5],s[2*a+6]=e[a+6],s[2*a+7]=e[a+7];return super.setColors(s,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class eT extends Ga{constructor(e){super({type:"LineMaterial",uniforms:Yx.clone(Yx.merge([Et.common,Et.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new ke(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${$I>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(t){!!t!="USE_DASH"in this.defines&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(t){!!t!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const W1=new Jn,gC=new J,yC=new J,gr=new Jn,yr=new Jn,uc=new Jn,q1=new J,X1=new on,vr=new TI,vC=new J,P_=new Vs,L_=new ks,hc=new Jn;let dc,nd;function _C(i,e,t){return hc.set(0,0,-e,1).applyMatrix4(i.projectionMatrix),hc.multiplyScalar(1/hc.w),hc.x=nd/t.width,hc.y=nd/t.height,hc.applyMatrix4(i.projectionMatrixInverse),hc.multiplyScalar(1/hc.w),Math.abs(Math.max(hc.x,hc.y))}function hk(i,e){const t=i.matrixWorld,n=i.geometry,s=n.attributes.instanceStart,a=n.attributes.instanceEnd,c=Math.min(n.instanceCount,s.count);for(let f=0,d=c;f<d;f++){vr.start.fromBufferAttribute(s,f),vr.end.fromBufferAttribute(a,f),vr.applyMatrix4(t);const m=new J,y=new J;dc.distanceSqToSegment(vr.start,vr.end,y,m),y.distanceTo(m)<nd*.5&&e.push({point:y,pointOnLine:m,distance:dc.origin.distanceTo(y),object:i,face:null,faceIndex:f,uv:null,[JI]:null})}}function fk(i,e,t){const n=e.projectionMatrix,a=i.material.resolution,c=i.matrixWorld,f=i.geometry,d=f.attributes.instanceStart,m=f.attributes.instanceEnd,y=Math.min(f.instanceCount,d.count),v=-e.near;dc.at(1,uc),uc.w=1,uc.applyMatrix4(e.matrixWorldInverse),uc.applyMatrix4(n),uc.multiplyScalar(1/uc.w),uc.x*=a.x/2,uc.y*=a.y/2,uc.z=0,q1.copy(uc),X1.multiplyMatrices(e.matrixWorldInverse,c);for(let x=0,E=y;x<E;x++){if(gr.fromBufferAttribute(d,x),yr.fromBufferAttribute(m,x),gr.w=1,yr.w=1,gr.applyMatrix4(X1),yr.applyMatrix4(X1),gr.z>v&&yr.z>v)continue;if(gr.z>v){const O=gr.z-yr.z,U=(gr.z-v)/O;gr.lerp(yr,U)}else if(yr.z>v){const O=yr.z-gr.z,U=(yr.z-v)/O;yr.lerp(gr,U)}gr.applyMatrix4(n),yr.applyMatrix4(n),gr.multiplyScalar(1/gr.w),yr.multiplyScalar(1/yr.w),gr.x*=a.x/2,gr.y*=a.y/2,yr.x*=a.x/2,yr.y*=a.y/2,vr.start.copy(gr),vr.start.z=0,vr.end.copy(yr),vr.end.z=0;const I=vr.closestPointToPointParameter(q1,!0);vr.at(I,vC);const w=T3.lerp(gr.z,yr.z,I),A=w>=-1&&w<=1,N=q1.distanceTo(vC)<nd*.5;if(A&&N){vr.start.fromBufferAttribute(d,x),vr.end.fromBufferAttribute(m,x),vr.start.applyMatrix4(c),vr.end.applyMatrix4(c);const O=new J,U=new J;dc.distanceSqToSegment(vr.start,vr.end,U,O),t.push({point:U,pointOnLine:O,distance:dc.origin.distanceTo(U),object:i,face:null,faceIndex:x,uv:null,[JI]:null})}}}class tD extends _s{constructor(e=new JM,t=new eT({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,s=new Float32Array(2*t.count);for(let c=0,f=0,d=t.count;c<d;c++,f+=2)gC.fromBufferAttribute(t,c),yC.fromBufferAttribute(n,c),s[f]=f===0?0:s[f-1],s[f+1]=s[f]+gC.distanceTo(yC);const a=new Zx(s,2,1);return e.setAttribute("instanceDistanceStart",new oo(a,1,0)),e.setAttribute("instanceDistanceEnd",new oo(a,1,1)),this}raycast(e,t){const n=this.material.worldUnits,s=e.camera;s===null&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const a=e.params.Line2!==void 0&&e.params.Line2.threshold||0;dc=e.ray;const c=this.matrixWorld,f=this.geometry,d=this.material;nd=d.linewidth+a,f.boundingSphere===null&&f.computeBoundingSphere(),L_.copy(f.boundingSphere).applyMatrix4(c);let m;if(n)m=nd*.5;else{const v=Math.max(s.near,L_.distanceToPoint(dc.origin));m=_C(s,v,d.resolution)}if(L_.radius+=m,dc.intersectsSphere(L_)===!1)return;f.boundingBox===null&&f.computeBoundingBox(),P_.copy(f.boundingBox).applyMatrix4(c);let y;if(n)y=nd*.5;else{const v=Math.max(s.near,P_.distanceToPoint(dc.origin));y=_C(s,v,d.resolution)}P_.expandByScalar(y),dc.intersectsBox(P_)!==!1&&(n?hk(this,t):fk(this,s,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(W1),this.material.uniforms.resolution.value.set(W1.z,W1.w))}}class dk extends tD{constructor(e=new eD,t=new eT({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}const pk=Ve.forwardRef(function({points:e,color:t=16777215,vertexColors:n,linewidth:s,lineWidth:a,segments:c,dashed:f,...d},m){var y,v;const x=vl(A=>A.size),E=Ve.useMemo(()=>c?new tD:new dk,[c]),[T]=Ve.useState(()=>new eT),I=(n==null||(y=n[0])==null?void 0:y.length)===4?4:3,w=Ve.useMemo(()=>{const A=c?new JM:new eD,N=e.map(O=>{const U=Array.isArray(O);return O instanceof J||O instanceof Jn?[O.x,O.y,O.z]:O instanceof ke?[O.x,O.y,0]:U&&O.length===3?[O[0],O[1],O[2]]:U&&O.length===2?[O[0],O[1],0]:O});if(A.setPositions(N.flat()),n){t=16777215;const O=n.map(U=>U instanceof wt?U.toArray():U);A.setColors(O.flat(),I)}return A},[e,c,n,I]);return Ve.useLayoutEffect(()=>{E.computeLineDistances()},[e,E]),Ve.useLayoutEffect(()=>{f?T.defines.USE_DASH="":delete T.defines.USE_DASH,T.needsUpdate=!0},[f,T]),Ve.useEffect(()=>()=>{w.dispose(),T.dispose()},[w]),Ve.createElement("primitive",sE({object:E,ref:m},d),Ve.createElement("primitive",{object:w,attach:"geometry"}),Ve.createElement("primitive",sE({object:T,attach:"material",color:t,vertexColors:!!n,resolution:[x.width,x.height],linewidth:(v=s??a)!==null&&v!==void 0?v:1,dashed:f,transparent:I===4},d)))}),mk=()=>parseInt(bm.replace(/\D+/g,"")),gk=mk(),yk=Ve.forwardRef(({makeDefault:i,camera:e,regress:t,domElement:n,enableDamping:s=!0,keyEvents:a=!1,onChange:c,onStart:f,onEnd:d,...m},y)=>{const v=vl(j=>j.invalidate),x=vl(j=>j.camera),E=vl(j=>j.gl),T=vl(j=>j.events),I=vl(j=>j.setEvents),w=vl(j=>j.set),A=vl(j=>j.get),N=vl(j=>j.performance),O=e||x,U=n||T.connected||E.domElement,q=Ve.useMemo(()=>new uk(O),[O]);return hy(()=>{q.enabled&&q.update()},-1),Ve.useEffect(()=>(a&&q.connect(a===!0?U:a),q.connect(U),()=>{q.dispose()}),[a,U,t,q,v]),Ve.useEffect(()=>{const j=P=>{v(),t&&N.regress(),c&&c(P)},F=P=>{f&&f(P)},R=P=>{d&&d(P)};return q.addEventListener("change",j),q.addEventListener("start",F),q.addEventListener("end",R),()=>{q.removeEventListener("start",F),q.removeEventListener("end",R),q.removeEventListener("change",j)}},[c,f,d,q,v,I]),Ve.useEffect(()=>{if(i){const j=A().controls;return w({controls:q}),()=>w({controls:j})}},[i,q]),Ve.createElement("primitive",sE({ref:y,object:q,enableDamping:s},m))});class vk extends Ga{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <${gk>=154?"colorspace_fragment":"encodings_fragment"}>
      }`})}}const _k=i=>new J().setFromSpherical(new Kx(i,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)),nD=Ve.forwardRef(({radius:i=100,depth:e=50,count:t=5e3,saturation:n=0,factor:s=4,fade:a=!1,speed:c=1},f)=>{const d=Ve.useRef(null),[m,y,v]=Ve.useMemo(()=>{const E=[],T=[],I=Array.from({length:t},()=>(.5+.5*Math.random())*s),w=new wt;let A=i+e;const N=e/t;for(let O=0;O<t;O++)A-=N*Math.random(),E.push(..._k(A).toArray()),w.setHSL(O/t,n,.9),T.push(w.r,w.g,w.b);return[new Float32Array(E),new Float32Array(T),new Float32Array(I)]},[t,e,s,i,n]);hy(E=>d.current&&(d.current.uniforms.time.value=E.clock.elapsedTime*c));const[x]=Ve.useState(()=>new vk);return Ve.createElement("points",{ref:f},Ve.createElement("bufferGeometry",null,Ve.createElement("bufferAttribute",{attach:"attributes-position",args:[m,3]}),Ve.createElement("bufferAttribute",{attach:"attributes-color",args:[y,3]}),Ve.createElement("bufferAttribute",{attach:"attributes-size",args:[v,1]})),Ve.createElement("primitive",{ref:d,object:x,attach:"material",blending:tx,"uniforms-fade-value":a,depthWrite:!1,transparent:!0,vertexColors:!0}))}),xk=()=>{};var xC={};const iD=function(i){const e=[];let t=0;for(let n=0;n<i.length;n++){let s=i.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<i.length&&(i.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(i.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},bk=function(i){const e=[];let t=0,n=0;for(;t<i.length;){const s=i[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const a=i[t++];e[n++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=i[t++],c=i[t++],f=i[t++],d=((s&7)<<18|(a&63)<<12|(c&63)<<6|f&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const a=i[t++],c=i[t++];e[n++]=String.fromCharCode((s&15)<<12|(a&63)<<6|c&63)}}return e.join("")},sD={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(i,e){if(!Array.isArray(i))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<i.length;s+=3){const a=i[s],c=s+1<i.length,f=c?i[s+1]:0,d=s+2<i.length,m=d?i[s+2]:0,y=a>>2,v=(a&3)<<4|f>>4;let x=(f&15)<<2|m>>6,E=m&63;d||(E=64,c||(x=64)),n.push(t[y],t[v],t[x],t[E])}return n.join("")},encodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(i):this.encodeByteArray(iD(i),e)},decodeString(i,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(i):bk(this.decodeStringToByteArray(i,e))},decodeStringToByteArray(i,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<i.length;){const a=t[i.charAt(s++)],f=s<i.length?t[i.charAt(s)]:0;++s;const m=s<i.length?t[i.charAt(s)]:64;++s;const v=s<i.length?t[i.charAt(s)]:64;if(++s,a==null||f==null||m==null||v==null)throw new Sk;const x=a<<2|f>>4;if(n.push(x),m!==64){const E=f<<4&240|m>>2;if(n.push(E),v!==64){const T=m<<6&192|v;n.push(T)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}};class Sk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ek=function(i){const e=iD(i);return sD.encodeByteArray(e,!0)},tb=function(i){return Ek(i).replace(/\./g,"")},Mk=function(i){try{return sD.decodeString(i,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Tk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const Ak=()=>Tk().__FIREBASE_DEFAULTS__,wk=()=>{if(typeof process>"u"||typeof xC>"u")return;const i=xC.__FIREBASE_DEFAULTS__;if(i)return JSON.parse(i)},Ck=()=>{if(typeof document>"u")return;let i;try{i=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=i&&Mk(i[1]);return e&&JSON.parse(e)},tT=()=>{try{return xk()||Ak()||wk()||Ck()}catch(i){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${i}`);return}},Rk=i=>tT()?.emulatorHosts?.[i],Ik=i=>{const e=Rk(i);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},rD=()=>tT()?.config;class Dk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}function nT(i){try{return(i.startsWith("http://")||i.startsWith("https://")?new URL(i).hostname:i).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Nk(i){return(await fetch(i,{credentials:"include"})).ok}function Pk(i,e){if(i.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=i.iat||0,a=i.sub||i.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...i};return[tb(JSON.stringify(t)),tb(JSON.stringify(c)),""].join(".")}const M0={};function Lk(){const i={prod:[],emulator:[]};for(const e of Object.keys(M0))M0[e]?i.emulator.push(e):i.prod.push(e);return i}function Ok(i){let e=document.getElementById(i),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",i),t=!0),{created:t,element:e}}let bC=!1;function Uk(i,e){if(typeof window>"u"||typeof document>"u"||!nT(window.location.host)||M0[i]===e||M0[i]||bC)return;M0[i]=e;function t(x){return`__firebase__banner__${x}`}const n="__firebase__banner",a=Lk().prod.length>0;function c(){const x=document.getElementById(n);x&&x.remove()}function f(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function d(x,E){x.setAttribute("width","24"),x.setAttribute("id",E),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function m(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{bC=!0,c()},x}function y(x,E){x.setAttribute("id",E),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function v(){const x=Ok(n),E=t("text"),T=document.getElementById(E)||document.createElement("span"),I=t("learnmore"),w=document.getElementById(I)||document.createElement("a"),A=t("preprendIcon"),N=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const O=x.element;f(O),y(w,I);const U=m();d(N,A),O.append(N,T,w,U),document.body.appendChild(O)}a?(T.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function zk(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Fk(){const i=tT()?.forceEnvironment;if(i==="node")return!0;if(i==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Bk(){return!Fk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vk(){try{return typeof indexedDB=="object"}catch{return!1}}function kk(){return new Promise((i,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),i(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const Hk="FirebaseError";class Cm extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=Hk,Object.setPrototypeOf(this,Cm.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,aD.prototype.create)}}class aD{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],c=a?Gk(a,n):"Error",f=`${this.serviceName}: ${c} (${s}).`;return new Cm(s,f,n)}}function Gk(i,e){return i.replace(jk,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const jk=/\{\$([^}]+)}/g;function nb(i,e){if(i===e)return!0;const t=Object.keys(i),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const a=i[s],c=e[s];if(SC(a)&&SC(c)){if(!nb(a,c))return!1}else if(a!==c)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function SC(i){return i!==null&&typeof i=="object"}function oD(i){return i&&i._delegate?i._delegate:i}class X0{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const qf="[DEFAULT]";class Wk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Dk;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Xk(e))try{this.getOrInitializeService({instanceIdentifier:qf})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});n.resolve(a)}catch{}}}}clearInstance(e=qf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=qf){return this.instances.has(e)}getOptions(e=qf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,c]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(a);n===f&&c.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const a=this.instances.get(n);return a&&e(a,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:qk(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=qf){return this.component?this.component.multipleInstances?e:qf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qk(i){return i===qf?void 0:i}function Xk(i){return i.instantiationMode==="EAGER"}class Yk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Wk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Zn;(function(i){i[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT"})(Zn||(Zn={}));const Zk={debug:Zn.DEBUG,verbose:Zn.VERBOSE,info:Zn.INFO,warn:Zn.WARN,error:Zn.ERROR,silent:Zn.SILENT},Kk=Zn.INFO,Qk={[Zn.DEBUG]:"log",[Zn.VERBOSE]:"log",[Zn.INFO]:"info",[Zn.WARN]:"warn",[Zn.ERROR]:"error"},$k=(i,e,...t)=>{if(e<i.logLevel)return;const n=new Date().toISOString(),s=Qk[e];if(s)console[s](`[${n}]  ${i.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lD{constructor(e){this.name=e,this._logLevel=Kk,this._logHandler=$k,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Zn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Zk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Zn.DEBUG,...e),this._logHandler(this,Zn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Zn.VERBOSE,...e),this._logHandler(this,Zn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Zn.INFO,...e),this._logHandler(this,Zn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Zn.WARN,...e),this._logHandler(this,Zn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Zn.ERROR,...e),this._logHandler(this,Zn.ERROR,...e)}}const Jk=(i,e)=>e.some(t=>i instanceof t);let EC,MC;function e8(){return EC||(EC=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function t8(){return MC||(MC=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cD=new WeakMap,RE=new WeakMap,uD=new WeakMap,Y1=new WeakMap,iT=new WeakMap;function n8(i){const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("success",a),i.removeEventListener("error",c)},a=()=>{t(Ah(i.result)),s()},c=()=>{n(i.error),s()};i.addEventListener("success",a),i.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&cD.set(t,i)}).catch(()=>{}),iT.set(e,i),e}function i8(i){if(RE.has(i))return;const e=new Promise((t,n)=>{const s=()=>{i.removeEventListener("complete",a),i.removeEventListener("error",c),i.removeEventListener("abort",c)},a=()=>{t(),s()},c=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",a),i.addEventListener("error",c),i.addEventListener("abort",c)});RE.set(i,e)}let IE={get(i,e,t){if(i instanceof IDBTransaction){if(e==="done")return RE.get(i);if(e==="objectStoreNames")return i.objectStoreNames||uD.get(i);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ah(i[e])},set(i,e,t){return i[e]=t,!0},has(i,e){return i instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in i}};function s8(i){IE=i(IE)}function r8(i){return i===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=i.call(Z1(this),e,...t);return uD.set(n,e.sort?e.sort():[e]),Ah(n)}:t8().includes(i)?function(...e){return i.apply(Z1(this),e),Ah(cD.get(this))}:function(...e){return Ah(i.apply(Z1(this),e))}}function a8(i){return typeof i=="function"?r8(i):(i instanceof IDBTransaction&&i8(i),Jk(i,e8())?new Proxy(i,IE):i)}function Ah(i){if(i instanceof IDBRequest)return n8(i);if(Y1.has(i))return Y1.get(i);const e=a8(i);return e!==i&&(Y1.set(i,e),iT.set(e,i)),e}const Z1=i=>iT.get(i);function o8(i,e,{blocked:t,upgrade:n,blocking:s,terminated:a}={}){const c=indexedDB.open(i,e),f=Ah(c);return n&&c.addEventListener("upgradeneeded",d=>{n(Ah(c.result),d.oldVersion,d.newVersion,Ah(c.transaction),d)}),t&&c.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),f.then(d=>{a&&d.addEventListener("close",()=>a()),s&&d.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),f}const l8=["get","getKey","getAll","getAllKeys","count"],c8=["put","add","delete","clear"],K1=new Map;function TC(i,e){if(!(i instanceof IDBDatabase&&!(e in i)&&typeof e=="string"))return;if(K1.get(e))return K1.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=c8.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||l8.includes(t)))return;const a=async function(c,...f){const d=this.transaction(c,s?"readwrite":"readonly");let m=d.store;return n&&(m=m.index(f.shift())),(await Promise.all([m[t](...f),s&&d.done]))[0]};return K1.set(e,a),a}s8(i=>({...i,get:(e,t,n)=>TC(e,t)||i.get(e,t,n),has:(e,t)=>!!TC(e,t)||i.has(e,t)}));class u8{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(h8(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function h8(i){return i.getComponent()?.type==="VERSION"}const DE="@firebase/app",AC="0.14.8";const xu=new lD("@firebase/app"),f8="@firebase/app-compat",d8="@firebase/analytics-compat",p8="@firebase/analytics",m8="@firebase/app-check-compat",g8="@firebase/app-check",y8="@firebase/auth",v8="@firebase/auth-compat",_8="@firebase/database",x8="@firebase/data-connect",b8="@firebase/database-compat",S8="@firebase/functions",E8="@firebase/functions-compat",M8="@firebase/installations",T8="@firebase/installations-compat",A8="@firebase/messaging",w8="@firebase/messaging-compat",C8="@firebase/performance",R8="@firebase/performance-compat",I8="@firebase/remote-config",D8="@firebase/remote-config-compat",N8="@firebase/storage",P8="@firebase/storage-compat",L8="@firebase/firestore",O8="@firebase/ai",U8="@firebase/firestore-compat",z8="firebase",F8="12.9.0";const NE="[DEFAULT]",B8={[DE]:"fire-core",[f8]:"fire-core-compat",[p8]:"fire-analytics",[d8]:"fire-analytics-compat",[g8]:"fire-app-check",[m8]:"fire-app-check-compat",[y8]:"fire-auth",[v8]:"fire-auth-compat",[_8]:"fire-rtdb",[x8]:"fire-data-connect",[b8]:"fire-rtdb-compat",[S8]:"fire-fn",[E8]:"fire-fn-compat",[M8]:"fire-iid",[T8]:"fire-iid-compat",[A8]:"fire-fcm",[w8]:"fire-fcm-compat",[C8]:"fire-perf",[R8]:"fire-perf-compat",[I8]:"fire-rc",[D8]:"fire-rc-compat",[N8]:"fire-gcs",[P8]:"fire-gcs-compat",[L8]:"fire-fst",[U8]:"fire-fst-compat",[O8]:"fire-vertex","fire-js":"fire-js",[z8]:"fire-js-all"};const ib=new Map,V8=new Map,PE=new Map;function wC(i,e){try{i.container.addComponent(e)}catch(t){xu.debug(`Component ${e.name} failed to register with FirebaseApp ${i.name}`,t)}}function sb(i){const e=i.name;if(PE.has(e))return xu.debug(`There were multiple attempts to register component ${e}.`),!1;PE.set(e,i);for(const t of ib.values())wC(t,i);for(const t of V8.values())wC(t,i);return!0}function k8(i,e){const t=i.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),i.container.getProvider(e)}function H8(i){return i==null?!1:i.settings!==void 0}const G8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},wh=new aD("app","Firebase",G8);class j8{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new X0("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wh.create("app-deleted",{appName:this._name})}}const W8=F8;function hD(i,e={}){let t=i;typeof e!="object"&&(e={name:e});const n={name:NE,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw wh.create("bad-app-name",{appName:String(s)});if(t||(t=rD()),!t)throw wh.create("no-options");const a=ib.get(s);if(a){if(nb(t,a.options)&&nb(n,a.config))return a;throw wh.create("duplicate-app",{appName:s})}const c=new Yk(s);for(const d of PE.values())c.addComponent(d);const f=new j8(t,n,c);return ib.set(s,f),f}function q8(i=NE){const e=ib.get(i);if(!e&&i===NE&&rD())return hD();if(!e)throw wh.create("no-app",{appName:i});return e}function Zp(i,e,t){let n=B8[i]??i;t&&(n+=`-${t}`);const s=n.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const c=[`Unable to register library "${n}" with version "${e}":`];s&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xu.warn(c.join(" "));return}sb(new X0(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const X8="firebase-heartbeat-database",Y8=1,Y0="firebase-heartbeat-store";let Q1=null;function fD(){return Q1||(Q1=o8(X8,Y8,{upgrade:(i,e)=>{switch(e){case 0:try{i.createObjectStore(Y0)}catch(t){console.warn(t)}}}}).catch(i=>{throw wh.create("idb-open",{originalErrorMessage:i.message})})),Q1}async function Z8(i){try{const t=(await fD()).transaction(Y0),n=await t.objectStore(Y0).get(dD(i));return await t.done,n}catch(e){if(e instanceof Cm)xu.warn(e.message);else{const t=wh.create("idb-get",{originalErrorMessage:e?.message});xu.warn(t.message)}}}async function CC(i,e){try{const n=(await fD()).transaction(Y0,"readwrite");await n.objectStore(Y0).put(e,dD(i)),await n.done}catch(t){if(t instanceof Cm)xu.warn(t.message);else{const n=wh.create("idb-set",{originalErrorMessage:t?.message});xu.warn(n.message)}}}function dD(i){return`${i.name}!${i.options.appId}`}const K8=1024,Q8=30;class $8{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new e9(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=RC();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>Q8){const s=t9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){xu.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=RC(),{heartbeatsToSend:t,unsentEntries:n}=J8(this._heartbeatsCache.heartbeats),s=tb(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return xu.warn(e),""}}}function RC(){return new Date().toISOString().substring(0,10)}function J8(i,e=K8){const t=[];let n=i.slice();for(const s of i){const a=t.find(c=>c.agent===s.agent);if(a){if(a.dates.push(s.date),IC(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),IC(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class e9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Vk()?kk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Z8(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return CC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return CC(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function IC(i){return tb(JSON.stringify({version:2,heartbeats:i})).length}function t9(i){if(i.length===0)return-1;let e=0,t=i[0].date;for(let n=1;n<i.length;n++)i[n].date<t&&(t=i[n].date,e=n);return e}function n9(i){sb(new X0("platform-logger",e=>new u8(e),"PRIVATE")),sb(new X0("heartbeat",e=>new $8(e),"PRIVATE")),Zp(DE,AC,i),Zp(DE,AC,"esm2020"),Zp("fire-js","")}n9("");var DC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ch,pD;(function(){var i;function e(F,R){function P(){}P.prototype=R.prototype,F.F=R.prototype,F.prototype=new P,F.prototype.constructor=F,F.D=function(H,B,X){for(var k=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)k[ue-2]=arguments[ue];return R.prototype[B].apply(H,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,t),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(F,R,P){P||(P=0);const H=Array(16);if(typeof R=="string")for(var B=0;B<16;++B)H[B]=R.charCodeAt(P++)|R.charCodeAt(P++)<<8|R.charCodeAt(P++)<<16|R.charCodeAt(P++)<<24;else for(B=0;B<16;++B)H[B]=R[P++]|R[P++]<<8|R[P++]<<16|R[P++]<<24;R=F.g[0],P=F.g[1],B=F.g[2];let X=F.g[3],k;k=R+(X^P&(B^X))+H[0]+3614090360&4294967295,R=P+(k<<7&4294967295|k>>>25),k=X+(B^R&(P^B))+H[1]+3905402710&4294967295,X=R+(k<<12&4294967295|k>>>20),k=B+(P^X&(R^P))+H[2]+606105819&4294967295,B=X+(k<<17&4294967295|k>>>15),k=P+(R^B&(X^R))+H[3]+3250441966&4294967295,P=B+(k<<22&4294967295|k>>>10),k=R+(X^P&(B^X))+H[4]+4118548399&4294967295,R=P+(k<<7&4294967295|k>>>25),k=X+(B^R&(P^B))+H[5]+1200080426&4294967295,X=R+(k<<12&4294967295|k>>>20),k=B+(P^X&(R^P))+H[6]+2821735955&4294967295,B=X+(k<<17&4294967295|k>>>15),k=P+(R^B&(X^R))+H[7]+4249261313&4294967295,P=B+(k<<22&4294967295|k>>>10),k=R+(X^P&(B^X))+H[8]+1770035416&4294967295,R=P+(k<<7&4294967295|k>>>25),k=X+(B^R&(P^B))+H[9]+2336552879&4294967295,X=R+(k<<12&4294967295|k>>>20),k=B+(P^X&(R^P))+H[10]+4294925233&4294967295,B=X+(k<<17&4294967295|k>>>15),k=P+(R^B&(X^R))+H[11]+2304563134&4294967295,P=B+(k<<22&4294967295|k>>>10),k=R+(X^P&(B^X))+H[12]+1804603682&4294967295,R=P+(k<<7&4294967295|k>>>25),k=X+(B^R&(P^B))+H[13]+4254626195&4294967295,X=R+(k<<12&4294967295|k>>>20),k=B+(P^X&(R^P))+H[14]+2792965006&4294967295,B=X+(k<<17&4294967295|k>>>15),k=P+(R^B&(X^R))+H[15]+1236535329&4294967295,P=B+(k<<22&4294967295|k>>>10),k=R+(B^X&(P^B))+H[1]+4129170786&4294967295,R=P+(k<<5&4294967295|k>>>27),k=X+(P^B&(R^P))+H[6]+3225465664&4294967295,X=R+(k<<9&4294967295|k>>>23),k=B+(R^P&(X^R))+H[11]+643717713&4294967295,B=X+(k<<14&4294967295|k>>>18),k=P+(X^R&(B^X))+H[0]+3921069994&4294967295,P=B+(k<<20&4294967295|k>>>12),k=R+(B^X&(P^B))+H[5]+3593408605&4294967295,R=P+(k<<5&4294967295|k>>>27),k=X+(P^B&(R^P))+H[10]+38016083&4294967295,X=R+(k<<9&4294967295|k>>>23),k=B+(R^P&(X^R))+H[15]+3634488961&4294967295,B=X+(k<<14&4294967295|k>>>18),k=P+(X^R&(B^X))+H[4]+3889429448&4294967295,P=B+(k<<20&4294967295|k>>>12),k=R+(B^X&(P^B))+H[9]+568446438&4294967295,R=P+(k<<5&4294967295|k>>>27),k=X+(P^B&(R^P))+H[14]+3275163606&4294967295,X=R+(k<<9&4294967295|k>>>23),k=B+(R^P&(X^R))+H[3]+4107603335&4294967295,B=X+(k<<14&4294967295|k>>>18),k=P+(X^R&(B^X))+H[8]+1163531501&4294967295,P=B+(k<<20&4294967295|k>>>12),k=R+(B^X&(P^B))+H[13]+2850285829&4294967295,R=P+(k<<5&4294967295|k>>>27),k=X+(P^B&(R^P))+H[2]+4243563512&4294967295,X=R+(k<<9&4294967295|k>>>23),k=B+(R^P&(X^R))+H[7]+1735328473&4294967295,B=X+(k<<14&4294967295|k>>>18),k=P+(X^R&(B^X))+H[12]+2368359562&4294967295,P=B+(k<<20&4294967295|k>>>12),k=R+(P^B^X)+H[5]+4294588738&4294967295,R=P+(k<<4&4294967295|k>>>28),k=X+(R^P^B)+H[8]+2272392833&4294967295,X=R+(k<<11&4294967295|k>>>21),k=B+(X^R^P)+H[11]+1839030562&4294967295,B=X+(k<<16&4294967295|k>>>16),k=P+(B^X^R)+H[14]+4259657740&4294967295,P=B+(k<<23&4294967295|k>>>9),k=R+(P^B^X)+H[1]+2763975236&4294967295,R=P+(k<<4&4294967295|k>>>28),k=X+(R^P^B)+H[4]+1272893353&4294967295,X=R+(k<<11&4294967295|k>>>21),k=B+(X^R^P)+H[7]+4139469664&4294967295,B=X+(k<<16&4294967295|k>>>16),k=P+(B^X^R)+H[10]+3200236656&4294967295,P=B+(k<<23&4294967295|k>>>9),k=R+(P^B^X)+H[13]+681279174&4294967295,R=P+(k<<4&4294967295|k>>>28),k=X+(R^P^B)+H[0]+3936430074&4294967295,X=R+(k<<11&4294967295|k>>>21),k=B+(X^R^P)+H[3]+3572445317&4294967295,B=X+(k<<16&4294967295|k>>>16),k=P+(B^X^R)+H[6]+76029189&4294967295,P=B+(k<<23&4294967295|k>>>9),k=R+(P^B^X)+H[9]+3654602809&4294967295,R=P+(k<<4&4294967295|k>>>28),k=X+(R^P^B)+H[12]+3873151461&4294967295,X=R+(k<<11&4294967295|k>>>21),k=B+(X^R^P)+H[15]+530742520&4294967295,B=X+(k<<16&4294967295|k>>>16),k=P+(B^X^R)+H[2]+3299628645&4294967295,P=B+(k<<23&4294967295|k>>>9),k=R+(B^(P|~X))+H[0]+4096336452&4294967295,R=P+(k<<6&4294967295|k>>>26),k=X+(P^(R|~B))+H[7]+1126891415&4294967295,X=R+(k<<10&4294967295|k>>>22),k=B+(R^(X|~P))+H[14]+2878612391&4294967295,B=X+(k<<15&4294967295|k>>>17),k=P+(X^(B|~R))+H[5]+4237533241&4294967295,P=B+(k<<21&4294967295|k>>>11),k=R+(B^(P|~X))+H[12]+1700485571&4294967295,R=P+(k<<6&4294967295|k>>>26),k=X+(P^(R|~B))+H[3]+2399980690&4294967295,X=R+(k<<10&4294967295|k>>>22),k=B+(R^(X|~P))+H[10]+4293915773&4294967295,B=X+(k<<15&4294967295|k>>>17),k=P+(X^(B|~R))+H[1]+2240044497&4294967295,P=B+(k<<21&4294967295|k>>>11),k=R+(B^(P|~X))+H[8]+1873313359&4294967295,R=P+(k<<6&4294967295|k>>>26),k=X+(P^(R|~B))+H[15]+4264355552&4294967295,X=R+(k<<10&4294967295|k>>>22),k=B+(R^(X|~P))+H[6]+2734768916&4294967295,B=X+(k<<15&4294967295|k>>>17),k=P+(X^(B|~R))+H[13]+1309151649&4294967295,P=B+(k<<21&4294967295|k>>>11),k=R+(B^(P|~X))+H[4]+4149444226&4294967295,R=P+(k<<6&4294967295|k>>>26),k=X+(P^(R|~B))+H[11]+3174756917&4294967295,X=R+(k<<10&4294967295|k>>>22),k=B+(R^(X|~P))+H[2]+718787259&4294967295,B=X+(k<<15&4294967295|k>>>17),k=P+(X^(B|~R))+H[9]+3951481745&4294967295,F.g[0]=F.g[0]+R&4294967295,F.g[1]=F.g[1]+(B+(k<<21&4294967295|k>>>11))&4294967295,F.g[2]=F.g[2]+B&4294967295,F.g[3]=F.g[3]+X&4294967295}n.prototype.v=function(F,R){R===void 0&&(R=F.length);const P=R-this.blockSize,H=this.C;let B=this.h,X=0;for(;X<R;){if(B==0)for(;X<=P;)s(this,F,X),X+=this.blockSize;if(typeof F=="string"){for(;X<R;)if(H[B++]=F.charCodeAt(X++),B==this.blockSize){s(this,H),B=0;break}}else for(;X<R;)if(H[B++]=F[X++],B==this.blockSize){s(this,H),B=0;break}}this.h=B,this.o+=R},n.prototype.A=function(){var F=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);F[0]=128;for(var R=1;R<F.length-8;++R)F[R]=0;R=this.o*8;for(var P=F.length-8;P<F.length;++P)F[P]=R&255,R/=256;for(this.v(F),F=Array(16),R=0,P=0;P<4;++P)for(let H=0;H<32;H+=8)F[R++]=this.g[P]>>>H&255;return F};function a(F,R){var P=f;return Object.prototype.hasOwnProperty.call(P,F)?P[F]:P[F]=R(F)}function c(F,R){this.h=R;const P=[];let H=!0;for(let B=F.length-1;B>=0;B--){const X=F[B]|0;H&&X==R||(P[B]=X,H=!1)}this.g=P}var f={};function d(F){return-128<=F&&F<128?a(F,function(R){return new c([R|0],R<0?-1:0)}):new c([F|0],F<0?-1:0)}function m(F){if(isNaN(F)||!isFinite(F))return v;if(F<0)return w(m(-F));const R=[];let P=1;for(let H=0;F>=P;H++)R[H]=F/P|0,P*=4294967296;return new c(R,0)}function y(F,R){if(F.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(F.charAt(0)=="-")return w(y(F.substring(1),R));if(F.indexOf("-")>=0)throw Error('number format error: interior "-" character');const P=m(Math.pow(R,8));let H=v;for(let X=0;X<F.length;X+=8){var B=Math.min(8,F.length-X);const k=parseInt(F.substring(X,X+B),R);B<8?(B=m(Math.pow(R,B)),H=H.j(B).add(m(k))):(H=H.j(P),H=H.add(m(k)))}return H}var v=d(0),x=d(1),E=d(16777216);i=c.prototype,i.m=function(){if(I(this))return-w(this).m();let F=0,R=1;for(let P=0;P<this.g.length;P++){const H=this.i(P);F+=(H>=0?H:4294967296+H)*R,R*=4294967296}return F},i.toString=function(F){if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(T(this))return"0";if(I(this))return"-"+w(this).toString(F);const R=m(Math.pow(F,6));var P=this;let H="";for(;;){const B=U(P,R).g;P=A(P,B.j(R));let X=((P.g.length>0?P.g[0]:P.h)>>>0).toString(F);if(P=B,T(P))return X+H;for(;X.length<6;)X="0"+X;H=X+H}},i.i=function(F){return F<0?0:F<this.g.length?this.g[F]:this.h};function T(F){if(F.h!=0)return!1;for(let R=0;R<F.g.length;R++)if(F.g[R]!=0)return!1;return!0}function I(F){return F.h==-1}i.l=function(F){return F=A(this,F),I(F)?-1:T(F)?0:1};function w(F){const R=F.g.length,P=[];for(let H=0;H<R;H++)P[H]=~F.g[H];return new c(P,~F.h).add(x)}i.abs=function(){return I(this)?w(this):this},i.add=function(F){const R=Math.max(this.g.length,F.g.length),P=[];let H=0;for(let B=0;B<=R;B++){let X=H+(this.i(B)&65535)+(F.i(B)&65535),k=(X>>>16)+(this.i(B)>>>16)+(F.i(B)>>>16);H=k>>>16,X&=65535,k&=65535,P[B]=k<<16|X}return new c(P,P[P.length-1]&-2147483648?-1:0)};function A(F,R){return F.add(w(R))}i.j=function(F){if(T(this)||T(F))return v;if(I(this))return I(F)?w(this).j(w(F)):w(w(this).j(F));if(I(F))return w(this.j(w(F)));if(this.l(E)<0&&F.l(E)<0)return m(this.m()*F.m());const R=this.g.length+F.g.length,P=[];for(var H=0;H<2*R;H++)P[H]=0;for(H=0;H<this.g.length;H++)for(let B=0;B<F.g.length;B++){const X=this.i(H)>>>16,k=this.i(H)&65535,ue=F.i(B)>>>16,he=F.i(B)&65535;P[2*H+2*B]+=k*he,N(P,2*H+2*B),P[2*H+2*B+1]+=X*he,N(P,2*H+2*B+1),P[2*H+2*B+1]+=k*ue,N(P,2*H+2*B+1),P[2*H+2*B+2]+=X*ue,N(P,2*H+2*B+2)}for(F=0;F<R;F++)P[F]=P[2*F+1]<<16|P[2*F];for(F=R;F<2*R;F++)P[F]=0;return new c(P,0)};function N(F,R){for(;(F[R]&65535)!=F[R];)F[R+1]+=F[R]>>>16,F[R]&=65535,R++}function O(F,R){this.g=F,this.h=R}function U(F,R){if(T(R))throw Error("division by zero");if(T(F))return new O(v,v);if(I(F))return R=U(w(F),R),new O(w(R.g),w(R.h));if(I(R))return R=U(F,w(R)),new O(w(R.g),R.h);if(F.g.length>30){if(I(F)||I(R))throw Error("slowDivide_ only works with positive integers.");for(var P=x,H=R;H.l(F)<=0;)P=q(P),H=q(H);var B=j(P,1),X=j(H,1);for(H=j(H,2),P=j(P,2);!T(H);){var k=X.add(H);k.l(F)<=0&&(B=B.add(P),X=k),H=j(H,1),P=j(P,1)}return R=A(F,B.j(R)),new O(B,R)}for(B=v;F.l(R)>=0;){for(P=Math.max(1,Math.floor(F.m()/R.m())),H=Math.ceil(Math.log(P)/Math.LN2),H=H<=48?1:Math.pow(2,H-48),X=m(P),k=X.j(R);I(k)||k.l(F)>0;)P-=H,X=m(P),k=X.j(R);T(X)&&(X=x),B=B.add(X),F=A(F,k)}return new O(B,F)}i.B=function(F){return U(this,F).h},i.and=function(F){const R=Math.max(this.g.length,F.g.length),P=[];for(let H=0;H<R;H++)P[H]=this.i(H)&F.i(H);return new c(P,this.h&F.h)},i.or=function(F){const R=Math.max(this.g.length,F.g.length),P=[];for(let H=0;H<R;H++)P[H]=this.i(H)|F.i(H);return new c(P,this.h|F.h)},i.xor=function(F){const R=Math.max(this.g.length,F.g.length),P=[];for(let H=0;H<R;H++)P[H]=this.i(H)^F.i(H);return new c(P,this.h^F.h)};function q(F){const R=F.g.length+1,P=[];for(let H=0;H<R;H++)P[H]=F.i(H)<<1|F.i(H-1)>>>31;return new c(P,F.h)}function j(F,R){const P=R>>5;R%=32;const H=F.g.length-P,B=[];for(let X=0;X<H;X++)B[X]=R>0?F.i(X+P)>>>R|F.i(X+P+1)<<32-R:F.i(X+P);return new c(B,F.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,pD=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=y,Ch=c}).apply(typeof DC<"u"?DC:typeof self<"u"?self:typeof window<"u"?window:{});var O_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var mD,c0,gD,q_,LE,yD,vD,_D;(function(){var i,e=Object.defineProperty;function t(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof O_=="object"&&O_];for(var L=0;L<_.length;++L){var V=_[L];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")}var n=t(this);function s(_,L){if(L)e:{var V=n;_=_.split(".");for(var $=0;$<_.length-1;$++){var fe=_[$];if(!(fe in V))break e;V=V[fe]}_=_[_.length-1],$=V[_],L=L($),L!=$&&L!=null&&e(V,_,{configurable:!0,writable:!0,value:L})}}s("Symbol.dispose",function(_){return _||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(_){return _||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(_){return _||function(L){var V=[],$;for($ in L)Object.prototype.hasOwnProperty.call(L,$)&&V.push([$,L[$]]);return V}});var a=a||{},c=this||self;function f(_){var L=typeof _;return L=="object"&&_!=null||L=="function"}function d(_,L,V){return _.call.apply(_.bind,arguments)}function m(_,L,V){return m=d,m.apply(null,arguments)}function y(_,L){var V=Array.prototype.slice.call(arguments,1);return function(){var $=V.slice();return $.push.apply($,arguments),_.apply(this,$)}}function v(_,L){function V(){}V.prototype=L.prototype,_.Z=L.prototype,_.prototype=new V,_.prototype.constructor=_,_.Ob=function($,fe,Te){for(var mt=Array(arguments.length-2),fn=2;fn<arguments.length;fn++)mt[fn-2]=arguments[fn];return L.prototype[fe].apply($,mt)}}var x=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?_=>_&&AsyncContext.Snapshot.wrap(_):_=>_;function E(_){const L=_.length;if(L>0){const V=Array(L);for(let $=0;$<L;$++)V[$]=_[$];return V}return[]}function T(_,L){for(let $=1;$<arguments.length;$++){const fe=arguments[$];var V=typeof fe;if(V=V!="object"?V:fe?Array.isArray(fe)?"array":V:"null",V=="array"||V=="object"&&typeof fe.length=="number"){V=_.length||0;const Te=fe.length||0;_.length=V+Te;for(let mt=0;mt<Te;mt++)_[V+mt]=fe[mt]}else _.push(fe)}}class I{constructor(L,V){this.i=L,this.j=V,this.h=0,this.g=null}get(){let L;return this.h>0?(this.h--,L=this.g,this.g=L.next,L.next=null):L=this.i(),L}}function w(_){c.setTimeout(()=>{throw _},0)}function A(){var _=F;let L=null;return _.g&&(L=_.g,_.g=_.g.next,_.g||(_.h=null),L.next=null),L}class N{constructor(){this.h=this.g=null}add(L,V){const $=O.get();$.set(L,V),this.h?this.h.next=$:this.g=$,this.h=$}}var O=new I(()=>new U,_=>_.reset());class U{constructor(){this.next=this.g=this.h=null}set(L,V){this.h=L,this.g=V,this.next=null}reset(){this.next=this.g=this.h=null}}let q,j=!1,F=new N,R=()=>{const _=Promise.resolve(void 0);q=()=>{_.then(P)}};function P(){for(var _;_=A();){try{_.h.call(_.g)}catch(V){w(V)}var L=O;L.j(_),L.h<100&&(L.h++,_.next=L.g,L.g=_)}j=!1}function H(){this.u=this.u,this.C=this.C}H.prototype.u=!1,H.prototype.dispose=function(){this.u||(this.u=!0,this.N())},H.prototype[Symbol.dispose]=function(){this.dispose()},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function B(_,L){this.type=_,this.g=this.target=L,this.defaultPrevented=!1}B.prototype.h=function(){this.defaultPrevented=!0};var X=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var _=!1,L=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const V=()=>{};c.addEventListener("test",V,L),c.removeEventListener("test",V,L)}catch{}return _})();function k(_){return/^[\s\xa0]*$/.test(_)}function ue(_,L){B.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_&&this.init(_,L)}v(ue,B),ue.prototype.init=function(_,L){const V=this.type=_.type,$=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;this.target=_.target||_.srcElement,this.g=L,L=_.relatedTarget,L||(V=="mouseover"?L=_.fromElement:V=="mouseout"&&(L=_.toElement)),this.relatedTarget=L,$?(this.clientX=$.clientX!==void 0?$.clientX:$.pageX,this.clientY=$.clientY!==void 0?$.clientY:$.pageY,this.screenX=$.screenX||0,this.screenY=$.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=_.pointerType,this.state=_.state,this.i=_,_.defaultPrevented&&ue.Z.h.call(this)},ue.prototype.h=function(){ue.Z.h.call(this);const _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var he="closure_listenable_"+(Math.random()*1e6|0),ee=0;function ie(_,L,V,$,fe){this.listener=_,this.proxy=null,this.src=L,this.type=V,this.capture=!!$,this.ha=fe,this.key=++ee,this.da=this.fa=!1}function ye(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function be(_,L,V){for(const $ in _)L.call(V,_[$],$,_)}function Be(_,L){for(const V in _)L.call(void 0,_[V],V,_)}function Oe(_){const L={};for(const V in _)L[V]=_[V];return L}const Pe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $e(_,L){let V,$;for(let fe=1;fe<arguments.length;fe++){$=arguments[fe];for(V in $)_[V]=$[V];for(let Te=0;Te<Pe.length;Te++)V=Pe[Te],Object.prototype.hasOwnProperty.call($,V)&&(_[V]=$[V])}}function Mt(_){this.src=_,this.g={},this.h=0}Mt.prototype.add=function(_,L,V,$,fe){const Te=_.toString();_=this.g[Te],_||(_=this.g[Te]=[],this.h++);const mt=Ie(_,L,$,fe);return mt>-1?(L=_[mt],V||(L.fa=!1)):(L=new ie(L,this.src,Te,!!$,fe),L.fa=V,_.push(L)),L};function Yt(_,L){const V=L.type;if(V in _.g){var $=_.g[V],fe=Array.prototype.indexOf.call($,L,void 0),Te;(Te=fe>=0)&&Array.prototype.splice.call($,fe,1),Te&&(ye(L),_.g[V].length==0&&(delete _.g[V],_.h--))}}function Ie(_,L,V,$){for(let fe=0;fe<_.length;++fe){const Te=_[fe];if(!Te.da&&Te.listener==L&&Te.capture==!!V&&Te.ha==$)return fe}return-1}var tt="closure_lm_"+(Math.random()*1e6|0),nt={};function Tt(_,L,V,$,fe){if(Array.isArray(L)){for(let Te=0;Te<L.length;Te++)Tt(_,L[Te],V,$,fe);return null}return V=te(V),_&&_[he]?_.J(L,V,f($)?!!$.capture:!1,fe):Lt(_,L,V,!1,$,fe)}function Lt(_,L,V,$,fe,Te){if(!L)throw Error("Invalid event type");const mt=f(fe)?!!fe.capture:!!fe;let fn=ze(_);if(fn||(_[tt]=fn=new Mt(_)),V=fn.add(L,V,$,mt,Te),V.proxy)return V;if($=Ht(),V.proxy=$,$.src=_,$.listener=V,_.addEventListener)X||(fe=mt),fe===void 0&&(fe=!1),_.addEventListener(L.toString(),$,fe);else if(_.attachEvent)_.attachEvent(Ue(L.toString()),$);else if(_.addListener&&_.removeListener)_.addListener($);else throw Error("addEventListener and attachEvent are unavailable.");return V}function Ht(){function _(V){return L.call(_.src,_.listener,V)}const L=Ye;return _}function un(_,L,V,$,fe){if(Array.isArray(L))for(var Te=0;Te<L.length;Te++)un(_,L[Te],V,$,fe);else $=f($)?!!$.capture:!!$,V=te(V),_&&_[he]?(_=_.i,Te=String(L).toString(),Te in _.g&&(L=_.g[Te],V=Ie(L,V,$,fe),V>-1&&(ye(L[V]),Array.prototype.splice.call(L,V,1),L.length==0&&(delete _.g[Te],_.h--)))):_&&(_=ze(_))&&(L=_.g[L.toString()],_=-1,L&&(_=Ie(L,V,$,fe)),(V=_>-1?L[_]:null)&&zt(V))}function zt(_){if(typeof _!="number"&&_&&!_.da){var L=_.src;if(L&&L[he])Yt(L.i,_);else{var V=_.type,$=_.proxy;L.removeEventListener?L.removeEventListener(V,$,_.capture):L.detachEvent?L.detachEvent(Ue(V),$):L.addListener&&L.removeListener&&L.removeListener($),(V=ze(L))?(Yt(V,_),V.h==0&&(V.src=null,L[tt]=null)):ye(_)}}}function Ue(_){return _ in nt?nt[_]:nt[_]="on"+_}function Ye(_,L){if(_.da)_=!0;else{L=new ue(L,this);const V=_.listener,$=_.ha||_.src;_.fa&&zt(_),_=V.call($,L)}return _}function ze(_){return _=_[tt],_ instanceof Mt?_:null}var ot="__closure_events_fn_"+(Math.random()*1e9>>>0);function te(_){return typeof _=="function"?_:(_[ot]||(_[ot]=function(L){return _.handleEvent(L)}),_[ot])}function yt(){H.call(this),this.i=new Mt(this),this.M=this,this.G=null}v(yt,H),yt.prototype[he]=!0,yt.prototype.removeEventListener=function(_,L,V,$){un(this,_,L,V,$)};function it(_,L){var V,$=_.G;if($)for(V=[];$;$=$.G)V.push($);if(_=_.M,$=L.type||L,typeof L=="string")L=new B(L,_);else if(L instanceof B)L.target=L.target||_;else{var fe=L;L=new B($,_),$e(L,fe)}fe=!0;let Te,mt;if(V)for(mt=V.length-1;mt>=0;mt--)Te=L.g=V[mt],fe=Rt(Te,$,!0,L)&&fe;if(Te=L.g=_,fe=Rt(Te,$,!0,L)&&fe,fe=Rt(Te,$,!1,L)&&fe,V)for(mt=0;mt<V.length;mt++)Te=L.g=V[mt],fe=Rt(Te,$,!1,L)&&fe}yt.prototype.N=function(){if(yt.Z.N.call(this),this.i){var _=this.i;for(const L in _.g){const V=_.g[L];for(let $=0;$<V.length;$++)ye(V[$]);delete _.g[L],_.h--}}this.G=null},yt.prototype.J=function(_,L,V,$){return this.i.add(String(_),L,!1,V,$)},yt.prototype.K=function(_,L,V,$){return this.i.add(String(_),L,!0,V,$)};function Rt(_,L,V,$){if(L=_.i.g[String(L)],!L)return!0;L=L.concat();let fe=!0;for(let Te=0;Te<L.length;++Te){const mt=L[Te];if(mt&&!mt.da&&mt.capture==V){const fn=mt.listener,Fi=mt.ha||mt.src;mt.fa&&Yt(_.i,mt),fe=fn.call(Fi,$)!==!1&&fe}}return fe&&!$.defaultPrevented}function st(_,L){if(typeof _!="function")if(_&&typeof _.handleEvent=="function")_=m(_.handleEvent,_);else throw Error("Invalid listener argument");return Number(L)>2147483647?-1:c.setTimeout(_,L||0)}function Q(_){_.g=st(()=>{_.g=null,_.i&&(_.i=!1,Q(_))},_.l);const L=_.h;_.h=null,_.m.apply(null,L)}class G extends H{constructor(L,V){super(),this.m=L,this.l=V,this.h=null,this.i=!1,this.g=null}j(L){this.h=arguments,this.g?this.i=!0:Q(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oe(_){H.call(this),this.h=_,this.g={}}v(oe,H);var Ae=[];function Fe(_){be(_.g,function(L,V){this.g.hasOwnProperty(V)&&zt(L)},_),_.g={}}oe.prototype.N=function(){oe.Z.N.call(this),Fe(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var we=c.JSON.stringify,vt=c.JSON.parse,rt=class{stringify(_){return c.JSON.stringify(_,void 0)}parse(_){return c.JSON.parse(_,void 0)}};function It(){}function Ft(){}var We={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Xe(){B.call(this,"d")}v(Xe,B);function _t(){B.call(this,"c")}v(_t,B);var ne={},xe=null;function at(){return xe=xe||new yt}ne.Ia="serverreachability";function se(_){B.call(this,ne.Ia,_)}v(se,B);function je(_){const L=at();it(L,new se(L))}ne.STAT_EVENT="statevent";function Ze(_,L){B.call(this,ne.STAT_EVENT,_),this.stat=L}v(Ze,B);function Je(_){const L=at();it(L,new Ze(L,_))}ne.Ja="timingevent";function Qe(_,L){B.call(this,ne.Ja,_),this.size=L}v(Qe,B);function Ce(_,L){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){_()},L)}function dt(){this.g=!0}dt.prototype.ua=function(){this.g=!1};function Bt(_,L,V,$,fe,Te){_.info(function(){if(_.g)if(Te){var mt="",fn=Te.split("&");for(let zn=0;zn<fn.length;zn++){var Fi=fn[zn].split("=");if(Fi.length>1){const xi=Fi[0];Fi=Fi[1];const ar=xi.split("_");mt=ar.length>=2&&ar[1]=="type"?mt+(xi+"="+Fi+"&"):mt+(xi+"=redacted&")}}}else mt=null;else mt=Te;return"XMLHTTP REQ ("+$+") [attempt "+fe+"]: "+L+`
`+V+`
`+mt})}function hn(_,L,V,$,fe,Te,mt){_.info(function(){return"XMLHTTP RESP ("+$+") [ attempt "+fe+"]: "+L+`
`+V+`
`+Te+" "+mt})}function nn(_,L,V,$){_.info(function(){return"XMLHTTP TEXT ("+L+"): "+Gi(_,V)+($?" "+$:"")})}function Si(_,L){_.info(function(){return"TIMEOUT: "+L})}dt.prototype.info=function(){};function Gi(_,L){if(!_.g)return L;if(!L)return null;try{const Te=JSON.parse(L);if(Te){for(_=0;_<Te.length;_++)if(Array.isArray(Te[_])){var V=Te[_];if(!(V.length<2)){var $=V[1];if(Array.isArray($)&&!($.length<1)){var fe=$[0];if(fe!="noop"&&fe!="stop"&&fe!="close")for(let mt=1;mt<$.length;mt++)$[mt]=""}}}}return we(Te)}catch{return L}}var Er={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},pa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Tl;function qr(){}v(qr,It),qr.prototype.g=function(){return new XMLHttpRequest},Tl=new qr;function er(_){return encodeURIComponent(String(_))}function Mr(_){var L=1;_=_.split(":");const V=[];for(;L>0&&_.length;)V.push(_.shift()),L--;return _.length&&V.push(_.join(":")),V}function ji(_,L,V,$){this.j=_,this.i=L,this.l=V,this.S=$||1,this.V=new oe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new tr}function tr(){this.i=null,this.g="",this.h=!1}var fi={},_i={};function nr(_,L,V){_.M=1,_.A=Cn(bt(L)),_.u=V,_.R=!0,bs(_,null)}function bs(_,L){_.F=Date.now(),Ws(_),_.B=bt(_.A);var V=_.B,$=_.S;Array.isArray($)||($=[String($)]),ho(V.i,"t",$),_.C=0,V=_.j.L,_.h=new tr,_.g=Zh(_.j,V?L:null,!_.u),_.P>0&&(_.O=new G(m(_.Y,_,_.g),_.P)),L=_.V,V=_.g,$=_.ba;var fe="readystatechange";Array.isArray(fe)||(fe&&(Ae[0]=fe.toString()),fe=Ae);for(let Te=0;Te<fe.length;Te++){const mt=Tt(V,fe[Te],$||L.handleEvent,!1,L.h||L);if(!mt)break;L.g[mt.key]=mt}L=_.J?Oe(_.J):{},_.u?(_.v||(_.v="POST"),L["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.B,_.v,_.u,L)):(_.v="GET",_.g.ea(_.B,_.v,null,L)),je(),Bt(_.i,_.v,_.B,_.l,_.S,_.u)}ji.prototype.ba=function(_){_=_.target;const L=this.O;L&&Ya(_)==3?L.j():this.Y(_)},ji.prototype.Y=function(_){try{if(_==this.g)e:{const fn=Ya(this.g),Fi=this.g.ya(),zn=this.g.ca();if(!(fn<3)&&(fn!=3||this.g&&(this.h.h||this.g.la()||Es(this.g)))){this.K||fn!=4||Fi==7||(Fi==8||zn<=0?je(3):je(2)),Yr(this);var L=this.g.ca();this.X=L;var V=Xr(this);if(this.o=L==200,hn(this.i,this.v,this.B,this.l,this.S,fn,L),this.o){if(this.U&&!this.L){t:{if(this.g){var $,fe=this.g;if(($=fe.g?fe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k($)){var Te=$;break t}}Te=null}if(_=Te)nn(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Z(this,_);else{this.o=!1,this.m=3,Je(12),qs(this),ir(this);break e}}if(this.R){_=!0;let xi;for(;!this.K&&this.C<V.length;)if(xi=Al(this,V),xi==_i){fn==4&&(this.m=4,Je(14),_=!1),nn(this.i,this.l,null,"[Incomplete Response]");break}else if(xi==fi){this.m=4,Je(15),nn(this.i,this.l,V,"[Invalid Chunk]"),_=!1;break}else nn(this.i,this.l,xi,null),Z(this,xi);if(Wa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),fn!=4||V.length!=0||this.h.h||(this.m=1,Je(16),_=!1),this.o=this.o&&_,!_)nn(this.i,this.l,V,"[Invalid Chunked Response]"),qs(this),ir(this);else if(V.length>0&&!this.W){this.W=!0;var mt=this.j;mt.g==this&&mt.aa&&!mt.P&&(mt.j.info("Great, no buffering proxy detected. Bytes received: "+V.length),wu(mt),mt.P=!0,Je(11))}}else nn(this.i,this.l,V,null),Z(this,V);fn==4&&qs(this),this.o&&!this.K&&(fn==4?Xh(this.j,this):(this.o=!1,Ws(this)))}else mo(this.g),L==400&&V.indexOf("Unknown SID")>0?(this.m=3,Je(12)):(this.m=0,Je(13)),qs(this),ir(this)}}}catch{}};function Xr(_){if(!Wa(_))return _.g.la();const L=Es(_.g);if(L==="")return"";let V="";const $=L.length,fe=Ya(_.g)==4;if(!_.h.i){if(typeof TextDecoder>"u")return qs(_),ir(_),"";_.h.i=new c.TextDecoder}for(let Te=0;Te<$;Te++)_.h.h=!0,V+=_.h.i.decode(L[Te],{stream:!(fe&&Te==$-1)});return L.length=0,_.h.g+=V,_.C=0,_.h.g}function Wa(_){return _.g?_.v=="GET"&&_.M!=2&&_.j.Aa:!1}function Al(_,L){var V=_.C,$=L.indexOf(`
`,V);return $==-1?_i:(V=Number(L.substring(V,$)),isNaN(V)?fi:($+=1,$+V>L.length?_i:(L=L.slice($,$+V),_.C=$+V,L)))}ji.prototype.cancel=function(){this.K=!0,qs(this)};function Ws(_){_.T=Date.now()+_.H,ma(_,_.H)}function ma(_,L){if(_.D!=null)throw Error("WatchDog timer not null");_.D=Ce(m(_.aa,_),L)}function Yr(_){_.D&&(c.clearTimeout(_.D),_.D=null)}ji.prototype.aa=function(){this.D=null;const _=Date.now();_-this.T>=0?(Si(this.i,this.B),this.M!=2&&(je(),Je(17)),qs(this),this.m=2,ir(this)):ma(this,this.T-_)};function ir(_){_.j.I==0||_.K||Xh(_.j,_)}function qs(_){Yr(_);var L=_.O;L&&typeof L.dispose=="function"&&L.dispose(),_.O=null,Fe(_.V),_.g&&(L=_.g,_.g=null,L.abort(),L.dispose())}function Z(_,L){try{var V=_.j;if(V.I!=0&&(V.g==_||lt(V.h,_))){if(!_.L&&lt(V.h,_)&&V.I==3){try{var $=V.Ba.g.parse(L)}catch{$=null}if(Array.isArray($)&&$.length==3){var fe=$;if(fe[0]==0){e:if(!V.v){if(V.g)if(V.g.F+3e3<_.F)Cu(V),go(V);else break e;Nl(V),Je(18)}}else V.xa=fe[1],0<V.xa-V.K&&fe[2]<37500&&V.F&&V.A==0&&!V.C&&(V.C=Ce(m(V.Va,V),6e3));me(V.h)<=1&&V.ta&&(V.ta=void 0)}else va(V,11)}else if((_.L||V.g==_)&&Cu(V),!k(L))for(fe=V.Ba.g.parse(L),L=0;L<fe.length;L++){let zn=fe[L];const xi=zn[0];if(!(xi<=V.K))if(V.K=xi,zn=zn[1],V.I==2)if(zn[0]=="c"){V.M=zn[1],V.ba=zn[2];const ar=zn[3];ar!=null&&(V.ka=ar,V.j.info("VER="+V.ka));const Qa=zn[4];Qa!=null&&(V.za=Qa,V.j.info("SVER="+V.za));const $a=zn[5];$a!=null&&typeof $a=="number"&&$a>0&&($=1.5*$a,V.O=$,V.j.info("backChannelRequestTimeoutMs_="+$)),$=V;const Tr=_.g;if(Tr){const Qo=Tr.g?Tr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qo){var Te=$.h;Te.g||Qo.indexOf("spdy")==-1&&Qo.indexOf("quic")==-1&&Qo.indexOf("h2")==-1||(Te.j=Te.l,Te.g=new Set,Te.h&&(pt(Te,Te.h),Te.h=null))}if($.G){const Lc=Tr.g?Tr.g.getResponseHeader("X-HTTP-Session-Id"):null;Lc&&($.wa=Lc,Ut($.J,$.G,Lc))}}V.I=3,V.l&&V.l.ra(),V.aa&&(V.T=Date.now()-_.F,V.j.info("Handshake RTT: "+V.T+"ms")),$=V;var mt=_;if($.na=Yh($,$.L?$.ba:null,$.W),mt.L){gt($.h,mt);var fn=mt,Fi=$.O;Fi&&(fn.H=Fi),fn.D&&(Yr(fn),Ws(fn)),$.g=mt}else Au($);V.i.length>0&&Ka(V)}else zn[0]!="stop"&&zn[0]!="close"||va(V,7);else V.I==3&&(zn[0]=="stop"||zn[0]=="close"?zn[0]=="stop"?va(V,7):Mu(V):zn[0]!="noop"&&V.l&&V.l.qa(zn),V.A=0)}}je(4)}catch{}}var le=class{constructor(_,L){this.g=_,this.map=L}};function Se(_){this.l=_||10,c.PerformanceNavigationTiming?(_=c.performance.getEntriesByType("navigation"),_=_.length>0&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ge(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function me(_){return _.h?1:_.g?_.g.size:0}function lt(_,L){return _.h?_.h==L:_.g?_.g.has(L):!1}function pt(_,L){_.g?_.g.add(L):_.h=L}function gt(_,L){_.h&&_.h==L?_.h=null:_.g&&_.g.has(L)&&_.g.delete(L)}Se.prototype.cancel=function(){if(this.i=ht(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function ht(_){if(_.h!=null)return _.i.concat(_.h.G);if(_.g!=null&&_.g.size!==0){let L=_.i;for(const V of _.g.values())L=L.concat(V.G);return L}return E(_.i)}var Pt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Kt(_,L){if(_){_=_.split("&");for(let V=0;V<_.length;V++){const $=_[V].indexOf("=");let fe,Te=null;$>=0?(fe=_[V].substring(0,$),Te=_[V].substring($+1)):fe=_[V],L(fe,Te?decodeURIComponent(Te.replace(/\+/g," ")):"")}}}function jt(_){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let L;_ instanceof jt?(this.l=_.l,sn(this,_.j),this.o=_.o,this.g=_.g,qn(this,_.u),this.h=_.h,ti(this,Wh(_.i)),this.m=_.m):_&&(L=String(_).match(Pt))?(this.l=!1,sn(this,L[1]||"",!0),this.o=ct(L[2]||""),this.g=ct(L[3]||"",!0),qn(this,L[4]),this.h=ct(L[5]||"",!0),ti(this,L[6]||"",!0),this.m=ct(L[7]||"")):(this.l=!1,this.i=new li(null,this.l))}jt.prototype.toString=function(){const _=[];var L=this.j;L&&_.push(Ei(L,Wi,!0),":");var V=this.g;return(V||L=="file")&&(_.push("//"),(L=this.o)&&_.push(Ei(L,Wi,!0),"@"),_.push(er(V).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),V=this.u,V!=null&&_.push(":",String(V))),(V=this.h)&&(this.g&&V.charAt(0)!="/"&&_.push("/"),_.push(Ei(V,V.charAt(0)=="/"?qi:Ls,!0))),(V=this.i.toString())&&_.push("?",V),(V=this.m)&&_.push("#",Ei(V,Vn)),_.join("")},jt.prototype.resolve=function(_){const L=bt(this);let V=!!_.j;V?sn(L,_.j):V=!!_.o,V?L.o=_.o:V=!!_.g,V?L.g=_.g:V=_.u!=null;var $=_.h;if(V)qn(L,_.u);else if(V=!!_.h){if($.charAt(0)!="/")if(this.g&&!this.h)$="/"+$;else{var fe=L.h.lastIndexOf("/");fe!=-1&&($=L.h.slice(0,fe+1)+$)}if(fe=$,fe==".."||fe==".")$="";else if(fe.indexOf("./")!=-1||fe.indexOf("/.")!=-1){$=fe.lastIndexOf("/",0)==0,fe=fe.split("/");const Te=[];for(let mt=0;mt<fe.length;){const fn=fe[mt++];fn=="."?$&&mt==fe.length&&Te.push(""):fn==".."?((Te.length>1||Te.length==1&&Te[0]!="")&&Te.pop(),$&&mt==fe.length&&Te.push("")):(Te.push(fn),$=!0)}$=Te.join("/")}else $=fe}return V?L.h=$:V=_.i.toString()!=="",V?ti(L,Wh(_.i)):V=!!_.m,V&&(L.m=_.m),L};function bt(_){return new jt(_)}function sn(_,L,V){_.j=V?ct(L,!0):L,_.j&&(_.j=_.j.replace(/:$/,""))}function qn(_,L){if(L){if(L=Number(L),isNaN(L)||L<0)throw Error("Bad port number "+L);_.u=L}else _.u=null}function ti(_,L,V){L instanceof li?(_.i=L,Cc(_.i,_.l)):(V||(L=Ei(L,Ss)),_.i=new li(L,_.l))}function Ut(_,L,V){_.i.set(L,V)}function Cn(_){return Ut(_,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),_}function ct(_,L){return _?L?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function Ei(_,L,V){return typeof _=="string"?(_=encodeURI(_).replace(L,Qt),V&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function Qt(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var Wi=/[#\/\?@]/g,Ls=/[#\?:]/g,qi=/[#\?]/g,Ss=/[#\?@]/g,Vn=/#/g;function li(_,L){this.h=this.g=null,this.i=_||null,this.j=!!L}function Mi(_){_.g||(_.g=new Map,_.h=0,_.i&&Kt(_.i,function(L,V){_.add(decodeURIComponent(L.replace(/\+/g," ")),V)}))}i=li.prototype,i.add=function(_,L){Mi(this),this.i=null,_=fo(this,_);let V=this.g.get(_);return V||this.g.set(_,V=[]),V.push(L),this.h+=1,this};function Ti(_,L){Mi(_),L=fo(_,L),_.g.has(L)&&(_.i=null,_.h-=_.g.get(L).length,_.g.delete(L))}function sr(_,L){return Mi(_),L=fo(_,L),_.g.has(L)}i.forEach=function(_,L){Mi(this),this.g.forEach(function(V,$){V.forEach(function(fe){_.call(L,fe,$,this)},this)},this)};function Zr(_,L){Mi(_);let V=[];if(typeof L=="string")sr(_,L)&&(V=V.concat(_.g.get(fo(_,L))));else for(_=Array.from(_.g.values()),L=0;L<_.length;L++)V=V.concat(_[L]);return V}i.set=function(_,L){return Mi(this),this.i=null,_=fo(this,_),sr(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[L]),this.h+=1,this},i.get=function(_,L){return _?(_=Zr(this,_),_.length>0?String(_[0]):L):L};function ho(_,L,V){Ti(_,L),V.length>0&&(_.i=null,_.g.set(fo(_,L),E(V)),_.h+=V.length)}i.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],L=Array.from(this.g.keys());for(let $=0;$<L.length;$++){var V=L[$];const fe=er(V);V=Zr(this,V);for(let Te=0;Te<V.length;Te++){let mt=fe;V[Te]!==""&&(mt+="="+er(V[Te])),_.push(mt)}}return this.i=_.join("&")};function Wh(_){const L=new li;return L.i=_.i,_.g&&(L.g=new Map(_.g),L.h=_.h),L}function fo(_,L){return L=String(L),_.j&&(L=L.toLowerCase()),L}function Cc(_,L){L&&!_.j&&(Mi(_),_.i=null,_.g.forEach(function(V,$){const fe=$.toLowerCase();$!=fe&&(Ti(this,$),ho(this,fe,V))},_)),_.j=L}function qa(_,L){const V=new dt;if(c.Image){const $=new Image;$.onload=y(Kr,V,"TestLoadImage: loaded",!0,L,$),$.onerror=y(Kr,V,"TestLoadImage: error",!1,L,$),$.onabort=y(Kr,V,"TestLoadImage: abort",!1,L,$),$.ontimeout=y(Kr,V,"TestLoadImage: timeout",!1,L,$),c.setTimeout(function(){$.ontimeout&&$.ontimeout()},1e4),$.src=_}else L(!1)}function Su(_,L){const V=new dt,$=new AbortController,fe=setTimeout(()=>{$.abort(),Kr(V,"TestPingServer: timeout",!1,L)},1e4);fetch(_,{signal:$.signal}).then(Te=>{clearTimeout(fe),Te.ok?Kr(V,"TestPingServer: ok",!0,L):Kr(V,"TestPingServer: server error",!1,L)}).catch(()=>{clearTimeout(fe),Kr(V,"TestPingServer: error",!1,L)})}function Kr(_,L,V,$,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),$(V)}catch{}}function Xo(){this.g=new rt}function ga(_){this.i=_.Sb||null,this.h=_.ab||!1}v(ga,It),ga.prototype.g=function(){return new wl(this.i,this.h)};function wl(_,L){yt.call(this),this.H=_,this.o=L,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(wl,yt),i=wl.prototype,i.open=function(_,L){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=_,this.D=L,this.readyState=1,ya(this)},i.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const L={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};_&&(L.body=_),(this.H||c).fetch(new Request(this.D,L)).then(this.Pa.bind(this),this.ga.bind(this))},i.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yo(this)),this.readyState=0},i.Pa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,ya(this)),this.g&&(this.readyState=3,ya(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Rc(this)}else _.text().then(this.Oa.bind(this),this.ga.bind(this))};function Rc(_){_.j.read().then(_.Ma.bind(_)).catch(_.ga.bind(_))}i.Ma=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var L=_.value?_.value:new Uint8Array(0);(L=this.B.decode(L,{stream:!_.done}))&&(this.response=this.responseText+=L)}_.done?Yo(this):ya(this),this.readyState==3&&Rc(this)}},i.Oa=function(_){this.g&&(this.response=this.responseText=_,Yo(this))},i.Na=function(_){this.g&&(this.response=_,Yo(this))},i.ga=function(){this.g&&Yo(this)};function Yo(_){_.readyState=4,_.l=null,_.j=null,_.B=null,ya(_)}i.setRequestHeader=function(_,L){this.A.append(_,L)},i.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],L=this.h.entries();for(var V=L.next();!V.done;)V=V.value,_.push(V[0]+": "+V[1]),V=L.next();return _.join(`\r
`)};function ya(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function Qr(_){let L="";return be(_,function(V,$){L+=$,L+=":",L+=V,L+=`\r
`}),L}function Ic(_,L,V){e:{for($ in V){var $=!1;break e}$=!0}$||(V=Qr(V),typeof _=="string"?V!=null&&er(V):Ut(_,L,V))}function si(_){yt.call(this),this.headers=new Map,this.L=_||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(si,yt);var rr=/^https?$/i,Eu=["POST","PUT"];i=si.prototype,i.Fa=function(_){this.H=_},i.ea=function(_,L,V,$){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);L=L?L.toUpperCase():"GET",this.D=_,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Tl.g(),this.g.onreadystatechange=x(m(this.Ca,this));try{this.B=!0,this.g.open(L,String(_),!0),this.B=!1}catch(Te){po(this,Te);return}if(_=V||"",V=new Map(this.headers),$)if(Object.getPrototypeOf($)===Object.prototype)for(var fe in $)V.set(fe,$[fe]);else if(typeof $.keys=="function"&&typeof $.get=="function")for(const Te of $.keys())V.set(Te,$.get(Te));else throw Error("Unknown input type for opt_headers: "+String($));$=Array.from(V.keys()).find(Te=>Te.toLowerCase()=="content-type"),fe=c.FormData&&_ instanceof c.FormData,!(Array.prototype.indexOf.call(Eu,L,void 0)>=0)||$||fe||V.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Te,mt]of V)this.g.setRequestHeader(Te,mt);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(_),this.v=!1}catch(Te){po(this,Te)}};function po(_,L){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=L,_.o=5,Cl(_),Xa(_)}function Cl(_){_.A||(_.A=!0,it(_,"complete"),it(_,"error"))}i.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=_||7,it(this,"complete"),it(this,"abort"),Xa(this))},i.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xa(this,!0)),si.Z.N.call(this)},i.Ca=function(){this.u||(this.B||this.v||this.j?Rl(this):this.Xa())},i.Xa=function(){Rl(this)};function Rl(_){if(_.h&&typeof a<"u"){if(_.v&&Ya(_)==4)setTimeout(_.Ca.bind(_),0);else if(it(_,"readystatechange"),Ya(_)==4){_.h=!1;try{const Te=_.ca();e:switch(Te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var L=!0;break e;default:L=!1}var V;if(!(V=L)){var $;if($=Te===0){let mt=String(_.D).match(Pt)[1]||null;!mt&&c.self&&c.self.location&&(mt=c.self.location.protocol.slice(0,-1)),$=!rr.test(mt?mt.toLowerCase():"")}V=$}if(V)it(_,"complete"),it(_,"success");else{_.o=6;try{var fe=Ya(_)>2?_.g.statusText:""}catch{fe=""}_.l=fe+" ["+_.ca()+"]",Cl(_)}}finally{Xa(_)}}}}function Xa(_,L){if(_.g){_.m&&(clearTimeout(_.m),_.m=null);const V=_.g;_.g=null,L||it(_,"ready");try{V.onreadystatechange=null}catch{}}}i.isActive=function(){return!!this.g};function Ya(_){return _.g?_.g.readyState:0}i.ca=function(){try{return Ya(this)>2?this.g.status:-1}catch{return-1}},i.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},i.La=function(_){if(this.g){var L=this.g.responseText;return _&&L.indexOf(_)==0&&(L=L.substring(_.length)),vt(L)}};function Es(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.F){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function mo(_){const L={};_=(_.g&&Ya(_)>=2&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let $=0;$<_.length;$++){if(k(_[$]))continue;var V=Mr(_[$]);const fe=V[0];if(V=V[1],typeof V!="string")continue;V=V.trim();const Te=L[fe]||[];L[fe]=Te,Te.push(V)}Be(L,function($){return $.join(", ")})}i.ya=function(){return this.o},i.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Za(_,L,V){return V&&V.internalChannelParams&&V.internalChannelParams[_]||L}function Zo(_){this.za=0,this.i=[],this.j=new dt,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Za("failFast",!1,_),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Za("baseRetryDelayMs",5e3,_),this.Za=Za("retryDelaySeedMs",1e4,_),this.Ta=Za("forwardChannelMaxRetries",2,_),this.va=Za("forwardChannelRequestTimeoutMs",2e4,_),this.ma=_&&_.xmlHttpFactory||void 0,this.Ua=_&&_.Rb||void 0,this.Aa=_&&_.useFetchStreams||!1,this.O=void 0,this.L=_&&_.supportsCrossDomainXhr||!1,this.M="",this.h=new Se(_&&_.concurrentRequestLimit),this.Ba=new Xo,this.S=_&&_.fastHandshake||!1,this.R=_&&_.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=_&&_.Pb||!1,_&&_.ua&&this.j.ua(),_&&_.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&_&&_.detectBufferingProxy||!1,this.ia=void 0,_&&_.longPollingTimeout&&_.longPollingTimeout>0&&(this.ia=_.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}i=Zo.prototype,i.ka=8,i.I=1,i.connect=function(_,L,V,$){Je(0),this.W=_,this.H=L||{},V&&$!==void 0&&(this.H.OSID=V,this.H.OAID=$),this.F=this.X,this.J=Yh(this,null,this.W),Ka(this)};function Mu(_){if(Dc(_),_.I==3){var L=_.V++,V=bt(_.J);if(Ut(V,"SID",_.M),Ut(V,"RID",L),Ut(V,"TYPE","terminate"),Dl(_,V),L=new ji(_,_.j,L),L.M=2,L.A=Cn(bt(V)),V=!1,c.navigator&&c.navigator.sendBeacon)try{V=c.navigator.sendBeacon(L.A.toString(),"")}catch{}!V&&c.Image&&(new Image().src=L.A,V=!0),V||(L.g=Zh(L.j,null),L.g.ea(L.A)),L.F=Date.now(),Ws(L)}Nc(_)}function go(_){_.g&&(wu(_),_.g.cancel(),_.g=null)}function Dc(_){go(_),_.v&&(c.clearTimeout(_.v),_.v=null),Cu(_),_.h.cancel(),_.m&&(typeof _.m=="number"&&c.clearTimeout(_.m),_.m=null)}function Ka(_){if(!ge(_.h)&&!_.m){_.m=!0;var L=_.Ea;q||R(),j||(q(),j=!0),F.add(L,_),_.D=0}}function Il(_,L){return me(_.h)>=_.h.j-(_.m?1:0)?!1:_.m?(_.i=L.G.concat(_.i),!0):_.I==1||_.I==2||_.D>=(_.Sa?0:_.Ta)?!1:(_.m=Ce(m(_.Ea,_,L),Pl(_,_.D)),_.D++,!0)}i.Ea=function(_){if(this.m)if(this.m=null,this.I==1){if(!_){this.V=Math.floor(Math.random()*1e5),_=this.V++;const fe=new ji(this,this.j,_);let Te=this.o;if(this.U&&(Te?(Te=Oe(Te),$e(Te,this.U)):Te=this.U),this.u!==null||this.R||(fe.J=Te,Te=null),this.S)e:{for(var L=0,V=0;V<this.i.length;V++){t:{var $=this.i[V];if("__data__"in $.map&&($=$.map.__data__,typeof $=="string")){$=$.length;break t}$=void 0}if($===void 0)break;if(L+=$,L>4096){L=V;break e}if(L===4096||V===this.i.length-1){L=V+1;break e}}L=1e3}else L=1e3;L=qh(this,fe,L),V=bt(this.J),Ut(V,"RID",_),Ut(V,"CVER",22),this.G&&Ut(V,"X-HTTP-Session-Id",this.G),Dl(this,V),Te&&(this.R?L="headers="+er(Qr(Te))+"&"+L:this.u&&Ic(V,this.u,Te)),pt(this.h,fe),this.Ra&&Ut(V,"TYPE","init"),this.S?(Ut(V,"$req",L),Ut(V,"SID","null"),fe.U=!0,nr(fe,V,null)):nr(fe,V,L),this.I=2}}else this.I==3&&(_?Tu(this,_):this.i.length==0||ge(this.h)||Tu(this))};function Tu(_,L){var V;L?V=L.l:V=_.V++;const $=bt(_.J);Ut($,"SID",_.M),Ut($,"RID",V),Ut($,"AID",_.K),Dl(_,$),_.u&&_.o&&Ic($,_.u,_.o),V=new ji(_,_.j,V,_.D+1),_.u===null&&(V.J=_.o),L&&(_.i=L.G.concat(_.i)),L=qh(_,V,1e3),V.H=Math.round(_.va*.5)+Math.round(_.va*.5*Math.random()),pt(_.h,V),nr(V,$,L)}function Dl(_,L){_.H&&be(_.H,function(V,$){Ut(L,$,V)}),_.l&&be({},function(V,$){Ut(L,$,V)})}function qh(_,L,V){V=Math.min(_.i.length,V);const $=_.l?m(_.l.Ka,_.l,_):null;e:{var fe=_.i;let fn=-1;for(;;){const Fi=["count="+V];fn==-1?V>0?(fn=fe[0].g,Fi.push("ofs="+fn)):fn=0:Fi.push("ofs="+fn);let zn=!0;for(let xi=0;xi<V;xi++){var Te=fe[xi].g;const ar=fe[xi].map;if(Te-=fn,Te<0)fn=Math.max(0,fe[xi].g-100),zn=!1;else try{Te="req"+Te+"_"||"";try{var mt=ar instanceof Map?ar:Object.entries(ar);for(const[Qa,$a]of mt){let Tr=$a;f($a)&&(Tr=we($a)),Fi.push(Te+Qa+"="+encodeURIComponent(Tr))}}catch(Qa){throw Fi.push(Te+"type="+encodeURIComponent("_badmap")),Qa}}catch{$&&$(ar)}}if(zn){mt=Fi.join("&");break e}}mt=void 0}return _=_.i.splice(0,V),L.G=_,mt}function Au(_){if(!_.g&&!_.v){_.Y=1;var L=_.Da;q||R(),j||(q(),j=!0),F.add(L,_),_.A=0}}function Nl(_){return _.g||_.v||_.A>=3?!1:(_.Y++,_.v=Ce(m(_.Da,_),Pl(_,_.A)),_.A++,!0)}i.Da=function(){if(this.v=null,vd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var _=4*this.T;this.j.info("BP detection timer enabled: "+_),this.B=Ce(m(this.Wa,this),_)}},i.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Je(10),go(this),vd(this))};function wu(_){_.B!=null&&(c.clearTimeout(_.B),_.B=null)}function vd(_){_.g=new ji(_,_.j,"rpc",_.Y),_.u===null&&(_.g.J=_.o),_.g.P=0;var L=bt(_.na);Ut(L,"RID","rpc"),Ut(L,"SID",_.M),Ut(L,"AID",_.K),Ut(L,"CI",_.F?"0":"1"),!_.F&&_.ia&&Ut(L,"TO",_.ia),Ut(L,"TYPE","xmlhttp"),Dl(_,L),_.u&&_.o&&Ic(L,_.u,_.o),_.O&&(_.g.H=_.O);var V=_.g;_=_.ba,V.M=1,V.A=Cn(bt(L)),V.u=null,V.R=!0,bs(V,_)}i.Va=function(){this.C!=null&&(this.C=null,go(this),Nl(this),Je(19))};function Cu(_){_.C!=null&&(c.clearTimeout(_.C),_.C=null)}function Xh(_,L){var V=null;if(_.g==L){Cu(_),wu(_),_.g=null;var $=2}else if(lt(_.h,L))V=L.G,gt(_.h,L),$=1;else return;if(_.I!=0){if(L.o)if($==1){V=L.u?L.u.length:0,L=Date.now()-L.F;var fe=_.D;$=at(),it($,new Qe($,V)),Ka(_)}else Au(_);else if(fe=L.m,fe==3||fe==0&&L.X>0||!($==1&&Il(_,L)||$==2&&Nl(_)))switch(V&&V.length>0&&(L=_.h,L.i=L.i.concat(V)),fe){case 1:va(_,5);break;case 4:va(_,10);break;case 3:va(_,6);break;default:va(_,2)}}}function Pl(_,L){let V=_.Qa+Math.floor(Math.random()*_.Za);return _.isActive()||(V*=2),V*L}function va(_,L){if(_.j.info("Error code "+L),L==2){var V=m(_.bb,_),$=_.Ua;const fe=!$;$=new jt($||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||sn($,"https"),Cn($),fe?qa($.toString(),V):Su($.toString(),V)}else Je(2);_.I=0,_.l&&_.l.pa(L),Nc(_),Dc(_)}i.bb=function(_){_?(this.j.info("Successfully pinged google.com"),Je(2)):(this.j.info("Failed to ping google.com"),Je(1))};function Nc(_){if(_.I=0,_.ja=[],_.l){const L=ht(_.h);(L.length!=0||_.i.length!=0)&&(T(_.ja,L),T(_.ja,_.i),_.h.i.length=0,E(_.i),_.i.length=0),_.l.oa()}}function Yh(_,L,V){var $=V instanceof jt?bt(V):new jt(V);if($.g!="")L&&($.g=L+"."+$.g),qn($,$.u);else{var fe=c.location;$=fe.protocol,L=L?L+"."+fe.hostname:fe.hostname,fe=+fe.port;const Te=new jt(null);$&&sn(Te,$),L&&(Te.g=L),fe&&qn(Te,fe),V&&(Te.h=V),$=Te}return V=_.G,L=_.wa,V&&L&&Ut($,V,L),Ut($,"VER",_.ka),Dl(_,$),$}function Zh(_,L,V){if(L&&!_.L)throw Error("Can't create secondary domain capable XhrIo object.");return L=_.Aa&&!_.ma?new si(new ga({ab:V})):new si(_.ma),L.Fa(_.L),L}i.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ru(){}i=Ru.prototype,i.ra=function(){},i.qa=function(){},i.pa=function(){},i.oa=function(){},i.isActive=function(){return!0},i.Ka=function(){};function Ko(){}Ko.prototype.g=function(_,L){return new Xs(_,L)};function Xs(_,L){yt.call(this),this.g=new Zo(L),this.l=_,this.h=L&&L.messageUrlParams||null,_=L&&L.messageHeaders||null,L&&L.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=L&&L.initMessageHeaders||null,L&&L.messageContentType&&(_?_["X-WebChannel-Content-Type"]=L.messageContentType:_={"X-WebChannel-Content-Type":L.messageContentType}),L&&L.sa&&(_?_["X-WebChannel-Client-Profile"]=L.sa:_={"X-WebChannel-Client-Profile":L.sa}),this.g.U=_,(_=L&&L.Qb)&&!k(_)&&(this.g.u=_),this.A=L&&L.supportsCrossDomainXhr||!1,this.v=L&&L.sendRawJson||!1,(L=L&&L.httpSessionIdParam)&&!k(L)&&(this.g.G=L,_=this.h,_!==null&&L in _&&(_=this.h,L in _&&delete _[L])),this.j=new vo(this)}v(Xs,yt),Xs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Xs.prototype.close=function(){Mu(this.g)},Xs.prototype.o=function(_){var L=this.g;if(typeof _=="string"){var V={};V.__data__=_,_=V}else this.v&&(V={},V.__data__=we(_),_=V);L.i.push(new le(L.Ya++,_)),L.I==3&&Ka(L)},Xs.prototype.N=function(){this.g.l=null,delete this.j,Mu(this.g),delete this.g,Xs.Z.N.call(this)};function yo(_){Xe.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var L=_.__sm__;if(L){e:{for(const V in L){_=V;break e}_=void 0}(this.i=_)&&(_=this.i,L=L!==null&&_ in L?L[_]:void 0),this.data=L}else this.data=_}v(yo,Xe);function Pc(){_t.call(this),this.status=1}v(Pc,_t);function vo(_){this.g=_}v(vo,Ru),vo.prototype.ra=function(){it(this.g,"a")},vo.prototype.qa=function(_){it(this.g,new yo(_))},vo.prototype.pa=function(_){it(this.g,new Pc)},vo.prototype.oa=function(){it(this.g,"b")},Ko.prototype.createWebChannel=Ko.prototype.g,Xs.prototype.send=Xs.prototype.o,Xs.prototype.open=Xs.prototype.m,Xs.prototype.close=Xs.prototype.close,_D=function(){return new Ko},vD=function(){return at()},yD=ne,LE={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Er.NO_ERROR=0,Er.TIMEOUT=8,Er.HTTP_ERROR=6,q_=Er,pa.COMPLETE="complete",gD=pa,Ft.EventType=We,We.OPEN="a",We.CLOSE="b",We.ERROR="c",We.MESSAGE="d",yt.prototype.listen=yt.prototype.J,c0=Ft,si.prototype.listenOnce=si.prototype.K,si.prototype.getLastError=si.prototype.Ha,si.prototype.getLastErrorCode=si.prototype.ya,si.prototype.getStatus=si.prototype.ca,si.prototype.getResponseJson=si.prototype.La,si.prototype.getResponseText=si.prototype.la,si.prototype.send=si.prototype.ea,si.prototype.setWithCredentials=si.prototype.Fa,mD=si}).apply(typeof O_<"u"?O_:typeof self<"u"?self:typeof window<"u"?window:{});class Vr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vr.UNAUTHENTICATED=new Vr(null),Vr.GOOGLE_CREDENTIALS=new Vr("google-credentials-uid"),Vr.FIRST_PARTY=new Vr("first-party-uid"),Vr.MOCK_USER=new Vr("mock-user");let Rm="12.9.0";function i9(i){Rm=i}const ud=new lD("@firebase/firestore");function zp(){return ud.logLevel}function Dt(i,...e){if(ud.logLevel<=Zn.DEBUG){const t=e.map(sT);ud.debug(`Firestore (${Rm}): ${i}`,...t)}}function bu(i,...e){if(ud.logLevel<=Zn.ERROR){const t=e.map(sT);ud.error(`Firestore (${Rm}): ${i}`,...t)}}function hd(i,...e){if(ud.logLevel<=Zn.WARN){const t=e.map(sT);ud.warn(`Firestore (${Rm}): ${i}`,...t)}}function sT(i){if(typeof i=="string")return i;try{return(function(t){return JSON.stringify(t)})(i)}catch{return i}}function bn(i,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,xD(i,n,t)}function xD(i,e,t){let n=`FIRESTORE (${Rm}) INTERNAL ASSERTION FAILED: ${e} (ID: ${i.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw bu(n),new Error(n)}function ns(i,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,i||xD(e,s,n)}function Kn(i,e){return i}const xt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xt extends Cm{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class id{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class bD{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class s9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Vr.UNAUTHENTICATED)))}shutdown(){}}class r9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class a9{constructor(e){this.t=e,this.currentUser=Vr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ns(this.o===void 0,42304);let n=this.i;const s=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let a=new id;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new id,e.enqueueRetryable((()=>s(this.currentUser)))};const c=()=>{const d=a;e.enqueueRetryable((async()=>{await d.promise,await s(this.currentUser)}))},f=d=>{Dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((d=>f(d))),setTimeout((()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?f(d):(Dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new id)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(Dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ns(typeof n.accessToken=="string",31837,{l:n}),new bD(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ns(e===null||typeof e=="string",2055,{h:e}),new Vr(e)}}class o9{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Vr.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class l9{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new o9(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Vr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class NC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class c9{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,H8(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ns(this.o===void 0,3512);const n=a=>{a.error!=null&&Dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.m;return this.m=a.token,Dt("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>n(a)))};const s=a=>{Dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):Dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new NC(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ns(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new NC(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function u9(i){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}class SD{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=u9(40);for(let a=0;a<s.length;++a)n.length<20&&s[a]<t&&(n+=e.charAt(s[a]%62))}return n}}function Wn(i,e){return i<e?-1:i>e?1:0}function OE(i,e){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++){const s=i.charAt(n),a=e.charAt(n);if(s!==a)return $1(s)===$1(a)?Wn(s,a):$1(s)?1:-1}return Wn(i.length,e.length)}const h9=55296,f9=57343;function $1(i){const e=i.charCodeAt(0);return e>=h9&&e<=f9}function hm(i,e,t){return i.length===e.length&&i.every(((n,s)=>t(n,e[s])))}const PC="__name__";class fc{constructor(e,t,n){t===void 0?t=0:t>e.length&&bn(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&bn(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return fc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof fc?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const a=fc.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return Wn(e.length,t.length)}static compareSegments(e,t){const n=fc.isNumericId(e),s=fc.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?fc.extractNumericId(e).compare(fc.extractNumericId(t)):OE(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ch.fromString(e.substring(4,e.length-2))}}class es extends fc{construct(e,t,n){return new es(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Xt(xt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((s=>s.length>0)))}return new es(t)}static emptyPath(){return new es([])}}const d9=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ha extends fc{construct(e,t,n){return new ha(e,t,n)}static isValidIdentifier(e){return d9.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ha.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===PC}static keyField(){return new ha([PC])}static fromServerFormat(e){const t=[];let n="",s=0;const a=()=>{if(n.length===0)throw new Xt(xt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let c=!1;for(;s<e.length;){const f=e[s];if(f==="\\"){if(s+1===e.length)throw new Xt(xt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Xt(xt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,s+=2}else f==="`"?(c=!c,s++):f!=="."||c?(n+=f,s++):(a(),s++)}if(a(),c)throw new Xt(xt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ha(t)}static emptyPath(){return new ha([])}}class an{constructor(e){this.path=e}static fromPath(e){return new an(es.fromString(e))}static fromName(e){return new an(es.fromString(e).popFirst(5))}static empty(){return new an(es.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&es.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return es.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new an(new es(e.slice()))}}function p9(i,e,t,n){if(e===!0&&n===!0)throw new Xt(xt.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function LC(i){if(an.isDocumentKey(i))throw new Xt(xt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function m9(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}function g9(i){if(i===void 0)return"undefined";if(i===null)return"null";if(typeof i=="string")return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if(typeof i=="number"||typeof i=="boolean")return""+i;if(typeof i=="object"){if(i instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(i);return e?`a custom ${e} object`:"an object"}}return typeof i=="function"?"a function":bn(12329,{type:typeof i})}function UE(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new Xt(xt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=g9(i);throw new Xt(xt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function Ps(i,e){const t={typeString:i};return e&&(t.value=e),t}function fy(i,e){if(!m9(i))throw new Xt(xt.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in i)){t=`JSON missing required field: '${n}'`;break}const c=i[n];if(s&&typeof c!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(a!==void 0&&c!==a.value){t=`Expected '${n}' field to equal '${a.value}'`;break}}if(t)throw new Xt(xt.INVALID_ARGUMENT,t);return!0}const OC=-62135596800,UC=1e6;class Ns{static now(){return Ns.fromMillis(Date.now())}static fromDate(e){return Ns.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*UC);return new Ns(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Xt(xt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Xt(xt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<OC)throw new Xt(xt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xt(xt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/UC}_compareTo(e){return this.seconds===e.seconds?Wn(this.nanoseconds,e.nanoseconds):Wn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ns._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(fy(e,Ns._jsonSchema))return new Ns(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-OC;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ns._jsonSchemaVersion="firestore/timestamp/1.0",Ns._jsonSchema={type:Ps("string",Ns._jsonSchemaVersion),seconds:Ps("number"),nanoseconds:Ps("number")};class gn{static fromTimestamp(e){return new gn(e)}static min(){return new gn(new Ns(0,0))}static max(){return new gn(new Ns(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Z0=-1;function y9(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,s=gn.fromTimestamp(n===1e9?new Ns(t+1,0):new Ns(t,n));return new Oh(s,an.empty(),e)}function v9(i){return new Oh(i.readTime,i.key,Z0)}class Oh{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Oh(gn.min(),an.empty(),Z0)}static max(){return new Oh(gn.max(),an.empty(),Z0)}}function _9(i,e){let t=i.readTime.compareTo(e.readTime);return t!==0?t:(t=an.comparator(i.documentKey,e.documentKey),t!==0?t:Wn(i.largestBatchId,e.largestBatchId))}const x9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class b9{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Zb(i){if(i.code!==xt.FAILED_PRECONDITION||i.message!==x9)throw i;Dt("LocalStore","Unexpectedly lost primary lease")}class qe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&bn(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new qe(((n,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(n,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof qe?t:qe.resolve(t)}catch(t){return qe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):qe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):qe.reject(t)}static resolve(e){return new qe(((t,n)=>{t(e)}))}static reject(e){return new qe(((t,n)=>{n(e)}))}static waitFor(e){return new qe(((t,n)=>{let s=0,a=0,c=!1;e.forEach((f=>{++s,f.next((()=>{++a,c&&a===s&&t()}),(d=>n(d)))})),c=!0,a===s&&t()}))}static or(e){let t=qe.resolve(!1);for(const n of e)t=t.next((s=>s?qe.resolve(s):n()));return t}static forEach(e,t){const n=[];return e.forEach(((s,a)=>{n.push(t.call(this,s,a))})),this.waitFor(n)}static mapArray(e,t){return new qe(((n,s)=>{const a=e.length,c=new Array(a);let f=0;for(let d=0;d<a;d++){const m=d;t(e[m]).next((y=>{c[m]=y,++f,f===a&&n(c)}),(y=>s(y)))}}))}static doWhile(e,t){return new qe(((n,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):n()};a()}))}}function S9(i){const e=i.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Im(i){return i.name==="IndexedDbTransactionError"}class Kb{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Kb.ce=-1;const E9=-1;function Qb(i){return i==null}function zE(i){return i===0&&1/i==-1/0}const ED="";function M9(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=zC(e)),e=T9(i.get(t),e);return zC(e)}function T9(i,e){let t=e;const n=i.length;for(let s=0;s<n;s++){const a=i.charAt(s);switch(a){case"\0":t+="";break;case ED:t+="";break;default:t+=a}}return t}function zC(i){return i+ED+""}function FC(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function dy(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function A9(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}class xs{constructor(e,t){this.comparator=e,this.root=t||_r.EMPTY}insert(e,t){return new xs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_r.BLACK,null,null))}remove(e){return new xs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_r.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new U_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new U_(this.root,e,this.comparator,!1)}getReverseIterator(){return new U_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new U_(this.root,e,this.comparator,!0)}}class U_{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _r{constructor(e,t,n,s,a){this.key=e,this.value=t,this.color=n??_r.RED,this.left=s??_r.EMPTY,this.right=a??_r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,a){return new _r(e??this.key,t??this.value,n??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const a=n(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,n),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return _r.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw bn(43730,{key:this.key,value:this.value});if(this.right.isRed())throw bn(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw bn(27949);return e+(this.isRed()?0:1)}}_r.EMPTY=null,_r.RED=!0,_r.BLACK=!1;_r.EMPTY=new class{constructor(){this.size=0}get key(){throw bn(57766)}get value(){throw bn(16141)}get color(){throw bn(16727)}get left(){throw bn(29726)}get right(){throw bn(36894)}copy(e,t,n,s,a){return this}insert(e,t,n){return new _r(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Hs{constructor(e){this.comparator=e,this.data=new xs(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new BC(this.data.getIterator())}getIteratorFrom(e){return new BC(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof Hs)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=n.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Hs(this.comparator);return t.data=e,t}}class BC{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Mh{constructor(e){this.fields=e,e.sort(ha.comparator)}static empty(){return new Mh([])}unionWith(e){let t=new Hs(ha.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Mh(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hm(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}class MD extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Sr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new MD("Invalid base64 string: "+a):a}})(e);return new Sr(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let c=0;c<s.length;++c)a+=String.fromCharCode(s[c]);return a})(e);return new Sr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Wn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Sr.EMPTY_BYTE_STRING=new Sr("");const w9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Uh(i){if(ns(!!i,39018),typeof i=="string"){let e=0;const t=w9.exec(i);if(ns(!!t,46558,{timestamp:i}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ms(i.seconds),nanos:ms(i.nanos)}}function ms(i){return typeof i=="number"?i:typeof i=="string"?Number(i):0}function zh(i){return typeof i=="string"?Sr.fromBase64String(i):Sr.fromUint8Array(i)}const TD="server_timestamp",AD="__type__",wD="__previous_value__",CD="__local_write_time__";function rT(i){return(i?.mapValue?.fields||{})[AD]?.stringValue===TD}function $b(i){const e=i.mapValue.fields[wD];return rT(e)?$b(e):e}function K0(i){const e=Uh(i.mapValue.fields[CD].timestampValue);return new Ns(e.seconds,e.nanos)}class C9{constructor(e,t,n,s,a,c,f,d,m,y,v){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=f,this.longPollingOptions=d,this.useFetchStreams=m,this.isUsingEmulator=y,this.apiKey=v}}const rb="(default)";class Q0{constructor(e,t){this.projectId=e,this.database=t||rb}static empty(){return new Q0("","")}get isDefaultDatabase(){return this.database===rb}isEqual(e){return e instanceof Q0&&e.projectId===this.projectId&&e.database===this.database}}function R9(i,e){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new Xt(xt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Q0(i.options.projectId,e)}const I9="__type__",D9="__max__",z_={mapValue:{}},N9="__vector__",FE="value";function Fh(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?rT(i)?4:L9(i)?9007199254740991:P9(i)?10:11:bn(28295,{value:i})}function Mc(i,e){if(i===e)return!0;const t=Fh(i);if(t!==Fh(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return K0(i).isEqual(K0(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const c=Uh(s.timestampValue),f=Uh(a.timestampValue);return c.seconds===f.seconds&&c.nanos===f.nanos})(i,e);case 5:return i.stringValue===e.stringValue;case 6:return(function(s,a){return zh(s.bytesValue).isEqual(zh(a.bytesValue))})(i,e);case 7:return i.referenceValue===e.referenceValue;case 8:return(function(s,a){return ms(s.geoPointValue.latitude)===ms(a.geoPointValue.latitude)&&ms(s.geoPointValue.longitude)===ms(a.geoPointValue.longitude)})(i,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return ms(s.integerValue)===ms(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const c=ms(s.doubleValue),f=ms(a.doubleValue);return c===f?zE(c)===zE(f):isNaN(c)&&isNaN(f)}return!1})(i,e);case 9:return hm(i.arrayValue.values||[],e.arrayValue.values||[],Mc);case 10:case 11:return(function(s,a){const c=s.mapValue.fields||{},f=a.mapValue.fields||{};if(FC(c)!==FC(f))return!1;for(const d in c)if(c.hasOwnProperty(d)&&(f[d]===void 0||!Mc(c[d],f[d])))return!1;return!0})(i,e);default:return bn(52216,{left:i})}}function $0(i,e){return(i.values||[]).find((t=>Mc(t,e)))!==void 0}function fm(i,e){if(i===e)return 0;const t=Fh(i),n=Fh(e);if(t!==n)return Wn(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Wn(i.booleanValue,e.booleanValue);case 2:return(function(a,c){const f=ms(a.integerValue||a.doubleValue),d=ms(c.integerValue||c.doubleValue);return f<d?-1:f>d?1:f===d?0:isNaN(f)?isNaN(d)?0:-1:1})(i,e);case 3:return VC(i.timestampValue,e.timestampValue);case 4:return VC(K0(i),K0(e));case 5:return OE(i.stringValue,e.stringValue);case 6:return(function(a,c){const f=zh(a),d=zh(c);return f.compareTo(d)})(i.bytesValue,e.bytesValue);case 7:return(function(a,c){const f=a.split("/"),d=c.split("/");for(let m=0;m<f.length&&m<d.length;m++){const y=Wn(f[m],d[m]);if(y!==0)return y}return Wn(f.length,d.length)})(i.referenceValue,e.referenceValue);case 8:return(function(a,c){const f=Wn(ms(a.latitude),ms(c.latitude));return f!==0?f:Wn(ms(a.longitude),ms(c.longitude))})(i.geoPointValue,e.geoPointValue);case 9:return kC(i.arrayValue,e.arrayValue);case 10:return(function(a,c){const f=a.fields||{},d=c.fields||{},m=f[FE]?.arrayValue,y=d[FE]?.arrayValue,v=Wn(m?.values?.length||0,y?.values?.length||0);return v!==0?v:kC(m,y)})(i.mapValue,e.mapValue);case 11:return(function(a,c){if(a===z_.mapValue&&c===z_.mapValue)return 0;if(a===z_.mapValue)return 1;if(c===z_.mapValue)return-1;const f=a.fields||{},d=Object.keys(f),m=c.fields||{},y=Object.keys(m);d.sort(),y.sort();for(let v=0;v<d.length&&v<y.length;++v){const x=OE(d[v],y[v]);if(x!==0)return x;const E=fm(f[d[v]],m[y[v]]);if(E!==0)return E}return Wn(d.length,y.length)})(i.mapValue,e.mapValue);default:throw bn(23264,{he:t})}}function VC(i,e){if(typeof i=="string"&&typeof e=="string"&&i.length===e.length)return Wn(i,e);const t=Uh(i),n=Uh(e),s=Wn(t.seconds,n.seconds);return s!==0?s:Wn(t.nanos,n.nanos)}function kC(i,e){const t=i.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const a=fm(t[s],n[s]);if(a)return a}return Wn(t.length,n.length)}function dm(i){return BE(i)}function BE(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?(function(t){const n=Uh(t);return`time(${n.seconds},${n.nanos})`})(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?(function(t){return zh(t).toBase64()})(i.bytesValue):"referenceValue"in i?(function(t){return an.fromName(t).toString()})(i.referenceValue):"geoPointValue"in i?(function(t){return`geo(${t.latitude},${t.longitude})`})(i.geoPointValue):"arrayValue"in i?(function(t){let n="[",s=!0;for(const a of t.values||[])s?s=!1:n+=",",n+=BE(a);return n+"]"})(i.arrayValue):"mapValue"in i?(function(t){const n=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const c of n)a?a=!1:s+=",",s+=`${c}:${BE(t.fields[c])}`;return s+"}"})(i.mapValue):bn(61005,{value:i})}function X_(i){switch(Fh(i)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$b(i);return e?16+X_(e):16;case 5:return 2*i.stringValue.length;case 6:return zh(i.bytesValue).approximateByteSize();case 7:return i.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((s,a)=>s+X_(a)),0)})(i.arrayValue);case 10:case 11:return(function(n){let s=0;return dy(n.fields,((a,c)=>{s+=a.length+X_(c)})),s})(i.mapValue);default:throw bn(13486,{value:i})}}function VE(i){return!!i&&"integerValue"in i}function aT(i){return!!i&&"arrayValue"in i}function HC(i){return!!i&&"nullValue"in i}function GC(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function J1(i){return!!i&&"mapValue"in i}function P9(i){return(i?.mapValue?.fields||{})[I9]?.stringValue===N9}function T0(i){if(i.geoPointValue)return{geoPointValue:{...i.geoPointValue}};if(i.timestampValue&&typeof i.timestampValue=="object")return{timestampValue:{...i.timestampValue}};if(i.mapValue){const e={mapValue:{fields:{}}};return dy(i.mapValue.fields,((t,n)=>e.mapValue.fields[t]=T0(n))),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=T0(i.arrayValue.values[t]);return e}return{...i}}function L9(i){return(((i.mapValue||{}).fields||{}).__type__||{}).stringValue===D9}class pc{constructor(e){this.value=e}static empty(){return new pc({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!J1(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=T0(t)}setAll(e){let t=ha.emptyPath(),n={},s=[];e.forEach(((c,f)=>{if(!t.isImmediateParentOf(f)){const d=this.getFieldsMap(t);this.applyChanges(d,n,s),n={},s=[],t=f.popLast()}c?n[f.lastSegment()]=T0(c):s.push(f.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,n,s)}delete(e){const t=this.field(e.popLast());J1(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Mc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];J1(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){dy(t,((s,a)=>e[s]=a));for(const s of n)delete e[s]}clone(){return new pc(T0(this.value))}}class Hr{constructor(e,t,n,s,a,c,f){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=a,this.data=c,this.documentState=f}static newInvalidDocument(e){return new Hr(e,0,gn.min(),gn.min(),gn.min(),pc.empty(),0)}static newFoundDocument(e,t,n,s){return new Hr(e,1,t,gn.min(),n,s,0)}static newNoDocument(e,t){return new Hr(e,2,t,gn.min(),gn.min(),pc.empty(),0)}static newUnknownDocument(e,t){return new Hr(e,3,t,gn.min(),gn.min(),pc.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(gn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pc.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pc.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Hr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Hr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class ab{constructor(e,t){this.position=e,this.inclusive=t}}function jC(i,e,t){let n=0;for(let s=0;s<i.position.length;s++){const a=e[s],c=i.position[s];if(a.field.isKeyField()?n=an.comparator(an.fromName(c.referenceValue),t.key):n=fm(c,t.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function WC(i,e){if(i===null)return e===null;if(e===null||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!Mc(i.position[t],e.position[t]))return!1;return!0}class ob{constructor(e,t="asc"){this.field=e,this.dir=t}}function O9(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}class RD{}class Bs extends RD{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new z9(e,t,n):t==="array-contains"?new V9(e,n):t==="in"?new k9(e,n):t==="not-in"?new H9(e,n):t==="array-contains-any"?new G9(e,n):new Bs(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new F9(e,n):new B9(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(fm(t,this.value)):t!==null&&Fh(this.value)===Fh(t)&&this.matchesComparison(fm(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return bn(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Tc extends RD{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Tc(e,t)}matches(e){return ID(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ID(i){return i.op==="and"}function DD(i){return U9(i)&&ID(i)}function U9(i){for(const e of i.filters)if(e instanceof Tc)return!1;return!0}function kE(i){if(i instanceof Bs)return i.field.canonicalString()+i.op.toString()+dm(i.value);if(DD(i))return i.filters.map((e=>kE(e))).join(",");{const e=i.filters.map((t=>kE(t))).join(",");return`${i.op}(${e})`}}function ND(i,e){return i instanceof Bs?(function(n,s){return s instanceof Bs&&n.op===s.op&&n.field.isEqual(s.field)&&Mc(n.value,s.value)})(i,e):i instanceof Tc?(function(n,s){return s instanceof Tc&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce(((a,c,f)=>a&&ND(c,s.filters[f])),!0):!1})(i,e):void bn(19439)}function PD(i){return i instanceof Bs?(function(t){return`${t.field.canonicalString()} ${t.op} ${dm(t.value)}`})(i):i instanceof Tc?(function(t){return t.op.toString()+" {"+t.getFilters().map(PD).join(" ,")+"}"})(i):"Filter"}class z9 extends Bs{constructor(e,t,n){super(e,t,n),this.key=an.fromName(n.referenceValue)}matches(e){const t=an.comparator(e.key,this.key);return this.matchesComparison(t)}}class F9 extends Bs{constructor(e,t){super(e,"in",t),this.keys=LD("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class B9 extends Bs{constructor(e,t){super(e,"not-in",t),this.keys=LD("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function LD(i,e){return(e.arrayValue?.values||[]).map((t=>an.fromName(t.referenceValue)))}class V9 extends Bs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return aT(t)&&$0(t.arrayValue,this.value)}}class k9 extends Bs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$0(this.value.arrayValue,t)}}class H9 extends Bs{constructor(e,t){super(e,"not-in",t)}matches(e){if($0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!$0(this.value.arrayValue,t)}}class G9 extends Bs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!aT(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>$0(this.value.arrayValue,n)))}}class j9{constructor(e,t=null,n=[],s=[],a=null,c=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=a,this.startAt=c,this.endAt=f,this.Te=null}}function qC(i,e=null,t=[],n=[],s=null,a=null,c=null){return new j9(i,e,t,n,s,a,c)}function oT(i){const e=Kn(i);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>kE(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(a){return a.field.canonicalString()+a.dir})(n))).join(","),Qb(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>dm(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>dm(n))).join(",")),e.Te=t}return e.Te}function lT(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<i.orderBy.length;t++)if(!O9(i.orderBy[t],e.orderBy[t]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let t=0;t<i.filters.length;t++)if(!ND(i.filters[t],e.filters[t]))return!1;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!WC(i.startAt,e.startAt)&&WC(i.endAt,e.endAt)}function HE(i){return an.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}class Jb{constructor(e,t=null,n=[],s=[],a=null,c="F",f=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=a,this.limitType=c,this.startAt=f,this.endAt=d,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function W9(i,e,t,n,s,a,c,f){return new Jb(i,e,t,n,s,a,c,f)}function OD(i){return new Jb(i)}function XC(i){return i.filters.length===0&&i.limit===null&&i.startAt==null&&i.endAt==null&&(i.explicitOrderBy.length===0||i.explicitOrderBy.length===1&&i.explicitOrderBy[0].field.isKeyField())}function q9(i){return an.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}function X9(i){return i.collectionGroup!==null}function A0(i){const e=Kn(i);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let f=new Hs(ha.comparator);return c.filters.forEach((d=>{d.getFlattenedFilters().forEach((m=>{m.isInequality()&&(f=f.add(m.field))}))})),f})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new ob(a,n))})),t.has(ha.keyField().canonicalString())||e.Ie.push(new ob(ha.keyField(),n))}return e.Ie}function xc(i){const e=Kn(i);return e.Ee||(e.Ee=Y9(e,A0(i))),e.Ee}function Y9(i,e){if(i.limitType==="F")return qC(i.path,i.collectionGroup,e,i.filters,i.limit,i.startAt,i.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new ob(s.field,a)}));const t=i.endAt?new ab(i.endAt.position,i.endAt.inclusive):null,n=i.startAt?new ab(i.startAt.position,i.startAt.inclusive):null;return qC(i.path,i.collectionGroup,e,i.filters,i.limit,t,n)}}function GE(i,e,t){return new Jb(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function eS(i,e){return lT(xc(i),xc(e))&&i.limitType===e.limitType}function UD(i){return`${oT(xc(i))}|lt:${i.limitType}`}function Fp(i){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((s=>PD(s))).join(", ")}]`),Qb(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((s=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(s))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((s=>dm(s))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((s=>dm(s))).join(",")),`Target(${n})`})(xc(i))}; limitType=${i.limitType})`}function tS(i,e){return e.isFoundDocument()&&(function(n,s){const a=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):an.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)})(i,e)&&(function(n,s){for(const a of A0(n))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(i,e)&&(function(n,s){for(const a of n.filters)if(!a.matches(s))return!1;return!0})(i,e)&&(function(n,s){return!(n.startAt&&!(function(c,f,d){const m=jC(c,f,d);return c.inclusive?m<=0:m<0})(n.startAt,A0(n),s)||n.endAt&&!(function(c,f,d){const m=jC(c,f,d);return c.inclusive?m>=0:m>0})(n.endAt,A0(n),s))})(i,e)}function Z9(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function zD(i){return(e,t)=>{let n=!1;for(const s of A0(i)){const a=K9(s,e,t);if(a!==0)return a;n=n||s.field.isKeyField()}return 0}}function K9(i,e,t){const n=i.field.isKeyField()?an.comparator(e.key,t.key):(function(a,c,f){const d=c.data.field(a),m=f.data.field(a);return d!==null&&m!==null?fm(d,m):bn(42886)})(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return bn(19790,{direction:i.dir})}}class yd{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,a]of n)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){dy(this.inner,((t,n)=>{for(const[s,a]of n)e(s,a)}))}isEmpty(){return A9(this.inner)}size(){return this.innerSize}}const Q9=new xs(an.comparator);function Bh(){return Q9}const FD=new xs(an.comparator);function u0(...i){let e=FD;for(const t of i)e=e.insert(t.key,t);return e}function $9(i){let e=FD;return i.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function $f(){return w0()}function BD(){return w0()}function w0(){return new yd((i=>i.toString()),((i,e)=>i.isEqual(e)))}const J9=new Hs(an.comparator);function $n(...i){let e=J9;for(const t of i)e=e.add(t);return e}const eH=new Hs(Wn);function tH(){return eH}function nH(i,e){if(i.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zE(e)?"-0":e}}function iH(i){return{integerValue:""+i}}class nS{constructor(){this._=void 0}}function sH(i,e,t){return i instanceof jE?(function(s,a){const c={fields:{[AD]:{stringValue:TD},[CD]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&rT(a)&&(a=$b(a)),a&&(c.fields[wD]=a),{mapValue:c}})(t,e):i instanceof lb?VD(i,e):i instanceof cb?kD(i,e):(function(s,a){const c=aH(s,a),f=YC(c)+YC(s.Ae);return VE(c)&&VE(s.Ae)?iH(f):nH(s.serializer,f)})(i,e)}function rH(i,e,t){return i instanceof lb?VD(i,e):i instanceof cb?kD(i,e):t}function aH(i,e){return i instanceof WE?(function(n){return VE(n)||(function(a){return!!a&&"doubleValue"in a})(n)})(e)?e:{integerValue:0}:null}class jE extends nS{}class lb extends nS{constructor(e){super(),this.elements=e}}function VD(i,e){const t=HD(e);for(const n of i.elements)t.some((s=>Mc(s,n)))||t.push(n);return{arrayValue:{values:t}}}class cb extends nS{constructor(e){super(),this.elements=e}}function kD(i,e){let t=HD(e);for(const n of i.elements)t=t.filter((s=>!Mc(s,n)));return{arrayValue:{values:t}}}class WE extends nS{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function YC(i){return ms(i.integerValue||i.doubleValue)}function HD(i){return aT(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}function oH(i,e){return i.field.isEqual(e.field)&&(function(n,s){return n instanceof lb&&s instanceof lb||n instanceof cb&&s instanceof cb?hm(n.elements,s.elements,Mc):n instanceof WE&&s instanceof WE?Mc(n.Ae,s.Ae):n instanceof jE&&s instanceof jE})(i.transform,e.transform)}class sd{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sd}static exists(e){return new sd(void 0,e)}static updateTime(e){return new sd(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Y_(i,e){return i.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(i.updateTime):i.exists===void 0||i.exists===e.isFoundDocument()}class cT{}function GD(i,e){if(!i.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return i.isNoDocument()?new cH(i.key,sd.none()):new uT(i.key,i.data,sd.none());{const t=i.data,n=pc.empty();let s=new Hs(ha.comparator);for(let a of e.fields)if(!s.has(a)){let c=t.field(a);c===null&&a.length>1&&(a=a.popLast(),c=t.field(a)),c===null?n.delete(a):n.set(a,c),s=s.add(a)}return new iS(i.key,n,new Mh(s.toArray()),sd.none())}}function lH(i,e,t){i instanceof uT?(function(s,a,c){const f=s.value.clone(),d=KC(s.fieldTransforms,a,c.transformResults);f.setAll(d),a.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(i,e,t):i instanceof iS?(function(s,a,c){if(!Y_(s.precondition,a))return void a.convertToUnknownDocument(c.version);const f=KC(s.fieldTransforms,a,c.transformResults),d=a.data;d.setAll(jD(s)),d.setAll(f),a.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(i,e,t):(function(s,a,c){a.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function C0(i,e,t,n){return i instanceof uT?(function(a,c,f,d){if(!Y_(a.precondition,c))return f;const m=a.value.clone(),y=QC(a.fieldTransforms,d,c);return m.setAll(y),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null})(i,e,t,n):i instanceof iS?(function(a,c,f,d){if(!Y_(a.precondition,c))return f;const m=QC(a.fieldTransforms,d,c),y=c.data;return y.setAll(jD(a)),y.setAll(m),c.convertToFoundDocument(c.version,y).setHasLocalMutations(),f===null?null:f.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((v=>v.field)))})(i,e,t,n):(function(a,c,f){return Y_(a.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):f})(i,e,t)}function ZC(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&!!(function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&hm(n,s,((a,c)=>oH(a,c)))})(i.fieldTransforms,e.fieldTransforms)&&(i.type===0?i.value.isEqual(e.value):i.type!==1||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask))}class uT extends cT{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class iS extends cT{constructor(e,t,n,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function jD(i){const e=new Map;return i.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}})),e}function KC(i,e,t){const n=new Map;ns(i.length===t.length,32656,{Ve:t.length,de:i.length});for(let s=0;s<t.length;s++){const a=i[s],c=a.transform,f=e.data.field(a.field);n.set(a.field,rH(c,f,t[s]))}return n}function QC(i,e,t){const n=new Map;for(const s of i){const a=s.transform,c=t.data.field(s.field);n.set(s.field,sH(a,c,e))}return n}class cH extends cT{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class uH{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&lH(a,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=C0(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=C0(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=BD();return this.mutations.forEach((s=>{const a=e.get(s.key),c=a.overlayedDocument;let f=this.applyToLocalView(c,a.mutatedFields);f=t.has(s.key)?null:f;const d=GD(c,f);d!==null&&n.set(s.key,d),c.isValidDocument()||c.convertToNoDocument(gn.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),$n())}isEqual(e){return this.batchId===e.batchId&&hm(this.mutations,e.mutations,((t,n)=>ZC(t,n)))&&hm(this.baseMutations,e.baseMutations,((t,n)=>ZC(t,n)))}}class hH{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class fH{constructor(e,t){this.count=e,this.unchangedNames=t}}var Ds,Yn;function WD(i){if(i===void 0)return bu("GRPC error has no .code"),xt.UNKNOWN;switch(i){case Ds.OK:return xt.OK;case Ds.CANCELLED:return xt.CANCELLED;case Ds.UNKNOWN:return xt.UNKNOWN;case Ds.DEADLINE_EXCEEDED:return xt.DEADLINE_EXCEEDED;case Ds.RESOURCE_EXHAUSTED:return xt.RESOURCE_EXHAUSTED;case Ds.INTERNAL:return xt.INTERNAL;case Ds.UNAVAILABLE:return xt.UNAVAILABLE;case Ds.UNAUTHENTICATED:return xt.UNAUTHENTICATED;case Ds.INVALID_ARGUMENT:return xt.INVALID_ARGUMENT;case Ds.NOT_FOUND:return xt.NOT_FOUND;case Ds.ALREADY_EXISTS:return xt.ALREADY_EXISTS;case Ds.PERMISSION_DENIED:return xt.PERMISSION_DENIED;case Ds.FAILED_PRECONDITION:return xt.FAILED_PRECONDITION;case Ds.ABORTED:return xt.ABORTED;case Ds.OUT_OF_RANGE:return xt.OUT_OF_RANGE;case Ds.UNIMPLEMENTED:return xt.UNIMPLEMENTED;case Ds.DATA_LOSS:return xt.DATA_LOSS;default:return bn(39323,{code:i})}}(Yn=Ds||(Ds={}))[Yn.OK=0]="OK",Yn[Yn.CANCELLED=1]="CANCELLED",Yn[Yn.UNKNOWN=2]="UNKNOWN",Yn[Yn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yn[Yn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yn[Yn.NOT_FOUND=5]="NOT_FOUND",Yn[Yn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yn[Yn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yn[Yn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yn[Yn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yn[Yn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yn[Yn.ABORTED=10]="ABORTED",Yn[Yn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yn[Yn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yn[Yn.INTERNAL=13]="INTERNAL",Yn[Yn.UNAVAILABLE=14]="UNAVAILABLE",Yn[Yn.DATA_LOSS=15]="DATA_LOSS";function dH(){return new TextEncoder}const pH=new Ch([4294967295,4294967295],0);function $C(i){const e=dH().encode(i),t=new pD;return t.update(e),new Uint8Array(t.digest())}function JC(i){const e=new DataView(i.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ch([t,n],0),new Ch([s,a],0)]}class hT{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new h0(`Invalid padding: ${t}`);if(n<0)throw new h0(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new h0(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new h0(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ch.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(Ch.fromNumber(n)));return s.compare(pH)===1&&(s=new Ch([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=$C(e),[n,s]=JC(t);for(let a=0;a<this.hashCount;a++){const c=this.ye(n,s,a);if(!this.we(c))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),c=new hT(a,s,t);return n.forEach((f=>c.insert(f))),c}insert(e){if(this.ge===0)return;const t=$C(e),[n,s]=JC(t);for(let a=0;a<this.hashCount;a++){const c=this.ye(n,s,a);this.be(c)}}be(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class h0 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class sS{constructor(e,t,n,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,py.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new sS(gn.min(),s,new xs(Wn),Bh(),$n())}}class py{constructor(e,t,n,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new py(n,t,$n(),$n(),$n())}}class Z_{constructor(e,t,n,s){this.Se=e,this.removedTargetIds=t,this.key=n,this.De=s}}class qD{constructor(e,t){this.targetId=e,this.Ce=t}}class XD{constructor(e,t,n=Sr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class eR{constructor(){this.ve=0,this.Fe=tR(),this.Me=Sr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=$n(),t=$n(),n=$n();return this.Fe.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:bn(38017,{changeType:a})}})),new py(this.Me,this.xe,e,t,n)}Ke(){this.Oe=!1,this.Fe=tR()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,ns(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class mH{constructor(e){this.Ge=e,this.ze=new Map,this.je=Bh(),this.He=F_(),this.Je=F_(),this.Ze=new xs(Wn)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.We(),n.Ne||n.Ke(),n.Le(e.resumeToken);break;case 2:n.We(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.Qe(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:bn(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const a=s.target;if(HE(a))if(n===0){const c=new an(a.path);this.et(t,c,Hr.newNoDocument(c,gn.min()))}else ns(n===1,20013,{expectedCount:n});else{const c=this._t(t);if(c!==n){const f=this.ut(e),d=f?this.ct(f,e,c):1;if(d!==0){this.it(t);const m=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:a=0}=t;let c,f;try{c=zh(n).toUint8Array()}catch(d){if(d instanceof MD)return hd("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{f=new hT(c,s,a)}catch(d){return hd(d instanceof h0?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return f.ge===0?null:f}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach((a=>{const c=this.Ge.ht(),f=`projects/${c.projectId}/databases/${c.database}/documents/${a.path.canonicalString()}`;e.mightContain(f)||(this.et(t,a,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((a,c)=>{const f=this.ot(c);if(f){if(a.current&&HE(f.target)){const d=new an(f.target.path);this.It(d).has(c)||this.Et(c,d)||this.et(c,d,Hr.newNoDocument(d,e))}a.Be&&(t.set(c,a.ke()),a.Ke())}}));let n=$n();this.Je.forEach(((a,c)=>{let f=!0;c.forEachWhile((d=>{const m=this.ot(d);return!m||m.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(n=n.add(a))})),this.je.forEach(((a,c)=>c.setReadTime(e)));const s=new sS(e,t,this.Ze,this.je,n);return this.je=Bh(),this.He=F_(),this.Je=F_(),this.Ze=new xs(Wn),s}Ye(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,n),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.qe(t,1):s.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new eR,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new Hs(Wn),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new Hs(Wn),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Dt("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new eR),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function F_(){return new xs(an.comparator)}function tR(){return new xs(an.comparator)}const gH={asc:"ASCENDING",desc:"DESCENDING"},yH={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},vH={and:"AND",or:"OR"};class _H{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function qE(i,e){return i.useProto3Json||Qb(e)?e:{value:e}}function xH(i,e){return i.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bH(i,e){return i.useProto3Json?e.toBase64():e.toUint8Array()}function Kp(i){return ns(!!i,49232),gn.fromTimestamp((function(t){const n=Uh(t);return new Ns(n.seconds,n.nanos)})(i))}function SH(i,e){return XE(i,e).canonicalString()}function XE(i,e){const t=(function(s){return new es(["projects",s.projectId,"databases",s.database])})(i).child("documents");return e===void 0?t:t.child(e)}function YD(i){const e=es.fromString(i);return ns(JD(e),10190,{key:e.toString()}),e}function eE(i,e){const t=YD(e);if(t.get(1)!==i.databaseId.projectId)throw new Xt(xt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new Xt(xt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new an(KD(t))}function ZD(i,e){return SH(i.databaseId,e)}function EH(i){const e=YD(i);return e.length===4?es.emptyPath():KD(e)}function nR(i){return new es(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function KD(i){return ns(i.length>4&&i.get(4)==="documents",29091,{key:i.toString()}),i.popFirst(5)}function MH(i,e){let t;if("targetChange"in e){e.targetChange;const n=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:bn(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(m,y){return m.useProto3Json?(ns(y===void 0||typeof y=="string",58123),Sr.fromBase64String(y||"")):(ns(y===void 0||y instanceof Buffer||y instanceof Uint8Array,16193),Sr.fromUint8Array(y||new Uint8Array))})(i,e.targetChange.resumeToken),c=e.targetChange.cause,f=c&&(function(m){const y=m.code===void 0?xt.UNKNOWN:WD(m.code);return new Xt(y,m.message||"")})(c);t=new XD(n,s,a,f||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=eE(i,n.document.name),a=Kp(n.document.updateTime),c=n.document.createTime?Kp(n.document.createTime):gn.min(),f=new pc({mapValue:{fields:n.document.fields}}),d=Hr.newFoundDocument(s,a,c,f),m=n.targetIds||[],y=n.removedTargetIds||[];t=new Z_(m,y,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=eE(i,n.document),a=n.readTime?Kp(n.readTime):gn.min(),c=Hr.newNoDocument(s,a),f=n.removedTargetIds||[];t=new Z_([],f,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=eE(i,n.document),a=n.removedTargetIds||[];t=new Z_([],a,s,null)}else{if(!("filter"in e))return bn(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:a}=n,c=new fH(s,a),f=n.targetId;t=new qD(f,c)}}return t}function TH(i,e){return{documents:[ZD(i,e.path)]}}function AH(i,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=ZD(i,s);const a=(function(m){if(m.length!==0)return $D(Tc.create(m,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const c=(function(m){if(m.length!==0)return m.map((y=>(function(x){return{field:Bp(x.field),direction:RH(x.dir)}})(y)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const f=qE(i,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:s}}function wH(i){let e=EH(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){ns(n===1,65062);const y=t.from[0];y.allDescendants?s=y.collectionId:e=e.child(y.collectionId)}let a=[];t.where&&(a=(function(v){const x=QD(v);return x instanceof Tc&&DD(x)?x.getFilters():[x]})(t.where));let c=[];t.orderBy&&(c=(function(v){return v.map((x=>(function(T){return new ob(Vp(T.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(T.direction))})(x)))})(t.orderBy));let f=null;t.limit&&(f=(function(v){let x;return x=typeof v=="object"?v.value:v,Qb(x)?null:x})(t.limit));let d=null;t.startAt&&(d=(function(v){const x=!!v.before,E=v.values||[];return new ab(E,x)})(t.startAt));let m=null;return t.endAt&&(m=(function(v){const x=!v.before,E=v.values||[];return new ab(E,x)})(t.endAt)),W9(e,s,c,a,f,"F",d,m)}function CH(i,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return bn(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function QD(i){return i.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=Vp(t.unaryFilter.field);return Bs.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Vp(t.unaryFilter.field);return Bs.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Vp(t.unaryFilter.field);return Bs.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Vp(t.unaryFilter.field);return Bs.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return bn(61313);default:return bn(60726)}})(i):i.fieldFilter!==void 0?(function(t){return Bs.create(Vp(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return bn(58110);default:return bn(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(i):i.compositeFilter!==void 0?(function(t){return Tc.create(t.compositeFilter.filters.map((n=>QD(n))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return bn(1026)}})(t.compositeFilter.op))})(i):bn(30097,{filter:i})}function RH(i){return gH[i]}function IH(i){return yH[i]}function DH(i){return vH[i]}function Bp(i){return{fieldPath:i.canonicalString()}}function Vp(i){return ha.fromServerFormat(i.fieldPath)}function $D(i){return i instanceof Bs?(function(t){if(t.op==="=="){if(GC(t.value))return{unaryFilter:{field:Bp(t.field),op:"IS_NAN"}};if(HC(t.value))return{unaryFilter:{field:Bp(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(GC(t.value))return{unaryFilter:{field:Bp(t.field),op:"IS_NOT_NAN"}};if(HC(t.value))return{unaryFilter:{field:Bp(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bp(t.field),op:IH(t.op),value:t.value}}})(i):i instanceof Tc?(function(t){const n=t.getFilters().map((s=>$D(s)));return n.length===1?n[0]:{compositeFilter:{op:DH(t.op),filters:n}}})(i):bn(54877,{filter:i})}function JD(i){return i.length>=4&&i.get(0)==="projects"&&i.get(2)==="databases"}class Th{constructor(e,t,n,s,a=gn.min(),c=gn.min(),f=Sr.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=f,this.expectedCount=d}withSequenceNumber(e){return new Th(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Th(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Th(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Th(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class NH{constructor(e){this.yt=e}}function PH(i){const e=wH({parent:i.parent,structuredQuery:i.structuredQuery});return i.limitType==="LAST"?GE(e,e.limit,"L"):e}class LH{constructor(){this.Sn=new OH}addToCollectionParentIndex(e,t){return this.Sn.add(t),qe.resolve()}getCollectionParents(e,t){return qe.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return qe.resolve()}deleteFieldIndex(e,t){return qe.resolve()}deleteAllFieldIndexes(e){return qe.resolve()}createTargetIndexes(e,t){return qe.resolve()}getDocumentsMatchingTarget(e,t){return qe.resolve(null)}getIndexType(e,t){return qe.resolve(0)}getFieldIndexes(e,t){return qe.resolve([])}getNextCollectionGroupToUpdate(e){return qe.resolve(null)}getMinOffset(e,t){return qe.resolve(Oh.min())}getMinOffsetFromCollectionGroup(e,t){return qe.resolve(Oh.min())}updateCollectionGroup(e,t,n){return qe.resolve()}updateIndexEntries(e,t){return qe.resolve()}}class OH{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new Hs(es.comparator),a=!s.has(n);return this.index[t]=s.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Hs(es.comparator)).toArray()}}const iR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},eN=41943040;class Va{static withCacheSize(e){return new Va(e,Va.DEFAULT_COLLECTION_PERCENTILE,Va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Va.DEFAULT_COLLECTION_PERCENTILE=10,Va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Va.DEFAULT=new Va(eN,Va.DEFAULT_COLLECTION_PERCENTILE,Va.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Va.DISABLED=new Va(-1,0,0);class pm{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new pm(0)}static ar(){return new pm(-1)}}const sR="LruGarbageCollector",UH=1048576;function rR([i,e],[t,n]){const s=Wn(i,t);return s===0?Wn(e,n):s}class zH{constructor(e){this.Pr=e,this.buffer=new Hs(rR),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();rR(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FH{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Dt(sR,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Im(t)?Dt(sR,"Ignoring IndexedDB error during garbage collection: ",t):await Zb(t)}await this.Ar(3e5)}))}}class BH{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return qe.resolve(Kb.ce);const n=new zH(t);return this.Vr.forEachTarget(e,(s=>n.Er(s.sequenceNumber))).next((()=>this.Vr.mr(e,(s=>n.Er(s))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Dt("LruGarbageCollector","Garbage collection skipped; disabled"),qe.resolve(iR)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Dt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),iR):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let n,s,a,c,f,d,m;const y=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Dt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),s=this.params.maximumSequenceNumbersToCollect):s=v,c=Date.now(),this.nthSequenceNumber(e,s)))).next((v=>(n=v,f=Date.now(),this.removeTargets(e,n,t)))).next((v=>(a=v,d=Date.now(),this.removeOrphanedDocuments(e,n)))).next((v=>(m=Date.now(),zp()<=Zn.DEBUG&&Dt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-y}ms
	Determined least recently used ${s} in `+(f-c)+`ms
	Removed ${a} targets in `+(d-f)+`ms
	Removed ${v} documents in `+(m-d)+`ms
Total Duration: ${m-y}ms`),qe.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:v}))))}}function VH(i,e){return new BH(i,e)}class kH{constructor(){this.changes=new yd((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Hr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?qe.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class HH{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class GH{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(n=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(n!==null&&C0(n.mutation,s,Mh.empty(),Ns.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,$n()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=$n()){const s=$f();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,n).next((a=>{let c=u0();return a.forEach(((f,d)=>{c=c.insert(f,d.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const n=$f();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,$n())))}populateOverlays(e,t,n){const s=[];return n.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((c,f)=>{t.set(c,f)}))}))}computeViews(e,t,n,s){let a=Bh();const c=w0(),f=(function(){return w0()})();return t.forEach(((d,m)=>{const y=n.get(m.key);s.has(m.key)&&(y===void 0||y.mutation instanceof iS)?a=a.insert(m.key,m):y!==void 0?(c.set(m.key,y.mutation.getFieldMask()),C0(y.mutation,m,y.mutation.getFieldMask(),Ns.now())):c.set(m.key,Mh.empty())})),this.recalculateAndSaveOverlays(e,a).next((d=>(d.forEach(((m,y)=>c.set(m,y))),t.forEach(((m,y)=>f.set(m,new HH(y,c.get(m)??null)))),f)))}recalculateAndSaveOverlays(e,t){const n=w0();let s=new xs(((c,f)=>c-f)),a=$n();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const f of c)f.keys().forEach((d=>{const m=t.get(d);if(m===null)return;let y=n.get(d)||Mh.empty();y=f.applyToLocalView(m,y),n.set(d,y);const v=(s.get(f.batchId)||$n()).add(d);s=s.insert(f.batchId,v)}))})).next((()=>{const c=[],f=s.getReverseIterator();for(;f.hasNext();){const d=f.getNext(),m=d.key,y=d.value,v=BD();y.forEach((x=>{if(!a.has(x)){const E=GD(t.get(x),n.get(x));E!==null&&v.set(x,E),a=a.add(x)}})),c.push(this.documentOverlayCache.saveOverlays(e,m,v))}return qe.waitFor(c)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,s){return q9(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):X9(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next((a=>{const c=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-a.size):qe.resolve($f());let f=Z0,d=a;return c.next((m=>qe.forEach(m,((y,v)=>(f<v.largestBatchId&&(f=v.largestBatchId),a.get(y)?qe.resolve():this.remoteDocumentCache.getEntry(e,y).next((x=>{d=d.insert(y,x)}))))).next((()=>this.populateOverlays(e,m,a))).next((()=>this.computeViews(e,d,m,$n()))).next((y=>({batchId:f,changes:$9(y)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new an(t)).next((n=>{let s=u0();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const a=t.collectionGroup;let c=u0();return this.indexManager.getCollectionParents(e,a).next((f=>qe.forEach(f,(d=>{const m=(function(v,x){return new Jb(x,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(t,d.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,n,s).next((y=>{y.forEach(((v,x)=>{c=c.insert(v,x)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,n,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((c=>(a=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,s)))).next((c=>{a.forEach(((d,m)=>{const y=m.getKey();c.get(y)===null&&(c=c.insert(y,Hr.newInvalidDocument(y)))}));let f=u0();return c.forEach(((d,m)=>{const y=a.get(d);y!==void 0&&C0(y.mutation,m,Mh.empty(),Ns.now()),tS(t,m)&&(f=f.insert(d,m))})),f}))}}class jH{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return qe.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Kp(s.createTime)}})(t)),qe.resolve()}getNamedQuery(e,t){return qe.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(s){return{name:s.name,query:PH(s.bundledQuery),readTime:Kp(s.readTime)}})(t)),qe.resolve()}}class WH{constructor(){this.overlays=new xs(an.comparator),this.Lr=new Map}getOverlay(e,t){return qe.resolve(this.overlays.get(t))}getOverlays(e,t){const n=$f();return qe.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&n.set(s,a)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((s,a)=>{this.bt(e,t,a)})),qe.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.Lr.get(n);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.Lr.delete(n)),qe.resolve()}getOverlaysForCollection(e,t,n){const s=$f(),a=t.length+1,c=new an(t.child("")),f=this.overlays.getIteratorFrom(c);for(;f.hasNext();){const d=f.getNext().value,m=d.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&d.largestBatchId>n&&s.set(d.getKey(),d)}return qe.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let a=new xs(((m,y)=>m-y));const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>n){let y=a.get(m.largestBatchId);y===null&&(y=$f(),a=a.insert(m.largestBatchId,y)),y.set(m.getKey(),m)}}const f=$f(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach(((m,y)=>f.set(m,y))),!(f.size()>=s)););return qe.resolve(f)}bt(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const c=this.Lr.get(s.largestBatchId).delete(n.key);this.Lr.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new hH(t,n));let a=this.Lr.get(t);a===void 0&&(a=$n(),this.Lr.set(t,a)),this.Lr.set(t,a.add(n.key))}}class qH{constructor(){this.sessionToken=Sr.EMPTY_BYTE_STRING}getSessionToken(e){return qe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,qe.resolve()}}class fT{constructor(){this.kr=new Hs(Js.Kr),this.qr=new Hs(Js.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const n=new Js(e,t);this.kr=this.kr.add(n),this.qr=this.qr.add(n)}$r(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Wr(new Js(e,t))}Qr(e,t){e.forEach((n=>this.removeReference(n,t)))}Gr(e){const t=new an(new es([])),n=new Js(t,e),s=new Js(t,e+1),a=[];return this.qr.forEachInRange([n,s],(c=>{this.Wr(c),a.push(c.key)})),a}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new an(new es([])),n=new Js(t,e),s=new Js(t,e+1);let a=$n();return this.qr.forEachInRange([n,s],(c=>{a=a.add(c.key)})),a}containsKey(e){const t=new Js(e,0),n=this.kr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Js{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return an.comparator(e.key,t.key)||Wn(e.Hr,t.Hr)}static Ur(e,t){return Wn(e.Hr,t.Hr)||an.comparator(e.key,t.key)}}class XH{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new Hs(Js.Kr)}checkEmpty(e){return qe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const a=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new uH(a,t,n,s);this.mutationQueue.push(c);for(const f of s)this.Jr=this.Jr.add(new Js(f.key,a)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return qe.resolve(c)}lookupMutationBatch(e,t){return qe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.Xr(n),a=s<0?0:s;return qe.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return qe.resolve(this.mutationQueue.length===0?E9:this.Yn-1)}getAllMutationBatches(e){return qe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Js(t,0),s=new Js(t,Number.POSITIVE_INFINITY),a=[];return this.Jr.forEachInRange([n,s],(c=>{const f=this.Zr(c.Hr);a.push(f)})),qe.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Hs(Wn);return t.forEach((s=>{const a=new Js(s,0),c=new Js(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([a,c],(f=>{n=n.add(f.Hr)}))})),qe.resolve(this.Yr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let a=n;an.isDocumentKey(a)||(a=a.child(""));const c=new Js(new an(a),0);let f=new Hs(Wn);return this.Jr.forEachWhile((d=>{const m=d.key.path;return!!n.isPrefixOf(m)&&(m.length===s&&(f=f.add(d.Hr)),!0)}),c),qe.resolve(this.Yr(f))}Yr(e){const t=[];return e.forEach((n=>{const s=this.Zr(n);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ns(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Jr;return qe.forEach(t.mutations,(s=>{const a=new Js(s.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Jr=n}))}nr(e){}containsKey(e,t){const n=new Js(t,0),s=this.Jr.firstAfterOrEqual(n);return qe.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,qe.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class YH{constructor(e){this.ti=e,this.docs=(function(){return new xs(an.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),a=s?s.size:0,c=this.ti(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return qe.resolve(n?n.document.mutableCopy():Hr.newInvalidDocument(t))}getEntries(e,t){let n=Bh();return t.forEach((s=>{const a=this.docs.get(s);n=n.insert(s,a?a.document.mutableCopy():Hr.newInvalidDocument(s))})),qe.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let a=Bh();const c=t.path,f=new an(c.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(f);for(;d.hasNext();){const{key:m,value:{document:y}}=d.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||_9(v9(y),n)<=0||(s.has(y.key)||tS(t,y))&&(a=a.insert(y.key,y.mutableCopy()))}return qe.resolve(a)}getAllFromCollectionGroup(e,t,n,s){bn(9500)}ni(e,t){return qe.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new ZH(this)}getSize(e){return qe.resolve(this.size)}}class ZH extends kH{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,s)=>{s.isValidDocument()?t.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(n)})),qe.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class KH{constructor(e){this.persistence=e,this.ri=new yd((t=>oT(t)),lT),this.lastRemoteSnapshotVersion=gn.min(),this.highestTargetId=0,this.ii=0,this.si=new fT,this.targetCount=0,this.oi=pm._r()}forEachTarget(e,t){return this.ri.forEach(((n,s)=>t(s))),qe.resolve()}getLastRemoteSnapshotVersion(e){return qe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return qe.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),qe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ii&&(this.ii=t),qe.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new pm(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,qe.resolve()}updateTargetData(e,t){return this.lr(t),qe.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,qe.resolve()}removeTargets(e,t,n){let s=0;const a=[];return this.ri.forEach(((c,f)=>{f.sequenceNumber<=t&&n.get(f.targetId)===null&&(this.ri.delete(c),a.push(this.removeMatchingKeysForTargetId(e,f.targetId)),s++)})),qe.waitFor(a).next((()=>s))}getTargetCount(e){return qe.resolve(this.targetCount)}getTargetData(e,t){const n=this.ri.get(t)||null;return qe.resolve(n)}addMatchingKeys(e,t,n){return this.si.$r(t,n),qe.resolve()}removeMatchingKeys(e,t,n){this.si.Qr(t,n);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((c=>{a.push(s.markPotentiallyOrphaned(e,c))})),qe.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),qe.resolve()}getMatchingKeysForTargetId(e,t){const n=this.si.jr(t);return qe.resolve(n)}containsKey(e,t){return qe.resolve(this.si.containsKey(t))}}class tN{constructor(e,t){this._i={},this.overlays={},this.ai=new Kb(0),this.ui=!1,this.ui=!0,this.ci=new qH,this.referenceDelegate=e(this),this.li=new KH(this),this.indexManager=new LH,this.remoteDocumentCache=(function(s){return new YH(s)})((n=>this.referenceDelegate.hi(n))),this.serializer=new NH(t),this.Pi=new jH(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new WH,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this._i[e.toKey()];return n||(n=new XH(t,this.referenceDelegate),this._i[e.toKey()]=n),n}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,n){Dt("MemoryPersistence","Starting transaction:",e);const s=new QH(this.ai.next());return this.referenceDelegate.Ti(),n(s).next((a=>this.referenceDelegate.Ii(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ei(e,t){return qe.or(Object.values(this._i).map((n=>()=>n.containsKey(e,t))))}}class QH extends b9{constructor(e){super(),this.currentSequenceNumber=e}}class dT{constructor(e){this.persistence=e,this.Ri=new fT,this.Ai=null}static Vi(e){return new dT(e)}get di(){if(this.Ai)return this.Ai;throw bn(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.di.delete(n.toString()),qe.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.di.add(n.toString()),qe.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),qe.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((s=>this.di.add(s.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.di.add(a.toString())))})).next((()=>n.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qe.forEach(this.di,(n=>{const s=an.fromPath(n);return this.mi(e,s).next((a=>{a||t.removeEntry(s,gn.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((n=>{n?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return qe.or([()=>qe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class ub{constructor(e,t){this.persistence=e,this.fi=new yd((n=>M9(n.path)),((n,s)=>n.isEqual(s))),this.garbageCollector=VH(this,t)}static Vi(e,t){return new ub(e,t)}Ti(){}Ii(e){return qe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((s=>n+s))))}pr(e){let t=0;return this.mr(e,(n=>{t++})).next((()=>t))}mr(e,t){return qe.forEach(this.fi,((n,s)=>this.wr(e,n,s).next((a=>a?qe.resolve():t(s)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ni(e,(c=>this.wr(e,c,t).next((f=>{f||(n++,a.removeEntry(c,gn.min()))})))).next((()=>a.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),qe.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),qe.resolve()}removeReference(e,t,n){return this.fi.set(n,e.currentSequenceNumber),qe.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),qe.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=X_(e.data.value)),t}wr(e,t,n){return qe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.fi.get(t);return qe.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class pT{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Ts=n,this.Is=s}static Es(e,t){let n=$n(),s=$n();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new pT(e,t.fromCache,n,s)}}class $H{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class JH{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return Bk()?8:S9(zk())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const a={result:null};return this.gs(e,t).next((c=>{a.result=c})).next((()=>{if(!a.result)return this.ps(e,t,s,n).next((c=>{a.result=c}))})).next((()=>{if(a.result)return;const c=new $H;return this.ys(e,t,c).next((f=>{if(a.result=f,this.As)return this.ws(e,t,c,f.size)}))})).next((()=>a.result))}ws(e,t,n,s){return n.documentReadCount<this.Vs?(zp()<=Zn.DEBUG&&Dt("QueryEngine","SDK will not create cache indexes for query:",Fp(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),qe.resolve()):(zp()<=Zn.DEBUG&&Dt("QueryEngine","Query:",Fp(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.ds*s?(zp()<=Zn.DEBUG&&Dt("QueryEngine","The SDK decides to create cache indexes for query:",Fp(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xc(t))):qe.resolve())}gs(e,t){if(XC(t))return qe.resolve(null);let n=xc(t);return this.indexManager.getIndexType(e,n).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=GE(t,null,"F"),n=xc(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((a=>{const c=$n(...a);return this.fs.getDocuments(e,c).next((f=>this.indexManager.getMinOffset(e,n).next((d=>{const m=this.bs(t,f);return this.Ss(t,m,c,d.readTime)?this.gs(e,GE(t,null,"F")):this.Ds(e,m,t,d)}))))})))))}ps(e,t,n,s){return XC(t)||s.isEqual(gn.min())?qe.resolve(null):this.fs.getDocuments(e,n).next((a=>{const c=this.bs(t,a);return this.Ss(t,c,n,s)?qe.resolve(null):(zp()<=Zn.DEBUG&&Dt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Fp(t)),this.Ds(e,c,t,y9(s,Z0)).next((f=>f)))}))}bs(e,t){let n=new Hs(zD(e));return t.forEach(((s,a)=>{tS(e,a)&&(n=n.add(a))})),n}Ss(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}ys(e,t,n){return zp()<=Zn.DEBUG&&Dt("QueryEngine","Using full collection scan to execute query:",Fp(t)),this.fs.getDocumentsMatchingQuery(e,t,Oh.min(),n)}Ds(e,t,n,s){return this.fs.getDocumentsMatchingQuery(e,n,s).next((a=>(t.forEach((c=>{a=a.insert(c.key,c)})),a)))}}const mT="LocalStore",e2=3e8;class t2{constructor(e,t,n,s){this.persistence=e,this.Cs=t,this.serializer=s,this.vs=new xs(Wn),this.Fs=new yd((a=>oT(a)),lT),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(n)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GH(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function n2(i,e,t,n){return new t2(i,e,t,n)}async function nN(i,e){const t=Kn(i);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next((a=>(s=a,t.Os(e),t.mutationQueue.getAllMutationBatches(n)))).next((a=>{const c=[],f=[];let d=$n();for(const m of s){c.push(m.batchId);for(const y of m.mutations)d=d.add(y.key)}for(const m of a){f.push(m.batchId);for(const y of m.mutations)d=d.add(y.key)}return t.localDocuments.getDocuments(n,d).next((m=>({Ns:m,removedBatchIds:c,addedBatchIds:f})))}))}))}function iN(i){const e=Kn(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function i2(i,e){const t=Kn(i),n=e.snapshotVersion;let s=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});s=t.vs;const f=[];e.targetChanges.forEach(((y,v)=>{const x=s.get(v);if(!x)return;f.push(t.li.removeMatchingKeys(a,y.removedDocuments,v).next((()=>t.li.addMatchingKeys(a,y.addedDocuments,v))));let E=x.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(v)!==null?E=E.withResumeToken(Sr.EMPTY_BYTE_STRING,gn.min()).withLastLimboFreeSnapshotVersion(gn.min()):y.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(y.resumeToken,n)),s=s.insert(v,E),(function(I,w,A){return I.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=e2?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0})(x,E,y)&&f.push(t.li.updateTargetData(a,E))}));let d=Bh(),m=$n();if(e.documentUpdates.forEach((y=>{e.resolvedLimboDocuments.has(y)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(a,y))})),f.push(s2(a,c,e.documentUpdates).next((y=>{d=y.Bs,m=y.Ls}))),!n.isEqual(gn.min())){const y=t.li.getLastRemoteSnapshotVersion(a).next((v=>t.li.setTargetsMetadata(a,a.currentSequenceNumber,n)));f.push(y)}return qe.waitFor(f).next((()=>c.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,d,m))).next((()=>d))})).then((a=>(t.vs=s,a)))}function s2(i,e,t){let n=$n(),s=$n();return t.forEach((a=>n=n.add(a))),e.getEntries(i,n).next((a=>{let c=Bh();return t.forEach(((f,d)=>{const m=a.get(f);d.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(f)),d.isNoDocument()&&d.version.isEqual(gn.min())?(e.removeEntry(f,d.readTime),c=c.insert(f,d)):!m.isValidDocument()||d.version.compareTo(m.version)>0||d.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(d),c=c.insert(f,d)):Dt(mT,"Ignoring outdated watch update for ",f,". Current version:",m.version," Watch version:",d.version)})),{Bs:c,Ls:s}}))}function r2(i,e){const t=Kn(i);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let s;return t.li.getTargetData(n,e).next((a=>a?(s=a,qe.resolve(s)):t.li.allocateTargetId(n).next((c=>(s=new Th(e,c,"TargetPurposeListen",n.currentSequenceNumber),t.li.addTargetData(n,s).next((()=>s)))))))})).then((n=>{const s=t.vs.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.vs=t.vs.insert(n.targetId,n),t.Fs.set(e,n.targetId)),n}))}async function YE(i,e,t){const n=Kn(i),s=n.vs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",a,(c=>n.persistence.referenceDelegate.removeTarget(c,s)))}catch(c){if(!Im(c))throw c;Dt(mT,`Failed to update sequence numbers for target ${e}: ${c}`)}n.vs=n.vs.remove(e),n.Fs.delete(s.target)}function aR(i,e,t){const n=Kn(i);let s=gn.min(),a=$n();return n.persistence.runTransaction("Execute query","readwrite",(c=>(function(d,m,y){const v=Kn(d),x=v.Fs.get(y);return x!==void 0?qe.resolve(v.vs.get(x)):v.li.getTargetData(m,y)})(n,c,xc(e)).next((f=>{if(f)return s=f.lastLimboFreeSnapshotVersion,n.li.getMatchingKeysForTargetId(c,f.targetId).next((d=>{a=d}))})).next((()=>n.Cs.getDocumentsMatchingQuery(c,e,t?s:gn.min(),t?a:$n()))).next((f=>(a2(n,Z9(e),f),{documents:f,ks:a})))))}function a2(i,e,t){let n=i.Ms.get(e)||gn.min();t.forEach(((s,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)})),i.Ms.set(e,n)}class oR{constructor(){this.activeTargetIds=tH()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class o2{constructor(){this.vo=new oR,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,n){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new oR,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class l2{Mo(e){}shutdown(){}}const lR="ConnectivityMonitor";class cR{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Dt(lR,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Dt(lR,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let B_=null;function ZE(){return B_===null?B_=(function(){return 268435456+Math.round(2147483648*Math.random())})():B_++,"0x"+B_.toString(16)}const tE="RestConnection",c2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class u2{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${n}/databases/${s}`,this.$o=this.databaseId.database===rb?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Wo(e,t,n,s,a){const c=ZE(),f=this.Qo(e,t.toUriEncodedString());Dt(tE,`Sending RPC '${e}' ${c}:`,f,n);const d={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(d,s,a);const{host:m}=new URL(f),y=nT(m);return this.zo(e,f,d,n,y).then((v=>(Dt(tE,`Received RPC '${e}' ${c}: `,v),v)),(v=>{throw hd(tE,`RPC '${e}' ${c} failed with error: `,v,"url: ",f,"request:",n),v}))}jo(e,t,n,s,a,c){return this.Wo(e,t,n,s,a)}Go(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Rm})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),n&&n.headers.forEach(((s,a)=>e[a]=s))}Qo(e,t){const n=c2[e];let s=`${this.qo}/v1/${t}:${n}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}class h2{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Br="WebChannelConnection",r0=(i,e,t)=>{i.listen(e,(n=>{try{t(n)}catch(s){setTimeout((()=>{throw s}),0)}}))};class Qp extends u2{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Qp.c_){const e=vD();r0(e,yD.STAT_EVENT,(t=>{t.stat===LE.PROXY?Dt(Br,"STAT_EVENT: detected buffering proxy"):t.stat===LE.NOPROXY&&Dt(Br,"STAT_EVENT: detected no buffering proxy")})),Qp.c_=!0}}zo(e,t,n,s,a){const c=ZE();return new Promise(((f,d)=>{const m=new mD;m.setWithCredentials(!0),m.listenOnce(gD.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case q_.NO_ERROR:const v=m.getResponseJson();Dt(Br,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(v)),f(v);break;case q_.TIMEOUT:Dt(Br,`RPC '${e}' ${c} timed out`),d(new Xt(xt.DEADLINE_EXCEEDED,"Request time out"));break;case q_.HTTP_ERROR:const x=m.getStatus();if(Dt(Br,`RPC '${e}' ${c} failed with status:`,x,"response text:",m.getResponseText()),x>0){let E=m.getResponseJson();Array.isArray(E)&&(E=E[0]);const T=E?.error;if(T&&T.status&&T.message){const I=(function(A){const N=A.toLowerCase().replace(/_/g,"-");return Object.values(xt).indexOf(N)>=0?N:xt.UNKNOWN})(T.status);d(new Xt(I,T.message))}else d(new Xt(xt.UNKNOWN,"Server responded with status "+m.getStatus()))}else d(new Xt(xt.UNAVAILABLE,"Connection failed."));break;default:bn(9055,{l_:e,streamId:c,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{Dt(Br,`RPC '${e}' ${c} completed.`)}}));const y=JSON.stringify(s);Dt(Br,`RPC '${e}' ${c} sending request:`,s),m.send(t,"POST",y,n,15)}))}T_(e,t,n){const s=ZE(),a=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Go(f.initMessageHeaders,t,n),f.encodeInitMessageHeaders=!0;const m=a.join("");Dt(Br,`Creating RPC '${e}' stream ${s}: ${m}`,f);const y=c.createWebChannel(m,f);this.I_(y);let v=!1,x=!1;const E=new h2({Ho:T=>{x?Dt(Br,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(v||(Dt(Br,`Opening RPC '${e}' stream ${s} transport.`),y.open(),v=!0),Dt(Br,`RPC '${e}' stream ${s} sending:`,T),y.send(T))},Jo:()=>y.close()});return r0(y,c0.EventType.OPEN,(()=>{x||(Dt(Br,`RPC '${e}' stream ${s} transport opened.`),E.i_())})),r0(y,c0.EventType.CLOSE,(()=>{x||(x=!0,Dt(Br,`RPC '${e}' stream ${s} transport closed`),E.o_(),this.E_(y))})),r0(y,c0.EventType.ERROR,(T=>{x||(x=!0,hd(Br,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),E.o_(new Xt(xt.UNAVAILABLE,"The operation could not be completed")))})),r0(y,c0.EventType.MESSAGE,(T=>{if(!x){const I=T.data[0];ns(!!I,16349);const w=I,A=w?.error||w[0]?.error;if(A){Dt(Br,`RPC '${e}' stream ${s} received error:`,A);const N=A.status;let O=(function(j){const F=Ds[j];if(F!==void 0)return WD(F)})(N),U=A.message;N==="NOT_FOUND"&&U.includes("database")&&U.includes("does not exist")&&U.includes(this.databaseId.database)&&hd(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),O===void 0&&(O=xt.INTERNAL,U="Unknown error status: "+N+" with message "+A.message),x=!0,E.o_(new Xt(O,U)),y.close()}else Dt(Br,`RPC '${e}' stream ${s} received:`,I),E.__(I)}})),Qp.u_(),setTimeout((()=>{E.s_()}),0),E}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,n){super.Go(e,t,n),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return _D()}}function f2(i){return new Qp(i)}function nE(){return typeof document<"u"?document:null}function sN(i){return new _H(i,!0)}Qp.c_=!1;class rN{constructor(e,t,n=1e3,s=1.5,a=6e4){this.Ci=e,this.timerId=t,this.R_=n,this.A_=s,this.V_=a,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&Dt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const uR="PersistentStream";class d2{constructor(e,t,n,s,a,c,f,d){this.Ci=e,this.b_=n,this.S_=s,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=f,this.listener=d,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new rN(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===xt.RESOURCE_EXHAUSTED?(bu(t.toString()),bu("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===xt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,s])=>{this.D_===t&&this.G_(n,s)}),(n=>{e((()=>{const s=new Xt(xt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)}))}))}G_(e,t){const n=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{n((()=>this.listener.Zo()))})),this.stream.Yo((()=>{n((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((s=>{n((()=>this.z_(s)))})),this.stream.onMessage((s=>{n((()=>++this.F_==1?this.H_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Dt(uR,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Dt(uR,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class p2 extends d2{constructor(e,t,n,s,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,c),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=MH(this.serializer,e),n=(function(a){if(!("targetChange"in a))return gn.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?gn.min():c.readTime?Kp(c.readTime):gn.min()})(e);return this.listener.J_(t,n)}Z_(e){const t={};t.database=nR(this.serializer),t.addTarget=(function(a,c){let f;const d=c.target;if(f=HE(d)?{documents:TH(a,d)}:{query:AH(a,d).ft},f.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){f.resumeToken=bH(a,c.resumeToken);const m=qE(a,c.expectedCount);m!==null&&(f.expectedCount=m)}else if(c.snapshotVersion.compareTo(gn.min())>0){f.readTime=xH(a,c.snapshotVersion.toTimestamp());const m=qE(a,c.expectedCount);m!==null&&(f.expectedCount=m)}return f})(this.serializer,e);const n=CH(this.serializer,e);n&&(t.labels=n),this.K_(t)}X_(e){const t={};t.database=nR(this.serializer),t.removeTarget=e,this.K_(t)}}class m2{}class g2 extends m2{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Xt(xt.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,c])=>this.connection.Wo(e,XE(t,n),s,a,c))).catch((a=>{throw a.name==="FirebaseError"?(a.code===xt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Xt(xt.UNKNOWN,a.toString())}))}jo(e,t,n,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,f])=>this.connection.jo(e,XE(t,n),s,c,f,a))).catch((c=>{throw c.name==="FirebaseError"?(c.code===xt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Xt(xt.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function y2(i,e,t,n){return new g2(i,e,t,n)}class v2{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(bu(t),this.aa=!1):Dt("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const mm="RemoteStore";class _2{constructor(e,t,n,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=a,this.Aa.Mo((c=>{n.enqueueAndForget((async()=>{gy(this)&&(Dt(mm,"Restarting streams for network reachability change."),await(async function(d){const m=Kn(d);m.Ea.add(4),await my(m),m.Va.set("Unknown"),m.Ea.delete(4),await rS(m)})(this))}))})),this.Va=new v2(n,s)}}async function rS(i){if(gy(i))for(const e of i.Ra)await e(!0)}async function my(i){for(const e of i.Ra)await e(!1)}function aN(i,e){const t=Kn(i);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),_T(t)?vT(t):Dm(t).O_()&&yT(t,e))}function gT(i,e){const t=Kn(i),n=Dm(t);t.Ia.delete(e),n.O_()&&oN(t,e),t.Ia.size===0&&(n.O_()?n.L_():gy(t)&&t.Va.set("Unknown"))}function yT(i,e){if(i.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gn.min())>0){const t=i.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Dm(i).Z_(e)}function oN(i,e){i.da.$e(e),Dm(i).X_(e)}function vT(i){i.da=new mH({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),At:e=>i.Ia.get(e)||null,ht:()=>i.datastore.serializer.databaseId}),Dm(i).start(),i.Va.ua()}function _T(i){return gy(i)&&!Dm(i).x_()&&i.Ia.size>0}function gy(i){return Kn(i).Ea.size===0}function lN(i){i.da=void 0}async function x2(i){i.Va.set("Online")}async function b2(i){i.Ia.forEach(((e,t)=>{yT(i,e)}))}async function S2(i,e){lN(i),_T(i)?(i.Va.ha(e),vT(i)):i.Va.set("Unknown")}async function E2(i,e,t){if(i.Va.set("Online"),e instanceof XD&&e.state===2&&e.cause)try{await(async function(s,a){const c=a.cause;for(const f of a.targetIds)s.Ia.has(f)&&(await s.remoteSyncer.rejectListen(f,c),s.Ia.delete(f),s.da.removeTarget(f))})(i,e)}catch(n){Dt(mm,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await hR(i,n)}else if(e instanceof Z_?i.da.Xe(e):e instanceof qD?i.da.st(e):i.da.tt(e),!t.isEqual(gn.min()))try{const n=await iN(i.localStore);t.compareTo(n)>=0&&await(function(a,c){const f=a.da.Tt(c);return f.targetChanges.forEach(((d,m)=>{if(d.resumeToken.approximateByteSize()>0){const y=a.Ia.get(m);y&&a.Ia.set(m,y.withResumeToken(d.resumeToken,c))}})),f.targetMismatches.forEach(((d,m)=>{const y=a.Ia.get(d);if(!y)return;a.Ia.set(d,y.withResumeToken(Sr.EMPTY_BYTE_STRING,y.snapshotVersion)),oN(a,d);const v=new Th(y.target,d,m,y.sequenceNumber);yT(a,v)})),a.remoteSyncer.applyRemoteEvent(f)})(i,t)}catch(n){Dt(mm,"Failed to raise snapshot:",n),await hR(i,n)}}async function hR(i,e,t){if(!Im(e))throw e;i.Ea.add(1),await my(i),i.Va.set("Offline"),t||(t=()=>iN(i.localStore)),i.asyncQueue.enqueueRetryable((async()=>{Dt(mm,"Retrying IndexedDB access"),await t(),i.Ea.delete(1),await rS(i)}))}async function fR(i,e){const t=Kn(i);t.asyncQueue.verifyOperationInProgress(),Dt(mm,"RemoteStore received new credentials");const n=gy(t);t.Ea.add(3),await my(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await rS(t)}async function M2(i,e){const t=Kn(i);e?(t.Ea.delete(2),await rS(t)):e||(t.Ea.add(2),await my(t),t.Va.set("Unknown"))}function Dm(i){return i.ma||(i.ma=(function(t,n,s){const a=Kn(t);return a.sa(),new p2(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(i.datastore,i.asyncQueue,{Zo:x2.bind(null,i),Yo:b2.bind(null,i),t_:S2.bind(null,i),J_:E2.bind(null,i)}),i.Ra.push((async e=>{e?(i.ma.B_(),_T(i)?vT(i):i.Va.set("Unknown")):(await i.ma.stop(),lN(i))}))),i.ma}class xT{constructor(e,t,n,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=a,this.deferred=new id,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,a){const c=Date.now()+n,f=new xT(e,t,c,s,a);return f.start(n),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Xt(xt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cN(i,e){if(bu("AsyncQueue",`${e}: ${i}`),Im(i))return new Xt(xt.UNAVAILABLE,`${e}: ${i}`);throw i}class $p{static emptySet(e){return new $p(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||an.comparator(t.key,n.key):(t,n)=>an.comparator(t.key,n.key),this.keyedMap=u0(),this.sortedSet=new xs(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $p)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=n.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new $p;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class dR{constructor(){this.ga=new xs(an.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):bn(63341,{Vt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class gm{constructor(e,t,n,s,a,c,f,d,m){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=f,this.excludesMetadataChanges=d,this.hasCachedResults=m}static fromInitialDocuments(e,t,n,s,a){const c=[];return t.forEach((f=>{c.push({type:0,doc:f})})),new gm(e,t,$p.emptySet(t),c,n,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&eS(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}class T2{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class A2{constructor(){this.queries=pR(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=Kn(t),a=s.queries;s.queries=pR(),a.forEach(((c,f)=>{for(const d of f.ba)d.onError(n)}))})(this,new Xt(xt.ABORTED,"Firestore shutting down"))}}function pR(){return new yd((i=>UD(i)),eS)}async function w2(i,e){const t=Kn(i);let n=3;const s=e.query;let a=t.queries.get(s);a?!a.Sa()&&e.Da()&&(n=2):(a=new T2,n=e.Da()?0:1);try{switch(n){case 0:a.wa=await t.onListen(s,!0);break;case 1:a.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(c){const f=cN(c,`Initialization of query '${Fp(e.query)}' failed`);return void e.onError(f)}t.queries.set(s,a),a.ba.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&bT(t)}async function C2(i,e){const t=Kn(i),n=e.query;let s=3;const a=t.queries.get(n);if(a){const c=a.ba.indexOf(e);c>=0&&(a.ba.splice(c,1),a.ba.length===0?s=e.Da()?0:1:!a.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function R2(i,e){const t=Kn(i);let n=!1;for(const s of e){const a=s.query,c=t.queries.get(a);if(c){for(const f of c.ba)f.Fa(s)&&(n=!0);c.wa=s}}n&&bT(t)}function I2(i,e,t){const n=Kn(i),s=n.queries.get(e);if(s)for(const a of s.ba)a.onError(t);n.queries.delete(e)}function bT(i){i.Ca.forEach((e=>{e.next()}))}var KE,mR;(mR=KE||(KE={})).Ma="default",mR.Cache="cache";class D2{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new gm(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.Ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=gm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==KE.Cache}}class uN{constructor(e){this.key=e}}class hN{constructor(e){this.key=e}}class N2{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=$n(),this.mutatedKeys=$n(),this.eu=zD(e),this.tu=new $p(this.eu)}get nu(){return this.Za}ru(e,t){const n=t?t.iu:new dR,s=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,c=s,f=!1;const d=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((y,v)=>{const x=s.get(y),E=tS(this.query,v)?v:null,T=!!x&&this.mutatedKeys.has(x.key),I=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let w=!1;x&&E?x.data.isEqual(E.data)?T!==I&&(n.track({type:3,doc:E}),w=!0):this.su(x,E)||(n.track({type:2,doc:E}),w=!0,(d&&this.eu(E,d)>0||m&&this.eu(E,m)<0)&&(f=!0)):!x&&E?(n.track({type:0,doc:E}),w=!0):x&&!E&&(n.track({type:1,doc:x}),w=!0,(d||m)&&(f=!0)),w&&(E?(c=c.add(E),a=I?a.add(y):a.delete(y)):(c=c.delete(y),a=a.delete(y)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const y=this.query.limitType==="F"?c.last():c.first();c=c.delete(y.key),a=a.delete(y.key),n.track({type:1,doc:y})}return{tu:c,iu:n,Ss:f,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((y,v)=>(function(E,T){const I=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return bn(20277,{Vt:w})}};return I(E)-I(T)})(y.type,v.type)||this.eu(y.doc,v.doc))),this.ou(n),s=s??!1;const f=t&&!s?this._u():[],d=this.Ya.size===0&&this.current&&!s?1:0,m=d!==this.Xa;return this.Xa=d,c.length!==0||m?{snapshot:new gm(this.query,e.tu,a,c,e.mutatedKeys,d===0,m,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new dR,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=$n(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Ya=this.Ya.add(n.key))}));const t=[];return e.forEach((n=>{this.Ya.has(n)||t.push(new hN(n))})),this.Ya.forEach((n=>{e.has(n)||t.push(new uN(n))})),t}cu(e){this.Za=e.ks,this.Ya=$n();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return gm.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const ST="SyncEngine";class P2{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class L2{constructor(e){this.key=e,this.hu=!1}}class O2{constructor(e,t,n,s,a,c){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new yd((f=>UD(f)),eS),this.Iu=new Map,this.Eu=new Set,this.Ru=new xs(an.comparator),this.Au=new Map,this.Vu=new fT,this.du={},this.mu=new Map,this.fu=pm.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function U2(i,e,t=!0){const n=gN(i);let s;const a=n.Tu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await fN(n,e,t,!0),s}async function z2(i,e){const t=gN(i);await fN(t,e,!0,!1)}async function fN(i,e,t,n){const s=await r2(i.localStore,xc(e)),a=s.targetId,c=i.sharedClientState.addLocalQueryTarget(a,t);let f;return n&&(f=await F2(i,e,a,c==="current",s.resumeToken)),i.isPrimaryClient&&t&&aN(i.remoteStore,s),f}async function F2(i,e,t,n,s){i.pu=(v,x,E)=>(async function(I,w,A,N){let O=w.view.ru(A);O.Ss&&(O=await aR(I.localStore,w.query,!1).then((({documents:F})=>w.view.ru(F,O))));const U=N&&N.targetChanges.get(w.targetId),q=N&&N.targetMismatches.get(w.targetId)!=null,j=w.view.applyChanges(O,I.isPrimaryClient,U,q);return yR(I,w.targetId,j.au),j.snapshot})(i,v,x,E);const a=await aR(i.localStore,e,!0),c=new N2(e,a.ks),f=c.ru(a.documents),d=py.createSynthesizedTargetChangeForCurrentChange(t,n&&i.onlineState!=="Offline",s),m=c.applyChanges(f,i.isPrimaryClient,d);yR(i,t,m.au);const y=new P2(e,t,c);return i.Tu.set(e,y),i.Iu.has(t)?i.Iu.get(t).push(e):i.Iu.set(t,[e]),m.snapshot}async function B2(i,e,t){const n=Kn(i),s=n.Tu.get(e),a=n.Iu.get(s.targetId);if(a.length>1)return n.Iu.set(s.targetId,a.filter((c=>!eS(c,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await YE(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),t&&gT(n.remoteStore,s.targetId),QE(n,s.targetId)})).catch(Zb)):(QE(n,s.targetId),await YE(n.localStore,s.targetId,!0))}async function V2(i,e){const t=Kn(i),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),gT(t.remoteStore,n.targetId))}async function dN(i,e){const t=Kn(i);try{const n=await i2(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const c=t.Au.get(a);c&&(ns(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?c.hu=!0:s.modifiedDocuments.size>0?ns(c.hu,14607):s.removedDocuments.size>0&&(ns(c.hu,42227),c.hu=!1))})),await mN(t,n,e)}catch(n){await Zb(n)}}function gR(i,e,t){const n=Kn(i);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach(((a,c)=>{const f=c.view.va(e);f.snapshot&&s.push(f.snapshot)})),(function(c,f){const d=Kn(c);d.onlineState=f;let m=!1;d.queries.forEach(((y,v)=>{for(const x of v.ba)x.va(f)&&(m=!0)})),m&&bT(d)})(n.eventManager,e),s.length&&n.Pu.J_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function k2(i,e,t){const n=Kn(i);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),a=s&&s.key;if(a){let c=new xs(an.comparator);c=c.insert(a,Hr.newNoDocument(a,gn.min()));const f=$n().add(a),d=new sS(gn.min(),new Map,new xs(Wn),c,f);await dN(n,d),n.Ru=n.Ru.remove(a),n.Au.delete(e),ET(n)}else await YE(n.localStore,e,!1).then((()=>QE(n,e,t))).catch(Zb)}function QE(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.Iu.get(e))i.Tu.delete(n),t&&i.Pu.yu(n,t);i.Iu.delete(e),i.isPrimaryClient&&i.Vu.Gr(e).forEach((n=>{i.Vu.containsKey(n)||pN(i,n)}))}function pN(i,e){i.Eu.delete(e.path.canonicalString());const t=i.Ru.get(e);t!==null&&(gT(i.remoteStore,t),i.Ru=i.Ru.remove(e),i.Au.delete(t),ET(i))}function yR(i,e,t){for(const n of t)n instanceof uN?(i.Vu.addReference(n.key,e),H2(i,n)):n instanceof hN?(Dt(ST,"Document no longer in limbo: "+n.key),i.Vu.removeReference(n.key,e),i.Vu.containsKey(n.key)||pN(i,n.key)):bn(19791,{wu:n})}function H2(i,e){const t=e.key,n=t.path.canonicalString();i.Ru.get(t)||i.Eu.has(n)||(Dt(ST,"New document in limbo: "+t),i.Eu.add(n),ET(i))}function ET(i){for(;i.Eu.size>0&&i.Ru.size<i.maxConcurrentLimboResolutions;){const e=i.Eu.values().next().value;i.Eu.delete(e);const t=new an(es.fromString(e)),n=i.fu.next();i.Au.set(n,new L2(t)),i.Ru=i.Ru.insert(t,n),aN(i.remoteStore,new Th(xc(OD(t.path)),n,"TargetPurposeLimboResolution",Kb.ce))}}async function mN(i,e,t){const n=Kn(i),s=[],a=[],c=[];n.Tu.isEmpty()||(n.Tu.forEach(((f,d)=>{c.push(n.pu(d,e,t).then((m=>{if((m||t)&&n.isPrimaryClient){const y=m?!m.fromCache:t?.targetChanges.get(d.targetId)?.current;n.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(m){s.push(m);const y=pT.Es(d.targetId,m);a.push(y)}})))})),await Promise.all(c),n.Pu.J_(s),await(async function(d,m){const y=Kn(d);try{await y.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>qe.forEach(m,(x=>qe.forEach(x.Ts,(E=>y.persistence.referenceDelegate.addReference(v,x.targetId,E))).next((()=>qe.forEach(x.Is,(E=>y.persistence.referenceDelegate.removeReference(v,x.targetId,E)))))))))}catch(v){if(!Im(v))throw v;Dt(mT,"Failed to update sequence numbers: "+v)}for(const v of m){const x=v.targetId;if(!v.fromCache){const E=y.vs.get(x),T=E.snapshotVersion,I=E.withLastLimboFreeSnapshotVersion(T);y.vs=y.vs.insert(x,I)}}})(n.localStore,a))}async function G2(i,e){const t=Kn(i);if(!t.currentUser.isEqual(e)){Dt(ST,"User change. New user:",e.toKey());const n=await nN(t.localStore,e);t.currentUser=e,(function(a,c){a.mu.forEach((f=>{f.forEach((d=>{d.reject(new Xt(xt.CANCELLED,c))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await mN(t,n.Ns)}}function j2(i,e){const t=Kn(i),n=t.Au.get(e);if(n&&n.hu)return $n().add(n.key);{let s=$n();const a=t.Iu.get(e);if(!a)return s;for(const c of a){const f=t.Tu.get(c);s=s.unionWith(f.view.nu)}return s}}function gN(i){const e=Kn(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=dN.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=j2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=k2.bind(null,e),e.Pu.J_=R2.bind(null,e.eventManager),e.Pu.yu=I2.bind(null,e.eventManager),e}class hb{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sN(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return n2(this.persistence,new JH,e.initialUser,this.serializer)}Cu(e){return new tN(dT.Vi,this.serializer)}Du(e){return new o2}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hb.provider={build:()=>new hb};class W2 extends hb{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ns(this.persistence.referenceDelegate instanceof ub,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new FH(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Va.withCacheSize(this.cacheSizeBytes):Va.DEFAULT;return new tN((n=>ub.Vi(n,t)),this.serializer)}}class $E{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>gR(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=G2.bind(null,this.syncEngine),await M2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new A2})()}createDatastore(e){const t=sN(e.databaseInfo.databaseId),n=f2(e.databaseInfo);return y2(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,s,a,c,f){return new _2(n,s,a,c,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>gR(this.syncEngine,t,0)),(function(){return cR.v()?new cR:new l2})())}createSyncEngine(e,t){return(function(s,a,c,f,d,m,y){const v=new O2(s,a,c,f,d,m);return y&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const n=Kn(t);Dt(mm,"RemoteStore shutting down."),n.Ea.add(5),await my(n),n.Aa.shutdown(),n.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}$E.provider={build:()=>new $E};class q2{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):bu("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Vh="FirestoreClient";class X2{constructor(e,t,n,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this._databaseInfo=s,this.user=Vr.UNAUTHENTICATED,this.clientId=SD.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,(async c=>{Dt(Vh,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(n,(c=>(Dt(Vh,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new id;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=cN(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function iE(i,e){i.asyncQueue.verifyOperationInProgress(),Dt(Vh,"Initializing OfflineComponentProvider");const t=i.configuration;await e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener((async s=>{n.isEqual(s)||(await nN(e.localStore,s),n=s)})),e.persistence.setDatabaseDeletedListener((()=>i.terminate())),i._offlineComponents=e}async function vR(i,e){i.asyncQueue.verifyOperationInProgress();const t=await Y2(i);Dt(Vh,"Initializing OnlineComponentProvider"),await e.initialize(t,i.configuration),i.setCredentialChangeListener((n=>fR(e.remoteStore,n))),i.setAppCheckTokenChangeListener(((n,s)=>fR(e.remoteStore,s))),i._onlineComponents=e}async function Y2(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){Dt(Vh,"Using user provided OfflineComponentProvider");try{await iE(i,i._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===xt.FAILED_PRECONDITION||s.code===xt.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;hd("Error using user provided cache. Falling back to memory cache: "+t),await iE(i,new hb)}}else Dt(Vh,"Using default OfflineComponentProvider"),await iE(i,new W2(void 0));return i._offlineComponents}async function Z2(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(Dt(Vh,"Using user provided OnlineComponentProvider"),await vR(i,i._uninitializedComponentsProvider._online)):(Dt(Vh,"Using default OnlineComponentProvider"),await vR(i,new $E))),i._onlineComponents}async function K2(i){const e=await Z2(i),t=e.eventManager;return t.onListen=U2.bind(null,e.syncEngine),t.onUnlisten=B2.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=z2.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=V2.bind(null,e.syncEngine),t}function Q2(i,e,t={}){const n=new id;return i.asyncQueue.enqueueAndForget((async()=>(function(a,c,f,d,m){const y=new q2({next:x=>{y.Nu(),c.enqueueAndForget((()=>C2(a,v))),x.fromCache&&d.source==="server"?m.reject(new Xt(xt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(x)},error:x=>m.reject(x)}),v=new D2(f,y,{includeMetadataChanges:!0,Ka:!0});return w2(a,v)})(await K2(i),i.asyncQueue,e,t,n))),n.promise}function yN(i){const e={};return i.timeoutSeconds!==void 0&&(e.timeoutSeconds=i.timeoutSeconds),e}const $2="ComponentProvider",_R=new Map;function J2(i,e,t,n,s){return new C9(i,e,t,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,yN(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,n)}const vN="firestore.googleapis.com",xR=!0;class bR{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Xt(xt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=vN,this.ssl=xR}else this.host=e.host,this.ssl=e.ssl??xR;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=eN;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<UH)throw new Xt(xt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}p9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yN(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Xt(xt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Xt(xt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Xt(xt.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,s){return n.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class MT{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bR({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Xt(xt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Xt(xt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bR(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new s9;switch(n.type){case"firstParty":return new l9(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Xt(xt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=_R.get(t);n&&(Dt($2,"Removing Datastore"),_R.delete(t),n.terminate())})(this),Promise.resolve()}}function eG(i,e,t,n={}){i=UE(i,MT);const s=nT(e),a=i._getSettings(),c={...a,emulatorOptions:i._getEmulatorOptions()},f=`${e}:${t}`;s&&(Nk(`https://${f}`),Uk("Firestore",!0)),a.host!==vN&&a.host!==f&&hd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d={...a,host:f,ssl:s,emulatorOptions:n};if(!nb(d,c)&&(i._setSettings(d),n.mockUserToken)){let m,y;if(typeof n.mockUserToken=="string")m=n.mockUserToken,y=Vr.MOCK_USER;else{m=Pk(n.mockUserToken,i._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new Xt(xt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Vr(v)}i._authCredentials=new r9(new bD(m,y))}}class aS{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new aS(this.firestore,e,this._query)}}class Go{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Go(this.firestore,e,this._key)}toJSON(){return{type:Go._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(fy(t,Go._jsonSchema))return new Go(e,n||null,new an(es.fromString(t.referencePath)))}}Go._jsonSchemaVersion="firestore/documentReference/1.0",Go._jsonSchema={type:Ps("string",Go._jsonSchemaVersion),referencePath:Ps("string")};class Jp extends aS{constructor(e,t,n){super(e,t,OD(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Go(this.firestore,null,new an(e))}withConverter(e){return new Jp(this.firestore,e,this._path)}}function SR(i,e,...t){if(i=oD(i),i instanceof MT){const n=es.fromString(e,...t);return LC(n),new Jp(i,null,n)}{if(!(i instanceof Go||i instanceof Jp))throw new Xt(xt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(es.fromString(e,...t));return LC(n),new Jp(i.firestore,null,n)}}const ER="AsyncQueue";class MR{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new rN(this,"async_queue_retry"),this._c=()=>{const n=nE();n&&Dt(ER,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=nE();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=nE();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new id;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Im(e))throw e;Dt(ER,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,bu("INTERNAL UNHANDLED ERROR: ",TR(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=xT.createAndSchedule(this,e,t,n,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&bn(47125,{Pc:TR(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function TR(i){let e=i.message||"";return i.stack&&(e=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),e}class _N extends MT{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new MR,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new MR(e),this._firestoreClient=void 0,await e}}}function tG(i,e){const t=typeof i=="object"?i:q8(),n=typeof i=="string"?i:rb,s=k8(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const a=Ik("firestore");a&&eG(s,...a)}return s}function nG(i){if(i._terminated)throw new Xt(xt.FAILED_PRECONDITION,"The client has already been terminated.");return i._firestoreClient||iG(i),i._firestoreClient}function iG(i){const e=i._freezeSettings(),t=J2(i._databaseId,i._app?.options.appId||"",i._persistenceKey,i._app?.options.apiKey,e);i._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(i._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),i._firestoreClient=new X2(i._authCredentials,i._appCheckCredentials,i._queue,t,i._componentsProvider&&(function(s){const a=s?._online.build();return{_offline:s?._offline.build(a),_online:a}})(i._componentsProvider))}class mc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mc(Sr.fromBase64String(e))}catch(t){throw new Xt(xt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new mc(Sr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:mc._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(fy(e,mc._jsonSchema))return mc.fromBase64String(e.bytes)}}mc._jsonSchemaVersion="firestore/bytes/1.0",mc._jsonSchema={type:Ps("string",mc._jsonSchemaVersion),bytes:Ps("string")};class xN{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Xt(xt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ha(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Rh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Xt(xt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Xt(xt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Wn(this._lat,e._lat)||Wn(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rh._jsonSchemaVersion}}static fromJSON(e){if(fy(e,Rh._jsonSchema))return new Rh(e.latitude,e.longitude)}}Rh._jsonSchemaVersion="firestore/geoPoint/1.0",Rh._jsonSchema={type:Ps("string",Rh._jsonSchemaVersion),latitude:Ps("number"),longitude:Ps("number")};class Ih{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,s){if(n.length!==s.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ih._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(fy(e,Ih._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ih(e.vectorValues);throw new Xt(xt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ih._jsonSchemaVersion="firestore/vectorValue/1.0",Ih._jsonSchema={type:Ps("string",Ih._jsonSchemaVersion),vectorValues:Ps("object")};function bN(i,e,t){if((e=oD(e))instanceof xN)return e._internalPath;if(typeof e=="string")return rG(i,e);throw JE("Field path arguments must be of type string or ",i)}const sG=new RegExp("[~\\*/\\[\\]]");function rG(i,e,t){if(e.search(sG)>=0)throw JE(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i);try{return new xN(...e.split("."))._internalPath}catch{throw JE(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i)}}function JE(i,e,t,n,s){let a=`Function ${e}() called with invalid data`;a+=". ";let c="";return new Xt(xt.INVALID_ARGUMENT,a+i+c)}class aG{convertValue(e,t="none"){switch(Fh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ms(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(zh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw bn(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return dy(e,((s,a)=>{n[s]=this.convertValue(a,t)})),n}convertVectorValue(e){const t=e.fields?.[FE].arrayValue?.values?.map((n=>ms(n.doubleValue)));return new Ih(t)}convertGeoPoint(e){return new Rh(ms(e.latitude),ms(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=$b(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(K0(e));default:return null}}convertTimestamp(e){const t=Uh(e);return new Ns(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=es.fromString(e);ns(JD(n),9688,{name:e});const s=new Q0(n.get(1),n.get(3)),a=new an(n.popFirst(5));return s.isEqual(t)||bu(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}class oG extends aG{constructor(e){super(),this.firestore=e}convertBytes(e){return new mc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Go(this.firestore,null,t)}}const AR="@firebase/firestore",wR="4.11.0";class SN{constructor(e,t,n,s,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Go(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lG(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(bN("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class lG extends SN{data(){return super.data()}}function cG(i){if(i.limitType==="L"&&i.explicitOrderBy.length===0)throw new Xt(xt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class V_{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class em extends SN{constructor(e,t,n,s,a,c){super(e,t,n,s,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new K_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(bN("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Xt(xt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=em._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}em._jsonSchemaVersion="firestore/documentSnapshot/1.0",em._jsonSchema={type:Ps("string",em._jsonSchemaVersion),bundleSource:Ps("string","DocumentSnapshot"),bundleName:Ps("string"),bundle:Ps("string")};class K_ extends em{data(e={}){return super.data(e)}}class tm{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new V_(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new K_(this._firestore,this._userDataWriter,n.key,n,new V_(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Xt(xt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map((f=>{const d=new K_(s._firestore,s._userDataWriter,f.doc.key,f.doc,new V_(s._snapshot.mutatedKeys.has(f.doc.key),s._snapshot.fromCache),s.query.converter);return f.doc,{type:"added",doc:d,oldIndex:-1,newIndex:c++}}))}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((f=>a||f.type!==3)).map((f=>{const d=new K_(s._firestore,s._userDataWriter,f.doc.key,f.doc,new V_(s._snapshot.mutatedKeys.has(f.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,y=-1;return f.type!==0&&(m=c.indexOf(f.doc.key),c=c.delete(f.doc.key)),f.type!==1&&(c=c.add(f.doc),y=c.indexOf(f.doc.key)),{type:uG(f.type),doc:d,oldIndex:m,newIndex:y}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Xt(xt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tm._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=SD.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function uG(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return bn(61501,{type:i})}}tm._jsonSchemaVersion="firestore/querySnapshot/1.0",tm._jsonSchema={type:Ps("string",tm._jsonSchemaVersion),bundleSource:Ps("string","QuerySnapshot"),bundleName:Ps("string"),bundle:Ps("string")};function CR(i){i=UE(i,aS);const e=UE(i.firestore,_N),t=nG(e),n=new oG(e);return cG(i._query),Q2(t,i._query).then((s=>new tm(e,n,i,s)))}(function(e,t=!0){i9(W8),sb(new X0("firestore",((n,{instanceIdentifier:s,options:a})=>{const c=n.getProvider("app").getImmediate(),f=new _N(new a9(n.getProvider("auth-internal")),new c9(c,n.getProvider("app-check-internal")),R9(c,s),c);return a={useFetchStreams:t,...a},f._setSettings(a),f}),"PUBLIC").setMultipleInstances(!0)),Zp(AR,wR,e),Zp(AR,wR,"esm2020")})();var hG="firebase",fG="12.9.0";Zp(hG,fG,"app");const dG={projectId:"we-are-the-walrus"},pG=hD(dG),RR=tG(pG),ym=Math.PI/180;function Q_(i,e,t){const n=i*ym;return[e*Math.cos(n),t,e*Math.sin(n)]}function J0(i){return{O:"#5c7aff",B:"#7a9fff",A:"#a4bfff",F:"#f5f0ff",G:"#ffe44d",K:"#ff8c00",M:"#ff4500"}[i?.toUpperCase()]??"#ffffff"}function mG(i,e){return .12*(i==="O"||i==="B"?1.6:i==="F"?1.2:i==="G"?1:i==="K"?.85:i==="M"?.65:1)*Math.max(.6,Math.min(e,2))}function EN({radius:i,color:e}){const t=Ve.useRef(null);return hy(({clock:n})=>{t.current&&(t.current.rotation.z=n.elapsedTime*.5)}),W.jsxs("mesh",{ref:t,rotation:[-Math.PI/2,0,0],children:[W.jsx("ringGeometry",{args:[i*1.6,i*2,48]}),W.jsx("meshBasicMaterial",{color:e,transparent:!0,opacity:.45,side:bl})]})}function gG({system:i,isSelected:e,onSelect:t}){const n=Ve.useRef(null),s=Ve.useRef(null),a=i.stars[0],c=J0(a.spectralClass),f=Q_(i.position.azimuth,i.position.distance,i.position.elevation),d=mG(a.spectralClass,a.radius);hy(()=>{if(s.current){const x=e?3.5:2.2;s.current.scale.setScalar(x)}});const m=Ve.useCallback(x=>{x.stopPropagation(),document.body.style.cursor="pointer"},[]),y=Ve.useCallback(()=>{document.body.style.cursor="auto"},[]),v=Ve.useCallback(x=>{x.stopPropagation(),!e&&t(i.id)},[i,e,t]);return W.jsxs("group",{position:f,children:[W.jsxs("mesh",{ref:s,children:[W.jsx("sphereGeometry",{args:[d,16,16]}),W.jsx("meshBasicMaterial",{color:c,transparent:!0,opacity:.12})]}),W.jsxs("mesh",{ref:n,onPointerOver:m,onPointerOut:y,onClick:v,children:[W.jsx("sphereGeometry",{args:[d,16,16]}),W.jsx("meshBasicMaterial",{color:c})]}),W.jsxs("mesh",{onClick:v,onPointerOver:m,onPointerOut:y,children:[W.jsx("sphereGeometry",{args:[Math.max(d*2,.7),16,16]}),W.jsx("meshBasicMaterial",{visible:!1})]}),W.jsx("pointLight",{color:c,intensity:e?2:.6,distance:3,decay:2}),e&&W.jsx(EN,{radius:d,color:c})]})}function yG({semiMajorAxis:i,eccentricity:e,inclination:t,color:n="#ffffff",opacity:s=.18}){const a=Ve.useMemo(()=>{const c=[],f=Math.sqrt(i)*9,d=f*Math.sqrt(1-e*e),m=t*ym,y=96;for(let v=0;v<=y;v++){const x=v/y*Math.PI*2,E=f*Math.cos(x),T=d*Math.sin(x),I=T*Math.sin(m),w=T*Math.cos(m);c.push([E,I,w])}return c},[i,e,t]);return W.jsx(pk,{points:a,color:n,lineWidth:1,transparent:!0,opacity:s})}function vG({planet:i,isSelected:e,onSelect:t}){const n=Ve.useRef(null),{orbit:s,render:a}=i,c=Math.sqrt(s.semiMajorAxis)*9,f=c*Math.sqrt(1-s.eccentricity*s.eccentricity),d=s.currentAngle*ym,m=s.inclination*ym,y=c*Math.cos(d),v=f*Math.sin(d),x=v*Math.sin(m),E=v*Math.cos(m),T=Math.max(.25,Math.sqrt(a.radius)*.45),I=Ve.useCallback(N=>{N.stopPropagation(),document.body.style.cursor="pointer"},[]),w=Ve.useCallback(()=>{document.body.style.cursor="auto"},[]),A=Ve.useCallback(N=>{N.stopPropagation(),t(e?"":i.id)},[e,t,i.id]);return W.jsxs("group",{position:[y,x,E],children:[W.jsxs("mesh",{ref:n,onPointerOver:I,onPointerOut:w,onClick:A,children:[W.jsx("sphereGeometry",{args:[T,32,32]}),W.jsx("meshStandardMaterial",{color:a.primaryColor,roughness:.55,metalness:.05})]}),a.atmosphereIntensity>.05&&W.jsxs("mesh",{children:[W.jsx("sphereGeometry",{args:[T*1.12,32,32]}),W.jsx("meshBasicMaterial",{color:a.atmosphereColor,transparent:!0,opacity:a.atmosphereIntensity*.4,side:jr})]}),e&&W.jsx(EN,{radius:T,color:a.primaryColor})]})}function _G({system:i,planets:e,selectedPlanetId:t,onSelectPlanet:n}){const s=i.stars[0],a=J0(s.spectralClass),c=Math.max(.6,Math.sqrt(s.radius)*.8);return W.jsxs("group",{children:[W.jsxs("mesh",{children:[W.jsx("sphereGeometry",{args:[c,32,32]}),W.jsx("meshBasicMaterial",{color:a})]}),W.jsx("pointLight",{color:a,intensity:8,distance:120,decay:1.2}),W.jsxs("mesh",{children:[W.jsx("sphereGeometry",{args:[c*1.5,32,32]}),W.jsx("meshBasicMaterial",{color:a,transparent:!0,opacity:.1})]}),i.stars.length>1&&i.stars[1]&&(()=>{const f=i.stars[1],d=J0(f.spectralClass),m=Math.max(.4,Math.sqrt(f.radius)*.6),y=(f.orbitRadius??.2)*20,v=(f.orbitAngle??0)*ym,x=y*Math.cos(v),E=y*Math.sin(v);return W.jsxs("group",{position:[x,0,E],children:[W.jsxs("mesh",{children:[W.jsx("sphereGeometry",{args:[m,24,24]}),W.jsx("meshBasicMaterial",{color:d})]}),W.jsx("pointLight",{color:d,intensity:5,distance:80,decay:1.5}),W.jsxs("mesh",{children:[W.jsx("sphereGeometry",{args:[m*1.5,24,24]}),W.jsx("meshBasicMaterial",{color:d,transparent:!0,opacity:.08})]})]})})(),e.map(f=>W.jsxs("group",{children:[W.jsx(yG,{semiMajorAxis:f.orbit.semiMajorAxis,eccentricity:f.orbit.eccentricity,inclination:f.orbit.inclination,color:f.render.primaryColor,opacity:.2}),W.jsx(vG,{planet:f,isSelected:t===f.id,onSelect:n})]},f.id))]})}function xG({targetPosition:i,targetLookAt:e,active:t}){const{camera:n}=vl(),s=Ve.useRef(new J(0,0,0));return hy(()=>{t&&(n.position.lerp(i,.04),s.current.lerp(e,.04),n.lookAt(s.current))}),null}function bG({starSystems:i,planets:e,selectedSystem:t,onSelectSystem:n,selectedStarId:s,onSelectStarId:a,selectedPlanetId:c,onSelectPlanetId:f}){const d=Ve.useRef(null),{camera:m}=vl(),y=Ve.useMemo(()=>new J(0,30,35),[]),v=Ve.useMemo(()=>new J(0,0,0),[]),x=Ve.useMemo(()=>{if(!t)return 0;const q=[],j=e.filter(F=>F.starSystemId===t.id);for(const F of j)q.push(Math.sqrt(F.orbit.semiMajorAxis)*9);if(t.stars.length>1&&t.stars[1]){const R=(t.stars[1].orbitRadius??.2)*20;q.push(R)}return q.length>0?Math.max(...q):5},[t,e]),E=Ve.useMemo(()=>{if(!t)return new J(0,30,35);const[q,j,F]=Q_(t.position.azimuth,t.position.distance,t.position.elevation),R=55/2*ym,H=Math.min(200,Math.max(10,x*1.35/Math.tan(R))),B=.55,X=.75,k=Math.sqrt(B**2+X**2);return new J(q,j+H*B/k,F+H*X/k)},[t,x]),T=Ve.useMemo(()=>{if(!t)return new J(0,0,0);const[q,j,F]=Q_(t.position.azimuth,t.position.distance,t.position.elevation);return new J(q,j,F)},[t]),[I,w]=Ve.useState(!1),A=Ve.useRef(null);Ve.useEffect(()=>{const q=t?.id??null;if(q!==A.current){A.current=q,w(!0);const j=setTimeout(()=>w(!1),1500);return()=>clearTimeout(j)}},[t]),Ve.useEffect(()=>{m.position.set(0,30,35),m.lookAt(0,0,0)},[m]);const N=t?E:y,O=t?T:v,U=Ve.useMemo(()=>t?e.filter(q=>q.starSystemId===t.id):[],[t,e]);return W.jsxs(W.Fragment,{children:[W.jsx(xG,{targetPosition:N,targetLookAt:O,active:I}),W.jsx(yk,{ref:d,enableDamping:!0,dampingFactor:.1,minDistance:2,maxDistance:t?Math.min(300,Math.max(80,x*4)):80,target:O}),W.jsx(nD,{radius:120,depth:80,count:3e3,factor:3,saturation:.1,fade:!0,speed:.5}),W.jsx("ambientLight",{intensity:.18}),!t&&W.jsx("group",{children:W.jsx("pointLight",{color:"#ffd89b",intensity:2,distance:15,decay:2})}),!t&&i.map(q=>W.jsx(gG,{system:q,isSelected:s===q.id,onSelect:a},q.id)),t&&W.jsx("group",{position:Q_(t.position.azimuth,t.position.distance,t.position.elevation),children:W.jsx(_G,{system:t,planets:U,selectedPlanetId:c,onSelectPlanet:f})})]})}function SG(){const{worldId:i}=vm(),e=fd(),[t,n]=Ve.useState(null),[s,a]=Ve.useState(null),[c,f]=Ve.useState(null),[d,m]=Ve.useState(!0),[y,v]=Ve.useState(""),[x,E]=Ve.useState("");Ve.useEffect(()=>{v(""),E("")},[t]),Ve.useEffect(()=>{if(!i)return;let w=!1;return m(!0),Promise.all([CR(SR(RR,"worlds",i,"star-systems")),CR(SR(RR,"worlds",i,"planets"))]).then(([A,N])=>{w||(a(A.docs.map(O=>({id:O.id,...O.data()}))),f(N.docs.map(O=>({id:O.id,...O.data()}))))}).catch(A=>{console.error("Firestore fetch error:",A)}).finally(()=>{w||m(!1)}),()=>{w=!0}},[i]);const T=Ve.useCallback(w=>{n(w),v(""),E("")},[]),I=Ve.useCallback(()=>{t?n(null):e(`/worlds/${i}`)},[t,e,i]);return W.jsxs(yn,{sx:{position:"relative",width:"100%",height:"calc(100vh - 64px)",bgcolor:"#000"},children:[W.jsxs(yn,{sx:{position:"absolute",top:16,left:16,zIndex:10,display:"flex",alignItems:"center",gap:1},children:[W.jsx(k_,{onClick:I,sx:{bgcolor:cn("#0a0f1e",.8),backdropFilter:"blur(8px)",border:`1px solid ${cn("#fff",.1)}`,color:"#fff","&:hover":{bgcolor:cn("#0a0f1e",.95)}},children:W.jsx(LP,{})}),W.jsxs(vc,{sx:{px:2,py:.8,bgcolor:cn("#0a0f1e",.8),backdropFilter:"blur(8px)",border:`1px solid ${cn("#fff",.1)}`},children:[W.jsx(Nt,{variant:"subtitle2",sx:{color:"#fff",fontWeight:600},children:t?t.name:"Galaxy Map"}),t&&W.jsxs(Nt,{variant:"caption",sx:{color:cn("#fff",.6)},children:[t.systemType==="binary"?"Binary":"Single"," "," ",t.stars[0]?.spectralClass,"-class  Click back to return"]})]})]}),d&&W.jsx(yn,{sx:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",zIndex:20,bgcolor:cn("#000",.7)},children:W.jsxs(gs,{alignItems:"center",spacing:2,children:[W.jsx(DR,{sx:{color:"#7c4dff"}}),W.jsx(Nt,{color:"#fff",children:"Loading galaxy data"})]})}),W.jsx(nk,{camera:{position:[0,30,35],fov:55,near:.1,far:500},style:{width:"100%",height:"100%"},gl:{antialias:!0,toneMapping:ny,toneMappingExposure:1.2},children:s&&c?W.jsx(bG,{starSystems:s,planets:c,selectedSystem:t,onSelectSystem:T,selectedStarId:y,onSelectStarId:v,selectedPlanetId:x,onSelectPlanetId:E}):W.jsxs(W.Fragment,{children:[W.jsx(nD,{radius:120,depth:80,count:3e3,factor:3,saturation:.1,fade:!0,speed:.5}),W.jsx("ambientLight",{intensity:.1})]})}),(()=>{if(!t&&y&&s){const w=s.find(O=>O.id===y);if(!w)return null;const A=w.stars[0],N=c?.filter(O=>O.starSystemId===w.id)??[];return W.jsxs(vc,{sx:{position:"absolute",bottom:24,right:24,zIndex:10,width:320,maxHeight:"50vh",overflow:"auto",bgcolor:cn("#0a0f1e",.92),backdropFilter:"blur(12px)",border:`1px solid ${cn("#fff",.12)}`,p:2},children:[W.jsxs(gs,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:.5},children:[W.jsx(Nt,{variant:"h6",sx:{color:"#fff",fontWeight:700},children:w.name}),W.jsx(k_,{size:"small",onClick:()=>v(""),sx:{color:cn("#fff",.5),"&:hover":{color:"#fff"}},children:W.jsx(dA,{fontSize:"small"})})]}),W.jsxs(gs,{direction:"row",spacing:1,sx:{mb:1,flexWrap:"wrap"},children:[W.jsx(Un,{label:w.systemType==="binary"?"Binary":"Single",size:"small",sx:{bgcolor:cn("#7c4dff",.25),color:"#c9b0ff",fontSize:"0.7rem"}}),W.jsx(Un,{label:`${A.spectralClass}-class`,size:"small",sx:{bgcolor:cn(J0(A.spectralClass),.25),color:J0(A.spectralClass),fontSize:"0.7rem"}}),w.status&&W.jsx(Un,{label:w.status,size:"small",sx:{bgcolor:cn("#fff",.08),color:"#aaa",fontSize:"0.7rem"}})]}),w.description&&W.jsx(Nt,{variant:"body2",sx:{color:cn("#fff",.65),mb:1,fontSize:"0.78rem"},children:w.description}),W.jsx(R0,{sx:{borderColor:cn("#fff",.08),mb:1}}),W.jsxs(Nt,{variant:"caption",sx:{color:cn("#fff",.5),display:"block",mb:.5},children:["Temperature: ",A.surfaceTemperature?.toLocaleString(),"K  Habitable zone: ",w.habitableZone]}),N.length>0&&W.jsxs(Nt,{variant:"caption",sx:{color:cn("#fff",.5),display:"block",mb:1},children:[N.length," planet",N.length!==1?"s":"",": ",N.map(O=>O.name).join(", ")]}),W.jsx(ey,{variant:"contained",size:"small",fullWidth:!0,startIcon:W.jsx(OP,{}),onClick:()=>T(w),sx:{mt:.5,bgcolor:"#7c4dff",textTransform:"none",fontWeight:600,"&:hover":{bgcolor:"#9e73ff"}},children:"View System"})]})}if(t&&x&&c){const w=c.find(A=>A.id===x);return w?W.jsxs(vc,{sx:{position:"absolute",bottom:24,right:24,zIndex:10,width:320,maxHeight:"50vh",overflow:"auto",bgcolor:cn("#0a0f1e",.92),backdropFilter:"blur(12px)",border:`1px solid ${cn("#fff",.12)}`,p:2},children:[W.jsxs(gs,{direction:"row",alignItems:"center",spacing:1,sx:{mb:.5},children:[W.jsx(fb,{sx:{color:w.render.primaryColor,fontSize:20}}),W.jsx(Nt,{variant:"h6",sx:{color:"#fff",fontWeight:700,flex:1},children:w.name}),W.jsx(k_,{size:"small",onClick:()=>E(""),sx:{color:cn("#fff",.5),"&:hover":{color:"#fff"}},children:W.jsx(dA,{fontSize:"small"})})]}),W.jsxs(gs,{direction:"row",spacing:1,sx:{mb:1,flexWrap:"wrap"},children:[W.jsx(Un,{label:w.type,size:"small",sx:{bgcolor:cn(w.render.primaryColor,.25),color:w.render.primaryColor,fontSize:"0.7rem"}}),W.jsx(Un,{label:w.habitability,size:"small",sx:{bgcolor:cn(w.habitability==="habitable"?"#4caf50":"#ff9800",.2),color:w.habitability==="habitable"?"#81c784":"#ffb74d",fontSize:"0.7rem"}})]}),w.description&&W.jsx(Nt,{variant:"body2",sx:{color:cn("#fff",.65),mb:1,fontSize:"0.78rem"},children:w.description}),W.jsx(R0,{sx:{borderColor:cn("#fff",.08),mb:1}}),W.jsxs(gs,{spacing:.3,sx:{mb:1},children:[W.jsxs(Nt,{variant:"caption",sx:{color:cn("#fff",.5)},children:["Climate: ",w.climate,"  Atmosphere: ",w.atmosphere]}),W.jsxs(Nt,{variant:"caption",sx:{color:cn("#fff",.5)},children:["Gravity: ",w.gravity,"  Orbit period: ",w.orbit.orbitalPeriod," days"]}),w.moons.length>0&&W.jsxs(Nt,{variant:"caption",sx:{color:cn("#fff",.5)},children:["Moons: ",w.moons.join(", ")]})]}),w.pointsOfInterest.length>0&&W.jsxs(W.Fragment,{children:[W.jsx(Nt,{variant:"caption",sx:{color:cn("#fff",.4),fontWeight:600,display:"block",mb:.3},children:"Points of Interest"}),W.jsx(gs,{direction:"row",spacing:.5,sx:{flexWrap:"wrap",gap:.5},children:w.pointsOfInterest.map(A=>W.jsx(Un,{label:A,size:"small",sx:{bgcolor:cn("#fff",.06),color:"#aaa",fontSize:"0.68rem"}},A))})]})]}):null}return null})()]})}function EG(){return W.jsx(BP,{children:W.jsx(VP,{children:W.jsxs(au,{element:W.jsx(qP,{}),children:[W.jsx(au,{path:"/",element:W.jsx(XP,{})}),W.jsx(au,{path:"/worlds",element:W.jsx($P,{})}),W.jsx(au,{path:"/worlds/:worldId",element:W.jsx(eL,{})}),W.jsx(au,{path:"/worlds/:worldId/timeline",element:W.jsx(oL,{})}),W.jsx(au,{path:"/worlds/:worldId/graph",element:W.jsx(cL,{})}),W.jsx(au,{path:"/worlds/:worldId/galaxy",element:W.jsx(SG,{})}),W.jsx(au,{path:"/worlds/:worldId/:entityType",element:W.jsx(nL,{})}),W.jsx(au,{path:"/worlds/:worldId/:entityType/:entityId",element:W.jsx(aL,{})})]})})})}jP.createRoot(document.getElementById("root")).render(W.jsx(Ve.StrictMode,{children:W.jsxs(UP,{theme:WP,children:[W.jsx(zP,{}),W.jsx(EG,{})]})}));
